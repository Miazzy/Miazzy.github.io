{"version":3,"file":"MiddleContent-aa256f5d.js","sources":["../../src/views/da/cockpit/power/MiddleContent.vue"],"sourcesContent":["<template>\n  <div class=\"middle-content\">\n    <div class=\"top-section data-board-box\">\n      <div class=\"data-board-box-inner\">\n        <DataBoardItem\n          title=\"实发电量(万kWh)\"\n          icon=\"realGen\"\n          :style=\"{ height: tabStatus === 'on' ? `10.09vh` : `10.88vh` }\"\n          :value=\"indexData.gen != null ? indexData.gen : ''\"\n          :tRatio=\"indexData.tGen != null ? indexData.tGen + '%' : ''\"\n          :hRatio=\"indexData.hGen != null ? indexData.hGen + '%' : ''\"\n          @clickValue=\"handlePowerContrast\"\n        />\n        <DataBoardItem\n          title=\"上网电量(万kWh)\"\n          icon=\"online\"\n          :style=\"{ height: tabStatus === 'on' ? `10.09vh` : `10.88vh` }\"\n          :value=\"indexData.online != null ? indexData.online : ''\"\n          :tRatio=\"indexData.tOnline != null ? indexData.tOnline + '%' : ''\"\n          :hRatio=\"indexData.hOnline != null ? indexData.hOnline + '%' : ''\"\n          @clickValue=\"handlePowerContrast\"\n        />\n        <DataBoardItem\n          title=\"结算电量(万kWh)\"\n          icon=\"settlement\"\n          :style=\"{ height: tabStatus === 'on' ? `10.09vh` : `10.88vh` }\"\n          :value=\"indexData.settlement != null ? indexData.settlement : ''\"\n          :tRatio=\"indexData.tSettlement != null ? indexData.tSettlement + '%' : ''\"\n          :hRatio=\"indexData.hSettlement != null ? indexData.hSettlement + '%' : ''\"\n          @clickValue=\"handlePowerContrast\"\n        />\n        <DataBoardItem\n          title=\"损失电量(万kWh)\"\n          icon=\"loss\"\n          :style=\"{ height: tabStatus === 'on' ? `10.09vh` : `10.88vh` }\"\n          :value=\"indexData.loss != null ? indexData.loss : ''\"\n          :tRatio=\"indexData.tLoss != null ? indexData.tLoss + '%' : ''\"\n          :hRatio=\"indexData.hLoss != null ? indexData.hLoss + '%' : ''\"\n          @clickValue=\"handlePowerContrast\"\n        />\n        <DataBoardItem\n          title=\"损失率(%)\"\n          icon=\"lossRate\"\n          tbTitle=\"同比\"\n          hbTitle=\"环比\"\n          :style=\"{ height: tabStatus === 'on' ? `10.09vh` : `10.88vh` }\"\n          :value=\"indexData.lossRate != null ? indexData.lossRate : ''\"\n          :tRatio=\"indexData.tLossRate != null ? indexData.tLossRate + '%' : ''\"\n          :hRatio=\"indexData.hLossRate != null ? indexData.hLossRate + '%' : ''\"\n        />\n        <DataBoardItem\n          title=\"综合厂用电率(%)\"\n          icon=\"facRate\"\n          tbTitle=\"同比\"\n          hbTitle=\"环比\"\n          :style=\"{ height: tabStatus === 'on' ? `10.09vh` : `10.88vh` }\"\n          :value=\"indexData.facRate != null ? indexData.facRate : ''\"\n          :tRatio=\"indexData.tFacRate != null ? indexData.tFacRate + '%' : ''\"\n          :hRatio=\"indexData.hFacRate != null ? indexData.hFacRate + '%' : ''\"\n          @clickValue=\"handlePowerContrast\"\n        />\n        <!-- <DataBoardItem\n          title=\"系统效率(%)\"\n          icon=\"sysRate\"\n          tbTitle=\"同比\"\n          hbTitle=\"环比\"\n          :style=\"{ height: tabStatus === 'on' ? `10.09vh` : `10.88vh` }\"\n          :value=\"indexData.sysRate != null ? indexData.sysRate : ''\"\n          :tRatio=\"indexData.tSysRate != null ? indexData.tSysRate + '%' : ''\"\n          :hRatio=\"indexData.hSysRate != null ? indexData.hSysRate + '%' : ''\"\n          @clickValue=\"handlePowerContrast\"\n        /> -->\n        <!-- <DataBoardItem\n          title=\"计划完成(%)\"\n          icon=\"comRate\"\n          tbTitle=\"同比\"\n          hbTitle=\"环比\"\n          :style=\"{ height: tabStatus === 'on' ? `10.09vh` : `10.88vh` }\"\n          :value=\"indexData.comRate != null ? indexData.comRate : ''\"\n          :tRatio=\"indexData.tComRate != null ? indexData.tComRate + '%' : ''\"\n          :hRatio=\"indexData.hComRate != null ? indexData.hComRate + '%' : ''\"\n        /> -->\n      </div>\n    </div>\n    <div :key=\"instanceKey\" class=\"data-chart-box\"> \n      <div class=\"middel-section section-box\">\n        <div class=\"section-bg\">\n          <SubtitleBar :subtitle=\"`电站能效排行`\">\n            <a-select\n              ref=\"select\"\n              label-in-value\n              v-model:value=\"searchInfo.selectEnergyValue\"\n              style=\"width: 1.2rem\"\n              :options=\"optionsEnergy\"\n              @change=\"handleEnergyChange\"\n            />\n          </SubtitleBar>\n          <div style=\"width: 100%; height: 2rem\">\n            <div style=\"margin-left: 0.16rem; transform: scale(0.85); transform-origin: 0 0\">\n              <EchartPillarChart\n                :data=\"energyChartData\"\n                :colors=\"energyChartData.colors\"\n                :width=\"`57vw`\"\n                :height=\"tabStatus === 'on' ? `32.42vh` : `36.17vh`\"\n                :name=\"energyChartName\"\n                :rotate=\"0\"\n                @clickItem=\"handlePowerContrastByParams\"\n                :dataZoomDisabled=\"false\"\n                :dataZoomDefaultValueRange=\"[0, 9]\"\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"bottom-section section-box\">\n        <div class=\"section-bg\">\n          <SubtitleBar :subtitle=\"`电站电量排行`\">\n            <a-select\n              ref=\"select\"\n              label-in-value\n              v-model:value=\"searchInfo.selectPowerValue\"\n              :options=\"optionsPower\"\n              style=\"width: 1.2rem\"\n              @change=\"handlePowerChange\"\n            />\n          </SubtitleBar>\n          <div style=\"width: 100%; height: 2rem\">\n            <div style=\"margin-left: 0.16rem; transform: scale(0.85); transform-origin: 0 0\">\n              <EchartPillarChart\n                :data=\"powerChartData\"\n                :colors=\"powerChartData.colors\"\n                :width=\"`57vw`\"\n                :height=\"tabStatus === 'on' ? `32.42vh` : `36.17vh`\"\n                :name=\"powerChartName\"\n                :rotate=\"0\"\n                @clickItem=\"handlePowerContrastByParams\"\n                :dataZoomDisabled=\"false\"\n                :dataZoomDefaultValueRange=\"[0, 9]\"\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import { reactive, UnwrapRef, ref, onMounted, watch } from 'vue';\n  import { assign } from 'lodash-es';\n  import DataBoardItem from '/@/components/Framework/Chart/DataBoardItem.vue';\n  import { handleRouteChange } from '../../utils';\n  import SubtitleBar from '/@/components/Framework/Chart/SubtitleBar.vue';\n  import EchartPillarChart from '/@/components/Framework/Chart/EchartPillarChart.vue';\n  import { optionsEnergy, getEnergyData, getPowerData, optionsPower } from './data';\n  import { buildUUID } from '@/utils/uuid';\n\n  //搜索参数\n  const searchInfo: UnwrapRef<any> = reactive({});\n  const indexData: UnwrapRef<any> = reactive({});\n  const instanceKey = ref(buildUUID());\n\n  interface Props {\n    topIndexData?: {};\n    searchInfoByTime?: {};\n    tabStatus?: '';\n  }\n  const props = withDefaults(defineProps<Props>(), {});\n  watch(\n    () => props.topIndexData,\n    (value) => {\n      assign(indexData, value);\n    },\n  );\n\n  //=============================== 电站能效==============================================\n  const energyChartData = ref({\n    barData: [],\n    lineData: [[], []],\n    categories: [],\n    units: ['', '(%)', '(%)'],\n    colors: [\n      ['#1890ff', '#18c8ff'],\n      ['#E59837', '#FAE895'],\n      ['#078C5D', '#68E4B8'],\n    ],\n  });\n\n  const energyChartName = ref(['等效小时数', '同比', '环比']);\n  const queryEnergyData = async () => {\n    searchInfo.index = searchInfo.selectEnergyValue;\n    if (searchInfo.selectValue === 'uth') {\n      energyChartData.value.units = ['(h)', '(%)', '(%)'];\n    }\n    if (searchInfo.selectValue === 'sys') {\n      energyChartData.value.units = ['(%)', '(%)', '(%)'];\n    }\n    if (searchInfo.selectValue === 'dwfd') {\n      energyChartData.value.units = ['(kwh)', '(%)', '(%)'];\n    }\n    let data = await getEnergyData(searchInfo);\n    if (data.result) {\n      energyChartData.value.barData = data.result.barData;\n      energyChartData.value.lineData = data.result.lineData;\n      energyChartData.value.categories = data.result.categories;\n    }\n  };\n  const handleEnergyChange = (value: string) => {\n    searchInfo.selectEnergyValue = value.value;\n    queryEnergyData();\n    energyChartName.value.splice(0, 1, value.label);\n  };\n\n  //=============================== 电站能量==============================================\n  const powerChartData = ref({\n    barData: [],\n    lineData: [[]],\n    categories: [],\n    units: ['(万Kw.h)', '(%)', '(%)'],\n    colors: [\n      ['#078C5D', '#68E4B8'],\n      ['#E59837', '#FAE895'],\n      ['#078C5D', '#68E4B8'],\n    ],\n  });\n  const powerChartName = ['理论电量', '同比', '环比'];\n\n  const handlePowerChange = (value: string) => {\n    searchInfo.selectPowerValue = value.value;\n    queryPowerData();\n    powerChartName.splice(0, 1, value.label);\n  };\n\n  const queryPowerData = async () => {\n    searchInfo.index = searchInfo.selectPowerValue;\n    let data = await getPowerData(searchInfo);\n    if (data.result) {\n      powerChartData.value.barData = data.result.barData;\n      powerChartData.value.lineData = data.result.lineData;\n      powerChartData.value.categories = data.result.categories;\n    }\n  };\n\n  watch(\n    () => props.searchInfoByTime,\n    (value) => {\n      assign(searchInfo, value);\n      //能效排行\n      queryEnergyData();\n      //电量排行\n      queryPowerData();\n    },\n  );\n\n  //=============================== 数据穿透==============================================\n  function handlePowerContrast() {\n    handleRouteChange('/bi/elec/powerContrast', {});\n  }\n\n  //echart帶參\n  function handlePowerContrastByParams(params) {\n    handleRouteChange('/bi/elec/powerContrast', { stationId: params.data.id });\n  }\n\n  // 更新组件函数\n  const handleUpdate = () => {\n    instanceKey.value = buildUUID();\n  };\n\n  defineExpose({\n    handleUpdate,\n  });\n\n  onMounted(() => {\n    assign(indexData, props.topIndexData);\n    assign(searchInfo, props.searchInfoByTime);\n    //能效默认值\n    searchInfo.selectEnergyValue = 'uth';\n    //电量默认值\n    searchInfo.selectPowerValue = 'theory';\n  });\n</script>\n\n<style lang=\"less\" scoped>\n  .middle-content {\n    display: flex;\n    flex-direction: column;\n    width: 50vw;\n    height: 100%;\n    padding-bottom: 1.68vh;\n\n    .data-board-box {\n      flex: 24%;\n      height: 24%;\n    }\n\n    .data-chart-box {\n      flex: 76%;\n      height: 76%;\n    }\n\n    .section-box {\n      flex: 50%;\n      height: 50%;\n      padding-top: 0.92vh;\n      overflow: hidden;\n\n      .section-bg {\n        width: 100%;\n        height: 100%;\n        background: url('../../../../assets/images/da/section_bg_2.png') no-repeat center/100% 100%;\n      }\n    }\n\n    .data-board-box-inner {\n      display: flex;\n      flex-wrap: wrap;\n      align-content: space-between;\n      align-items: center;\n      justify-content: space-between;\n      width: 100%;\n      height: 100%;\n\n      :deep(.data-board-item) {\n        width: 16.1vw;\n        padding: 0 0.2rem;\n        .title-box {\n          .icon-box {\n            margin-right: 0.14rem;\n          }\n        }\n      }\n    }\n  }\n</style>\n"],"names":["searchInfo","reactive","indexData","instanceKey","ref","buildUUID","watch","props","value","assign","energyChartData","energyChartName","queryEnergyData","__async","data","getEnergyData","handleEnergyChange","powerChartData","powerChartName","handlePowerChange","queryPowerData","getPowerData","handlePowerContrast","handleRouteChange","handlePowerContrastByParams","params","__expose","onMounted"],"mappings":"k3CA8JQA,EAA6BC,EAAS,CAAA,CAAE,EACxCC,EAA4BD,EAAS,CAAA,CAAE,EACvCE,EAAcC,EAAIC,EAAA,CAAW,EAQnCC,EACE,IAAMC,EAAM,aACXC,GAAU,CACTC,EAAOP,EAAWM,CAAK,CACzB,CAAA,EAIF,MAAME,EAAkBN,EAAI,CAC1B,QAAS,CAAC,EACV,SAAU,CAAC,CAAC,EAAG,EAAE,EACjB,WAAY,CAAC,EACb,MAAO,CAAC,GAAI,MAAO,KAAK,EACxB,OAAQ,CACN,CAAC,UAAW,SAAS,EACrB,CAAC,UAAW,SAAS,EACrB,CAAC,UAAW,SAAS,CACvB,CAAA,CACD,EAEKO,EAAkBP,EAAI,CAAC,QAAS,KAAM,IAAI,CAAC,EAC3CQ,EAAkB,IAAYC,EAAA,sBAClCb,EAAW,MAAQA,EAAW,kBAC1BA,EAAW,cAAgB,QAC7BU,EAAgB,MAAM,MAAQ,CAAC,MAAO,MAAO,KAAK,GAEhDV,EAAW,cAAgB,QAC7BU,EAAgB,MAAM,MAAQ,CAAC,MAAO,MAAO,KAAK,GAEhDV,EAAW,cAAgB,SAC7BU,EAAgB,MAAM,MAAQ,CAAC,QAAS,MAAO,KAAK,GAElD,IAAAI,EAAO,MAAMC,EAAcf,CAAU,EACrCc,EAAK,SACSJ,EAAA,MAAM,QAAUI,EAAK,OAAO,QAC5BJ,EAAA,MAAM,SAAWI,EAAK,OAAO,SAC7BJ,EAAA,MAAM,WAAaI,EAAK,OAAO,WACjD,GAEIE,EAAsBR,GAAkB,CAC5CR,EAAW,kBAAoBQ,EAAM,MACrBI,IAChBD,EAAgB,MAAM,OAAO,EAAG,EAAGH,EAAM,KAAK,CAAA,EAI1CS,EAAiBb,EAAI,CACzB,QAAS,CAAC,EACV,SAAU,CAAC,CAAA,CAAE,EACb,WAAY,CAAC,EACb,MAAO,CAAC,UAAW,MAAO,KAAK,EAC/B,OAAQ,CACN,CAAC,UAAW,SAAS,EACrB,CAAC,UAAW,SAAS,EACrB,CAAC,UAAW,SAAS,CACvB,CAAA,CACD,EACKc,EAAiB,CAAC,OAAQ,KAAM,IAAI,EAEpCC,EAAqBX,GAAkB,CAC3CR,EAAW,iBAAmBQ,EAAM,MACrBY,IACfF,EAAe,OAAO,EAAG,EAAGV,EAAM,KAAK,CAAA,EAGnCY,EAAiB,IAAYP,EAAA,sBACjCb,EAAW,MAAQA,EAAW,iBAC1B,IAAAc,EAAO,MAAMO,EAAarB,CAAU,EACpCc,EAAK,SACQG,EAAA,MAAM,QAAUH,EAAK,OAAO,QAC5BG,EAAA,MAAM,SAAWH,EAAK,OAAO,SAC7BG,EAAA,MAAM,WAAaH,EAAK,OAAO,WAChD,GAGFR,EACE,IAAMC,EAAM,iBACXC,GAAU,CACTC,EAAOT,EAAYQ,CAAK,EAERI,IAEDQ,GACjB,CAAA,EAIF,SAASE,GAAsB,CACXC,EAAA,yBAA0B,CAAA,CAAE,CAChD,CAGA,SAASC,EAA4BC,EAAQ,CAC3CF,EAAkB,yBAA0B,CAAE,UAAWE,EAAO,KAAK,GAAI,CAC3E,CAOa,OAAAC,EAAA,CACX,aALmB,IAAM,CACzBvB,EAAY,MAAQE,GAAU,CAI9B,CACD,EAEDsB,EAAU,IAAM,CACPlB,EAAAP,EAAWK,EAAM,YAAY,EAC7BE,EAAAT,EAAYO,EAAM,gBAAgB,EAEzCP,EAAW,kBAAoB,MAE/BA,EAAW,iBAAmB,QAAA,CAC/B"}