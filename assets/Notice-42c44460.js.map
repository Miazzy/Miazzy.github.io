{"version":3,"file":"Notice-42c44460.js","sources":["../../src/api/workbench/index.ts","../../src/views/workbench/Notice.vue"],"sourcesContent":["import { defHttp } from '@/utils/http/axios';\n\n// 查询通知公告列表\nexport function getNoticeAndAnnouncementPage(params) {\n  return defHttp.get(\n    { url: '/po/workbench/notice-and-announcement-page', params },\n    { isOnlyResult: true },\n  );\n}\n\n// 查询资讯列表\nexport function getInformationPage(params) {\n  return defHttp.get(\n    { url: '/po/workbench/information-page', params },\n    { isOnlyResult: true },\n  );\n}\n","<template>\n  <a-card title=\"信息公告\" :bordered=\"false\">\n    <template #extra>\n      <span @click=\"toMorePage\">更多 &gt;</span>\n    </template>\n    <div class=\"card-content\">\n      <a-tabs v-model:activeKey=\"activeKey\" @change=\"handleTabChange\">\n        <a-tab-pane key=\"1\" tab=\"通知公告\">\n          <ul class=\"notice-list-box\">\n            <li\n              class=\"notice-item\"\n              @click=\"toNotice(item)\"\n              v-for=\"(item, index) in noticeList\"\n              :key=\"index\"\n            >\n              <span class=\"item-dot\"></span>\n              <span class=\"title-text\" :class=\"{ isRead: item.isRead }\">{{ item.title }}</span>\n              <span class=\"dept-text\">{{ item.dept }}</span>\n              <span class=\"person-text\">{{ item.person }}</span>\n              <span class=\"time-text\">{{ item.time }}</span>\n            </li>\n          </ul>\n        </a-tab-pane>\n        <a-tab-pane key=\"2\" tab=\"资讯\" force-render>\n          <ul class=\"notice-list-box\">\n            <li\n              class=\"notice-item\"\n              @click=\"toInformation(item)\"\n              v-for=\"(item, index) in informationList\"\n              :key=\"index\"\n            >\n              <span class=\"item-dot\"></span>\n              <span class=\"title-text\">{{ item.title }}</span>\n              <span class=\"dept-text\">{{ item.type }}</span>\n              <span class=\"person-text\">{{ item.person }}</span>\n              <span class=\"time-text\">{{ item.time }}</span>\n            </li>\n          </ul>\n        </a-tab-pane>\n      </a-tabs>\n    </div>\n  </a-card>\n</template>\n\n<script lang=\"ts\" setup>\n  import { ref, onMounted } from 'vue';\n  import * as DateUtil from '/@/utils/dateUtil';\n  import * as WorkbenchApi from '@/api/workbench';\n  import { addTabPage } from '@/utils/route';\n\n\n  const noticeList = ref([]);\n  const informationList = ref([]);\n\n  const toMorePage = () => {\n    if(activeKey.value == '1'){\n      addTabPage(`/oa/info/query/index`, '信息查询');\n    }else{\n      addTabPage('/oa/info/informationquery/index', '资讯查询');\n    }\n    \n  };\n\n\n  const activeKey = ref('1');\n  const handleTabChange = (item) => {\n    if (item === '1') {\n      getNoticeAndAnnouncementPage();\n    } else if (item === '2') {\n      getInformation();\n    } \n  };\n\n  const toNotice = (item) => {\n    var params = {\n      bizId: item.id,\n      module: item.businessType,\n    };\n    addTabPage('/oa/info/officedoc/view', '通知公告详情', params);\n\n    item.isRead = 1; //设置为已读\n\n  };\n\n  const toInformation = (item) => {\n    if(item.source === '1'){\n      window.open(item.url);\n    }else{\n      var params = {\n        bizId: item.id\n      };\n      addTabPage('/oa/info/informationquery/view', '资讯详情', params);\n    }\n  };\n\n  const getNoticeAndAnnouncementPage = async () => {\n    const noticeAndAnnouncement = await WorkbenchApi.getNoticeAndAnnouncementPage({\n      pageNo: 1,\n      pageSize: 6,\n    });\n    if (noticeAndAnnouncement) {\n      noticeList.value.splice(0, noticeList.value.length);\n      noticeAndAnnouncement.list.forEach((e) => {\n        noticeList.value.push({\n          id: e.id,\n          title: e.subject,\n          dept: e.deptName,\n          person: e.personMemberName,\n          time: DateUtil.formatToDate(e.finishedDate, 'YYYY-MM-DD HH:mm'),\n          isRead: e.isRead,\n          businessType: e.businessType,\n        });\n      });\n    }\n  };\n\n  const getInformation = async () => {\n    const information = await WorkbenchApi.getInformationPage({\n      pageNo: 1,\n      pageSize: 6,\n    });\n    if (information) {\n      informationList.value.splice(0, informationList.value.length);\n      information.list.forEach((e) => {\n        informationList.value.push({\n          id: e.id,\n          title: e.subject,\n          type: e.typeText,\n          source: e.source,\n          url: e.url,\n          person: e.personMemberName,\n          time: DateUtil.formatToDate(e.finishedDate, 'YYYY-MM-DD'),\n          // isRead: e.isRead,\n          // businessType: e.businessType,\n        });\n      });\n    }\n  };\n\n  /** 初始化 */\n  onMounted(async () => {\n    getNoticeAndAnnouncementPage();\n  });\n</script>\n\n<style lang=\"less\" scoped>\n  .card-content {\n    height: 318px;\n    padding-top: 2px;\n\n    .notice-item {\n      display: flex;\n      align-items: center;\n      font-size: 14px;\n      line-height: 42px;\n\n      .item-dot {\n        width: 5px;\n        height: 5px;\n        border-radius: 50%;\n      }\n\n      .title-text {\n        width: 67%;\n        padding: 0 14px;\n        overflow: hidden;\n        opacity: 0.97;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        cursor: pointer;\n      }\n\n      .dept-text {\n        width: 12%;\n        padding-right: 14px;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n      }\n\n      .person-text {\n        width: 7%;\n        padding-right: 14px;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n      }\n\n      .time-text {\n        width: 14%;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n      }\n    }\n  }\n</style>\n"],"names":["getNoticeAndAnnouncementPage","params","defHttp","getInformationPage","noticeList","ref","informationList","toMorePage","activeKey","addTabPage","handleTabChange","item","getInformation","toNotice","toInformation","__async","noticeAndAnnouncement","WorkbenchApi.getNoticeAndAnnouncementPage","DateUtil.formatToDate","information","WorkbenchApi.getInformationPage","onMounted"],"mappings":"sbAGO,SAASA,EAA6BC,EAAQ,CACnD,OAAOC,EAAQ,IACb,CAAE,IAAK,6CAA8C,OAAAD,CAAO,EAC5D,CAAE,aAAc,EAAK,CAAA,CAEzB,CAGO,SAASE,EAAmBF,EAAQ,CACzC,OAAOC,EAAQ,IACb,CAAE,IAAK,iCAAkC,OAAAD,CAAO,EAChD,CAAE,aAAc,EAAK,CAAA,CAEzB,wbCmCQ,MAAAG,EAAaC,EAAI,CAAA,CAAE,EACnBC,EAAkBD,EAAI,CAAA,CAAE,EAExBE,EAAa,IAAM,CACpBC,EAAU,OAAS,IACpBC,EAAW,uBAAwB,MAAM,EAEzCA,EAAW,kCAAmC,MAAM,CACtD,EAKID,EAAYH,EAAI,GAAG,EACnBK,EAAmBC,GAAS,CAC5BA,IAAS,IACkBX,IACpBW,IAAS,KACHC,GACjB,EAGIC,EAAYF,GAAS,CACzB,IAAIV,EAAS,CACX,MAAOU,EAAK,GACZ,OAAQA,EAAK,YAAA,EAEJF,EAAA,0BAA2B,SAAUR,CAAM,EAEtDU,EAAK,OAAS,CAAA,EAIVG,EAAiBH,GAAS,CAC3B,GAAAA,EAAK,SAAW,IACV,OAAA,KAAKA,EAAK,GAAG,MACjB,CACH,IAAIV,EAAS,CACX,MAAOU,EAAK,EAAA,EAEHF,EAAA,iCAAkC,OAAQR,CAAM,CAC7D,CAAA,EAGID,EAA+B,IAAYe,EAAA,sBACzC,MAAAC,EAAwB,MAAMC,EAA0C,CAC5E,OAAQ,EACR,SAAU,CAAA,CACX,EACGD,IACFZ,EAAW,MAAM,OAAO,EAAGA,EAAW,MAAM,MAAM,EAC5BY,EAAA,KAAK,QAAS,GAAM,CACxCZ,EAAW,MAAM,KAAK,CACpB,GAAI,EAAE,GACN,MAAO,EAAE,QACT,KAAM,EAAE,SACR,OAAQ,EAAE,iBACV,KAAMc,EAAsB,EAAE,aAAc,kBAAkB,EAC9D,OAAQ,EAAE,OACV,aAAc,EAAE,YAAA,CACjB,CAAA,CACF,EACH,GAGIN,EAAiB,IAAYG,EAAA,sBAC3B,MAAAI,EAAc,MAAMC,EAAgC,CACxD,OAAQ,EACR,SAAU,CAAA,CACX,EACGD,IACFb,EAAgB,MAAM,OAAO,EAAGA,EAAgB,MAAM,MAAM,EAChDa,EAAA,KAAK,QAAS,GAAM,CAC9Bb,EAAgB,MAAM,KAAK,CACzB,GAAI,EAAE,GACN,MAAO,EAAE,QACT,KAAM,EAAE,SACR,OAAQ,EAAE,OACV,IAAK,EAAE,IACP,OAAQ,EAAE,iBACV,KAAMY,EAAsB,EAAE,aAAc,YAAY,CAAA,CAGzD,CAAA,CACF,EACH,GAIF,OAAAG,EAAU,IAAYN,EAAA,sBACSf,GAAA,EAC9B"}