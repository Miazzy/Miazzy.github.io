var D=(w,r,n)=>new Promise((h,f)=>{var k=s=>{try{o(n.next(s))}catch(d){f(d)}},I=s=>{try{o(n.throw(s))}catch(d){f(d)}},o=s=>s.done?h(s.value):Promise.resolve(s.value).then(k,I);o((n=n.apply(w,r)).next())});import{I as j,ay as T,_ as z}from"./index.js";import{aG as O,aF as E,ba as F,aC as V,ai as U,K as $}from"./antd-15ac76ed.js";import{B as G}from"./BasicTable-0434a334.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1ba7be9e.js";import"./index-085d06c7.js";import{u as K}from"./useTable-109483b3.js";import{_ as q}from"./EchartLineChart.vue_vue_type_style_index_0_lang-c85cdf3b.js";import{e as A,R as P}from"./monitorApi-44e70004.js";import"./index-74ac3212.js";import{j as X}from"./Export2Excel-389a8fc9.js";import{d as Z,k as c,r as H,w as J,o as Q,Z as m,_ as v,$ as _,f as i,aa as x,u as l,ac as y,E as W}from"./vue-71d1abb3.js";import"./useForm-dea3ed18.js";import"./uniqBy-92d3bc7f.js";import"./index-316f6ffb.js";import"./useWindowSizeFn-13b1b8a2.js";import"./index-f4fc48e6.js";import"./useTabs-2b062e85.js";import"./download-03e71dd5.js";import"./index-5d49b7a7.js";import"./SearchBox-22bb02d6.js";import"./UploadBox-636ecf02.js";import"./Dialog-0a006d82.js";import"./DictSelectBox.vue_vue_type_script_setup_true_lang-e03e9fe8.js";import"./OrganDialog-dd1023ce.js";import"./sortable.esm-4ae27e0b.js";import"./dict-c04c0dd8.js";import"./install-58e0bd81.js";import"./helper-474c7a04.js";import"./api-32c7505d.js";const ee={class:"data-detail"},te={class:"header-box"},ae={class:"header-left"},se={class:"radio-btn-box"},oe={class:"date-picker-box"},ie={key:0,class:"select-box"},ne={key:0,class:"header-right"},le={class:"content-box"},re={key:0,class:"chart-box"},ce={key:1,class:"table-box"},de=Z({__name:"seriesDataDetail",props:{tableColumns:{},stationDeviceInfo:{}},setup(w){const r=w,n=c([]),h=c([]),f=()=>D(this,null,function*(){return h}),[k,{reload:I}]=K({api:f,columns:n,bordered:!0,showTableSetting:!1,rowKey:"time",pagination:{show:!0,pageSize:15},tableSetting:{fullScreen:!1}}),o=c("chart"),s=c(),d=e=>{console.log("选择日期",e),N()},u=c([]),C=c([]),L=e=>{console.log(`selected ${e}`),u.value=e,N()},M=()=>{n.value=r.tableColumns;let e=new Date;s.value=$(T(e),"YYYY-MM-DD")},R=e=>D(this,null,function*(){let{stationId:a,areaId:t,esn:g}=e,b=yield A({stationId:a,areaId:t,esn:g,dataType:3}),Y=[];b.forEach(B=>{Y.push({label:B.addressDesc,value:B.addressField})}),C.value=Y}),p=H({categories:[],lineData:[],units:[],seriesName:[]}),N=()=>D(this,null,function*(){let e={},a=[];a.push(r.stationDeviceInfo.esn),e.queryFieldList=u.value,e.startDate=T(s.value),e.endDate=T(s.value),e.esns=a,e.esn=r.stationDeviceInfo.esn,e.dataType=1;let t=yield P(e);t!=null&&t.length&&t[0]?Object.assign(p,{lineData:t[0].dataList,categories:t[0].timeList,units:t[0].unitList,seriesName:t[0].zhList}):Object.assign(p,{lineData:[],categories:[],units:[],seriesName:[]}),Object.assign(p,{categories:["组串1","组串2","组串3"],lineData:[[1,2,4],[6,5,4],[11,23,17],[20,10,30]],units:["kw","kwh","mw","h"],seriesName:["指标1","指标2","指标3","指标4"]})});function S(){let e={};n.value.forEach(t=>{e[t.dataIndex]=t.title});let a=[];h.value.forEach(t=>{let g={};for(let b in e)g[b]=t[b];a.push(g)}),X({data:a,header:e,filename:"数据明细.xlsx"})}return J(()=>r.stationDeviceInfo,e=>{Object.assign(p,{lineData:[],categories:[],units:[],seriesName:[]}),u.value=[],C.value=[],R(e)},{deep:!0}),Q(()=>{M()}),(e,a)=>(m(),v("div",ee,[_("div",te,[_("div",ae,[_("div",se,[i(l(E),{value:o.value,"onUpdate:value":a[0]||(a[0]=t=>o.value=t),size:"small"},{default:x(()=>[i(l(O),{value:"chart"},{default:x(()=>[i(j,{icon:"ant-design:line-chart-outlined",class:"radio-btn-icon",size:14})]),_:1}),i(l(O),{value:"table"},{default:x(()=>[i(j,{icon:"ant-design:insert-row-above-outlined",class:"radio-btn-icon",size:14})]),_:1})]),_:1},8,["value"])]),_("div",oe,[i(l(F),{value:s.value,"onUpdate:value":a[1]||(a[1]=t=>s.value=t),valueFormat:"YYYY-MM-DD",onChange:d},null,8,["value"])]),o.value==="chart"?(m(),v("div",ie,[i(l(V),{value:u.value,"onUpdate:value":a[2]||(a[2]=t=>u.value=t),mode:"multiple",style:{"min-width":"206px"},placeholder:"选择指标",options:C.value,"max-tag-count":2,showArrow:"",onChange:L},null,8,["value","options"])])):y("",!0)]),o.value==="table"?(m(),v("div",ne,[i(l(U),{type:"primary",onClick:S},{default:x(()=>[W("导出")]),_:1})])):y("",!0)]),_("div",le,[o.value==="chart"?(m(),v("div",re,[i(q,{data:p,width:1372,height:302},null,8,["data"])])):y("",!0),o.value==="table"?(m(),v("div",ce,[i(l(G),{onRegister:l(k),scroll:{y:500}},null,8,["onRegister"])])):y("",!0)])]))}});const Ue=z(de,[["__scopeId","data-v-55eb2bd4"]]);export{Ue as default};
//# sourceMappingURL=seriesDataDetail-291e7e62.js.map
