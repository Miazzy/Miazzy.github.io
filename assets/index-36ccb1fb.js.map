{"version":3,"file":"index-36ccb1fb.js","sources":["../../src/views/po/equipment/equipment.data.ts","../../src/views/po/equipment/index.vue"],"sourcesContent":["import { BasicColumn, FormSchema, useRender } from '@/components/Table';\n\nconst statusArr: any = [\n  { label: '全部', value: '' },\n  { label: '启用', value: '1' },\n  { label: '禁用', value: '0' },\n];\n\nexport const columns: BasicColumn[] = [\n  {\n    title: '电站',\n    dataIndex: 'stationName',\n    width: 160,\n    sorter: true,\n    resizable: true,\n  },\n\n  {\n    title: '期数',\n    dataIndex: 'periodName',\n    width: 160,\n    sorter: true,\n    resizable: true,\n  },\n  {\n    title: '设备编码',\n    dataIndex: 'code',\n    width: 160,\n    sorter: true,\n    resizable: true,\n  },\n  {\n    title: '区域子阵',\n    dataIndex: 'subarrayName',\n    width: 160,\n    sorter: true,\n    resizable: true,\n  },\n  {\n    title: '设备名称',\n    dataIndex: 'name',\n    width: 160,\n    sorter: true,\n    resizable: true,\n  },\n  {\n    title: '物料全称',\n    dataIndex: 'materialWholeName',\n    width: 160,\n    sorter: true,\n    resizable: true,\n  },\n  {\n    title: '生产厂家',\n    dataIndex: 'factoryName',\n    width: 160,\n    sorter: true,\n    resizable: true,\n  },\n  {\n    title: '供应商',\n    dataIndex: 'supplierName',\n    width: 160,\n    sorter: true,\n    resizable: true,\n  },\n  {\n    title: '数量',\n    dataIndex: 'qty',\n    width: 160,\n    sorter: true,\n    resizable: true,\n  },\n\n  {\n    title: '计量单位',\n    dataIndex: 'unitId',\n    width: 160,\n    sorter: true,\n    resizable: true,\n  },\n  {\n    title: '关联设备',\n    dataIndex: 'deviceCode',\n    width: 200,sorter: true,\n    resizable: true,\n    customRender: ({ text, record }) => {\n      let url = `/baseset/monitor/device?deviceEsn=${record.deviceCode}`;\n      return useRender.renderIframeLink(url, text,null,text);\n    },\n  },\n  {\n    title: '投运日期',\n    dataIndex: 'usedDate',\n    width: 160,\n    sorter: true,\n    resizable: true,\n  },\n  {\n    title: '状态',\n    dataIndex: 'status',\n    width: 160,\n    sorter: true,\n    resizable: true,\n  },\n];\n\nexport const searchFormSchema: FormSchema[] = [\n  {\n    label: '设备编码',\n    field: 'code',\n    component: 'Input',\n    colProps: { span: 8 },\n  },\n  {\n    label: '设备名称',\n    field: 'name',\n    component: 'Input',\n    colProps: { span: 8 },\n  },\n\n  {\n    label: '供应商',\n    field: 'supplierName',\n    component: 'Input',\n    colProps: { span: 8 },\n  },\n  {\n    label: '生产厂家',\n    field: 'factoryName',\n    component: 'Input',\n    colProps: { span: 8 },\n  },\n\n  {\n    label: '投运日期',\n    field: '[startDate, endDate]',\n    component: 'RangePicker',\n    componentProps: {\n      format: 'YYYY-MM-DD',\n      valueFormat: 'YYYY-MM-DD',\n      placeholder: ['开始日期', '结束日期'],\n    },\n    colProps: { span: 8 },\n  },\n  {\n    label: '状态',\n    field: 'status',\n    component: 'Select',\n    componentProps: {\n      options: statusArr,\n    },\n    colProps: { span: 8 },\n  },\n];\n\nexport const createFormSchema: FormSchema[] = [\n  {\n    label: '编号',\n    field: 'id',\n    show: false,\n    component: 'Input',\n  },\n  {\n    label: '所属公司ID',\n    field: 'stationOrganId',\n    component: 'Input',\n  },\n  {\n    label: '所属公司',\n    field: 'stationOrganName',\n    component: 'Input',\n  },\n  {\n    label: '电站ID',\n    field: 'stationId',\n    component: 'Input',\n  },\n  {\n    label: '电站',\n    field: 'stationName',\n    component: 'Input',\n  },\n  {\n    label: '期数ID',\n    field: 'periodId',\n    component: 'Input',\n  },\n  {\n    label: '期数',\n    field: 'periodName',\n    component: 'Input',\n  },\n  {\n    label: '状态',\n    field: 'status',\n    component: 'RadioButtonGroup',\n    componentProps: {\n      options: [],\n    },\n  },\n  {\n    label: '设备编码',\n    field: 'code',\n    component: 'Input',\n  },\n  {\n    label: '设备名称',\n    field: 'name',\n    component: 'Input',\n  },\n  {\n    label: '物料ID',\n    field: 'materialId',\n    component: 'Input',\n  },\n  {\n    label: '物料编码',\n    field: 'materialCode',\n    component: 'Input',\n  },\n  {\n    label: '物料',\n    field: 'materialName',\n    component: 'Input',\n  },\n  {\n    label: '物料全称',\n    field: 'materialWholeName',\n    component: 'Input',\n  },\n  {\n    label: '生产厂家ID',\n    field: 'factoryId',\n    component: 'Input',\n  },\n  {\n    label: '生产厂家',\n    field: 'factoryName',\n    component: 'Input',\n  },\n  {\n    label: '供应商ID',\n    field: 'supplierId',\n    component: 'Input',\n  },\n  {\n    label: '供应商',\n    field: 'supplierName',\n    component: 'Input',\n  },\n  {\n    label: '出厂编码',\n    field: 'productionNumber',\n    component: 'Input',\n  },\n  {\n    label: '出厂日期',\n    field: 'productionDate',\n    component: 'DatePicker',\n  },\n  {\n    label: '投运日期',\n    field: 'usedDate',\n    component: 'DatePicker',\n  },\n  {\n    label: '质保到期时间',\n    field: 'warrantyDate',\n    component: 'DatePicker',\n  },\n  {\n    label: '区域ID',\n    field: 'areaId',\n    component: 'Input',\n  },\n  {\n    label: '区域',\n    field: 'areaName',\n    component: 'Input',\n  },\n  {\n    label: '子阵ID',\n    field: 'subarrayId',\n    component: 'Input',\n  },\n  {\n    label: '子阵',\n    field: 'subarrayName',\n    component: 'Input',\n  },\n  {\n    label: '数量',\n    field: 'qty',\n    component: 'Input',\n  },\n  {\n    label: '计量单位ID',\n    field: 'unitId',\n    component: 'Input',\n  },\n  {\n    label: '计量单位',\n    field: 'unitName',\n    component: 'Input',\n  },\n  {\n    label: '备注',\n    field: 'remark',\n    component: 'Input',\n  },\n  {\n    label: '业务状态',\n    field: 'bizStatus',\n    component: 'RadioButtonGroup',\n    componentProps: {\n      options: [],\n    },\n  },\n];\n\nexport const updateFormSchema: FormSchema[] = [\n  {\n    label: '编号',\n    field: 'id',\n    show: false,\n    component: 'Input',\n  },\n  {\n    label: '所属公司ID',\n    field: 'stationOrganId',\n    component: 'Input',\n  },\n  {\n    label: '所属公司',\n    field: 'stationOrganName',\n    component: 'Input',\n  },\n  {\n    label: '电站ID',\n    field: 'stationId',\n    component: 'Input',\n  },\n  {\n    label: '电站',\n    field: 'stationName',\n    component: 'Input',\n  },\n  {\n    label: '期数ID',\n    field: 'periodId',\n    component: 'Input',\n  },\n  {\n    label: '期数',\n    field: 'periodName',\n    component: 'Input',\n  },\n  {\n    label: '状态',\n    field: 'status',\n    component: 'RadioButtonGroup',\n    componentProps: {\n      options: [],\n    },\n  },\n  {\n    label: '设备编码',\n    field: 'code',\n    component: 'Input',\n  },\n  {\n    label: '设备名称',\n    field: 'name',\n    component: 'Input',\n  },\n  {\n    label: '物料ID',\n    field: 'materialId',\n    component: 'Input',\n  },\n  {\n    label: '物料编码',\n    field: 'materialCode',\n    component: 'Input',\n  },\n  {\n    label: '物料',\n    field: 'materialName',\n    component: 'Input',\n  },\n  {\n    label: '物料全称',\n    field: 'materialWholeName',\n    component: 'Input',\n  },\n  {\n    label: '生产厂家ID',\n    field: 'factoryId',\n    component: 'Input',\n  },\n  {\n    label: '生产厂家',\n    field: 'factoryName',\n    component: 'Input',\n  },\n  {\n    label: '供应商ID',\n    field: 'supplierId',\n    component: 'Input',\n  },\n  {\n    label: '供应商',\n    field: 'supplierName',\n    component: 'Input',\n  },\n  {\n    label: '出厂编码',\n    field: 'productionNumber',\n    component: 'Input',\n  },\n  {\n    label: '出厂日期',\n    field: 'productionDate',\n    component: 'DatePicker',\n  },\n  {\n    label: '投运日期',\n    field: 'usedDate',\n    component: 'DatePicker',\n  },\n  {\n    label: '质保到期时间',\n    field: 'warrantyDate',\n    component: 'DatePicker',\n  },\n  {\n    label: '区域ID',\n    field: 'areaId',\n    component: 'Input',\n  },\n  {\n    label: '区域',\n    field: 'areaName',\n    component: 'Input',\n  },\n  {\n    label: '子阵ID',\n    field: 'subarrayId',\n    component: 'Input',\n  },\n  {\n    label: '子阵',\n    field: 'subarrayName',\n    component: 'Input',\n  },\n  {\n    label: '数量',\n    field: 'qty',\n    component: 'Input',\n  },\n  {\n    label: '计量单位ID',\n    field: 'unitId',\n    component: 'Input',\n  },\n  {\n    label: '计量单位',\n    field: 'unitName',\n    component: 'Input',\n  },\n  {\n    label: '备注',\n    field: 'remark',\n    component: 'Input',\n  },\n  {\n    label: '业务状态',\n    field: 'bizStatus',\n    component: 'RadioButtonGroup',\n    componentProps: {\n      options: [],\n    },\n  },\n];\n","<script lang=\"ts\" setup>\n  import { onMounted, ref, reactive, toRaw } from 'vue';\n  import { message } from 'ant-design-vue';\n  import { useI18n } from '@/hooks/web/useI18n';\n  import { useMessage } from '@/hooks/web/useMessage';\n  import { IconEnum } from '@/enums/appEnum';\n  import { BasicTable, useTable, SorterResult } from '@/components/Table';\n  import { TreeItem } from '/@/components/Tree';\n  import { PageWrapper } from '/@/components/Page';\n  import CommonTree from '@/components/Framework/Tree/CommonTree.vue';\n  import TreeBox from '@/components/Framework/Combox/TreeBox.vue';\n  import DictSelectBox from '@/components/Framework/Combox/DictSelectBox.vue';\n  import { exportExcelFile } from '@/utils/file/download';\n  import * as EquipmentApi from '@/api/po/equipment';\n  import * as CommonApi from '@/api/baseset/common';\n  import { columns } from './equipment.data';\n  import { addTabPage } from '@/utils/route';\n  import { MsgManager } from '/@/message/MsgManager';\n  import { defHttp } from '/@/utils/http/axios';\n  import * as CommonUtil from '/@/utils/common';\n  import { assign } from 'lodash-es';\n  import { SysMessage } from '/@/hooks/web/useMessage';\n  import { DownOutlined, UpOutlined } from '@ant-design/icons-vue';\n\n  defineOptions({ name: 'Equipment' });\n\n  const { t } = useI18n();\n  const { createConfirm, createMessage } = useMessage();\n\n  const treeData = ref<TreeItem[]>([]); // 左侧电站树数据\n  const selectedNode = ref({}); // 被选择的电站节点\n  const checkedKeys = ref<Array<string | number>>([]);\n  const expand = ref(false);\n\n  const seachFormState = reactive({\n    code: '',\n    name: '',\n    supplierName: '',\n    factoryName: '',\n    rangeData: null,\n    status: '',\n    materialTypeCodes: [],\n    materialCategoryNames: [],\n  });\n\n  // 物料类型树数据\n  const treeDatas = ref<TreeItem[]>([]);\n\n  const getTreeUrl = '/baseset/material-category/getTreeData';\n  // 获取物料类型树数据\n  const getTreeData = () =>\n    defHttp.get(\n      {\n        url: getTreeUrl,\n      },\n      {},\n    );\n  // 查询下拉选框树数据\n  async function queryTreeList_() {\n    const typeList = await getTreeData();\n    treeDatas.value = typeList.result as unknown[] as TreeItem[];\n  }\n\n  const search = () => {\n    reload();\n  };\n  const reset = () => {\n    seachFormState.code = '';\n    seachFormState.name = '';\n    seachFormState.supplierName = '';\n    seachFormState.factoryName = '';\n    seachFormState.rangeData = null;\n    seachFormState.status = '';\n    seachFormState.materialTypeCodes = [];\n    seachFormState.materialCategoryNames = [];\n  };\n\n  const treeBoxSelect = (node, event) => {\n    let selectedNodes = event.selectedNodes;\n    let materialTypeCodes = [];\n    let materialCategoryNames = [];\n    if (Array.isArray(selectedNodes)) {\n      selectedNodes.forEach((item) => {\n        materialCategoryNames.push(item.name);\n        materialTypeCodes.push(item.id);\n      });\n      if (materialCategoryNames.length > 0) {\n        let stn = materialCategoryNames.join(',');\n        let sti = materialTypeCodes.join(',');\n        seachFormState.materialTypeCodes = sti;\n        seachFormState.materialCategoryNames = stn;\n      }\n    }\n  };\n\n  const searchInfo = reactive<any>({});\n\n  const getIsSelectData = () => {\n    return checkedKeys.value.length == 0;\n  }\n\n  const [registerTable, { getForm, reload, redoHeight, getSelectRows }] = useTable({\n    title: '设备物资台账',\n    api: EquipmentApi.getEquipmentPage,\n    columns,\n    useSearchForm: false,\n    bordered: true,\n    rowKey: 'id',\n    rowSelection: {\n      type: 'checkbox',\n      selectedRowKeys: checkedKeys,\n      onSelect: onSelect,\n      onSelectAll: onSelectAll,\n    },\n    beforeFetch(search) {\n      search.stationOrganId = selectedNode.value.stationOrganId;\n      search.stationId = selectedNode.value.stationId;\n      search.periodId = selectedNode.value.periodId;\n\n      search.code = seachFormState.code;\n      search.name = seachFormState.name;\n      search.supplierName = seachFormState.supplierName;\n\n      search.factoryName = seachFormState.factoryName;\n      search.status = seachFormState.status;\n      search.materialTypeCode = seachFormState.materialTypeCodes.join(',');\n\n      if (seachFormState.rangeData != null) {\n        search.startDate = seachFormState.rangeData[0];\n        search.endDate = seachFormState.rangeData[1];\n      }\n\n      assign(search, searchInfo);\n\n      checkedKeys.value.splice(0, checkedKeys.value.length);\n\n      return search;\n    },\n    sortFn: (sortInfo: SorterResult) => {\n      const sortOrder = sortInfo.order?.replace('end', '');\n      searchInfo.sortOrder = sortOrder;\n      searchInfo.sortField = sortOrder ? CommonUtil.toUnderline(sortInfo.field) : undefined;\n    },\n    showTableSetting: true,\n    tableSetting: { fullScreen: true },\n    showIndexColumn: true,\n  });\n\n  function onSelect(record, selected) {\n    if (selected) {\n      checkedKeys.value = [...checkedKeys.value, record.id];\n    } else {\n      checkedKeys.value = checkedKeys.value.filter((id) => id !== record.id);\n    }\n  }\n  function onSelectAll(selected, selectedRows, changeRows) {\n    const changeIds = changeRows.map((item) => item.id);\n    if (selected) {\n      checkedKeys.value = [...checkedKeys.value, ...changeIds];\n    } else {\n      checkedKeys.value = checkedKeys.value.filter((id) => {\n        return !changeIds.includes(id);\n      });\n    }\n  }\n\n  function checkSelectData() {\n    if (checkedKeys.value.length == 0 || checkedKeys.value.length > 1 || !checkedKeys.value['0']) {\n      message.warning('请选择一行数据');\n      return false;\n    }\n    return true;\n  }\n\n  const handleEnable = () => {\n    if (checkedKeys.value.length == 0) {\n      message.warning('请选择数据。');\n      return;\n    }\n    createConfirm({\n      title: '确认操作',\n      iconType: 'warning',\n      content: '确定要启用选中数据吗？',\n      async onOk() {\n        await EquipmentApi.updateEquipmentStatus(checkedKeys.value, 1);\n        reload();\n        createMessage.success('操作成功。');\n      },\n    });\n  };\n\n  const handleDisable = () => {\n    if (checkedKeys.value.length == 0) {\n      message.warning('请选择数据。');\n      return;\n    }\n    createConfirm({\n      title: '确认操作',\n      iconType: 'warning',\n      content: '确定要禁用选中数据吗？',\n      async onOk() {\n        await EquipmentApi.updateEquipmentStatus(checkedKeys.value, 0);\n        reload();\n        createMessage.success('操作成功。');\n      },\n    });\n  };\n\n  function handleCreate() {\n    if (selectedNode.value.periodId == null || selectedNode.value.periodId == '') {\n      message.warning('请选择电站分期。');\n      return;\n    }\n    const formData = toRaw(selectedNode.value);\n    addTabPage('/po/equipment/create', '添加物资', formData);\n  }\n\n  function handleEdit() {\n    if (!checkSelectData()) {\n      return;\n    }\n    const id = checkedKeys.value[0];\n    addTabPage('/po/equipment/create', '修改物资', { id: id });\n  }\n\n  function handleSplit() {\n    let selectRows = getSelectRows();\n    if (selectRows.length !== 1) {\n      SysMessage.getInstance().warning('请选择一条数据。');\n      return false;\n    }\n    let row = selectRows[0];\n    if (row.status == 0) {\n      SysMessage.getInstance().warning('该设备物资已禁用,不能拆分。');\n      return false;\n    }\n    let qty = row.qty;\n    if (qty <= 1) {\n      SysMessage.getInstance().warning('该设备物资数量为' + qty + ',不能进行拆分。');\n      return false;\n    }\n    let ex = /^\\d+$/;\n    if (!ex.test(qty)) {\n      SysMessage.getInstance().warning('该设备物资数量不是正整数，不能进行拆分。');\n      return false;\n    }\n    addTabPage('/po/equipment/split', '物资拆分', { id: row.id });\n  }\n\n  function handleDelete() {\n    if (checkedKeys.value.length == 0) {\n      message.warning('请选择数据。');\n      return;\n    }\n    createConfirm({\n      title: t('common.message.confirmTitle'),\n      iconType: 'warning',\n      content: t('common.message.delMessage'),\n      async onOk() {\n        await EquipmentApi.deleteEquipment(checkedKeys.value);\n        reload();\n        checkedKeys.value.splice(0, checkedKeys.value.length);\n        createMessage.success(t('common.delSuccessText'));\n      },\n    });\n  }\n\n  function handleView(record: any) {\n    const data = toRaw(record);\n    addTabPage('/po/equipment/create', '查看物资', { id: data.id, page_readonly: 'true' });\n  }\n\n  async function handleExport() {\n    createConfirm({\n      title: t('common.exportTitle'),\n      iconType: 'warning',\n      content: t('common.exportMessage'),\n      async onOk() {\n        await EquipmentApi.exportEquipment(getForm().getFieldsValue()).then((res) => {\n          exportExcelFile(res?.data, '设备物资台账.xls');\n        });\n        createMessage.success(t('common.exportSuccessText'));\n      },\n    });\n  }\n\n  // 左侧树状菜单选中事件\n  function handleSelect(node = {}) {\n    selectedNode.value.stationOrganId = node?.organId ?? '';\n    selectedNode.value.stationOrganName = node?.organName ?? '';\n    selectedNode.value.stationId = node?.powerStationId ?? '';\n    selectedNode.value.stationName = node?.powerStationName ?? '';\n    selectedNode.value.periodId = node?.powerStationPeriodId ?? '';\n    selectedNode.value.periodName = node?.powerStationPeriodName ?? '';\n    reload();\n  }\n\n  // 查询左侧电站树数据\n  async function queryDeptTreeList() {\n    const deptList = (await CommonApi.getOrgStationPeriodTree()) as unknown as TreeItem[];\n    treeData.value = deptList;\n  }\n\n  const handleFormToggle = () => {\n    expand.value = !expand.value;\n    setTimeout(redoHeight, 300);\n  };\n\n  onMounted(() => {\n    queryDeptTreeList();\n    queryTreeList_();\n    MsgManager.getInstance().listen('equipment-page', reload);\n  });\n</script>\n<template>\n  <PageWrapper dense contentFullHeight fixedHeight contentClass=\"flex\" style=\"position: relative\">\n    <!-- 电站组织树 -->\n    <CommonTree\n      title=\"电站组织\"\n      @select=\"handleSelect\"\n      :value=\"treeData\"\n      class=\"left-tree-layout\"\n      :toolbar=\"true\"\n      :canEdit=\"false\"\n      :canAdd=\"false\"\n      :canDelete=\"false\"\n      :isShowOperationBtns=\"false\"\n      :fieldNames=\"{ key: 'id', title: 'name' }\"\n    />\n    <div class=\"right-table-layout tab-model\">\n      <div class=\"tab-button-div\">\n        <a-form :model=\"seachFormState\" autocomplete=\"off\">\n          <a-row :gutter=\"32\">\n            <a-col flex=\"27.5%\">\n              <a-form-item\n                name=\"code\"\n                label=\"设备编码\"\n                :colon=\"false\"\n                :labelCol=\"{ style: { width: '120px' } }\"\n              >\n                <a-input v-model:value=\"seachFormState.code\" maxlength=\"64\" />\n              </a-form-item>\n            </a-col>\n            <a-col flex=\"27.5%\">\n              <a-form-item\n                name=\"name\"\n                label=\"设备名称\"\n                :colon=\"false\"\n                :labelCol=\"{ style: { width: '120px' } }\"\n              >\n                <a-input v-model:value=\"seachFormState.name\" maxlength=\"64\" />\n              </a-form-item>\n            </a-col>\n            <a-col flex=\"27.5%\">\n              <a-form-item\n                name=\"supplierName\"\n                label=\"供应商\"\n                :colon=\"false\"\n                :labelCol=\"{ style: { width: '120px' } }\"\n              >\n                <a-input v-model:value=\"seachFormState.supplierName\" maxlength=\"64\" />\n              </a-form-item>\n            </a-col>\n            <a-col flex=\"17.5%\">\n              <a-form-item style=\"text-align: right\">\n                <a-button class=\"tab-button\" @click=\"reset\">{{ t('common.resetText') }}</a-button>\n                <a-button type=\"primary\" class=\"tab-button\" @click=\"search\">{{\n                  t('common.queryText')\n                }}</a-button>\n                <a style=\"font-size: 12px\" @click=\"handleFormToggle\">\n                  <template v-if=\"expand\">\n                    收起\n                    <UpOutlined />\n                  </template>\n                  <template v-else>\n                    展开\n                    <DownOutlined />\n                  </template>\n                </a>\n              </a-form-item>\n            </a-col>\n          </a-row>\n          <a-row v-show=\"expand\" :gutter=\"32\">\n            <a-col flex=\"27.5%\">\n              <a-form-item\n                name=\"factoryName\"\n                label=\"生产厂家\"\n                :colon=\"false\"\n                :labelCol=\"{ style: { width: '120px' } }\"\n              >\n                <a-input v-model:value=\"seachFormState.factoryName\" maxlength=\"64\" />\n              </a-form-item>\n            </a-col>\n            <a-col flex=\"27.5%\">\n              <a-form-item\n                label=\"投运日期\"\n                name=\"rangeData\"\n                :labelCol=\"{ style: { width: '120px' } }\"\n                :colon=\"false\"\n              >\n                <a-range-picker\n                  v-model:value=\"seachFormState.rangeData\"\n                  value-format=\"YYYY-MM-DD\"\n                  style=\"width: 100%\"\n                />\n              </a-form-item>\n            </a-col>\n            <a-col flex=\"27.5%\">\n              <a-form-item\n                name=\"status\"\n                label=\"状态\"\n                :labelCol=\"{ style: { width: '120px' } }\"\n                :colon=\"false\"\n              >\n                <DictSelectBox\n                  :type=\"`enable_or_disable`\"\n                  @change=\"`()=> seachFormState.status = value`\"\n                  v-model:value=\"seachFormState.status\"\n                  style=\"width: 100%\"\n                />\n              </a-form-item>\n            </a-col>\n          </a-row>\n          <a-row v-show=\"expand\" :gutter=\"32\">\n            <a-col flex=\"27.5%\">\n              <a-form-item\n                label=\"物料类别\"\n                name=\"materialCategoryNames\"\n                :labelCol=\"{ style: { width: '120px' } }\"\n                :colon=\"false\"\n              >\n                <TreeBox\n                  v-model:value=\"seachFormState.materialCategoryNames\"\n                  v-model:skeys=\"seachFormState.materialTypeCodes\"\n                  :multiple=\"true\"\n                  :tfields=\"{ key: 'code', title: 'name', children: 'children' }\"\n                  :data=\"treeDatas\"\n                  @select=\"treeBoxSelect\"\n                />\n              </a-form-item>\n            </a-col>\n          </a-row>\n        </a-form>\n      </div>\n      <div class=\"tab-table-div\">\n        <BasicTable\n          class=\"fix-basic-table\"\n          @register=\"registerTable\"\n          @resize-column=\"(w, col) => (col.width = w)\"\n          @row-db-click=\"(record) => handleView(record)\"\n        >\n          <template #toolbar>\n            <a-button type=\"primary\" :preIcon=\"IconEnum.ADD\" @click=\"handleCreate\">\n              {{ t('common.action.create') }}\n            </a-button>\n            <a-button type=\"primary\" :disabled=\"getIsSelectData()\" :preIcon=\"IconEnum.EDIT\" @click=\"handleEdit\">{{\n              t('common.action.edit')\n            }}</a-button>\n            <a-button type=\"primary\" v-auth=\"`po:equipment:index:split`\" @click=\"handleSplit\">\n              拆分\n            </a-button>\n            <a-button class=\"red-btn\" :disabled=\"getIsSelectData()\" :preIcon=\"IconEnum.DELETE\" @click=\"handleDelete\">{{\n              t('common.delText')\n            }}</a-button>\n            <a-button class=\"green-btn\" :disabled=\"getIsSelectData()\" :preIcon=\"IconEnum.ENABLE\" @click=\"handleEnable\">\n              启用\n            </a-button>\n            <a-button class=\"grey-btn\" :disabled=\"getIsSelectData()\" :preIcon=\"IconEnum.DISABLE\" @click=\"handleDisable\">\n              禁用\n            </a-button>\n            <a-button class=\"yellow-btn\" :preIcon=\"IconEnum.EXPORT\" @click=\"handleExport\">\n              导出\n            </a-button>\n          </template>\n          <template #bodyCell=\"{ column, text }\">\n            <template v-if=\"column.dataIndex === 'status'\">\n              <span style=\"color: #19be6b\" v-if=\"text == 1\">启用</span>\n              <span style=\"color: red\" v-if=\"text == 0\">禁用</span>\n            </template>\n          </template>\n        </BasicTable>\n      </div>\n    </div>\n  </PageWrapper>\n</template>\n<style lang=\"less\" scoped>\n  .left-tree-layout {\n    width: 298px;\n    border-radius: 2px;\n    flex-shrink: 0;\n  }\n\n  .right-table-layout {\n    width: calc(100% - 308px);\n  }\n  .tab-model {\n    height: 100vh;\n    padding: 10px 10px 0;\n\n    div.tab-table-content {\n      height: calc(100vh - 86px);\n\n      :deep(.vben-basic-table) {\n        max-width: 100%;\n        height: 100%;\n        margin-top: -12px;\n      }\n    }\n  }\n\n  .tab-button-div {\n    padding: 12px 16px 4px;\n    :deep(.ant-form-item) {\n      margin-bottom: 8px;\n    }\n  }\n\n  .tab-button {\n    margin-right: 10px;\n  }\n\n  .tab-table-div {\n    margin-top: 10px;\n    margin-bottom: 10px;\n    overflow: auto;\n    border-radius: 2px;\n\n    :deep(.ant-tabs-top > .ant-tabs-nav) {\n      margin-bottom: 10px;\n    }\n\n    :deep(.ant-tabs-content-holder) {\n      padding: 0 16px;\n    }\n  }\n\n  .ant-row-rtl .tabs-extra-demo-button {\n    margin-right: 5px;\n    margin-left: 16px;\n  }\n\n  .editable-row-operations a {\n    margin-right: 8px;\n  }\n  .fix-basic-table {\n    :deep(&.vben-basic-table .ant-table-wrapper) {\n      padding: 10px 16px 12px;\n    }\n\n    :deep(.table-settings) {\n      margin-right: 0;\n    }\n\n    :deep(.table-settings .anticon-setting) {\n      margin-right: 0;\n    }\n  }\n</style>\n"],"names":["columns","text","record","url","useRender","getTreeUrl","t","useI18n","createConfirm","createMessage","useMessage","treeData","ref","selectedNode","checkedKeys","expand","seachFormState","reactive","treeDatas","getTreeData","defHttp","queryTreeList_","__async","typeList","search","reload","reset","treeBoxSelect","node","event","selectedNodes","materialTypeCodes","materialCategoryNames","item","stn","sti","searchInfo","getIsSelectData","registerTable","getForm","redoHeight","getSelectRows","useTable","EquipmentApi.getEquipmentPage","onSelect","onSelectAll","assign","sortInfo","sortOrder","_a","CommonUtil.toUnderline","selected","id","selectedRows","changeRows","changeIds","checkSelectData","message","handleEnable","EquipmentApi.updateEquipmentStatus","handleDisable","handleCreate","formData","toRaw","addTabPage","handleEdit","handleSplit","selectRows","SysMessage","row","qty","handleDelete","EquipmentApi.deleteEquipment","handleView","data","handleExport","EquipmentApi.exportEquipment","res","exportExcelFile","handleSelect","_b","_c","_d","_e","_f","queryDeptTreeList","deptList","CommonApi.getOrgStationPeriodTree","handleFormToggle","onMounted","MsgManager"],"mappings":"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"}