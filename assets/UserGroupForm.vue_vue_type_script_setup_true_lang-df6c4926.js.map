{"version":3,"file":"UserGroupForm.vue_vue_type_script_setup_true_lang-df6c4926.js","sources":["../../src/views/bpm/manage/group/UserGroupForm.vue"],"sourcesContent":["<template>\n  <Dialog v-model=\"dialogVisible\" :title=\"dialogTitle\">\n    <el-form\n      ref=\"formRef\"\n      v-loading=\"formLoading\"\n      :model=\"formData\"\n      :rules=\"formRules\"\n      label-width=\"100px\"\n    >\n      <el-form-item label=\"组名\" prop=\"name\">\n        <el-input v-model=\"formData.name\" placeholder=\"请输入组名\" />\n      </el-form-item>\n      <el-form-item label=\"描述\">\n        <el-input v-model=\"formData.description\" placeholder=\"请输入描述\" type=\"textarea\" />\n      </el-form-item>\n      <el-form-item label=\"成员\" prop=\"memberUserIds\">\n        <el-select v-model=\"formData.memberUserIds\" multiple placeholder=\"请选择成员\">\n          <el-option\n            v-for=\"user in userList\"\n            :key=\"user.id\"\n            :label=\"user.nickname\"\n            :value=\"user.id\"\n          />\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"状态\" prop=\"status\">\n        <el-radio-group v-model=\"formData.status\">\n          <el-radio\n            v-for=\"dict in getIntDictOptions(DICT_TYPE.COMMON_STATUS)\"\n            :key=\"dict.value\"\n            :label=\"dict.value\"\n          >\n            {{ dict.label }}\n          </el-radio>\n        </el-radio-group>\n      </el-form-item>\n    </el-form>\n    <template #footer>\n      <el-button :disabled=\"formLoading\" type=\"primary\" @click=\"submitForm\">确 定</el-button>\n      <el-button @click=\"dialogVisible = false\">取 消</el-button>\n    </template>\n  </Dialog>\n</template>\n<script lang=\"ts\" setup>\n  import { DICT_TYPE, getIntDictOptions } from '@/utils/dict';\n  import { CommonStatusEnum } from '@/utils/constants';\n  import * as UserGroupApi from '@/api/bpm/userGroup';\n  import * as UserApi from '@/api/bpm/system/user';\n  import { ref, reactive } from 'vue';\n  import { useI18n } from 'vue-i18n';\n  import { useMessage } from '/@/hooks/web/useMessage';\n\n  defineOptions({ name: 'UserGroupForm' });\n\n  const { t } = useI18n(); // 国际化\n  const message = useMessage(); // 消息弹窗\n\n  const dialogVisible = ref(false); // 弹窗的是否展示\n  const dialogTitle = ref(''); // 弹窗的标题\n  const formLoading = ref(false); // 表单的加载中：1）修改时的数据加载；2）提交的按钮禁用\n  const formType = ref(''); // 表单的类型：create - 新增；update - 修改\n  const formData = ref({\n    id: undefined,\n    name: undefined,\n    description: undefined,\n    memberUserIds: undefined,\n    status: CommonStatusEnum.ENABLE,\n  });\n  const formRules = reactive({\n    name: [{ required: true, message: '组名不能为空', trigger: 'blur' }],\n    description: [{ required: true, message: '描述不能为空', trigger: 'blur' }],\n    memberUserIds: [{ required: true, message: '成员不能为空', trigger: 'blur' }],\n    status: [{ required: true, message: '状态不能为空', trigger: 'blur' }],\n  });\n  const formRef = ref(); // 表单 Ref\n  const userList = ref<any[]>([]); // 用户列表\n\n  /** 打开弹窗 */\n  const open = async (type: string, id?: number) => {\n    dialogVisible.value = true;\n    dialogTitle.value = t('action.' + type);\n    formType.value = type;\n    resetForm();\n    // 修改时，设置数据\n    if (id) {\n      formLoading.value = true;\n      try {\n        formData.value = await UserGroupApi.getUserGroup(id);\n      } finally {\n        formLoading.value = false;\n      }\n    }\n    // 加载用户列表\n    userList.value = await UserApi.getSimpleUserList();\n  };\n  defineExpose({ open }); // 提供 open 方法，用于打开弹窗\n\n  /** 提交表单 */\n  const emit = defineEmits(['success']); // 定义 success 事件，用于操作成功后的回调\n  const submitForm = async () => {\n    // 校验表单\n    if (!formRef.value) return;\n    const valid = await formRef.value.validate();\n    if (!valid) return;\n    // 提交请求\n    formLoading.value = true;\n    try {\n      const data = formData.value as unknown as UserGroupApi.UserGroupVO;\n      if (formType.value === 'create') {\n        await UserGroupApi.createUserGroup(data);\n        message.success(t('common.createSuccess'));\n      } else {\n        await UserGroupApi.updateUserGroup(data);\n        message.success(t('common.updateSuccess'));\n      }\n      dialogVisible.value = false;\n      // 发送操作成功的事件\n      emit('success');\n    } finally {\n      formLoading.value = false;\n    }\n  };\n\n  /** 重置表单 */\n  const resetForm = () => {\n    formData.value = {\n      id: undefined,\n      name: undefined,\n      description: undefined,\n      memberUserIds: undefined,\n      status: CommonStatusEnum.ENABLE,\n    };\n    formRef.value?.resetFields();\n  };\n</script>\n"],"names":["t","useI18n","message","useMessage","dialogVisible","ref","dialogTitle","formLoading","formType","formData","CommonStatusEnum","formRules","reactive","formRef","userList","__expose","type","id","__async","resetForm","UserGroupApi.getUserGroup","UserApi.getSimpleUserList","submitForm","data","UserGroupApi.createUserGroup","UserGroupApi.updateUserGroup","emit","_a"],"mappings":"koBAsDQ,KAAA,CAAE,EAAAA,GAAMC,IACRC,EAAUC,IAEVC,EAAgBC,EAAI,EAAK,EACzBC,EAAcD,EAAI,EAAE,EACpBE,EAAcF,EAAI,EAAK,EACvBG,EAAWH,EAAI,EAAE,EACjBI,EAAWJ,EAAI,CACnB,GAAI,OACJ,KAAM,OACN,YAAa,OACb,cAAe,OACf,OAAQK,EAAiB,MAAA,CAC1B,EACKC,EAAYC,EAAS,CACzB,KAAM,CAAC,CAAE,SAAU,GAAM,QAAS,SAAU,QAAS,OAAQ,EAC7D,YAAa,CAAC,CAAE,SAAU,GAAM,QAAS,SAAU,QAAS,OAAQ,EACpE,cAAe,CAAC,CAAE,SAAU,GAAM,QAAS,SAAU,QAAS,OAAQ,EACtE,OAAQ,CAAC,CAAE,SAAU,GAAM,QAAS,SAAU,QAAS,OAAQ,CAAA,CAChE,EACKC,EAAUR,IACVS,EAAWT,EAAW,CAAA,CAAE,EAoBjBU,EAAA,CAAE,KAjBF,CAAOC,EAAcC,IAAgBC,EAAA,sBAMhD,GALAd,EAAc,MAAQ,GACVE,EAAA,MAAQN,EAAE,UAAYgB,CAAI,EACtCR,EAAS,MAAQQ,EACPG,IAENF,EAAI,CACNV,EAAY,MAAQ,GAChB,GAAA,CACFE,EAAS,MAAQ,MAAMW,EAA0BH,CAAE,CAAA,QACnD,CACAV,EAAY,MAAQ,EACtB,CACF,CAESO,EAAA,MAAQ,MAAMO,GAA0B,GAE9B,EAIrB,MAAMC,EAAa,IAAYJ,EAAA,sBAI7B,GAFI,GAACL,EAAQ,OAET,EADU,MAAMA,EAAQ,MAAM,SAAS,IAG3C,CAAAN,EAAY,MAAQ,GAChB,GAAA,CACF,MAAMgB,EAAOd,EAAS,MAClBD,EAAS,QAAU,UACf,MAAAgB,EAA6BD,CAAI,EAC/BrB,EAAA,QAAQF,EAAE,sBAAsB,CAAC,IAEnC,MAAAyB,EAA6BF,CAAI,EAC/BrB,EAAA,QAAQF,EAAE,sBAAsB,CAAC,GAE3CI,EAAc,MAAQ,GAEtBsB,EAAK,SAAS,CAAA,QACd,CACAnB,EAAY,MAAQ,EACtB,EAAA,GAIIY,EAAY,IAAM,OACtBV,EAAS,MAAQ,CACf,GAAI,OACJ,KAAM,OACN,YAAa,OACb,cAAe,OACf,OAAQC,EAAiB,MAAA,GAE3BiB,EAAAd,EAAQ,QAAR,MAAAc,EAAe,aAAY"}