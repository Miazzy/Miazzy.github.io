{"version":3,"file":"WorkOrder-92b20fde.js","sources":["../../src/views/da/groupOperation/operation/WorkOrder.vue"],"sourcesContent":["<template>\n  <div class=\"work-order\">\n    <SmallModule title=\"工单统计\">\n      <!-- <template #titleRight>\n        <div class=\"right-title-layout\">\n          <div class=\"operation-screen-select\">\n            <a-select ref=\"select\" label-in-value allow-clear v-model:value=\"workOrderSearchInfo.selectWorkOrderValue\" :options=\"optionsWorkOrder\"\n              @change=\"handleWorkOrderChange\" />\n          </div>\n          <div class=\"detail-text\"\n            ><span class=\"text\">详情</span><span class=\"arrow\">&gt;</span></div\n          >\n        </div>\n      </template> -->\n      <template #content>\n        <div class=\"content-layout\">\n          <div class=\"data-layout\">\n            <DataIndicator label=\"未分配\" :value=\"workOrderIndexData.notAllocation\" />\n            <DataIndicator\n              label=\"处理中\"\n              @click=\"toBiReport\"\n              :value=\"workOrderIndexData.processing\"\n            />\n            <DataIndicator\n              label=\"今日新增\"\n              @click=\"toWorkOrder\"\n              :value=\"workOrderIndexData.day_create\"\n            />\n            <DataIndicator\n              label=\"今日完结\"\n              @click=\"toWorkOrder\"\n              :value=\"workOrderIndexData.day_result\"\n            />\n          </div>\n          <div class=\"table-layout\" style=\"height: 18vh; margin-top: -0.14vh\">\n            <template v-if=\"workOrderData && workOrderData.length\">\n              <a-table\n                class=\"operation-screen-table\"\n                :columns=\"workOrdercolumns\"\n                :data-source=\"workOrderData\"\n                size=\"small\"\n                :pagination=\"false\"\n                :scroll=\"{ y: 'calc(21.7vh - 0.68rem)' }\"\n                :row-class-name=\"(_record, index) => (index % 2 === 0 ? 'table-striped' : null)\"\n                :customRow=\"rowCustom\"\n              >\n                <template #bodyCell=\"{ column, record }\">\n                  <template v-if=\"column.key === 'responsible'\">\n                    <span class=\"blue-text\">{{ record.responsible }}</span>\n                  </template>\n                  <template v-else-if=\"column.key === 'status'\">\n                    <span v-if=\"record.status === '处理中'\" class=\"blue-text\">{{\n                      record.status\n                    }}</span>\n                    <span v-if=\"record.status === '已完成'\" class=\"green-text\">{{\n                      record.status\n                    }}</span>\n                    <span v-if=\"record.status === '未分配'\" class=\"white-text\">{{\n                      record.status\n                    }}</span>\n                  </template>\n                </template>\n              </a-table>\n            </template>\n            <NoData v-else />\n          </div>\n        </div>\n      </template>\n    </SmallModule>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import SmallModule from '/@/components/Framework/OperationScreen/SmallModule.vue';\n  import DataIndicator from '/@/components/Framework/OperationScreen/DataIndicator.vue';\n  import { reactive, UnwrapRef, ref, onMounted } from 'vue';\n  import { getWorkOrderData, workOrdercolumns } from './data';\n  import { assign } from 'lodash-es';\n  import { addTabPage } from '@/utils/route';\n  import dayjs from 'dayjs';\n  import NoData from '/@/components/Framework/Chart/NoData.vue';\n\n  const workOrderSearchInfo: UnwrapRef<any> = reactive({});\n  const workOrderIndexData: UnwrapRef<any> = reactive({});\n\n  onMounted(() => {\n    workOrderSearchInfo.selectWorkOrderValue = 'qx';\n    queryWorkOrderData();\n  });\n\n  // const handleWorkOrderChange = (value: string) => {\n  //   workOrderSearchInfo.selectWorkOrderValue = value.value;\n  //   queryWorkOrderData();\n  // };\n\n  const workOrderData = ref([]);\n  const queryWorkOrderData = async () => {\n    workOrderSearchInfo.selectValue = workOrderSearchInfo.selectWorkOrderValue;\n    let data = await getWorkOrderData(workOrderSearchInfo);\n    if (data.result) {\n      assign(workOrderIndexData, data.result);\n      workOrderData.value = data.result.barData;\n    }\n  };\n  const rowCustom = (record, index) => {\n    return {\n      onClick: () => {\n        rowToWorkOrder(record);\n      },\n    };\n  };\n\n  const currentMonth = dayjs().format('YYYY-MM');\n  const toBiCommonParams = { startMonth: currentMonth, endMonth: currentMonth };\n  // 穿透方法\n  const toBiReport = async (record: any) => {\n    // 参数处理\n    let url = '/bi/maintenance/workorder';\n    let param = {\n      jumpFlag: 'largeScreen',\n      dateType: 'month',\n      startDate: currentMonth,\n      endDate: currentMonth,\n    };\n    addTabPage(url, '', param);\n  };\n  // 穿透方法-跳转到工单管理\n  const toWorkOrder = async (record: any) => {\n    // 参数处理\n    let url = '/po/workorder/index';\n    let param = {\n      jumpFlag: 'largeScreen',\n      ...toBiCommonParams,\n    };\n    addTabPage(url, '', param);\n  };\n  // 行数据穿透-跳转到工单管理\n  const rowToWorkOrder = async (record: any) => {\n    console.log(record);\n    // 参数处理\n    let url = '/po/workorder/index';\n    let param = {\n      jumpFlag: 'largeScreen-row',\n      stationId: record.stationId,\n      result: 1,\n      ...toBiCommonParams,\n    };\n    addTabPage(url, '', param);\n  };\n</script>\n\n<style lang=\"less\" scoped>\n  .right-title-layout {\n    display: flex;\n    align-items: center;\n    padding-right: 0.16rem;\n\n    .detail-text {\n      margin-left: 0.14rem;\n      color: #fff;\n      font-size: 0.12rem;\n      line-height: 1;\n      cursor: pointer;\n\n      .text {\n        margin-right: 0.04rem;\n      }\n\n      .arrow {\n        opacity: 0.6;\n      }\n    }\n  }\n\n  .content-layout {\n    height: 100%;\n\n    .data-layout {\n      display: flex;\n      align-items: flex-end;\n      justify-content: space-between;\n      height: 20.74%;\n      margin-top: -0.11rem;\n      padding: 0 0.55rem;\n    }\n\n    .table-layout {\n      width: 100%;\n      height: 79.26%;\n      padding: 0 0.16rem;\n\n      .blue-text {\n        color: #03a9ff;\n      }\n\n      .white-text {\n        color: #fff;\n      }\n\n      .green-text {\n        color: #00ffa4;\n      }\n    }\n  }\n</style>\n"],"names":["workOrderSearchInfo","reactive","workOrderIndexData","onMounted","queryWorkOrderData","workOrderData","ref","__async","data","getWorkOrderData","assign","rowCustom","record","index","rowToWorkOrder","currentMonth","dayjs","toBiCommonParams","toBiReport","addTabPage","toWorkOrder","url","param","__spreadValues"],"mappings":"qwCAkFQ,MAAAA,EAAsCC,EAAS,CAAA,CAAE,EACjDC,EAAqCD,EAAS,CAAA,CAAE,EAEtDE,EAAU,IAAM,CACdH,EAAoB,qBAAuB,KACxBI,GAAA,CACpB,EAOK,MAAAC,EAAgBC,EAAI,CAAA,CAAE,EACtBF,EAAqB,IAAYG,EAAA,sBACrCP,EAAoB,YAAcA,EAAoB,qBAClD,IAAAQ,EAAO,MAAMC,EAAiBT,CAAmB,EACjDQ,EAAK,SACAE,EAAAR,EAAoBM,EAAK,MAAM,EACxBH,EAAA,MAAQG,EAAK,OAAO,QACpC,GAEIG,EAAY,CAACC,EAAQC,KAClB,CACL,QAAS,IAAM,CACbC,EAAeF,CAAM,CACvB,CAAA,GAIEG,EAAeC,EAAA,EAAQ,OAAO,SAAS,EACvCC,EAAmB,CAAE,WAAYF,EAAc,SAAUA,CAAa,EAEtEG,EAAoBN,GAAgBL,EAAA,sBAS7BY,EAPD,4BAOM,GANJ,CACV,SAAU,cACV,SAAU,QACV,UAAWJ,EACX,QAASA,CAAA,CAEc,CAAA,GAGrBK,EAAqBR,GAAgBL,EAAA,sBAEzC,IAAIc,EAAM,sBACNC,EAAQC,EAAA,CACV,SAAU,eACPN,GAEME,EAAAE,EAAK,GAAIC,CAAK,CAAA,GAGrBR,EAAwBF,GAAgBL,EAAA,sBAC5C,QAAQ,IAAIK,CAAM,EAElB,IAAIS,EAAM,sBACNC,EAAQC,EAAA,CACV,SAAU,kBACV,UAAWX,EAAO,UAClB,OAAQ,GACLK,GAEME,EAAAE,EAAK,GAAIC,CAAK,CAAA"}