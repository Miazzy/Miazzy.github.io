{"version":3,"file":"BottomContent-865b0acc.js","sources":["../../src/views/da/cockpit/composition/BottomContent.vue"],"sourcesContent":["<template>\n  <div class=\"bottom-content\" :key=\"instanceKey\">\n    <div class=\"left-section section-box\">\n      <div class=\"section-bg\">\n        <SubtitleBar :subtitle=\"`车辆统计`\">\n          <a-select\n            ref=\"select\"\n            v-model:value=\"searchInfo.selectVehicleValue\"\n            :options=\"optionsDimension\"\n            style=\"width: 1.2rem\"\n            @change=\"handleVehicleChange\"\n            v-show=\"optionsDimension.length > 1\"\n          />\n        </SubtitleBar>\n        <IndicatorGroup\n          :data=\"vehicleData\"\n          class=\"indicator-group-layout\"\n          :style=\"tabStatus === 'on' ? 'margin-top: -0.15rem' : 'margin-top: -0.2rem'\"\n          :class=\"tabStatus === 'on' ? '' : 'fix-indicator-group-padding'\"\n          @click-item=\"(item, index) => toBiReport('vehicle', index)\"\n        />\n        <div style=\"width: 100%; height: 2rem\">\n          <div style=\"margin-left: 0.16rem; transform: scale(0.85); transform-origin: 0 0\">\n            <EchartPillarChart\n              :data=\"vehicleChartData\"\n              :colors=\"vehicleChartData.colors\"\n              :width=\"`36.14vw`\"\n              :height=\"tabStatus === 'on' ? `34.8vh` : `39vh`\"\n              :name=\"vehicleChartData.chartName\"\n              @clickItem=\"handleVehicleCert\"\n              :dataZoomDisabled=\"false\"\n              :dataZoomDefaultValueRange=\"[0, 5]\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"middle-section section-box\">\n      <div class=\"section-bg\">\n        <SubtitleBar :subtitle=\"`考核评价`\">\n          <a-select\n            ref=\"select\"\n            v-model:value=\"searchInfo.selectEvalValue\"\n            :options=\"optionsDimension\"\n            style=\"width: 1.2rem\"\n            @change=\"handleEvalChange\"\n            v-show=\"optionsDimension.length > 1\"\n          />\n        </SubtitleBar>\n        <IndicatorGroup\n          :data=\"evalResultData\"\n          :style=\"tabStatus === 'on' ? 'margin-top: -0.15rem' : 'margin-top: -0.2rem'\"\n          class=\"indicator-group-layout2\"\n          :class=\"tabStatus === 'on' ? '' : 'fix-indicator-group-padding'\"\n        />\n        <div style=\"width: 100%; height: 2rem\">\n          <div style=\"margin-left: 0.16rem; transform: scale(0.85); transform-origin: 0 0\">\n            <EchartStackBarChart\n              :data=\"evalResultChartData\"\n              :colors=\"evalResultChartData.colors\"\n              ybgcolor=\"#01B7D730\"\n              :rotate=\"25\"\n              :width=\"`36.14vw`\"\n              :height=\"tabStatus === 'on' ? `34.8vh` : `39vh`\"\n              :dataZoomDisabled=\"false\"\n              :dataZoomDefaultValueRange=\"[0, 5]\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"right-section section-box\">\n      <div class=\"section-bg\">\n        <SubtitleBar :subtitle=\"`培训统计`\">\n          <a-select\n            ref=\"select\"\n            v-model:value=\"searchInfo.selectTrainingValue\"\n            :options=\"optionsDimension\"\n            style=\"width: 1.2rem\"\n            @change=\"handleTrainingChange\"\n            v-show=\"optionsDimension.length > 1\"\n          />\n        </SubtitleBar>\n        <IndicatorGroup\n          :data=\"trainingData\"\n          :style=\"tabStatus === 'on' ? 'margin-top: -0.15rem' : 'margin-top: -0.2rem'\"\n          class=\"indicator-group-layout3\"\n          :class=\"tabStatus === 'on' ? '' : 'fix-indicator-group-padding'\"\n          @clickItem=\"toBiReport('training')\"\n        />\n        <div style=\"width: 100%; height: 2rem\">\n          <div style=\"margin-left: 0.16rem; transform: scale(0.85); transform-origin: 0 0\">\n            <EchartLineBarChart\n              :data=\"trainingChartData\"\n              :width=\"`36.14vw`\"\n              :height=\"tabStatus === 'on' ? `34.5vh` : `39vh`\"\n              :category=\"trainingChartData.categories\"\n              ybgcolor=\"#01B7D730\"\n              :name=\"trainingChartData.chartSeriesName\"\n              @clickItem=\"handleTrainingByParam\"\n              :dataZoomDisabled=\"false\"\n              :dataZoomDefaultValueRange=\"[0, 5]\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import { reactive, UnwrapRef, ref, onMounted, watch } from 'vue';\n  import SubtitleBar from '/@/components/Framework/Chart/SubtitleBar.vue';\n  import IndicatorGroup from '/@/components/Framework/Chart/IndicatorGroup.vue';\n  import EchartPillarChart from '/@/components/Framework/Chart/EchartPillarChart.vue';\n  import EchartLineBarChart from '/@/components/Framework/Chart/EchartLineBarChart.vue';\n  import EchartStackBarChart from '/@/components/Framework/Chart/EchartStackBarChart.vue';\n  import { getVehicleData, getEvalResultData, getTrainingtData } from './data';\n  import { assign } from 'lodash-es';\n  import { handleRouteChange } from '../../utils';\n  import * as CommonApi from '@/api/da/common';\n  import { buildUUID } from '@/utils/uuid';\n\n  const searchInfo: UnwrapRef<any> = reactive({\n    selectVehicleValue: 'station',\n    selectEvalValue: 'station',\n    selectTrainingValue: 'station',\n  });\n\n  interface Props {\n    searchInfoByTime?: {};\n    tabStatus?: '';\n  }\n  const props = withDefaults(defineProps<Props>(), {});\n  const optionsDimension: any = ref([]);\n  const instanceKey = ref(buildUUID());\n\n  watch(\n    () => props.searchInfoByTime,\n    (value) => {\n      assign(searchInfo, value);\n      queryVehicleData();\n      queryEvalResultData();\n      queryTrainingData();\n    },\n  );\n\n  onMounted(async () => {\n    const sts = await CommonApi.getDictDataMap({ dictType: 'cockpit_three_dimension' });\n    sts.result.forEach((e) => {\n      optionsDimension.value.push({ value: e.value, label: e.label });\n    });\n    assign(searchInfo, props.searchInfoByTime);\n  });\n\n  //=============================== 车辆统计=============================================\n  const vehicleData = ref({});\n  const vehicleChartData = ref({\n    barData: [],\n    categories: [],\n    units: ['(次)'],\n    colors: [['#078C5D', '#68E4B8'], '#60C0C0', '#60A0A0'],\n    chartName: ['车辆检查'],\n  });\n  const queryVehicleData = async () => {\n    searchInfo.dimension = searchInfo.selectVehicleValue;\n    let data = await getVehicleData(searchInfo);\n    if (data.result) {\n      vehicleChartData.value.barData = data.result.barData;\n      vehicleChartData.value.categories = data.result.categories;\n      vehicleData.value = [\n        { value: data.result.insurance, label: '保险即将到期(辆)' },\n        { value: data.result.yearCheck, label: '即将年检(辆)' },\n        { value: data.result.total, label: '车辆检查(次)' },\n      ];\n    }\n  };\n  const handleVehicleChange = (value: string) => {\n    searchInfo.selectVehicleValue = value;\n    queryVehicleData();\n  };\n\n  //=============================== 考核评价=============================================\n  const evalResultData = ref({});\n  const evalResultChartData = ref({\n    categories: [],\n    barData: [[], [], [], []],\n    colors: [['#1C5C99', '#4CAFF9'], ['#105D3A', '#55CFD0'], '#f39c12', '#d81b60'],\n    barNames: ['电量', '安全', '运维', '综合'],\n  });\n  const queryEvalResultData = async () => {\n    searchInfo.dimension = searchInfo.selectEvalValue;\n    let data = await getEvalResultData(searchInfo);\n    if (data.result) {\n      evalResultChartData.value.barData = data.result.barData;\n      evalResultChartData.value.categories = data.result.categories;\n      evalResultData.value = [\n        { value: data.result.technology, label: '电量(分)' },\n        { value: data.result.safety, label: '安全(分)' },\n        { value: data.result.operation, label: '运维(分)' },\n        { value: data.result.comprehensive, label: '综合(分)' },\n      ];\n    }\n  };\n  const handleEvalChange = (value: string) => {\n    searchInfo.selectEvalValue = value;\n    queryEvalResultData();\n  };\n\n  //=============================== 培训统计=============================================\n  const trainingData = ref({});\n  const trainingChartData = ref({\n    barData: [],\n    // lineData: [],\n    categories: [],\n    units: [['(次)'], ['(人)']],\n    // colors: [['#078C5D', '#68E4B8'], '#60C0C0', '#60A0A0'],\n    chartSeriesName: [['培训次数', '参与人数']],\n  });\n  const queryTrainingData = async () => {\n    searchInfo.dimension = searchInfo.selectTrainingValue;\n    let data = await getTrainingtData(searchInfo);\n    if (data.result) {\n      trainingChartData.value.barData = data.result.barData;\n      // trainingChartData.value.lineData[0] = data.result.lineData;\n      trainingChartData.value.categories = data.result.categories;\n      trainingData.value = [\n        { value: data.result.total, label: '培训次数(次)' },\n        { value: data.result.actualNumber, label: '参与人数(人)' },\n      ];\n    }\n  };\n  const handleTrainingChange = (value: string) => {\n    searchInfo.selectTrainingValue = value;\n    queryTrainingData();\n  };\n\n  //=============================== 穿透方法=============================================\n  //车辆柱形图\n  function handleVehicleCert(params) {\n    handleRouteChange('/bi/integrated/vehicle', {\n      selectType: searchInfo.selectVehicleValue,\n      id: params.data.id,\n    });\n  }\n\n  const toBiReport = async (type: string, index) => {\n    if (type === 'vehicle') {\n      //车辆指标\n      if (index === 0 || index === 1 || index === 2) {\n        handleRouteChange('/bi/integrated/vehicle', {});\n      }\n    } else if (type === 'training') {\n      //培训指标\n      handleRouteChange('/bi/integrated/trainingStatistics', {});\n    }\n  };\n\n  function handleTrainingByParam(params) {\n    handleRouteChange('/bi/integrated/trainingStatistics', {\n      selectType: searchInfo.selectTrainingValue,\n      id: params.data.id,\n      name: params.data.fullName,\n    });\n  }\n\n  // 更新组件函数\n  const handleUpdate = () => {\n    instanceKey.value = buildUUID();\n  };\n\n  defineExpose({\n    handleUpdate,\n  });\n</script>\n\n<style lang=\"less\" scoped>\n  .bottom-content {\n    display: flex;\n    flex: 44.34%;\n    justify-content: space-between;\n    height: 44.34%;\n    padding-top: 0.93vh;\n\n    .section-box {\n      flex: 33.3333%;\n      width: 33.3333%;\n      height: 100%;\n    }\n\n    .section-bg {\n      width: 100%;\n      height: 100%;\n      background: url('../../../../assets/images/da/section_bg_4.png') no-repeat center/100% 100%;\n    }\n\n    .left-section {\n      padding-right: 0.56vw;\n    }\n\n    .middle-section {\n      padding: 0 0.28vw;\n    }\n\n    .right-section {\n      padding-left: 0.56vw;\n    }\n\n    :deep(.ant-select:not(.ant-select-customize-input) .ant-select-selector) {\n      height: 0.26rem !important;\n      border: 0.01rem solid #07a6ff70;\n      border-radius: 0;\n      background-color: transparent;\n    }\n\n    :deep(.ant-select-single .ant-select-selector .ant-select-selection-placeholder) {\n      height: 0.26rem;\n      line-height: 0.26rem;\n    }\n\n    :deep(.ant-select-arrow) {\n      color: rgb(255 255 255 / 50%);\n    }\n\n    .indicator-group-layout {\n      padding: 0.08rem 1.2rem 0;\n\n      &.fix-indicator-group-padding {\n        padding-top: 1.8vh;\n      }\n    }\n\n    .indicator-group-layout2 {\n      padding: 0.08rem 1rem 0;\n\n      &.fix-indicator-group-padding {\n        padding-top: 1.8vh;\n      }\n    }\n\n    .indicator-group-layout3 {\n      padding: 0.08rem 1.88rem 0;\n\n      &.fix-indicator-group-padding {\n        padding-top: 1.8vh;\n      }\n    }\n\n    :deep(.no-data) {\n      margin-top: 0.2rem;\n    }\n  }\n</style>\n"],"names":["searchInfo","reactive","optionsDimension","ref","instanceKey","buildUUID","watch","props","value","assign","queryVehicleData","queryEvalResultData","queryTrainingData","onMounted","__async","CommonApi.getDictDataMap","e","vehicleData","vehicleChartData","data","getVehicleData","handleVehicleChange","evalResultData","evalResultChartData","getEvalResultData","handleEvalChange","trainingData","trainingChartData","getTrainingtData","handleTrainingChange","handleVehicleCert","params","handleRouteChange","toBiReport","type","index","handleTrainingByParam","__expose"],"mappings":"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"}