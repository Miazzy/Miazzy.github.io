var H=Object.defineProperty;var N=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var k=(c,t,a)=>t in c?H(c,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[t]=a,E=(c,t)=>{for(var a in t||(t={}))q.call(t,a)&&k(c,a,t[a]);if(N)for(var a of N(t))W.call(t,a)&&k(c,a,t[a]);return c};var g=(c,t,a)=>new Promise((h,n)=>{var i=s=>{try{u(a.next(s))}catch(f){n(f)}},p=s=>{try{u(a.throw(s))}catch(f){n(f)}},u=s=>s.done?h(s.value):Promise.resolve(s.value).then(i,p);u((a=a.apply(c,t)).next())});import{b as X,au as Z,a7 as j,av as I,ax as w,_ as G}from"./index.js";import{B as J}from"./BasicTable-0434a334.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1ba7be9e.js";import"./index-085d06c7.js";import{u as Q}from"./useTable-109483b3.js";import"./antd-15ac76ed.js";import{P as U}from"./index-20519caf.js";import{C as Y}from"./CommonTree-c4ed7838.js";import{e as ee}from"./download-03e71dd5.js";import{g as te,s as ae,a as oe,b as ne,d as ie,e as re}from"./vehicle.data-492931e8.js";import{a as O}from"./assign-37f1c13d.js";import{d as se,k as S,r as C,o as le,al as ce,Z as de,a9 as me,aa as d,f as m,$ as pe,u as l,E as _,ad as b}from"./vue-71d1abb3.js";import"./useForm-dea3ed18.js";import"./uniqBy-92d3bc7f.js";import"./index-316f6ffb.js";import"./useWindowSizeFn-13b1b8a2.js";import"./index-f4fc48e6.js";import"./useTabs-2b062e85.js";import"./index-5d49b7a7.js";import"./SearchBox-22bb02d6.js";import"./UploadBox-636ecf02.js";import"./Dialog-0a006d82.js";import"./DictSelectBox.vue_vue_type_script_setup_true_lang-e03e9fe8.js";import"./OrganDialog-dd1023ce.js";import"./sortable.esm-4ae27e0b.js";import"./dict-c04c0dd8.js";import"./useContentViewHeight-7f845167.js";import"./index-3801a970.js";const ue={class:"right-table-layout"},fe=se({__name:"index",setup(c){const{t}=X(),a=Z(),h=S([]),n=C({}),i=C({}),p=S(!0),u=()=>g(this,null,function*(){const e=P(),o=C({});return O(o,n),o.pageNo=e.current,o.pageSize=e.pageSize,o.sortField||(o.sortField="createTime",o.sortOrder="desc"),(yield oe(o)).result}),s=S("车辆信息"),[f,{reload:x,clearSelectedRowKeys:D,getPaginationRef:P,getSelectRows:R}]=Q({title:s,api:u,columns:te(),useSearchForm:!0,formConfig:ae,bordered:!0,rowKey:"id",rowSelection:{type:"radio"},sortFn:e=>{var r;const o=(r=e.order)==null?void 0:r.replace("end","");n.sortOrder=o,n.sortField=o?e.field:void 0},handleSearchInfoFn(e){return O(n,e),e},showTableSetting:!0,tableSetting:{fullScreen:!0},showIndexColumn:!0});function $(){return g(this,null,function*(){const e=yield ne({});h.value=e.result})}function F(e){n.stationId=null,n.stationOrganId=null,i.stationId="",i.stationName="",i.stationOrganId="",i.stationOrganName="",e&&(e.nodeKindId==="org"&&(n.stationOrganId=e.id),e.nodeKindId==="station"&&(n.stationId=e.powerStationId,i.stationId=e.powerStationId,i.stationName=e.powerStationName,i.stationOrganId=e.organId,i.stationOrganName=e.organName)),x()}function B(){if(!i.stationId){a.error("请选择电站组织");return}w("/po/integrated/vehicle/create",y({}),E({},i))}function L(){const e=T();e&&w(`/po/integrated/vehicle/create?id=${e}`,y({id:e}))}function M(e){w(`/po/integrated/vehicle/create?id=${e.id}&isReadonly=true`,y(e,!0))}const y=(e,o)=>{const r=s.value;return o?`查看${r}`:e!=null&&e.id?`${t("common.action.edit")}${r}`:`${t("common.action.create")}${r}`},K=()=>g(this,null,function*(){const e=T();e&&(yield a.delConfirm(),yield ie(`?id=${e}`),a.success(t("common.delSuccess")),D(),x())});function T(){const e=R();return e.length==0?(a.error("请选择一行数据"),!1):e[0].id}function V(){a.createConfirm({title:t("common.message.confirmTitle"),iconType:"warning",content:t("common.message.exportMessage"),onOk(){return g(this,null,function*(){n.filename=`${s.value}.xls`,yield re(n).then(o=>{ee(o==null?void 0:o.data,n.filename)}),n.filename=null,a.success(t("common.exportSuccessText"))})}})}function z({rows:e}){p.value=e.length===0}return le(()=>{$(),j.getInstance().listen("integrated-vehicle",x)}),(e,o)=>{const r=ce("a-button");return de(),me(l(U),{dense:"",contentFullHeight:"",fixedHeight:"",contentClass:"flex",style:{position:"relative"}},{default:d(()=>[m(Y,{title:"电站组织",onSelect:F,value:h.value,class:"left-tree-layout",toolbar:!0,canEdit:!1,canAdd:!1,canDelete:!1,isShowOperationBtns:!1,fieldNames:{key:"id",title:"name"}},null,8,["value"]),pe("div",ue,[m(l(J),{onRegister:l(f),class:"fix-basic-table",searchInfo:n,onResizeColumn:o[0]||(o[0]=(v,A)=>A.width=v),onRowDbClick:o[1]||(o[1]=v=>M(v)),onSelectionChange:z},{toolbar:d(()=>[m(r,{type:"primary",preIcon:l(I).ADD,onClick:B},{default:d(()=>[_(b(l(t)("common.action.create")),1)]),_:1},8,["preIcon"]),m(r,{disabled:p.value,type:"primary",preIcon:l(I).EDIT,onClick:L},{default:d(()=>[_(b(l(t)("common.action.edit")),1)]),_:1},8,["disabled","preIcon"]),m(r,{disabled:p.value,class:"red-btn",preIcon:l(I).DELETE,onClick:K},{default:d(()=>[_(b(l(t)("common.delText")),1)]),_:1},8,["disabled","preIcon"]),m(r,{class:"yellow-btn",preIcon:l(I).EXPORT,onClick:V},{default:d(()=>[_(b(l(t)("common.action.export")),1)]),_:1},8,["preIcon"])]),_:1},8,["onRegister","searchInfo"])])]),_:1})}}});const qe=G(fe,[["__scopeId","data-v-5a6b5af1"]]);export{qe as default};
//# sourceMappingURL=index-625e75dd.js.map
