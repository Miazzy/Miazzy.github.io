var S=Object.defineProperty;var y=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var I=(a,t,e)=>t in a?S(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,_=(a,t)=>{for(var e in t||(t={}))T.call(t,e)&&I(a,e,t[e]);if(y)for(var e of y(t))A.call(t,e)&&I(a,e,t[e]);return a};var p=(a,t,e)=>new Promise((i,r)=>{var h=s=>{try{m(e.next(s))}catch(u){r(u)}},f=s=>{try{m(e.throw(s))}catch(u){r(u)}},m=s=>s.done?i(s.value):Promise.resolve(s.value).then(h,f);m((e=e.apply(a,t)).next())});import{a0 as v,a5 as b,b as F,au as M,av as k,_ as R}from"./index.js";import{B as E}from"./BasicTable-0434a334.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1ba7be9e.js";import"./index-085d06c7.js";import{u as N}from"./useTable-109483b3.js";import"./antd-15ac76ed.js";import{P as W}from"./index-20519caf.js";import{e as Y}from"./download-03e71dd5.js";import{e as L}from"./index-5d738211.js";import{r as z,d as Q,k as B,al as V,Z as H,a9 as q,aa as x,f as w,u as g,E as j,ad as D}from"./vue-71d1abb3.js";import"./useForm-dea3ed18.js";import"./uniqBy-92d3bc7f.js";import"./index-316f6ffb.js";import"./useWindowSizeFn-13b1b8a2.js";import"./index-f4fc48e6.js";import"./useTabs-2b062e85.js";import"./index-5d49b7a7.js";import"./SearchBox-22bb02d6.js";import"./UploadBox-636ecf02.js";import"./Dialog-0a006d82.js";import"./DictSelectBox.vue_vue_type_script_setup_true_lang-e03e9fe8.js";import"./OrganDialog-dd1023ce.js";import"./sortable.esm-4ae27e0b.js";import"./dict-c04c0dd8.js";import"./useContentViewHeight-7f845167.js";const U=a=>b.get({url:"/bi/oa/att/page",params:a},{isOnlyResult:!0}),X=a=>b.post({url:"/bi/oa/att/export-excel",params:a,responseType:"blob"},{isOnlyResult:!0}),Z=a=>b.get({url:"/bi/common/org/info",params:a},{isOnlyResult:!0}),O=()=>{const a=[{title:"所属公司",dataIndex:"stationOrganName",headAlign:"center",align:"left",sorter:!0,resizable:!0,width:220},{title:"电站名称",dataIndex:"stationName",headAlign:"center",align:"left",sorter:!0,resizable:!0,width:220},{title:"人员",dataIndex:"personName",sorter:!0,resizable:!0,width:120},{title:"工作日白班数量",dataIndex:"weekdayQty",headAlign:"center",align:"right",sorter:!0,resizable:!0,minWidth:150},{title:"工作日夜班数量",dataIndex:"weekdayNightQty",headAlign:"center",align:"right",sorter:!0,resizable:!0,minWidth:150},{title:"节假日白班数量",dataIndex:"holidayQty",headAlign:"center",align:"right",sorter:!0,resizable:!0,minWidth:150},{title:"节假日夜班数量",dataIndex:"holidayNightQty",headAlign:"center",align:"right",sorter:!0,resizable:!0,minWidth:150},{title:"白班合计",dataIndex:"dayQty",headAlign:"center",align:"right",sorter:!0,resizable:!0,minWidth:150},{title:"夜班合计",dataIndex:"nightQty",headAlign:"center",align:"right",sorter:!0,resizable:!0,minWidth:150}];if(v().isMultiOrganization)return a;{const[,...t]=a;return[...t]}},$=()=>{const a=z({organId:null});return{baseColProps:{span:8},labelWidth:120,autoAdvancedLine:1,schemas:[{field:"[startMonth, endMonth]",label:"月份",component:"RangePicker",componentProps:{format:"YYYY-MM",valueFormat:"YYYY-MM",picker:"month",placeholder:["开始月份","结束月份"],style:"width: 100%"}},{field:"stationOrganId",label:"所属公司",component:"ApiSelect",componentProps:({formModel:t})=>({api:()=>p(void 0,null,function*(){const e=yield Z({}),i=[];return e&&e.length>0&&e.forEach(r=>{i.push({value:r.id,label:r.label})}),i}),immediate:!1,onChange:e=>{a.organId=e,t.stationIds=[]}}),show:v().isMultiOrganization},{field:"stationIds",label:"电站名称",component:"ApiSelect",componentProps:{api:()=>p(void 0,null,function*(){const t=yield L(_({},a)),e=[];return t&&t.length>0&&t.forEach(i=>{e.push({value:i.id,label:i.name})}),e}),mode:"multiple",maxTagCount:"responsive",filterOption:(t,e)=>e.label.toLowerCase().indexOf(t.toLowerCase())>=0}}]}},G=Q({__name:"index",setup(a){const{t}=F(),{createConfirm:e,createMessage:i}=M(),r=z({}),h=d=>{const o=C().getFieldsValue();o.stationIds&&o.stationIds.length>0&&(o.stationId=o.stationIds.join(","));let l={};for(const c in o)c!=="stationIds"&&(l[c]=o[c]);if(d){const c=u();l.pageNo=c.current,l.pageSize=c.pageSize}return l.sortField=r.sortField,l.sortOrder=r.sortOrder,l},f=()=>p(this,null,function*(){const d=h(!0);return yield U(d)}),m=B("排班统计"),[s,{getPaginationRef:u,getForm:C}]=N({title:m,api:f,columns:O(),useSearchForm:!0,formConfig:$(),bordered:!0,showTableSetting:!0,tableSetting:{fullScreen:!0},showIndexColumn:!0,sortFn:d=>{var o;const n=(o=d.order)==null?void 0:o.replace("end","");r.sortOrder=n,r.sortField=n?d.field:void 0}});function P(){e({title:t("common.message.confirmTitle"),iconType:"warning",content:t("common.message.exportMessage"),onOk(){return p(this,null,function*(){const n=h(!1);n.filename=`${m.value}.xlsx`,n.excelList=O(),yield X(n).then(o=>{Y(o==null?void 0:o.data,n.filename)}),i.success(t("common.exportSuccessText"))})}})}return(d,n)=>{const o=V("a-button");return H(),q(g(W),{dense:"",contentFullHeight:"",fixedHeight:"",contentClass:"flex",style:{position:"relative"}},{default:x(()=>[w(g(E),{class:"fix-basic-table",onRegister:g(s),searchInfo:r,onResizeColumn:n[0]||(n[0]=(l,c)=>c.width=l)},{toolbar:x(()=>[w(o,{class:"yellow-btn",preIcon:g(k).EXPORT,onClick:P},{default:x(()=>[j(D(g(t)("common.action.export")),1)]),_:1},8,["preIcon"])]),_:1},8,["onRegister","searchInfo"])]),_:1})}}});const ve=R(G,[["__scopeId","data-v-c0e0c041"]]);export{ve as default};
//# sourceMappingURL=index-f9e6c1ca.js.map
