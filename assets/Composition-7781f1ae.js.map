{"version":3,"file":"Composition-7781f1ae.js","sources":["../../src/views/da/cockpit/composition/Composition.vue"],"sourcesContent":["<template>\n  <div v-if=\"refreshFlag\" class=\"layout rem-layout\">\n    <div class=\"dashboard\">\n      <CockpitHeader v-if=\"tabStatus === 'on'\" class=\"header-layout\" :title=\"title\" @date-change=\"handleDateChange\" />\n      <CockpitSetting v-if=\"tabStatus === 'off'\" @date-change=\"handleDateChange\" />\n      <div class=\"content\">\n        <TopContent ref=\"topContentRef\" :data=\"topIndexData\" />\n        <MiddleContent ref=\"middleContentRef\" :searchInfoByTime=\"searchInfoByTime\" :tabStatus=\"tabStatus\" />\n        <BottomContent ref=\"bottomContentRef\" :searchInfoByTime=\"searchInfoByTime\" :tabStatus=\"tabStatus\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import '../../rem.ts';\n  import { ref, reactive, onMounted, nextTick, getCurrentInstance } from 'vue';\n  import { assign } from 'min-dash';\n  import CockpitHeader from '/@/components/Framework/Chart/CockpitHeader.vue';\n  import TopContent from '/@/views/da/cockpit/composition/TopContent.vue';\n  import MiddleContent from '/@/views/da/cockpit/composition/MiddleContent.vue';\n  import BottomContent from '/@/views/da/cockpit/composition/BottomContent.vue';\n  import { getTopIndexData } from './data';\n  import CockpitSetting from '/@/components/Framework/Chart/CockpitSetting.vue';\n  import { handleInstanceUpdated } from '/@/utils/route';\n  import { useRouter } from 'vue-router';\n  // import { MsgManager } from '/@/message/MsgManager';\n\n  const title = ref('综合驾驶舱');\n  const searchInfoByTime = ref({});\n  const topIndexData = reactive({});\n  const refreshFlag = ref(true);\n  const tabStatus = ref('');\n  const instance = getCurrentInstance();\n  const topContentRef = ref();\n  const middleContentRef = ref();\n  const bottomContentRef = ref();\n  const router = useRouter();\n\n  function handleDateChange(e) {\n    const [startMonth, endMonth] = e;\n    searchInfoByTime.value = { startMonth, endMonth };\n    queryTopIndexData();\n  }\n\n  const queryTopIndexData = async () => {\n    let data = await getTopIndexData(searchInfoByTime.value);\n    if (data.result) {\n      assign(topIndexData, data.result);\n    }\n  };\n\n  // 判断当前页面是否在 iframe 中显示\n  const checkInIframe = () => {\n    try {\n      return window.self !== window.top;\n    } catch (e) {\n      return true;\n    }\n  };\n\n  // 更新页面\n  const handlePageUpdate = () => {\n    try {\n      const path = router.currentRoute.value?.path;\n      if (path === '/frame/cockpit/composition') {\n        handleInstanceUpdated(instance);\n      } else if (path === '/cockpitcomposition') {\n        bottomContentRef.value?.handleUpdate();\n        middleContentRef.value?.handleUpdate();\n        topContentRef.value?.handleUpdate();\n      }\n    } catch (error) {\n      console.error('update composition page error:', error);\n    }\n  };\n\n  onMounted(() => {\n    tabStatus.value = checkInIframe() ? 'off' : 'on';\n    window.addEventListener('resize', handlePageUpdate);\n  });\n</script>\n\n<style lang=\"less\" scoped>\n  .layout {\n    position: relative;\n    width: 100%;\n    height: 100%;\n\n    .dashboard {\n      display: flex;\n      position: relative;\n      flex-direction: column;\n      width: 100%;\n      height: 100%;\n      background: url('../../../../assets/images/da/sky_bg.jpg') no-repeat center/100% 100%;\n\n      .content {\n        display: flex;\n        flex: 1;\n        flex-direction: column;\n        flex-shrink: 0;\n        height: 100%;\n        padding: 2.78vh 0.78vw 1.48vh;\n\n        :deep(.ant-select-selection-search-input) {\n          color: rgb(255 255 255 / 85%);\n        }\n\n        :deep(.ant-select-selection-item) {\n          color: rgb(255 255 255 / 85%);\n        }\n\n        :deep(\n            .ant-select-single .ant-select-selector .ant-select-selection-item,\n            .ant-select-single .ant-select-selector .ant-select-selection-placeholder\n          ) {\n          line-height: 0.24rem;\n        }\n\n        :deep(.ant-select) {\n          font-size: 0.14rem;\n        }\n      }\n    }\n  }\n</style>\n"],"names":["title","ref","searchInfoByTime","topIndexData","reactive","refreshFlag","tabStatus","instance","getCurrentInstance","topContentRef","middleContentRef","bottomContentRef","router","useRouter","handleDateChange","e","startMonth","endMonth","queryTopIndexData","__async","data","getTopIndexData","assign","checkInIframe","handlePageUpdate","path","_a","handleInstanceUpdated","_b","_c","_d","error","onMounted"],"mappings":"o4CA4BQ,MAAAA,EAAQC,EAAI,OAAO,EACnBC,EAAmBD,EAAI,CAAA,CAAE,EACzBE,EAAeC,EAAS,CAAA,CAAE,EAC1BC,EAAcJ,EAAI,EAAI,EACtBK,EAAYL,EAAI,EAAE,EAClBM,EAAWC,IACXC,EAAgBR,IAChBS,EAAmBT,IACnBU,EAAmBV,IACnBW,EAASC,IAEf,SAASC,EAAiBC,EAAG,CACrB,KAAA,CAACC,EAAYC,CAAQ,EAAIF,EACdb,EAAA,MAAQ,CAAE,WAAAc,EAAY,SAAAC,CAAS,EAC9BC,GACpB,CAEA,MAAMA,EAAoB,IAAYC,EAAA,sBACpC,IAAIC,EAAO,MAAMC,EAAgBnB,EAAiB,KAAK,EACnDkB,EAAK,QACAE,EAAAnB,EAAciB,EAAK,MAAM,CAClC,GAIIG,EAAgB,IAAM,CACtB,GAAA,CACK,OAAA,OAAO,OAAS,OAAO,UACvBR,EAAG,CACH,MAAA,EACT,CAAA,EAIIS,EAAmB,IAAM,aACzB,GAAA,CACI,MAAAC,GAAOC,EAAAd,EAAO,aAAa,QAApB,YAAAc,EAA2B,KACpCD,IAAS,6BACXE,EAAsBpB,CAAQ,EACrBkB,IAAS,yBAClBG,EAAAjB,EAAiB,QAAjB,MAAAiB,EAAwB,gBACxBC,EAAAnB,EAAiB,QAAjB,MAAAmB,EAAwB,gBACxBC,EAAArB,EAAc,QAAd,MAAAqB,EAAqB,sBAEhBC,EAAO,CACN,QAAA,MAAM,iCAAkCA,CAAK,CACvD,CAAA,EAGF,OAAAC,EAAU,IAAM,CACJ1B,EAAA,MAAQiB,IAAkB,MAAQ,KACrC,OAAA,iBAAiB,SAAUC,CAAgB,CAAA,CACnD"}