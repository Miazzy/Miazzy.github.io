{"version":3,"file":"MiddleContent-ea07e343.js","sources":["../../src/views/da/cockpit/property/MiddleContent.vue"],"sourcesContent":["<template>\n  <div class=\"middle-content\" :key=\"instanceKey\">\n    <div class=\"left-section section-box\">\n      <div class=\"section-bg\">\n        <SubtitleBar :subtitle=\"`电站统计`\">\n          <a-select\n            ref=\"select\"\n            v-model:value=\"searchInfo.selectStationValue\"\n            :options=\"optionsStationAndCompany\"\n            style=\"width: 1.2rem\"\n            @change=\"handleStationChange\"\n            v-show=\"optionsStationAndCompany.length > 1\"\n          />\n        </SubtitleBar>\n        <div\n          v-if=\"donutDataByStation?.pieData?.length || pChartDataByStation?.barData?.length\"\n          class=\"chart-box\"\n        >\n          <!-- <DonutChart :data=\"donutDataByStation.pieData\" width=\"2rem\" height=\"2rem\" radius=\"100\" /> -->\n          <EchartPieChart\n            id=\"station-stat-pie\"\n            :width=\"`10.4vw`\"\n            :height=\"tabStatus === 'on' ? `33.08vh` : `36.53vh`\"\n            :data=\"donutDataByStation.pieData\"\n            :roseType=\"false\"\n            :radius=\"['50%', '70%']\"\n            showLegend\n            :legendOptions=\"{ top: '60%' }\"\n            :pieCenter=\"['50%', '35%']\"\n            @click-item=\"handleStationPenetrate\"\n          />\n          <div style=\"width: 7.08rem; height: 2rem\">\n            <div\n              :style=\"\n                tabStatus === 'on'\n                  ? 'margin-top: -0.3rem; transform: scale(0.85)'\n                  : 'margin-top: -0.35rem; transform: scale(0.85)'\n              \"\n            >\n              <EchartPillarChart\n                :data=\"pChartDataByStation\"\n                :colors=\"pChartDataByStation.colors\"\n                :name=\"pChartNameByStation\"\n                :width=\"`39.59vw`\"\n                :height=\"tabStatus === 'on' ? `40vh` : `44vh`\"\n                :tipsFormat=\"handleTipsContent\"\n                @clickItem=\"handleStationPenetrateByParams\"\n                :dataZoomDisabled=\"false\"\n                :dataZoomDefaultValueRange=\"[0, 5]\"\n              />\n            </div>\n          </div>\n        </div>\n        <NoData v-else />\n      </div>\n    </div>\n    <div class=\"right-section section-box\">\n      <div class=\"section-bg\">\n        <SubtitleBar :subtitle=\"`设备统计`\">\n          <a-select\n            ref=\"select\"\n            v-model:value=\"searchInfo.selectEquipmentValue\"\n            :options=\"optionsDimension\"\n            style=\"width: 1.2rem; margin-right: 0.1rem\"\n            @change=\"handleEquipmentChange\"\n            v-show=\"optionsDimension.length > 1\"\n          />\n          <a-select\n            ref=\"select\"\n            v-model:value=\"searchInfo.selectEquipmentType\"\n            :options=\"optionsEquipment\"\n            style=\"width: 1.2rem\"\n            label-in-value\n            @change=\"handleEquipmentTypeChange\"\n          />\n        </SubtitleBar>\n        <div\n          v-if=\"donutDataByEquipment?.pieData?.length || barchartDataByEquipment?.barData?.length\"\n          class=\"chart-box\"\n        >\n          <!-- <DonutChart\n            :data=\"donutDataByEquipment.pieData\"\n            width=\"2rem\"\n            height=\"2rem\"\n            radius=\"100\"\n          /> -->\n          <EchartPieChart\n            id=\"equipment-stat-pie\"\n            :width=\"`10.4vw`\"\n            :height=\"tabStatus === 'on' ? `33.08vh` : `36.53vh`\"\n            :data=\"donutDataByEquipment.pieData\"\n            :roseType=\"false\"\n            :radius=\"['50%', '70%']\"\n            showLegend\n            :legendOptions=\"{ top: '60%' }\"\n            :pieCenter=\"['50%', '35%']\"\n            @click-item=\"handleEquipmentPenetrate\"\n          />\n          <div style=\"width: 7.08rem; height: 2rem\">\n            <div\n              :style=\"\n                tabStatus === 'on'\n                  ? 'margin-top: -0.35rem; transform: scale(0.85)'\n                  : 'margin-top: -0.35rem; transform: scale(0.85)'\n              \"\n            >\n              <EchartStackBarChart\n                id=\"equipment_stack_chart\"\n                :data=\"barchartDataByEquipment\"\n                :width=\"`39.59vw`\"\n                :height=\"tabStatus === 'on' ? `40vh` : `44vh`\"\n                :category=\"barchartDataByEquipment.categories\"\n                ybgcolor=\"#01B7D730\"\n                @click=\"handleEquipmentPenetrate\"\n              />\n            </div>\n          </div>\n        </div>\n        <NoData v-else />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import { reactive, UnwrapRef, ref, onMounted, watch } from 'vue';\n  import SubtitleBar from '/@/components/Framework/Chart/SubtitleBar.vue';\n  // import DonutChart from '/@/components/Framework/Chart/DonutChart2.vue';\n  import EchartPillarChart from '/@/components/Framework/Chart/EchartPillarChart.vue';\n  import {\n    getStationStatisticData,\n    getEquipmentTypeData,\n    getEquipmentStatisticsData,\n  } from './data';\n  import { assign } from 'lodash-es';\n  import { handleRouteChange } from '../../utils';\n  import * as CommonApi from '@/api/da/common';\n  import EchartPieChart from '/@/components/Framework/Chart/EchartPieChart.vue';\n  import NoData from '/@/components/Framework/Chart/NoData.vue';\n  import EchartStackBarChart from '/@/components/Framework/Chart/EchartStackBarChart.vue';\n  import { buildUUID } from '@/utils/uuid';\n\n  const searchInfo: UnwrapRef<any> = reactive({\n    //电站统计\n    selectStationValue: 'station',\n    //设备统计\n    selectEquipmentValue: 'station',\n    // selectEquipmentType: '1',\n  });\n\n  interface Props {\n    searchInfoByTime?: {};\n    tabStatus?: '';\n  }\n  const props = withDefaults(defineProps<Props>(), {});\n  const optionsDimension: any = ref([]);\n  const optionsStationAndCompany: any = ref([]);\n  const optionsEquipment: any = ref([]);\n  const instanceKey = ref(buildUUID());\n\n  watch(\n    () => props.searchInfoByTime,\n    (value) => {\n      assign(searchInfo, value);\n      queryStationData();\n      if (searchInfo.selectEquipmentType) {\n        queryEquipmentData();\n      }\n    },\n  );\n\n  onMounted(async () => {\n    const sts = await CommonApi.getDictDataMap({ dictType: 'cockpit_three_dimension' });\n    sts.result.forEach((e) => {\n      optionsDimension.value.push({ value: e.value, label: e.label });\n    });\n\n    const stationList = await CommonApi.getDictDataMap({ dictType: 'cockpit_two_dimension' });\n    stationList.result.forEach((e) => {\n      optionsStationAndCompany.value.push({ value: e.value, label: e.label });\n    });\n\n    const equipmentData = await getEquipmentTypeData({});\n    if (equipmentData.result) {\n      if (equipmentData.result?.length) {\n        searchInfo.selectEquipmentType = equipmentData.result[0].value;\n      }\n      equipmentData.result.forEach((e) => {\n        optionsEquipment.value.push({ value: e.value, label: e.label });\n      });\n    }\n    queryEquipmentData();\n  });\n\n  //=============================== 电站统计==============================================\n  const pChartDataByStation = ref({\n    barData: [],\n    categories: [],\n    units: ['容量(MW)'],\n    colors: [\n      ['#488FF6', '#60D1F3'],\n      ['#E59837', '#FAE895'],\n      ['#078C5D', '#68E4B8'],\n    ],\n  });\n  const pChartNameByStation = ref(['容量(MW)']);\n  const donutDataByStation = ref({\n    pieData: [],\n  });\n  const queryStationData = async () => {\n    searchInfo.dimension = searchInfo.selectStationValue;\n    let data = await getStationStatisticData(searchInfo);\n    if (data.result) {\n      pChartDataByStation.value.barData = data.result.barData;\n      pChartDataByStation.value.categories = data.result.categories;\n      let pieData = [];\n      data.result.pieData.forEach((item) => {\n        item.name = item.label;\n        pieData.push(item);\n      });\n      donutDataByStation.value.pieData = pieData;\n    }\n  };\n  const handleStationChange = (value: string) => {\n    searchInfo.selectStationValue = value;\n    queryStationData();\n  };\n  const handleTipsContent = (params) => {\n    const element = params[0];\n    const text = `电站：${element.name}\\n\\r</br>容量：${element.data.value}(MW)`;\n    return text;\n  };\n  //=============================== 设备统计=============================================\n  const donutDataByEquipment = ref({\n    pieData: [],\n  });\n  const barchartDataByEquipment = ref({\n    barData: [[]],\n    categories: [],\n    // units: ['单位'],\n    // colors: [\n    //   ['#488FF6', '#60D1F3'],\n    //   ['#078C5D', '#68E4B8'],\n    //   ['#E59837', '#FAE895'],\n    //   '#f39c12',\n    //   '#f39c12',\n    // ],\n    barNames: [],\n  });\n\n  const handleEquipmentTipsContent = (params) => {\n    const element = params[0];\n    const text = `电站：${element.name} \\n\\r</br>数量：${element.data.value}`;\n    return text;\n  };\n  const queryEquipmentData = async () => {\n    searchInfo.dimension = searchInfo.selectEquipmentValue;\n    searchInfo.index = searchInfo.selectEquipmentType;\n\n    let data = await getEquipmentStatisticsData(searchInfo);\n    if (data.result) {\n      barchartDataByEquipment.value.barData = data.result.barData;\n      barchartDataByEquipment.value.categories = data.result.categories;\n      barchartDataByEquipment.value.barNames = data.result.barNames;\n      let pieData = [];\n      data.result.pieData.forEach((item) => {\n        item.name = item.label;\n        pieData.push(item);\n      });\n      donutDataByEquipment.value.pieData = pieData;\n    }\n  };\n  const handleEquipmentChange = (value: string) => {\n    searchInfo.selectEquipmentValue = value;\n    queryEquipmentData();\n  };\n  const handleEquipmentTypeChange = (value: string) => {\n    searchInfo.selectEquipmentType = value.value;\n    queryEquipmentData();\n  };\n\n  //=============================== 数据穿透=============================================\n  //电站统计穿透-并网记录统计\n  function handleStationPenetrate() {\n    handleRouteChange('/bi/grid/record/statistics', {});\n  }\n\n  function handleStationPenetrateByParams(params) {\n    handleRouteChange('/bi/grid/record/statistics', {\n      stationId: searchInfo.selectStationValue === 'station' ? params.data.id : '',\n      orgId: searchInfo.selectStationValue === 'company' ? params.data.id : '',\n    });\n  }\n\n  // 设备统计\n  function handleEquipmentPenetrate(params) {\n    handleRouteChange('/po/equipment/index', {});\n  }\n\n  // 更新组件函数\n  const handleUpdate = () => {\n    instanceKey.value = buildUUID();\n  };\n\n  defineExpose({\n    handleUpdate,\n  });\n</script>\n\n<style lang=\"less\" scoped>\n  .middle-content {\n    display: flex;\n    flex: 44.34%;\n    justify-content: space-between;\n    height: 44.34%;\n    padding-top: 0.93vh;\n\n    .section-box {\n      flex: 50%;\n      width: 50%;\n      height: 100%;\n\n      :deep(.subtitle-bar) {\n        padding-left: 0.2rem;\n      }\n    }\n\n    .section-bg {\n      width: 100%;\n      height: 100%;\n      background: url('../../../../assets/images/da/property_section_bg_1.png') no-repeat\n        center/100% 100%;\n    }\n\n    .left-section {\n      padding-right: 0.41vw;\n    }\n\n    .right-section {\n      padding-left: 0.41vw;\n    }\n\n    :deep(.ant-select:not(.ant-select-customize-input) .ant-select-selector) {\n      height: 0.26rem !important;\n      border: 0.01rem solid #07a6ff70;\n      border-radius: 0;\n      background-color: transparent;\n    }\n\n    :deep(.ant-select-single .ant-select-selector .ant-select-selection-placeholder) {\n      height: 0.26rem;\n      line-height: 0.26rem;\n    }\n\n    :deep(.ant-select-arrow) {\n      color: rgb(255 255 255 / 50%);\n    }\n\n    .chart-box {\n      display: flex;\n      padding-left: 0.2rem;\n    }\n  }\n</style>\n"],"names":["searchInfo","reactive","optionsDimension","ref","optionsStationAndCompany","optionsEquipment","instanceKey","buildUUID","watch","props","value","assign","queryStationData","queryEquipmentData","onMounted","__async","CommonApi.getDictDataMap","e","equipmentData","getEquipmentTypeData","_a","pChartDataByStation","pChartNameByStation","donutDataByStation","data","getStationStatisticData","pieData","item","handleStationChange","handleTipsContent","params","element","donutDataByEquipment","barchartDataByEquipment","getEquipmentStatisticsData","handleEquipmentChange","handleEquipmentTypeChange","handleStationPenetrate","handleRouteChange","handleStationPenetrateByParams","handleEquipmentPenetrate","__expose"],"mappings":"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"}