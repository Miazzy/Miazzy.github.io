{"version":3,"file":"index-3f871d0c.js","sources":["../../src/views/sys/error-log/index.vue"],"sourcesContent":["<template>\n  <div class=\"p-4\">\n    <template v-for=\"src in imgList\" :key=\"src\">\n      <img :src=\"src\" v-show=\"false\" alt=\"\" />\n    </template>\n    <DetailModal :info=\"rowInfo\" @register=\"registerModal\" />\n    <BasicTable @register=\"register\" class=\"error-handle-table\">\n      <template #toolbar>\n        <a-button @click=\"fireVueError\" type=\"primary\">\n          {{ t('sys.errorLog.fireVueError') }}\n        </a-button>\n        <a-button @click=\"fireResourceError\" type=\"primary\">\n          {{ t('sys.errorLog.fireResourceError') }}\n        </a-button>\n        <a-button @click=\"fireAjaxError\" type=\"primary\">\n          {{ t('sys.errorLog.fireAjaxError') }}\n        </a-button>\n      </template>\n      <template #bodyCell=\"{ column, record }\">\n        <template v-if=\"column.key === 'action'\">\n          <TableAction\n            :actions=\"[\n              {\n                label: t('sys.errorLog.tableActionDesc'),\n                onClick: handleDetail.bind(null, record),\n              },\n            ]\"\n          />\n        </template>\n      </template>\n    </BasicTable>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import type { ErrorLogInfo } from '/#/store';\n  import { watch, ref, nextTick } from 'vue';\n  import DetailModal from './DetailModal.vue';\n  import { BasicTable, useTable, TableAction } from '/@/components/Table/index';\n  import { useModal } from '/@/components/Modal';\n  import { useMessage } from '/@/hooks/web/useMessage';\n  import { useI18n } from '/@/hooks/web/useI18n';\n  import { useErrorLogStore } from '/@/store/modules/errorLog';\n  import { getColumns } from './data';\n  import { cloneDeep } from 'lodash-es';\n  // import { fireErrorApi } from '/@/api/demo/error';\n\n  const rowInfo = ref<ErrorLogInfo>();\n  const imgList = ref<string[]>([]);\n\n  const { t } = useI18n();\n  const errorLogStore = useErrorLogStore();\n  const [register, { setTableData }] = useTable({\n    title: t('sys.errorLog.tableTitle'),\n    columns: getColumns(),\n    actionColumn: {\n      width: 80,\n      title: 'Action',\n      dataIndex: 'action',\n      // slots: { customRender: 'action' },\n    },\n  });\n  const [registerModal, { openModal }] = useModal();\n\n  watch(\n    () => errorLogStore.getErrorLogInfoList,\n    (list) => {\n      nextTick(() => {\n        setTableData(cloneDeep(list));\n      });\n    },\n    {\n      immediate: true,\n    },\n  );\n  const { createMessage } = useMessage();\n  if (import.meta.env.DEV) {\n    createMessage.info(t('sys.errorLog.enableMessage'));\n  }\n  // 查看详情\n  function handleDetail(row: ErrorLogInfo) {\n    rowInfo.value = row;\n    openModal(true);\n  }\n\n  function fireVueError() {\n    throw new Error('fire vue error!');\n  }\n\n  function fireResourceError() {\n    imgList.value.push(`${new Date().getTime()}.png`);\n  }\n\n  async function fireAjaxError() {\n    // await fireErrorApi();\n  }\n</script>\n"],"names":["rowInfo","ref","imgList","useI18n","errorLogStore","useErrorLogStore","register","setTableData","useTable","getColumns","registerModal","openModal","useModal","watch","list","nextTick","cloneDeep","useMessage","handleDetail","row","fireVueError","fireResourceError","fireAjaxError","__async"],"mappings":"o0CA+CE,MAAMA,EAAUC,IACVC,EAAUD,EAAc,CAAA,CAAE,EAE1B,CAAE,GAAME,IACRC,EAAgBC,IAChB,CAACC,EAAU,CAAE,aAAAC,CAAc,CAAA,EAAIC,EAAS,CAC5C,MAAO,EAAE,yBAAyB,EAClC,QAASC,EAAW,EACpB,aAAc,CACZ,MAAO,GACP,MAAO,SACP,UAAW,QAEb,CAAA,CACD,EACK,CAACC,EAAe,CAAE,UAAAC,CAAU,CAAC,EAAIC,EAAS,EAEhDC,EACE,IAAMT,EAAc,oBACnBU,GAAS,CACRC,EAAS,IAAM,CACAR,EAAAS,EAAUF,CAAI,CAAC,CAAA,CAC7B,CACH,EACA,CACE,UAAW,EACb,CAAA,EAEwBG,EAAW,EAKrC,SAASC,EAAaC,EAAmB,CACvCnB,EAAQ,MAAQmB,EAChBR,EAAU,EAAI,CAChB,CAEA,SAASS,GAAe,CAChB,MAAA,IAAI,MAAM,iBAAiB,CACnC,CAEA,SAASC,GAAoB,CACnBnB,EAAA,MAAM,KAAK,GAAG,IAAI,OAAO,QAAA,CAAS,MAAM,CAClD,CAEA,SAAeoB,GAAgB,QAAAC,EAAA,sBAE/B"}