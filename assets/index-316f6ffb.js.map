{"version":3,"file":"index-316f6ffb.js","sources":["../../src/components/Modal/src/props.ts","../../src/components/Modal/src/hooks/useModalDrag.ts","../../src/components/Modal/src/components/Modal.tsx","../../src/components/Modal/src/hooks/useModalContext.ts","../../src/components/Modal/src/components/ModalWrapper.vue","../../src/components/Modal/src/components/ModalClose.vue","../../src/components/Modal/src/components/ModalFooter.vue","../../src/components/Modal/src/components/ModalHeader.vue","../../src/components/Modal/src/hooks/useModalFullScreen.ts","../../src/components/Modal/src/BasicModal.vue","../../src/components/Modal/src/AModal.vue","../../src/components/Modal/src/hooks/useModal.ts","../../src/components/Modal/index.ts"],"sourcesContent":["import type { PropType, CSSProperties } from 'vue';\nimport type { ModalWrapperProps } from './typing';\nimport { ButtonProps } from 'ant-design-vue/es/button/buttonTypes';\nimport { useI18n } from '/@/hooks/web/useI18n';\n\nconst { t } = useI18n();\n\nexport const modalProps = {\n  visible: { type: Boolean },\n  scrollTop: { type: Boolean, default: true },\n  height: { type: Number },\n  minHeight: { type: Number },\n  // open drag\n  draggable: { type: Boolean, default: true },\n  centered: { type: Boolean },\n  cancelText: { type: String, default: t('common.cancelText') },\n  okText: { type: String, default: t('common.okText') },\n\n  closeFunc: Function as PropType<() => Promise<boolean>>,\n};\n\nexport const basicProps = Object.assign({}, modalProps, {\n  defaultFullscreen: { type: Boolean },\n  // Can it be full screen\n  canFullscreen: { type: Boolean, default: true },\n  // After enabling the wrapper, the bottom can be increased in height\n  wrapperFooterOffset: { type: Number, default: 0 },\n  // Warm reminder message\n  helpMessage: [String, Array] as PropType<string | string[]>,\n  // Whether to setting wrapper\n  useWrapper: { type: Boolean, default: true },\n  loading: { type: Boolean },\n  loadingTip: { type: String },\n  /**\n   * @description: Show close button\n   */\n  showCancelBtn: { type: Boolean, default: true },\n  /**\n   * @description: Show confirmation button\n   */\n  showOkBtn: { type: Boolean, default: true },\n\n  wrapperProps: Object as PropType<Partial<ModalWrapperProps>>,\n\n  afterClose: Function as PropType<() => Promise<VueNode>>,\n\n  bodyStyle: Object as PropType<CSSProperties>,\n\n  closable: { type: Boolean, default: true },\n\n  closeIcon: Object as PropType<VueNode>,\n\n  confirmLoading: { type: Boolean },\n\n  destroyOnClose: { type: Boolean },\n\n  footer: Object as PropType<VueNode>,\n\n  getContainer: Function as PropType<() => any>,\n\n  mask: { type: Boolean, default: true },\n\n  maskClosable: { type: Boolean, default: true },\n  keyboard: { type: Boolean, default: true },\n\n  maskStyle: Object as PropType<CSSProperties>,\n\n  okType: { type: String, default: 'primary' },\n\n  okButtonProps: Object as PropType<ButtonProps>,\n\n  cancelButtonProps: Object as PropType<ButtonProps>,\n\n  title: { type: String },\n\n  visible: { type: Boolean },\n\n  width: [String, Number] as PropType<string | number>,\n\n  wrapClassName: { type: String },\n\n  zIndex: { type: Number },\n});\n","import { Ref, unref, watchEffect } from 'vue';\nimport { useTimeoutFn } from '@vben/hooks';\n\nexport interface UseModalDragMoveContext {\n  draggable: Ref<boolean>;\n  destroyOnClose: Ref<boolean | undefined> | undefined;\n  visible: Ref<boolean>;\n}\n\nexport function useModalDragMove(context: UseModalDragMoveContext) {\n  const getStyle = (dom: any, attr: any) => {\n    return getComputedStyle(dom)[attr];\n  };\n  const drag = (wrap: any) => {\n    if (!wrap) return;\n    wrap.setAttribute('data-drag', unref(context.draggable));\n    const dialogHeaderEl = wrap.querySelector('.ant-modal-header');\n    const dragDom = wrap.querySelector('.ant-modal');\n\n    if (!dialogHeaderEl || !dragDom || !unref(context.draggable)) return;\n\n    dialogHeaderEl.style.cursor = 'move';\n\n    dialogHeaderEl.onmousedown = (e: any) => {\n      if (!e) return;\n      // 鼠标按下，计算当前元素距离可视区的距离\n      const disX = e.clientX;\n      const disY = e.clientY;\n      const screenWidth = document.body.clientWidth; // body当前宽度\n      const screenHeight = document.documentElement.clientHeight; // 可见区域高度(应为body高度，可某些环境下无法获取)\n\n      const dragDomWidth = dragDom.offsetWidth; // 对话框宽度\n      const dragDomheight = dragDom.offsetHeight; // 对话框高度\n\n      const minDragDomLeft = dragDom.offsetLeft;\n\n      const maxDragDomLeft = screenWidth - dragDom.offsetLeft - dragDomWidth;\n      const minDragDomTop = dragDom.offsetTop;\n      const maxDragDomTop = screenHeight - dragDom.offsetTop - dragDomheight;\n      // 获取到的值带px 正则匹配替换\n      const domLeft = getStyle(dragDom, 'left');\n      const domTop = getStyle(dragDom, 'top');\n      let styL = +domLeft;\n      let styT = +domTop;\n\n      // 注意在ie中 第一次获取到的值为组件自带50% 移动之后赋值为px\n      if (domLeft.includes('%')) {\n        styL = +document.body.clientWidth * (+domLeft.replace(/%/g, '') / 100);\n        styT = +document.body.clientHeight * (+domTop.replace(/%/g, '') / 100);\n      } else {\n        styL = +domLeft.replace(/px/g, '');\n        styT = +domTop.replace(/px/g, '');\n      }\n\n      document.onmousemove = function (e) {\n        // 通过事件委托，计算移动的距离\n        let left = e.clientX - disX;\n        let top = e.clientY - disY;\n\n        // 边界处理\n        if (-left > minDragDomLeft) {\n          left = -minDragDomLeft;\n        } else if (left > maxDragDomLeft) {\n          left = maxDragDomLeft;\n        }\n\n        if (-top > minDragDomTop) {\n          top = -minDragDomTop;\n        } else if (top > maxDragDomTop) {\n          top = maxDragDomTop;\n        }\n\n        // 移动当前元素\n        dragDom.style.cssText += `;left:${left + styL}px;top:${top + styT}px;`;\n      };\n\n      document.onmouseup = () => {\n        document.onmousemove = null;\n        document.onmouseup = null;\n      };\n    };\n  };\n\n  const handleDrag = () => {\n    const dragWraps = document.querySelectorAll('.ant-modal-wrap');\n    for (const wrap of Array.from(dragWraps)) {\n      if (!wrap) continue;\n      const display = getStyle(wrap, 'display');\n      const draggable = wrap.getAttribute('data-drag');\n      if (display !== 'none') {\n        // 拖拽位置\n        if (draggable === null || unref(context.destroyOnClose)) {\n          drag(wrap);\n        }\n      }\n    }\n  };\n\n  watchEffect(() => {\n    if (!unref(context.visible) || !unref(context.draggable)) {\n      return;\n    }\n    useTimeoutFn(() => {\n      handleDrag();\n    }, 30);\n  });\n}\n","import { Modal } from 'ant-design-vue';\nimport { defineComponent, toRefs, unref } from 'vue';\nimport { basicProps } from '../props';\nimport { useModalDragMove } from '../hooks/useModalDrag';\nimport { useAttrs } from '@vben/hooks';\nimport { extendSlots } from '/@/utils/helper/tsxHelper';\n\nexport default defineComponent({\n  name: 'Modal',\n  inheritAttrs: false,\n  props: basicProps as any,\n  emits: ['cancel', 'ok'],\n  setup(props, { slots, emit }) {\n    const { visible, draggable, destroyOnClose } = toRefs(props);\n    const attrs = useAttrs();\n    useModalDragMove({\n      visible,\n      destroyOnClose,\n      draggable,\n    });\n\n    const onOk = (e: Event) => {\n      emit('ok', e);\n    };\n\n    const onCancel = (e: Event) => {\n      emit('cancel', e);\n    };\n\n    return () => {\n      const propsData = { ...unref(attrs), ...props, onCancel, onOk } as Recordable;\n      return <Modal {...propsData}>{extendSlots(slots)}</Modal>;\n    };\n  },\n});\n","import { InjectionKey } from 'vue';\nimport { createContext, useContext } from '/@/hooks/core/useContext';\n\nexport interface ModalContextProps {\n  redoModalHeight: () => void;\n}\n\nconst key: InjectionKey<ModalContextProps> = Symbol();\n\nexport function createModalContext(context: ModalContextProps) {\n  return createContext<ModalContextProps>(context, key);\n}\n\nexport function useModalContext() {\n  return useContext<ModalContextProps>(key);\n}\n","<template>\n  <ScrollContainer ref=\"wrapperRef\">\n    <div ref=\"spinRef\" :style=\"spinStyle\" v-loading=\"loading\" :loading-tip=\"loadingTip\">\n      <slot></slot>\n    </div>\n  </ScrollContainer>\n</template>\n<script lang=\"ts\">\n  import type { CSSProperties } from 'vue';\n  import {\n    defineComponent,\n    computed,\n    ref,\n    watchEffect,\n    unref,\n    watch,\n    onMounted,\n    nextTick,\n    onUnmounted,\n  } from 'vue';\n  import { useWindowSizeFn } from '@vben/hooks';\n  import { type AnyFunction } from '@vben/types';\n  import { ScrollContainer } from '/@/components/Container';\n  import { createModalContext } from '../hooks/useModalContext';\n  import { useMutationObserver } from '@vueuse/core';\n\n  const props = {\n    loading: { type: Boolean },\n    useWrapper: { type: Boolean, default: true },\n    modalHeaderHeight: { type: Number, default: 57 },\n    modalFooterHeight: { type: Number, default: 74 },\n    minHeight: { type: Number, default: 200 },\n    height: { type: Number },\n    footerOffset: { type: Number, default: 0 },\n    visible: { type: Boolean },\n    fullScreen: { type: Boolean },\n    loadingTip: { type: String },\n  };\n\n  export default defineComponent({\n    name: 'ModalWrapper',\n    components: { ScrollContainer },\n    inheritAttrs: false,\n    props,\n    emits: ['height-change', 'ext-height'],\n    setup(props, { emit }) {\n      const wrapperRef = ref(null);\n      const spinRef = ref(null);\n      const realHeightRef = ref(0);\n      const minRealHeightRef = ref(0);\n\n      let realHeight = 0;\n\n      let stopElResizeFn: AnyFunction = () => {};\n\n      useWindowSizeFn(setModalHeight.bind(null, false));\n\n      useMutationObserver(\n        spinRef,\n        () => {\n          setModalHeight();\n        },\n        {\n          attributes: true,\n          subtree: true,\n        },\n      );\n\n      createModalContext({\n        redoModalHeight: setModalHeight,\n      });\n\n      const spinStyle = computed((): CSSProperties => {\n        return {\n          minHeight: `${props.minHeight}px`,\n          [props.fullScreen ? 'height' : 'maxHeight']: `${unref(realHeightRef)}px`,\n        };\n      });\n\n      watchEffect(() => {\n        props.useWrapper && setModalHeight();\n      });\n\n      watch(\n        () => props.fullScreen,\n        (v) => {\n          setModalHeight();\n          if (!v) {\n            realHeightRef.value = minRealHeightRef.value;\n          } else {\n            minRealHeightRef.value = realHeightRef.value;\n          }\n        },\n      );\n\n      onMounted(() => {\n        const { modalHeaderHeight, modalFooterHeight } = props;\n        emit('ext-height', modalHeaderHeight + modalFooterHeight);\n      });\n\n      onUnmounted(() => {\n        stopElResizeFn && stopElResizeFn();\n      });\n\n      async function scrollTop() {\n        nextTick(() => {\n          const wrapperRefDom = unref(wrapperRef);\n          if (!wrapperRefDom) return;\n          (wrapperRefDom as any)?.scrollTo?.(0);\n        });\n      }\n\n      async function setModalHeight() {\n        // 解决在弹窗关闭的时候监听还存在,导致再次打开弹窗没有高度\n        // 加上这个,就必须在使用的时候传递父级的visible\n        if (!props.visible) return;\n        const wrapperRefDom = unref(wrapperRef);\n        if (!wrapperRefDom) return;\n\n        const bodyDom = (wrapperRefDom as any).$el.parentElement;\n        if (!bodyDom) return;\n        bodyDom.style.padding = '0';\n        await nextTick();\n\n        try {\n          const modalDom = bodyDom.parentElement && bodyDom.parentElement.parentElement;\n          if (!modalDom) return;\n\n          const modalRect = getComputedStyle(modalDom as Element).top;\n          const modalTop = Number.parseInt(modalRect);\n          let maxHeight =\n            window.innerHeight -\n            modalTop * 2 +\n            (props.footerOffset! || 0) -\n            props.modalFooterHeight -\n            props.modalHeaderHeight;\n\n          // 距离顶部过进会出现滚动条\n          if (modalTop < 40) {\n            maxHeight -= 26;\n          }\n          await nextTick();\n          const spinEl: any = unref(spinRef);\n\n          if (!spinEl) return;\n          await nextTick();\n          // if (!realHeight) {\n          realHeight = spinEl.scrollHeight;\n          // }\n\n          if (props.fullScreen) {\n            realHeightRef.value =\n              window.innerHeight - props.modalFooterHeight - props.modalHeaderHeight - 28;\n          } else {\n            realHeightRef.value = props.height\n              ? props.height\n              : realHeight > maxHeight\n              ? maxHeight\n              : realHeight;\n          }\n          emit('height-change', unref(realHeightRef));\n        } catch (error) {\n          console.log(error);\n        }\n      }\n\n      return { wrapperRef, spinRef, spinStyle, scrollTop, setModalHeight };\n    },\n  });\n</script>\n","<template>\n  <div :class=\"getClass\">\n    <template v-if=\"canFullscreen\">\n      <Tooltip :title=\"t('component.modal.restore')\" placement=\"bottom\" v-if=\"fullScreen\">\n        <FullscreenExitOutlined role=\"full\" @click=\"handleFullScreen\" />\n      </Tooltip>\n      <Tooltip :title=\"t('component.modal.maximize')\" placement=\"bottom\" v-else>\n        <FullscreenOutlined role=\"close\" @click=\"handleFullScreen\" />\n      </Tooltip>\n    </template>\n    <Tooltip :title=\"t('component.modal.close')\" placement=\"bottom\">\n      <CloseOutlined @click=\"handleCancel\" />\n    </Tooltip>\n  </div>\n</template>\n<script lang=\"ts\">\n  import { defineComponent, computed } from 'vue';\n  import { FullscreenExitOutlined, FullscreenOutlined, CloseOutlined } from '@ant-design/icons-vue';\n  import { useDesign } from '/@/hooks/web/useDesign';\n  import { Tooltip } from 'ant-design-vue';\n  import { useI18n } from '/@/hooks/web/useI18n';\n\n  export default defineComponent({\n    name: 'ModalClose',\n    components: { Tooltip, FullscreenExitOutlined, FullscreenOutlined, CloseOutlined },\n    props: {\n      canFullscreen: { type: Boolean, default: true },\n      fullScreen: { type: Boolean },\n    },\n    emits: ['cancel', 'fullscreen'],\n    setup(props, { emit }) {\n      const { prefixCls } = useDesign('basic-modal-close');\n      const { t } = useI18n();\n\n      const getClass = computed(() => {\n        return [\n          prefixCls,\n          `${prefixCls}--custom`,\n          {\n            [`${prefixCls}--can-full`]: props.canFullscreen,\n          },\n        ];\n      });\n\n      function handleCancel(e: Event) {\n        emit('cancel', e);\n      }\n\n      function handleFullScreen(e: Event) {\n        e?.stopPropagation();\n        e?.preventDefault();\n        emit('fullscreen');\n      }\n\n      return {\n        t,\n        getClass,\n        prefixCls,\n        handleCancel,\n        handleFullScreen,\n      };\n    },\n  });\n</script>\n<style lang=\"less\">\n  @prefix-cls: ~'@{namespace}-basic-modal-close';\n  .@{prefix-cls} {\n    display: flex;\n    align-items: center;\n    height: 95%;\n\n    > span {\n      margin-left: 48px;\n      font-size: 16px;\n    }\n\n    &--can-full {\n      > span {\n        margin-left: 12px;\n      }\n    }\n\n    &:not(&--can-full) {\n      > span:nth-child(1) {\n        &:hover {\n          font-weight: 700;\n        }\n      }\n    }\n\n    & span:nth-child(1) {\n      display: inline-block;\n      padding: 10px;\n\n      &:hover {\n        color: @primary-color;\n      }\n    }\n\n    & span:last-child {\n      &:hover {\n        color: @error-color;\n      }\n    }\n  }\n</style>\n","<template>\n  <div>\n    <slot name=\"insertFooter\"></slot>\n    <a-button v-bind=\"cancelButtonProps\" @click=\"handleCancel\" v-if=\"showCancelBtn\">\n      {{ cancelText }}\n    </a-button>\n    <slot name=\"centerFooter\"></slot>\n    <a-button\n      :type=\"okType\"\n      @click=\"handleOk\"\n      :loading=\"confirmLoading\"\n      v-bind=\"okButtonProps\"\n      v-if=\"showOkBtn\"\n    >\n      {{ okText }}\n    </a-button>\n    <slot name=\"appendFooter\"></slot>\n  </div>\n</template>\n<script lang=\"ts\">\n  import { defineComponent } from 'vue';\n\n  import { basicProps } from '../props';\n\n  export default defineComponent({\n    name: 'BasicModalFooter',\n    props: basicProps,\n    emits: ['ok', 'cancel'],\n    setup(_, { emit }) {\n      function handleOk(e: Event) {\n        emit('ok', e);\n      }\n\n      function handleCancel(e: Event) {\n        emit('cancel', e);\n      }\n\n      return { handleOk, handleCancel };\n    },\n  });\n</script>\n","<template>\n  <BasicTitle :helpMessage=\"helpMessage\">\n    {{ title }}\n  </BasicTitle>\n</template>\n<script lang=\"ts\">\n  import type { PropType } from 'vue';\n  import { defineComponent } from 'vue';\n  import { BasicTitle } from '/@/components/Basic';\n\n  export default defineComponent({\n    name: 'BasicModalHeader',\n    components: { BasicTitle },\n    props: {\n      helpMessage: {\n        type: [String, Array] as PropType<string | string[]>,\n      },\n      title: { type: String },\n    },\n  });\n</script>\n","import { computed, Ref, ref, unref } from 'vue';\n\nexport interface UseFullScreenContext {\n  wrapClassName: Ref<string | undefined>;\n  modalWrapperRef: Ref<ComponentRef>;\n  extHeightRef: Ref<number>;\n}\n\nexport function useFullScreen(context: UseFullScreenContext) {\n  // const formerHeightRef = ref(0);\n  const fullScreenRef = ref(false);\n\n  const getWrapClassName = computed(() => {\n    const clsName = unref(context.wrapClassName) || '';\n    return unref(fullScreenRef) ? `fullscreen-modal ${clsName} ` : unref(clsName);\n  });\n\n  function handleFullScreen(e: Event) {\n    e && e.stopPropagation();\n    fullScreenRef.value = !unref(fullScreenRef);\n\n    // const modalWrapper = unref(context.modalWrapperRef);\n\n    // if (!modalWrapper) return;\n\n    // const wrapperEl = modalWrapper.$el as HTMLElement;\n    // if (!wrapperEl) return;\n    // const modalWrapSpinEl = wrapperEl.querySelector('.ant-spin-nested-loading') as HTMLElement;\n\n    // if (!modalWrapSpinEl) return;\n\n    // if (!unref(formerHeightRef) && unref(fullScreenRef)) {\n    //   formerHeightRef.value = modalWrapSpinEl.offsetHeight;\n    // }\n\n    // if (unref(fullScreenRef)) {\n    //   modalWrapSpinEl.style.height = `${window.innerHeight - unref(context.extHeightRef)}px`;\n    // } else {\n    //   modalWrapSpinEl.style.height = `${unref(formerHeightRef)}px`;\n    // }\n  }\n  return { getWrapClassName, handleFullScreen, fullScreenRef };\n}\n","<template>\n  <Modal v-bind=\"getBindValue\" @cancel=\"handleCancel\">\n    <template #closeIcon v-if=\"!$slots.closeIcon\">\n      <ModalClose\n        :canFullscreen=\"getProps.canFullscreen\"\n        :fullScreen=\"fullScreenRef\"\n        @cancel=\"handleCancel\"\n        @fullscreen=\"handleFullScreen\"\n      />\n    </template>\n\n    <template #title v-if=\"!$slots.title\">\n      <ModalHeader\n        :helpMessage=\"getProps.helpMessage\"\n        :title=\"getMergeProps.title\"\n        @dblclick=\"handleTitleDbClick\"\n      />\n    </template>\n\n    <template #footer v-if=\"!$slots.footer\">\n      <ModalFooter v-bind=\"getBindValue\" @ok=\"handleOk\" @cancel=\"handleCancel\">\n        <template #[item]=\"data\" v-for=\"item in Object.keys($slots)\">\n          <slot :name=\"item\" v-bind=\"data || {}\"></slot>\n        </template>\n      </ModalFooter>\n    </template>\n\n    <ModalWrapper\n      :useWrapper=\"getProps.useWrapper\"\n      :footerOffset=\"wrapperFooterOffset\"\n      :fullScreen=\"fullScreenRef\"\n      ref=\"modalWrapperRef\"\n      :loading=\"getProps.loading\"\n      :loading-tip=\"getProps.loadingTip\"\n      :minHeight=\"getProps.minHeight\"\n      :height=\"getWrapperHeight\"\n      :visible=\"visibleRef\"\n      :modalFooterHeight=\"footer !== undefined && !footer ? 0 : undefined\"\n      v-bind=\"omit(getProps.wrapperProps, 'visible', 'height', 'modalFooterHeight')\"\n      @ext-height=\"handleExtHeight\"\n      @height-change=\"handleHeightChange\"\n    >\n      <slot></slot>\n    </ModalWrapper>\n\n    <template #[item]=\"data\" v-for=\"item in Object.keys(omit($slots, 'default'))\">\n      <slot :name=\"item\" v-bind=\"data || {}\"></slot>\n    </template>\n  </Modal>\n</template>\n<script lang=\"ts\">\n  import type { ModalProps, ModalMethods } from './typing';\n\n  import {\n    defineComponent,\n    computed,\n    ref,\n    watch,\n    unref,\n    watchEffect,\n    toRef,\n    getCurrentInstance,\n    nextTick,\n  } from 'vue';\n  import Modal from './components/Modal';\n  import ModalWrapper from './components/ModalWrapper.vue';\n  import ModalClose from './components/ModalClose.vue';\n  import ModalFooter from './components/ModalFooter.vue';\n  import ModalHeader from './components/ModalHeader.vue';\n  import { isFunction } from '/@/utils/is';\n  import { deepMerge } from '/@/utils';\n  import { basicProps } from './props';\n  import { useFullScreen } from './hooks/useModalFullScreen';\n  import { omit } from 'lodash-es';\n  import { useDesign } from '/@/hooks/web/useDesign';\n  import { MsgManager } from '/@/message/MsgManager';\n  import { dialogMaskOpen, dialogMaskClose } from '@/utils/mask';\n\n  export default defineComponent({\n    name: 'BasicModal',\n    components: { Modal, ModalWrapper, ModalClose, ModalFooter, ModalHeader },\n    inheritAttrs: false,\n    props: basicProps,\n    emits: ['visible-change', 'height-change', 'cancel', 'ok', 'register', 'update:visible'],\n    setup(props, { emit, attrs }) {\n      const visibleRef = ref(false);\n      const propsRef = ref<Partial<ModalProps> | null>(null);\n      const modalWrapperRef = ref<any>(null);\n      const { prefixCls } = useDesign('basic-modal');\n\n      // modal   Bottom and top height\n      const extHeightRef = ref(0);\n      const modalMethods: ModalMethods = {\n        setModalProps,\n        emitVisible: undefined,\n        redoModalHeight: () => {\n          nextTick(() => {\n            if (unref(modalWrapperRef)) {\n              (unref(modalWrapperRef) as any).setModalHeight();\n            }\n          });\n        },\n      };\n\n      const instance = getCurrentInstance();\n      if (instance) {\n        emit('register', modalMethods, instance.uid);\n      }\n\n      // Custom title component: get title\n      const getMergeProps = computed((): Recordable => {\n        return {\n          ...props,\n          ...(unref(propsRef) as any),\n        };\n      });\n\n      const { handleFullScreen, getWrapClassName, fullScreenRef } = useFullScreen({\n        modalWrapperRef,\n        extHeightRef,\n        wrapClassName: toRef(getMergeProps.value, 'wrapClassName'),\n      });\n\n      // modal component does not need title and origin buttons\n      const getProps = computed((): Recordable => {\n        const opt = {\n          ...unref(getMergeProps),\n          visible: unref(visibleRef),\n          okButtonProps: undefined,\n          cancelButtonProps: undefined,\n          title: undefined,\n        };\n        return {\n          ...opt,\n          wrapClassName: unref(getWrapClassName),\n        };\n      });\n\n      const getBindValue = computed((): Recordable => {\n        const attr = {\n          ...attrs,\n          ...unref(getMergeProps),\n          visible: unref(visibleRef),\n        };\n        attr['wrapClassName'] = `${attr?.['wrapClassName'] || ''} ${unref(getWrapClassName)}`;\n\n        if (unref(fullScreenRef)) {\n          return omit(attr, ['height', 'title']);\n        }\n        return omit(attr, 'title');\n      });\n\n      const getWrapperHeight = computed(() => {\n        if (unref(fullScreenRef)) return undefined;\n        return unref(getProps).height;\n      });\n\n      watchEffect(() => {\n        visibleRef.value = !!props.visible;\n        fullScreenRef.value = !!props.defaultFullscreen;\n      });\n\n      watch(\n        () => unref(visibleRef),\n        (v) => {\n          emit('visible-change', v);\n          emit('update:visible', v);\n          instance && modalMethods.emitVisible?.(v, instance.uid);\n          nextTick(() => {\n            if (props.scrollTop && v && unref(modalWrapperRef)) {\n              (unref(modalWrapperRef) as any).scrollTop();\n            }\n          });\n          handleMask(v);\n        },\n        {\n          immediate: false,\n        },\n      );\n\n      const handleMask = (v) => {\n        if (v) {\n          dialogMaskOpen();\n        } else {\n          dialogMaskClose();\n        }\n      };\n\n      // 取消事件\n      async function handleCancel(e: Event) {\n        e?.stopPropagation();\n        // 过滤自定义关闭按钮的空白区域\n        if ((e.target as HTMLElement)?.classList?.contains(prefixCls + '-close--custom')) return;\n        if (props.closeFunc && isFunction(props.closeFunc)) {\n          const isClose: boolean = await props.closeFunc();\n          visibleRef.value = !isClose;\n          return;\n        }\n        visibleRef.value = false;\n        emit('cancel', e);\n        handleMask(visibleRef.value);\n      }\n\n      /**\n       * @description: 设置modal参数\n       */\n      function setModalProps(props: Partial<ModalProps>): void {\n        // Keep the last setModalProps\n        propsRef.value = deepMerge(unref(propsRef) || ({} as any), props);\n        if (Reflect.has(props, 'visible')) {\n          visibleRef.value = !!props.visible;\n          handleMask(visibleRef.value);\n        }\n        if (Reflect.has(props, 'defaultFullscreen')) {\n          fullScreenRef.value = !!props.defaultFullscreen;\n        }\n      }\n\n      function handleOk(e: Event) {\n        emit('ok', e);\n      }\n\n      function handleHeightChange(height: string) {\n        emit('height-change', height);\n      }\n\n      function handleExtHeight(height: number) {\n        extHeightRef.value = height;\n      }\n\n      function handleTitleDbClick(e) {\n        if (!props.canFullscreen) return;\n        e.stopPropagation();\n        handleFullScreen(e);\n      }\n\n      return {\n        handleCancel,\n        getBindValue,\n        getProps,\n        handleFullScreen,\n        fullScreenRef,\n        getMergeProps,\n        handleOk,\n        visibleRef,\n        omit,\n        modalWrapperRef,\n        handleExtHeight,\n        handleHeightChange,\n        handleTitleDbClick,\n        getWrapperHeight,\n      };\n    },\n  });\n</script>\n","<template>\n  <Modal v-modal:visible=\"tVisible\" :title=\"tTitle\" @cancel=\"handleCancel\" @ok=\"handleOk\">\n    <slot></slot>\n  </Modal>\n</template>\n\n<script lang=\"ts\" setup>\n  import { ref, onMounted, watch } from 'vue';\n  import { Modal } from 'ant-design-vue';\n  import { MsgManager } from '/@/message/MsgManager';\n  import { dialogMaskOpen, dialogMaskClose } from '@/utils/mask';\n\n  defineOptions({\n    name: 'AModal',\n    extends: Modal,\n  });\n\n  const props = defineProps({\n    visible: { type: Boolean, default: false },\n    title: { type: String, default: '' },\n  });\n\n  const tVisible = ref(false);\n  const tTitle = ref('');\n\n  const emit = defineEmits(['cancel', 'ok']); // 定义事件\n\n  const handleCancel = () => {\n    emit('cancel');\n    dialogMaskClose();\n  };\n\n  const handleOk = () => {\n    emit('ok');\n    dialogMaskClose();\n  };\n\n  watch(\n    () => props.visible,\n    () => {\n      tVisible.value = props.visible;\n    },\n  );\n\n  watch(\n    () => props.title,\n    () => {\n      tTitle.value = props.title;\n    },\n  );\n\n  onMounted(() => {\n    //\n    tVisible.value = props.visible;\n    tTitle.value = props.title;\n  });\n</script>\n","import type {\n  UseModalReturnType,\n  ModalMethods,\n  ModalProps,\n  ReturnMethods,\n  UseModalInnerReturnType,\n} from '../typing';\nimport {\n  ref,\n  onUnmounted,\n  unref,\n  getCurrentInstance,\n  reactive,\n  watchEffect,\n  nextTick,\n  toRaw,\n  computed,\n} from 'vue';\nimport { isProdMode } from '/@/utils/env';\nimport { isFunction } from '/@/utils/is';\nimport { isEqual } from 'lodash-es';\nimport { tryOnUnmounted } from '@vueuse/core';\nimport { error } from '/@/utils/log';\n\nconst dataTransfer = reactive<any>({});\n\nconst visibleData = reactive<{ [key: number]: boolean }>({});\n\n/**\n * @description: Applicable to independent modal and call outside\n */\nexport function useModal(): UseModalReturnType {\n  const modal = ref<Nullable<ModalMethods>>(null);\n  const loaded = ref<Nullable<boolean>>(false);\n  const uid = ref<string>('');\n\n  function register(modalMethod: ModalMethods, uuid: string) {\n    if (!getCurrentInstance()) {\n      throw new Error('useModal() can only be used inside setup() or functional components!');\n    }\n    uid.value = uuid;\n    isProdMode() &&\n      onUnmounted(() => {\n        modal.value = null;\n        loaded.value = false;\n        dataTransfer[unref(uid)] = null;\n      });\n    if (unref(loaded) && isProdMode() && modalMethod === unref(modal)) return;\n\n    modal.value = modalMethod;\n    loaded.value = true;\n    modalMethod.emitVisible = (visible: boolean, uid: number) => {\n      visibleData[uid] = visible;\n    };\n  }\n\n  const getInstance = () => {\n    const instance = unref(modal);\n    if (!instance) {\n      error('useModal instance is undefined!');\n    }\n    return instance;\n  };\n\n  const methods: ReturnMethods = {\n    setModalProps: (props: Partial<ModalProps>): void => {\n      getInstance()?.setModalProps(props);\n    },\n\n    getVisible: computed((): boolean => {\n      return visibleData[~~unref(uid)];\n    }),\n\n    redoModalHeight: () => {\n      getInstance()?.redoModalHeight?.();\n    },\n\n    openModal: <T = any>(options: Partial<ModalProps>, data?: T, openOnSet = true): void => {\n      getInstance()?.setModalProps({\n        ...options,\n      });\n\n      if (!data) return;\n      const id = unref(uid);\n      if (openOnSet) {\n        dataTransfer[id] = null;\n        dataTransfer[id] = toRaw(data);\n        return;\n      }\n      const equal = isEqual(toRaw(dataTransfer[id]), toRaw(data));\n      if (!equal) {\n        dataTransfer[id] = toRaw(data);\n      }\n    },\n\n    closeModal: () => {\n      getInstance()?.setModalProps({ visible: false });\n    },\n  };\n  return [register, methods];\n}\n\nexport const useModalInner = (callbackFn?: Fn): UseModalInnerReturnType => {\n  const modalInstanceRef = ref<Nullable<ModalMethods>>(null);\n  const currentInstance = getCurrentInstance();\n  const uidRef = ref<string>('');\n\n  const getInstance = () => {\n    const instance = unref(modalInstanceRef);\n    if (!instance) {\n      error('useModalInner instance is undefined!');\n    }\n    return instance;\n  };\n\n  const register = (modalInstance: ModalMethods, uuid: string) => {\n    isProdMode() &&\n      tryOnUnmounted(() => {\n        modalInstanceRef.value = null;\n      });\n    uidRef.value = uuid;\n    modalInstanceRef.value = modalInstance;\n    currentInstance?.emit('register', modalInstance, uuid);\n  };\n\n  watchEffect(() => {\n    const data = dataTransfer[unref(uidRef)];\n    if (!data) return;\n    if (!callbackFn || !isFunction(callbackFn)) return;\n    nextTick(() => {\n      callbackFn(data);\n    });\n  });\n\n  return [\n    register,\n    {\n      changeLoading: (loading = true) => {\n        getInstance()?.setModalProps({ loading });\n      },\n      getVisible: computed((): boolean => {\n        return visibleData[~~unref(uidRef)];\n      }),\n\n      changeOkLoading: (loading = true) => {\n        getInstance()?.setModalProps({ confirmLoading: loading });\n      },\n\n      closeModal: () => {\n        getInstance()?.setModalProps({ visible: false });\n      },\n\n      setModalProps: (props: Partial<ModalProps>) => {\n        getInstance()?.setModalProps(props);\n      },\n\n      redoModalHeight: () => {\n        const callRedo = getInstance()?.redoModalHeight;\n        callRedo && callRedo();\n      },\n    },\n  ];\n};\n","import { withInstall } from '/@/utils';\nimport './src/index.less';\n// import OrganDialog from '/@/components/Framework/Modal/OrganDialog.vue';\n// import Dialog from '/@/components/Framework/Modal/Dialog.vue';\nimport basicModal from './src/BasicModal.vue';\nimport aModal from './src/AModal.vue';\n\nexport const BasicModal = withInstall(basicModal);\nexport const AModal = withInstall(aModal);\n// export const OrganDialog = () => withInstall(OrganDialog);\n// export const Dialog = () => withInstall(Dialog);\nexport { useModalContext } from './src/hooks/useModalContext';\nexport { useModal, useModalInner } from './src/hooks/useModal';\nexport * from './src/typing';\n"],"names":["t","useI18n","modalProps","basicProps","useModalDragMove","context","getStyle","dom","attr","drag","wrap","unref","dialogHeaderEl","dragDom","e","disX","disY","screenWidth","screenHeight","dragDomWidth","dragDomheight","minDragDomLeft","maxDragDomLeft","minDragDomTop","maxDragDomTop","domLeft","domTop","styL","styT","left","top","handleDrag","dragWraps","display","draggable","watchEffect","useTimeoutFn","_isSlot","s","Object","prototype","toString","call","_isVNode","defineComponent","name","inheritAttrs","props","emits","setup","slots","emit","visible","destroyOnClose","toRefs","attrs","useAttrs","onOk","onCancel","_slot","propsData","__spreadProps","__spreadValues","_createVNode","Modal","extendSlots","default","key","createModalContext","createContext","useModalContext","useContext","_sfc_main$5","ScrollContainer","wrapperRef","ref","spinRef","realHeightRef","minRealHeightRef","realHeight","useWindowSizeFn","setModalHeight","useMutationObserver","spinStyle","computed","watch","v","onMounted","modalHeaderHeight","modalFooterHeight","onUnmounted","scrollTop","__async","nextTick","wrapperRefDom","_a","bodyDom","modalDom","modalRect","modalTop","maxHeight","spinEl","error","_resolveDirective","_component_ScrollContainer","_withCtx","_withDirectives","_openBlock","_createElementBlock","_normalizeStyle","_ctx","_hoisted_1","_sfc_main$4","Tooltip","FullscreenExitOutlined","FullscreenOutlined","CloseOutlined","prefixCls","useDesign","getClass","handleCancel","handleFullScreen","_resolveComponent","_normalizeClass","_Fragment","_createBlock","_component_Tooltip","_component_FullscreenExitOutlined","_component_FullscreenOutlined","_createCommentVNode","_sfc_main$3","_","handleOk","_renderSlot","_component_a_button","_mergeProps","_sfc_main$2","BasicTitle","_component_BasicTitle","useFullScreen","fullScreenRef","getWrapClassName","clsName","_sfc_main$1","ModalWrapper","ModalClose","ModalFooter","ModalHeader","visibleRef","propsRef","modalWrapperRef","extHeightRef","modalMethods","setModalProps","instance","getCurrentInstance","getMergeProps","toRef","getProps","opt","getBindValue","omit","getWrapperHeight","handleMask","dialogMaskOpen","dialogMaskClose","_b","isFunction","isClose","deepMerge","handleHeightChange","height","handleExtHeight","handleTitleDbClick","_createSlots","_component_ModalWrapper","_component_ModalClose","_component_ModalHeader","_component_ModalFooter","item","data","tVisible","tTitle","dataTransfer","reactive","visibleData","useModal","modal","loaded","uid","register","modalMethod","uuid","isProdMode","getInstance","methods","options","openOnSet","id","toRaw","isEqual","useModalInner","callbackFn","modalInstanceRef","currentInstance","uidRef","modalInstance","tryOnUnmounted","loading","callRedo","BasicModal","withInstall","basicModal","aModal"],"mappings":"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"}