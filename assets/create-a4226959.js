var J=Object.defineProperty;var h=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var S=(r,e,n)=>e in r?J(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n,I=(r,e)=>{for(var n in e||(e={}))Q.call(e,n)&&S(r,n,e[n]);if(h)for(var n of h(e))Z.call(e,n)&&S(r,n,e[n]);return r};var R=(r,e,n)=>new Promise((y,c)=>{var q=u=>{try{i(n.next(u))}catch(b){c(b)}},N=u=>{try{i(n.throw(u))}catch(b){c(b)}},i=u=>u.done?y(u.value):Promise.resolve(u.value).then(q,N);i((n=n.apply(r,e)).next())});import{d as $,r as B,k as x,ax as G,u as H,o as K,al as f,Z as W,_ as X,f as a,aa as t,$ as T,E as w,v as m,A as _,J as Y}from"./vue-71d1abb3.js";import{g as ee,s as ae,a as te}from"./index-f6696a2c.js";import{B as le}from"./BillTitle-d17ab3e4.js";import{ak as ne,aC as U,a7 as D,ax as se,_ as oe}from"./index.js";import{a as M}from"./assign-37f1c13d.js";import{a2 as A}from"./antd-15ac76ed.js";const re={class:"load"},ie={class:"process-box"},ue={class:"header-box"},de={class:"header-right",style:{width:"15%"}},pe={class:"content"},fe=$({__name:"create",setup(r){const e=B({spinning:!1});x(!0);const n=x(!1),y=x(!1),c=B({});c.subject="无人机巡检",c.infoItems=[];const q=G(),{currentRoute:N}=q;H(N);const i=ne.getInstance().getQuery();function u(){U()}const b=x();function F(){e.spinning=!0;try{b.value.validateFields().then(()=>{ae(e).then(s=>{e.id=s.result,A.success("保存成功"),D.getInstance().sendMsg("droneinspection",{}),U()})})}catch(s){console.log("error",s)}finally{e.spinning=!1}}function V(){e.spinning=!0;try{b.value.validateFields().then(()=>{te(e).then(s=>{e.id=s.result,A.success("下发成功，请稍后查看结果。"),D.getInstance().sendMsg("droneinspection",{}),U()})})}catch(s){console.log("error",s)}finally{e.spinning=!1}}function j(){var s={content:e.content};se("/po/drone/droneinspection/content","查看巡检详情",Y(s))}const E=["未执行","执行中","已执行","执行失败"];K(()=>R(this,null,function*(){yield ee({id:i.id,billCode:i.billCode}).then(s=>{if(i.id||i.billCode)M(e,s.result);else{const l=I(I({},s.result),i);M(e,l),e.spinning=!1}e.statusText=E[e.status],e.spinning=!1}),yield L()}));const L=()=>R(this,null,function*(){y.value=e.status==0,c.title="无人机巡检";let{billCode:s,fillinDate:l,personMemberName:g,deptName:d}=e;M(c,{billCode:s,fillinDate:l,personMemberName:g,deptName:d})});return(s,l)=>{const g=f("a-button"),d=f("a-input"),v=f("a-form-item"),p=f("a-col"),C=f("a-row"),k=f("a-card"),O=f("a-textarea"),P=f("a-form"),z=f("a-spin");return W(),X("div",re,[a(z,{spinning:e.spinning,tip:"Loading..."},{default:t(()=>[T("div",ie,[T("div",ue,[a(le,{options:c},null,8,["options"]),T("div",de,[a(g,{disabled:!y.value,type:"primary",onClick:V,loading:n.value},{default:t(()=>[w(" 执行 ")]),_:1},8,["disabled","loading"]),a(g,{class:"!ml-4",disabled:!y.value,type:"primary",onClick:F,loading:n.value},{default:t(()=>[w(" 保存 ")]),_:1},8,["disabled","loading"]),a(g,{class:"!ml-4",onClick:u},{default:t(()=>[w("关闭")]),_:1})])]),T("div",pe,[a(P,{ref_key:"formRef",ref:b,model:e,labelAlign:"right",autocomplete:"off"},{default:t(()=>[a(k,{title:"告警信息",bordered:!1},{default:t(()=>[a(C,{gutter:24},{default:t(()=>[m(a(p,{span:12},{default:t(()=>[a(v,{name:"powerStationName",label:"电站",labelCol:{span:4},rules:[{required:!1}]},{default:t(()=>[a(d,{disabled:"",value:e.powerStationName,"onUpdate:value":l[0]||(l[0]=o=>e.powerStationName=o)},null,8,["value"])]),_:1})]),_:1},512),[[_,!0]]),m(a(p,{span:12},{default:t(()=>[a(v,{name:"equipmentName",label:"告警设备",labelCol:{span:4},rules:[{required:!1}]},{default:t(()=>[a(d,{disabled:"",value:e.equipmentName,"onUpdate:value":l[1]||(l[1]=o=>e.equipmentName=o)},null,8,["value"])]),_:1})]),_:1},512),[[_,!0]])]),_:1}),a(C,{gutter:24},{default:t(()=>[m(a(p,{span:12},{default:t(()=>[a(v,{name:"alarmContent",label:"告警内容",labelCol:{span:4},rules:[{required:!1}]},{default:t(()=>[a(d,{disabled:"",value:e.alarmContent,"onUpdate:value":l[2]||(l[2]=o=>e.alarmContent=o)},null,8,["value"])]),_:1})]),_:1},512),[[_,!0]]),m(a(p,{span:12},{default:t(()=>[a(v,{name:"alarmTime",label:"告警时间",labelCol:{span:4},rules:[{required:!1}]},{default:t(()=>[a(d,{disabled:"",value:e.alarmTime,"onUpdate:value":l[3]||(l[3]=o=>e.alarmTime=o)},null,8,["value"])]),_:1})]),_:1},512),[[_,!0]])]),_:1})]),_:1}),a(k,{title:"巡检信息",bordered:!1},{default:t(()=>[a(C,{gutter:24},{default:t(()=>[m(a(p,{span:12},{default:t(()=>[a(v,{name:"statusText",label:"状态",labelCol:{span:4},rules:[{required:!1}]},{default:t(()=>[a(d,{disabled:"",value:e.statusText,"onUpdate:value":l[4]||(l[4]=o=>e.statusText=o)},null,8,["value"])]),_:1})]),_:1},512),[[_,!0]]),m(a(p,{span:12},{default:t(()=>[a(v,{name:"startTime",label:"巡检开始时间",labelCol:{span:4},rules:[{required:!1}]},{default:t(()=>[a(d,{disabled:"",value:e.startTime,"onUpdate:value":l[5]||(l[5]=o=>e.startTime=o)},null,8,["value"])]),_:1})]),_:1},512),[[_,!0]])]),_:1}),a(C,{gutter:24},{default:t(()=>[m(a(p,{span:12},{default:t(()=>[a(v,{name:"endTime",label:"巡检结束时间",labelCol:{span:4},rules:[{required:!1}]},{default:t(()=>[a(d,{disabled:"",value:e.endTime,"onUpdate:value":l[6]||(l[6]=o=>e.endTime=o)},null,8,["value"])]),_:1})]),_:1},512),[[_,!0]])]),_:1}),a(C,{gutter:24},{default:t(()=>[m(a(p,{span:24},{default:t(()=>[a(v,{name:"results",label:"巡检结果",labelCol:{span:2},rules:[{required:!1}]},{default:t(()=>[a(O,{disabled:"",value:e.results,"onUpdate:value":l[7]||(l[7]=o=>e.results=o),"auto-size":{minRows:8,maxRows:10}},null,8,["value"])]),_:1})]),_:1},512),[[_,!0]])]),_:1})]),_:1}),a(k,{title:"巡检详情",bordered:!1},{default:t(()=>[a(C,{gutter:24},{default:t(()=>[m(a(p,{span:12},{default:t(()=>[a(g,{disabled:e.status!=2,type:"primary",onClick:j,loading:n.value},{default:t(()=>[w(" 查看 ")]),_:1},8,["disabled","loading"])]),_:1},512),[[_,!0]])]),_:1})]),_:1})]),_:1},8,["model"])])])]),_:1},8,["spinning"])])}}});const ye=oe(fe,[["__scopeId","data-v-285d95ff"]]);export{ye as default};
//# sourceMappingURL=create-a4226959.js.map
