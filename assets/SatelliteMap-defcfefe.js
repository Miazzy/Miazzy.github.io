var p=(w,n,i)=>new Promise((g,u)=>{var M=l=>{try{c(i.next(l))}catch(d){u(d)}},m=l=>{try{c(i.throw(l))}catch(d){u(d)}},c=l=>l.done?g(l.value):Promise.resolve(l.value).then(M,m);c((i=i.apply(w,n)).next())});import{B as E,a7 as r,_ as z}from"./index.js";import{d as A,k as f,o as O,Z as x,_ as T,aF as D}from"./vue-71d1abb3.js";import"./antd-15ac76ed.js";const Z={ewc:{online:"/images/work_card_online.svg",leave:"/images/work_card_leave.svg",offline:"/images/work_card_offline.svg"},dr:{online:"/images/dashcam_online.svg",leave:"/images/dashcam_leave.svg",offline:"/images/dashcam_offline.svg"},ii:{online:"/images/itinerant_detector_online.svg",leave:"/images/itinerant_detector_leave.svg",offline:"/images/itinerant_detector_offline.svg"}},C={class:"satellite-map"},j=D('<div id="map-container" class="map-container" data-v-199d3a83></div><div class="mask-left" data-v-199d3a83></div><div class="mask-top" data-v-199d3a83></div><div class="mask-right" data-v-199d3a83></div><div class="mask-bottom" data-v-199d3a83></div>',5),N=[j],R=A({__name:"SatelliteMap",setup(w){const n=f(),i=f();E();const g=()=>{n.value=new BMapGL.Map("map-container"),n.value.enableScrollWheelZoom(!0),n.value.setMapType(BMAP_EARTH_MAP),n.value.centerAndZoom(new BMapGL.Point(112,34),5)},u=(a,e)=>{let o={position:a,offset:new BMapGL.Size(10,-40)},t=new BMapGL.Label(e,o);return t.setStyle({width:"auto !important",color:"white",fontSize:"12px",backgroundColor:"rgba(0,0,0)",border:0,padding:"10px",borderRadius:"4px"}),t},M=()=>p(this,null,function*(){}),m=(a,e,o)=>{let t=new BMapGL.Icon(Z[o][e.status],new BMapGL.Size(30,44),{anchor:new BMapGL.Size(15,44)}),s=new BMapGL.Marker(a,{icon:t});n.value.addOverlay(s),s.onclick=()=>p(this,null,function*(){r.getInstance().sendMsg("smart-device-modal-info",{type:o,record:e})});const v=u(a,e.stationShortName);s.onmouseover=()=>{n.value.addOverlay(v)},s.onmouseout=()=>{n.value.removeOverlay(v)}};let c=new BMapGL.Geocoder;const l=a=>{c.getLocation(new BMapGL.Point(a.longitude,a.latitude),function(e){e&&(a.address=e.address)})},d=o=>p(this,[o],function*({type:a,data:e}){k(),_(),n.value.centerAndZoom(new BMapGL.Point(112,34),5),e!=null&&e.length&&e.forEach(t=>{if(l(t),t.status==="online"){const s=new BMapGL.Point(t.longitude,t.latitude);m(s,t,a)}})}),B=({type:a,record:e})=>{r.getInstance().sendMsg("smart-device-modal",!1),l(e);const o=n.value.getZoom(),t=new BMapGL.Point(e.longitude,e.latitude);n.value.centerAndZoom(t,14),m(t,e,a);const s=Math.round(o)===14?"moveend":"zoomend";_(),h(s,a,e)},h=(a,e,o)=>{n.value.addEventListener(a,()=>{r.getInstance().sendMsg("smart-device-modal-info",{type:e,record:o,removeEvent:_})})},_=()=>{n.value.removeEventListener("zoomend"),n.value.removeEventListener("moveend")},G=({trackParams:a,data:e})=>{switch(a.type){case"track":S(a,e);break;case"replay":i.value.setDuration(a.duration),i.value.start();break;case"pause":i.value.pause();break;case"continue":i.value.continue();break;case"cancel":i.value.cancel();break}},y=(a,e)=>{const o=new BMapGL.Point(a,e);let t=new BMapGL.Icon("/images/marker_start.png",new BMapGL.Size(30,50),{anchor:new BMapGL.Size(15,50)}),s=new BMapGL.Marker(o,{icon:t});n.value.addOverlay(s)},b=(a,e)=>{const o=new BMapGL.Point(a,e);let t=new BMapGL.Icon("/images/marker_end.png",new BMapGL.Size(30,50),{anchor:new BMapGL.Size(15,50)}),s=new BMapGL.Marker(o,{icon:t});n.value.addOverlay(s)},k=()=>{r.getInstance().sendMsg("smart-device-modal",!1),n.value.clearOverlays()},S=(a,e)=>p(this,null,function*(){k(),y(e[0].longitude,e[0].latitude),b(e[e.length-1].longitude,e[e.length-1].latitude);let o=[];e.forEach(v=>{const P=new BMapGL.Point(v.longitude,v.latitude);o.push(P)});const t=new BMapGL.Polyline(o,L("blue"));n.value.addOverlay(t);const s=new BMapGL.Polyline(o,L("green"));i.value=new BMapGLLib.TrackAnimation(n.value,s,{overallView:!0,tilt:30,duration:a.trackDuration,delay:0})}),L=a=>({enableEditing:!1,enableClicking:!0,icons:[],strokeStyle:"dashed",strokeColor:a,strokeWeight:8,strokeOpacity:.8,strokeTexture:{url:`https://mapopen-pub-jsapigl.bj.bcebos.com/svgmodel/Icon_road_${a}_arrow.png`,width:16,height:64}}),I=()=>{r.getInstance().listen("smart-device-all-point-mark",d),r.getInstance().listen("smart-device-point-mark",B),r.getInstance().listen("smart-device-track",G),r.getInstance().listen("smart-device-clear-overlays",k)};return O(()=>{g(),M(),I()}),(a,e)=>(x(),T("div",C,N))}});const U=z(R,[["__scopeId","data-v-199d3a83"]]);export{U as default};
//# sourceMappingURL=SatelliteMap-defcfefe.js.map
