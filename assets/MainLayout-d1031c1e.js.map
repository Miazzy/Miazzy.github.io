{"version":3,"mappings":"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","names":["_PageVisibleHandler","event","_a","element","callback","error","scallback","hcallback","id","task","__publicField","PageVisibleHandler","SettingDrawer","createAsyncComponent","__vitePreload","topModuleList","ref","userStore","useUserStore","currentKey","todoTaskList","executor","menuNameMap","getHeaderTheme","useHeaderSetting","toggle","isFullscreen","useFullscreen","prefixCls","useDesign","watch","props","handleLoadModules","handleModuleClick","emit","nextTick","selector","generateNameMap","tree","node","path","handleTodoTask","TaskApi.getTodoTaskPage","onMounted","TaskExecutor","TimeInterval","__async","resp","checkToken","getOrganTree","menuList","systemTheme","systemMode","openKeys","selectedKeys","iconColor","systemCollapsed","systemCollClass","containerRef","menuMap","loadOverFlag","theme","handleCollapsed","MsgManager","handleMenuItemId","handlePath","value","tempKey","PageEnum","handleClickEmit","key","menu","screenRouteMap","ScreenList","pathName","winOpenUrl","handleMenuClick","token","getAuthCache","TOKEN_KEY","message","routeList","FrameBlank","Workbench","currentComponent","myFrame","activeKey","firstPageFlag","routeMap","framePath","componentFlag","showCompFlag","computed","params","urlToPath","component","Memory","pageurl","cacheurl","loading","visible","workbench","cachepage","panes","paneMap","tabWidth","trigger","contentClass","contentStyle","contentWidth","iframeWidth","instance","getCurrentInstance","menuTabMargin","screenFlag","screenClass","activePane","iframeClass","loadingInstance","handleTabChange","options","pane","removeUrlRandom","handleTabEdit","targetKey","action","handleRemoveItem","handleIframeStyle","handleResize","swidth","cwidth","lastIndex","i","handlePanesSingle","handleActivePath","handleRemoveItemById","handleDivTransformOffset","offsetX","match","currentX","currentY","newX","handleNewTabPage","name","buildUUID","handleKeyExist","nkey","calcUrlRandom","handleUrlChange","handleRefreshTabPage","tkey","resultA","resultB","url","paramStr","handleScreenTabPage","handleRefreshTabById","handleCloseTabPage","currentIndex","item","index","handleDeleteCommentNode","pnode","inkBar","dom","handleTabMessage","data","handlePanesEmpty","handleReload","handleRefreshMenuAll","handleMenuCollapsed","status","checkInIframe","handleMaskZindex","type","handleFrameLoadOver","handleMask","__expose","ElLoading","onUnmounted","getParameterByCode","code","defHttp","currentModule","currentPath","currentMenu","state","reactive","mode","cmodule","menus","handleTabsClick","preKey","owidth","handleScreenMessage","handleLoadUserExtra","DICT_TYPE","userInfo","multiOrganization","ParameterApi.getParameterByCode","flag","FileApi.getFiles","getDownloadURL","CacheManager","handleReloadFn","throttle","sleep","handleRouteGo","listenOfflineMessage","handleInstanceUpdated"],"sources":["../../src/utils/handler/pageVisibleHandler.ts","../../src/layouts/frame/Header.vue","../../src/layouts/frame/Menu.vue","../../src/components/Frame/Frame.vue","../../src/layouts/frame/Content.vue","../../src/api/system/parameter/index.ts","../../src/layouts/frame/MainLayout.vue"],"sourcesContent":["/**\n * @description 全局监听框架页面是否显示类\n */\nexport class PageVisibleHandler {\n  private static instance: PageVisibleHandler | undefined;\n  private static taskList: Array<any> = [];\n  private static showCallback: Function | null;\n  private static hideCallback: Function | null;\n\n  public static getInstance() {\n    if (!PageVisibleHandler.instance) {\n      PageVisibleHandler.instance = new PageVisibleHandler();\n    }\n    return PageVisibleHandler.instance;\n  }\n\n  constructor() {\n    PageVisibleHandler.taskList = [];\n    PageVisibleHandler.showCallback = null;\n    PageVisibleHandler.hideCallback = null;\n  }\n\n  start() {\n    window.addEventListener('visibilitychange', this.handleVisible);\n  }\n\n  end() {\n    window.removeEventListener('visibilitychange', this.handleVisible);\n  }\n\n  handleVisible(event) {\n    try {\n      if (document.hidden) {\n        if (PageVisibleHandler.hideCallback) {\n          PageVisibleHandler.hideCallback(event);\n        }\n      } else {\n        if (PageVisibleHandler.showCallback) {\n          PageVisibleHandler.showCallback(event);\n        }\n        if (PageVisibleHandler?.taskList?.length > 0) {\n          PageVisibleHandler?.taskList.forEach((element) => {\n            const { callback } = element;\n            callback();\n          });\n        }\n      }\n    } catch (error) {\n      //\n    }\n  }\n\n  setCallback(scallback: Function = () => {}, hcallback: Function = () => {}) {\n    PageVisibleHandler.showCallback = scallback;\n    PageVisibleHandler.hideCallback = hcallback;\n  }\n\n  pushTask(id: String, callback: Function = () => {}) {\n    PageVisibleHandler.taskList.push({ id, callback });\n  }\n\n  removeTask(id: String) {\n    PageVisibleHandler.taskList = PageVisibleHandler.taskList.filter((task) => task.id !== id);\n  }\n}\n","<template>\n  <header class=\"app-header\">\n    <!-- 公司 Logo -->\n    <div class=\"logo anticon vben-app-logo light vben-layout-header-logo\" style=\"width: 220px\">\n    </div>\n    <div class=\"module-info\">\n      <a-menu v-model:selectedKeys=\"currentKey\" mode=\"horizontal\">\n        <a-menu-item\n          v-for=\"element in topModuleList\"\n          :key=\"element.id\"\n          :iconvalue=\"element.icon\"\n          :name=\"element.name\"\n          :class=\"`id__${element.id}`\"\n          @click=\"handleModuleClick(element)\"\n        >\n          <template #icon>\n            <Icon :icon=\"element.icon\" />\n          </template>\n          {{ element.name }}\n        </a-menu-item>\n      </a-menu>\n    </div>\n    <!-- 用户信息 -->\n    <div class=\"user-info\">\n      <div class=\"icon-element\">\n        <AppSearch :class=\"`${prefixCls}-action__item `\" class=\"search-icon\" />\n      </div>\n      <div class=\"icon-element\" style=\"display: none;\">\n        <Notify :class=\"`${prefixCls}-action__item notify-item notify-icon`\" />\n      </div>\n      <div class=\"icon-element\" style=\"cursor: pointer\">\n        <Icon\n          v-if=\"!isFullscreen\"\n          :icon=\"'ant-design:fullscreen-outlined'\"\n          size=\"20\"\n          class=\"fullscreen-icon\"\n          @click=\"toggle\"\n        />\n        <Icon\n          v-if=\"isFullscreen\"\n          :icon=\"'ant-design:fullscreen-exit-outlined'\"\n          size=\"20\"\n          class=\"fullscreen-icon\"\n          @click=\"toggle\"\n        />\n      </div>\n      <div class=\"icon-element avatar-element\" style=\"cursor: pointer\">\n        <UserDropDown :theme=\"getHeaderTheme\" />\n      </div>\n      <div class=\"icon-element\">\n        <SettingDrawer :class=\"`${prefixCls}-action__item drawer-icon`\" />\n      </div>\n    </div>\n  </header>\n</template>\n<script lang=\"ts\" setup>\n  import { onMounted, ref, watch, nextTick } from 'vue';\n  import { useUserStore } from '/@/store/modules/user';\n  import Icon from '@/components/Icon/Icon.vue';\n  import { AppSearch } from '/@/components/Application';\n  import { useDesign } from '/@/hooks/web/useDesign';\n  import { useHeaderSetting } from '/@/hooks/setting/useHeaderSetting';\n  import { UserDropDown, Notify } from '@/layouts/default/header/components';\n  import { useFullscreen } from '@vueuse/core';\n  import { createAsyncComponent } from '/@/utils/factory/createAsyncComponent';\n  import * as TaskApi from '/@/api/bpm/task';\n  import { TaskExecutor } from '/@/executor/taskExecutor';\n  import { TimeInterval } from '@/constant/constant';\n  import { PageVisibleHandler } from '/@/utils/handler/pageVisibleHandler';\n  import { checkToken, getOrganTree } from '/@/api/sys/user';\n\n  const SettingDrawer = createAsyncComponent(() => import('/@/layouts/default/setting/index.vue'), {\n    loading: true,\n  });\n  const topModuleList = ref([]);\n  const userStore = useUserStore();\n  const currentKey = ref('');\n  const todoTaskList = ref();\n  const executor = ref<TaskExecutor>();\n  const menuNameMap = new Map();\n\n  const props = defineProps({\n    current: { type: String, default: null },\n    modules: { type: Array, default: null },\n  });\n\n  const { getHeaderTheme } = useHeaderSetting();\n\n  const { toggle, isFullscreen } = useFullscreen();\n  // 重新检查全屏状态\n  isFullscreen.value = !!(\n    document.fullscreenElement ||\n    document.webkitFullscreenElement ||\n    document.mozFullScreenElement ||\n    document.msFullscreenElement\n  );\n\n  const { prefixCls } = useDesign('layout-header');\n  const emit = defineEmits(['click', 'change', 'menuclick']);\n\n  watch(\n    () => props.modules,\n    () => {\n      handleLoadModules();\n    },\n  );\n\n  // 顶部模块\n  const handleModuleClick = (element) => {\n    emit('click', element, element.children);\n  };\n\n  // 加载模块数据\n  const handleLoadModules = () => {\n    try {\n      // 如果传入modules参数为空，则使用默认menulist作为顶部展示modules内容\n      if (props.modules == null || props?.modules?.length == 0) {\n        topModuleList.value = userStore.getMenuList;\n      } else {\n        topModuleList.value = props.modules;\n      }\n      // 打开顶部模块第默认菜单\n      if (topModuleList.value && topModuleList.value.length > 0) {\n        currentKey.value = [topModuleList.value[0].id];\n        nextTick(() => {\n          const selector = `.id__${topModuleList.value[0].id}`;\n          const defaultModule = document.querySelector(selector);\n          defaultModule.click();\n          // 生成菜单名称\n          generateNameMap(topModuleList.value);\n          userStore.setMenuNameMap(menuNameMap);\n        });\n      }\n    } catch (error) {\n      //\n    }\n  };\n\n  // 获取节点名称\n  const generateNameMap = (tree = []) => {\n    try {\n      for (const node of tree) {\n        const path = node?.url.includes('?') ? node?.url.split('?')[0] : node?.url;\n        menuNameMap.set(path, node?.name);\n        if (node?.children && node?.children.length > 0) {\n          generateNameMap(node?.children);\n        }\n      }\n    } catch (error) {\n      //\n    }\n  };\n\n  const handleTodoTask = () => {\n    todoTaskList.value = TaskApi.getTodoTaskPage({});\n  };\n\n  onMounted(() => {\n    handleLoadModules();\n    executor.value = TaskExecutor.getInstance(TimeInterval.ONE_SECOND);\n    executor.value.pushListTask('execTodoTaskList', handleTodoTask, TimeInterval.ONE_HOUR);\n    executor.value.start();\n    PageVisibleHandler.getInstance().start();\n    PageVisibleHandler.getInstance().setCallback(async () => {\n      const resp = await checkToken('');\n      console.info('browser visibility: ', resp.user_id);\n    });\n    nextTick(async () => {\n      const orgKindIds = 'ogn,dpt,pos,psm';\n      const showPosition = true;\n      const resp = await getOrganTree({ orgKindIds, showPosition, status: 1 });\n      userStore.setOgranTree(resp);\n    });\n  });\n</script>\n<style lang=\"less\">\n  // 深色主题\n  [data-theme='dark'] .theme1 {\n    .module-info {\n      .ant-menu {\n        background: transparent;\n      }\n\n      .ant-menu-horizontal {\n        border-bottom-color: transparent;\n      }\n    }\n\n    .user-info {\n      .ant-badge {\n        color: #fff;\n      }\n    }\n  }\n\n  .theme1 {\n    .app-header {\n      border-bottom: 1px solid rgb(255 255 255 / 16%);\n      background-color: rgb(10 36 74 / 70%);\n    }\n\n    .logo {\n      background: url('../../assets/images/my-logo-dark.png') no-repeat 24px 6px/130px auto;\n    }\n\n    .user-info {\n      .icon-element {\n        .search-icon,\n        .notify-icon,\n        .fullscreen-icon,\n        .drawer-icon {\n          color: #fff;\n        }\n      }\n    }\n\n    .avatar-element {\n      .text {\n        color: #fff;\n      }\n    }\n  }\n\n  // 浅色主题\n  .theme3 {\n    .app-header {\n      border-bottom: 1px solid #f0f0f0;\n      background-color: #fff;\n    }\n\n    .logo {\n      background: url('../../assets/images/my-logo-light.png') no-repeat 24px 6px/130px auto;\n    }\n\n    .user-info {\n      .icon-element {\n        .search-icon,\n        .notify-icon,\n        .fullscreen-icon,\n        .drawer-icon {\n          color: #333;\n        }\n      }\n    }\n\n    .avatar-element {\n      .text {\n        color: #333;\n      }\n    }\n  }\n</style>\n<style lang=\"less\" scoped>\n  .app-header {\n    display: flex;\n    align-items: left;\n    justify-content: left;\n    height: 3.25rem;\n    padding: 0;\n    line-height: 3.25rem;\n  }\n\n  .logo {\n    width: 260px;\n    height: 100%;\n    margin: 0.22rem 0.05rem 0 0;\n  }\n\n  .module-info {\n    width: calc(100% - 220px - 280px);\n  }\n\n  .user-info {\n    display: flex;\n    flex-direction: row;\n    align-items: right;\n    justify-content: right;\n    width: 280px;\n\n    .icon-element {\n      width: 40px;\n      padding: 0.15rem 0 0;\n      cursor: pointer;\n\n      .search-icon {\n        z-index: 1000;\n        margin-top: -0.45rem;\n        transform: scale(1.2);\n      }\n\n      .notify-icon {\n        z-index: 1000;\n        width: 1rem;\n        height: 1rem;\n        margin-top: 0.85rem;\n      }\n\n      .fullscreen-icon {\n        z-index: 1000;\n      }\n\n      .drawer-icon {\n        z-index: 1000;\n        width: 1.2rem;\n        height: 1.2rem;\n        margin-top: -0.15rem;\n        transform: scale(1.1);\n        transform-origin: 0% 0%;\n      }\n\n      :deep(.vben-header-user-dropdown) {\n        padding: 0 !important;\n      }\n    }\n\n    .avatar-element {\n      width: 100px;\n      padding: 0.15rem 0 0;\n      cursor: pointer;\n\n      .avatar {\n        float: left;\n\n        .avatar-item {\n          margin: -0.5rem 0 0;\n          background-color: #87d068;\n        }\n      }\n\n      .text {\n        margin: -0.15rem 0.5rem 0;\n        float: left;\n      }\n    }\n  }\n</style>\n","<template>\n  <aside class=\"app-menu\" ref=\"containerRef\" :class=\"systemTheme + ' ' + systemCollClass\">\n    <a-menu\n      v-model:openKeys=\"openKeys\"\n      v-model:selectedKeys=\"selectedKeys\"\n      class=\"menu-content\"\n      :mode=\"systemMode\"\n      :theme=\"systemTheme\"\n      :inline-collapsed=\"systemCollapsed\"\n      @click=\"handleMenuClick\"\n    >\n      <template v-for=\"menu in menuList\" :key=\"menu.id\">\n        <template v-if=\"menu?.visible && menu?.component === 'LAYOUT'\">\n          <a-sub-menu :key=\"menu?.id\">\n            <template #icon>\n              <Icon :icon=\"menu.icon\" size=\"16\" />\n            </template>\n            <template #title>{{ menu.name }}</template>\n            <template v-for=\"item in menu.children\">\n              <template v-if=\"item?.visible && item?.component !== 'LAYOUT'\">\n                <a-menu-item :key=\"handleMenuItemId(item)\">{{ item?.name }}</a-menu-item>\n              </template>\n              <template v-if=\"item?.visible && item?.component === 'LAYOUT'\">\n                <a-sub-menu :key=\"item?.id\" :title=\"item?.name\">\n                  <template v-for=\"subitem in item.children\">\n                    <template v-if=\"subitem?.visible && subitem?.component !== 'LAYOUT'\">\n                      <a-menu-item :key=\"handleMenuItemId(subitem)\">{{\n                        subitem?.name\n                      }}</a-menu-item>\n                    </template>\n                    <template v-if=\"subitem?.visible && subitem?.component === 'LAYOUT'\">\n                      <a-sub-menu :key=\"subitem?.id\" :title=\"subitem?.name\">\n                        <template v-for=\"secsubitem in subitem.children\">\n                          <template v-if=\"secsubitem?.visible\">\n                            <a-menu-item :key=\"handleMenuItemId(secsubitem)\">{{\n                              secsubitem?.name\n                            }}</a-menu-item>\n                          </template>\n                        </template>\n                      </a-sub-menu>\n                    </template>\n                  </template>\n                </a-sub-menu>\n              </template>\n            </template>\n          </a-sub-menu>\n        </template>\n        <template v-else-if=\"menu?.visible && menu?.component !== 'LAYOUT'\">\n          <a-menu-item :key=\"handleMenuItemId(menu)\">\n            <template #icon>\n              <Icon :icon=\"menu.icon\" size=\"16\" />\n            </template>\n            {{ menu.name }}\n          </a-menu-item>\n        </template>\n      </template>\n    </a-menu>\n\n    <a-affix class=\"app-menu-collClass-icon\" @click=\"handleCollapsed\">\n      <Icon :icon=\"`${systemCollapsed ? 'gg:move-right' : 'gg:move-left'}`\" />\n    </a-affix>\n  </aside>\n</template>\n<script lang=\"ts\" setup>\n  import { onMounted, ref, watch } from 'vue';\n  import Icon from '@/components/Icon/Icon.vue';\n  import { getAuthCache } from '/@/utils/auth';\n  import { TOKEN_KEY } from '/@/enums/cacheEnum';\n  import { useUserStore } from '/@/store/modules/user';\n  import { MsgManager } from '/@/message/MsgManager';\n  import { ScreenList } from '/@/constant/constant';\n  import { winOpenUrl } from '/@/utils/route';\n  import { PageEnum } from '/@/enums/pageEnum';\n\n  const menuList = ref<any[]>([]);\n  const systemTheme = ref('');\n  const systemMode = ref('');\n  const openKeys = ref<string[]>(['']);\n  const selectedKeys = ref<string[]>(['']);\n  const iconColor = ref('#333');\n  const systemCollapsed = ref(false);\n  const systemCollClass = ref('');\n  const containerRef = ref();\n  const menuMap = new Map();\n  const userStore = useUserStore();\n  const loadOverFlag = ref(false);\n\n  const props = defineProps({\n    mode: { type: String, default: 'inline' },\n    theme: { type: String, default: 'light' },\n    menus: { type: Array, default: null },\n  });\n\n  const emit = defineEmits(['click']);\n\n  watch(\n    () => props.menus,\n    () => {\n      menuList.value = props.menus;\n    },\n  );\n\n  watch(\n    () => props.theme,\n    (theme) => {\n      systemTheme.value = props.theme;\n      iconColor.value = theme == 'dark' ? '#ccc' : '#333';\n    },\n  );\n\n  watch(\n    () => props.mode,\n    () => {\n      systemMode.value = props.mode;\n    },\n  );\n\n  const handleCollapsed = () => {\n    systemCollapsed.value = !systemCollapsed.value;\n    systemCollClass.value = systemCollapsed.value ? 'collapsed' : 'expand';\n    if (systemCollapsed.value) {\n      MsgManager.getInstance().sendMsg('system-menu-collapse', { status: 'collapsed' });\n    } else {\n      MsgManager.getInstance().sendMsg('system-menu-collapse', { status: 'expand' });\n    }\n    if (systemCollClass.value == 'expand') {\n      setTimeout(() => {\n        systemCollClass.value = '';\n      }, 300);\n    }\n  };\n\n  const handleMenuItemId = (element) => {\n    menuMap.set(element?.id, element);\n    return element?.id;\n  };\n\n  const handlePath = (value) => {\n    const path = value.startsWith('/') ? value : '/' + value;\n    let tempKey = path.replace('/da/', '/');\n    tempKey = tempKey.startsWith(PageEnum.BASE_HOME) ? tempKey : PageEnum.BASE_HOME + tempKey;\n    const key = tempKey.includes('/#') ? tempKey : '/#' + tempKey;\n    return key;\n  };\n\n  const handleClickEmit = (event) => {\n    const { key } = event;\n    const menu = menuMap.get(key);\n    const screenRouteMap = new Map(ScreenList);\n    if (menu.openWindowModel === 'newWindow') {\n      const path = handlePath(menu.url);\n      if (screenRouteMap.has(path)) {\n        const pathName = (screenRouteMap.get(path) as string) || '';\n        winOpenUrl(pathName, pathName.slice(3)); // window.open(`${window.origin}${pathName}`,  pathName.slice(3));\n      } else {\n        winOpenUrl(path, path.slice(3)); // window.open(`${window.origin}${path}`, path.slice(3));\n      }\n    } else {\n      emit('click', key, menu, event);\n    }\n  };\n\n  const handleMenuClick = (event) => {\n    try {\n      const token = getAuthCache<string>(TOKEN_KEY);\n      if (typeof token == 'undefined' || token == null || token == '') {\n        return userStore.logout();\n      }\n      if (loadOverFlag.value) {\n        handleClickEmit(event);\n      } else {\n        handleClickEmit(event);\n      }\n    } catch (error) {\n      console.error('menu click error', error);\n    }\n  };\n\n  onMounted(() => {\n    menuList.value = props.menus;\n    systemTheme.value = props.theme;\n    systemMode.value = props.mode;\n\n    MsgManager.getInstance().listen('workbench-loadover', (message) => {\n      loadOverFlag.value = message;\n    });\n  });\n</script>\n<style lang=\"less\">\n  .app-menu {\n    .ant-menu-light .ant-menu-item:hover,\n    .ant-menu-light .ant-menu-item-active,\n    .ant-menu-light .ant-menu:not(.ant-menu-inline) .ant-menu-submenu-open,\n    .ant-menu-light .ant-menu-submenu-active,\n    .ant-menu-light .ant-menu-submenu-title:hover {\n      color: #1890ff;\n    }\n  }\n\n  .theme1 {\n    .app-menu {\n      background-color: rgb(10 36 74 / 70%);\n\n      .ant-menu {\n        background-color: transparent;\n        color: #a7adb4;\n      }\n\n      .ant-menu-sub.ant-menu-inline {\n        background-color: rgb(5 22 41 / 70%);\n      }\n\n      .ant-menu:not(.ant-menu-horizontal) .ant-menu-item-selected {\n        background-color: #1890ff;\n      }\n\n      .ant-menu-item:active,\n      .ant-menu-submenu-title:active {\n        background-color: #1890ff;\n      }\n\n      .ant-menu-item-selected,\n      .ant-menu-submenu-selected {\n        color: #fefefe;\n      }\n\n      .ant-menu-light .ant-menu-item-selected.ant-menu-item:hover {\n        color: #fefefe;\n      }\n\n      .ant-menu-light .ant-menu-item-selected.ant-menu-item-active {\n        color: #fefefe;\n      }\n\n      .ant-menu-submenu-expand-icon,\n      .ant-menu-submenu-arrow {\n        color: #a7adb4;\n      }\n    }\n  }\n\n  .theme3 {\n    .app-menu {\n      background-color: #001529;\n\n      .ant-menu {\n        background-color: #001529;\n        color: #a7adb4;\n      }\n\n      .ant-menu-sub.ant-menu-inline {\n        background-color: #000c17;\n      }\n\n      .ant-menu:not(.ant-menu-horizontal) .ant-menu-item-selected {\n        background-color: #1890ff;\n      }\n\n      .ant-menu-item:active,\n      .ant-menu-submenu-title:active {\n        background-color: #1890ff;\n      }\n\n      .ant-menu-item-selected,\n      .ant-menu-submenu-selected {\n        color: #fefefe;\n      }\n\n      .ant-menu-light .ant-menu-item-selected.ant-menu-item:hover {\n        color: #fefefe;\n      }\n\n      .ant-menu-light .ant-menu-item-selected.ant-menu-item-active {\n        color: #fefefe;\n      }\n\n      .ant-menu-submenu-expand-icon,\n      .ant-menu-submenu-arrow {\n        color: #a7adb4;\n      }\n    }\n  }\n</style>\n<style lang=\"less\" scoped>\n  .app-menu {\n    width: 220px;\n    min-width: 220px;\n    height: calc(100vh - 3.25rem);\n    padding: 0;\n    overflow-x: hidden;\n    overflow-y: scroll;\n\n    &.expand {\n      transition: all 0.3s;\n      border-right: none;\n    }\n\n    .menu-content {\n      width: 220px;\n      height: 100%;\n    }\n\n    .app-menu-collClass-icon {\n      position: fixed;\n      bottom: 50vh;\n      left: 205px;\n      height: 1rem;\n      border-radius: 20px;\n      background: #f0f0f0;\n      line-height: 1rem;\n    }\n\n    &.dark {\n      background-color: #000;\n    }\n\n    &.collapsed {\n      width: 60px;\n      min-width: 60px;\n      transition: all 0.1s;\n      border-right: none;\n      border-left: none;\n\n      .menu-content {\n        width: 55px;\n        height: 100%;\n      }\n\n      .app-menu-collClass-icon {\n        position: fixed;\n        bottom: 50vh;\n        left: 50px;\n        height: 1rem;\n        transition: all 0.1s;\n        border-radius: 20px;\n        background: #f0f0f0;\n        line-height: 1rem;\n      }\n    }\n  }\n\n  .logo {\n    width: 100%;\n    height: calc(100vh - 3.25rem);\n  }\n</style>\n","<template>\n  <div\n    v-if=\"showCompFlag\"\n    id=\"iframe-component\"\n    class=\"iframe-component\"\n    :url=\"activeKey\"\n    :path=\"framePath\"\n  >\n    <keep-alive>\n      <component :is=\"currentComponent\" />\n    </keep-alive>\n  </div>\n  <iframe\n    v-show=\"!showCompFlag\"\n    ref=\"myFrame\"\n    :src=\"activeKey\"\n    :panekey=\"activeKey\"\n    :pageurl=\"activeKey\"\n    :class=\"`${status ? 'active' : 'disactive'}`\"\n    :style=\"props.style\"\n  ></iframe>\n</template>\n<script lang=\"ts\" setup>\n  import { onMounted, ref, watch, defineProps, computed } from 'vue';\n  import { urlToPath } from '/@/utils/route';\n  import FrameBlank from '/@/views/sys/iframe/FrameBlank.vue';\n  import Workbench from '/@/views/workbench/Workbench.vue';\n  import { Memory } from '@/router/index';\n\n  const routeList = [\n    ['/frame/cachepage', FrameBlank],\n    ['/frame/workbench', Workbench],\n  ];\n\n  defineOptions({\n    name: 'Frame',\n    inheritAttrs: false,\n  });\n\n  const props = defineProps({\n    isLoadOver: { type: [String, Boolean], default: false },\n    isFirstPage: { type: [String, Boolean], default: false },\n    status: { type: [String, Boolean], default: true },\n    style: { type: [String, Object], default: '' },\n    url: { type: String, default: '' },\n  });\n\n  const emit = defineEmits(['loadover']);\n  const currentComponent = ref<any>(Workbench);\n  const myFrame = ref();\n  const activeKey = ref('');\n  const loadOverFlag = ref();\n  const firstPageFlag = ref();\n  const routeMap = new Map<string, Object>();\n  const framePath = ref('');\n  const componentFlag = ref(true);\n\n  const showCompFlag = computed(() => {\n    if (componentFlag.value) {\n      return true;\n    } else if (!loadOverFlag.value || !firstPageFlag.value) {\n      return true;\n    } else {\n      return false;\n    }\n  });\n\n  watch(\n    () => props.url,\n    async () => {\n      const { path, params } = urlToPath(props.url);\n      const component = routeMap.get(path);\n      activeKey.value = props.url;\n      framePath.value = path;\n\n      Memory.getInstance().url = props.url;\n      Memory.getInstance().path = path;\n      Memory.getInstance().params = params;\n      Memory.getInstance().query = params;\n\n      if (component) {\n        currentComponent.value = component;\n      } else {\n        componentFlag.value = false;\n      }\n    },\n  );\n\n  watch(\n    () => props.isLoadOver,\n    () => {\n      loadOverFlag.value = props.isLoadOver;\n    },\n  );\n\n  watch(\n    () => props.isFirstPage,\n    () => {\n      firstPageFlag.value = props.isFirstPage;\n    },\n  );\n\n  onMounted(() => {\n    activeKey.value = props.url;\n    loadOverFlag.value = props.isLoadOver;\n    firstPageFlag.value = props.isFirstPage;\n    myFrame.value.onload = () => {\n      setTimeout(() => {\n        emit('loadover', { status: true });\n        console.info('myframe 工作台 frame 加载完毕...', new Date().getTime());\n      }, 1000);\n    };\n    routeList.forEach((element) => {\n      const [path, component] = element;\n      if (typeof path === 'string') {\n        routeMap.set('/#' + path, component);\n      }\n    });\n  });\n</script>\n\n<style lang=\"less\" scoped></style>\n","<template>\n  <teleport to=\"body\">\n    <div class=\"modal-mask\" v-if=\"visible\" @mousewheel.prevent>\n      <div class=\"modal-mask-container\" @mousewheel.prevent></div>\n    </div>\n  </teleport>\n  <main class=\"app-content\">\n    <div class=\"vben-multiple-tabs\" :class=\"screenClass + '-tabs'\">\n      <div v-show=\"!screenFlag\" class=\"tabs-content\" :class=\"screenClass\" :style=\"contentWidth\">\n        <a-dropdown :trigger=\"['contextmenu']\">\n          <a-tabs\n            v-model:activeKey=\"activeKey\"\n            :style=\"`width: ${tabWidth};`\"\n            class=\"vben-tabs-panes\"\n            type=\"editable-card\"\n            hideAdd\n            @change=\"handleTabChange\"\n            @edit=\"handleTabEdit\"\n          >\n            <a-tab-pane\n              v-for=\"pane in panes\"\n              :key=\"pane.pageurl\"\n              :tab=\"pane.title\"\n              :closable=\"pane.closable\"\n            >\n              {{ pane.content }}\n            </a-tab-pane>\n          </a-tabs>\n          <template #overlay>\n            <a-menu>\n              <a-menu-item>\n                <a @click=\"handleRefreshTabPage\">重新加载</a>\n              </a-menu-item>\n              <a-menu-item>\n                <a @click=\"handleCloseTabPage('now')\">关闭当前</a>\n              </a-menu-item>\n              <a-menu-item>\n                <a @click=\"handleCloseTabPage('left')\">关闭左侧</a>\n              </a-menu-item>\n              <a-menu-item>\n                <a @click=\"handleCloseTabPage('right')\">关闭右侧</a>\n              </a-menu-item>\n              <a-menu-item>\n                <a @click=\"handleCloseTabPage('other')\">关闭其他</a>\n              </a-menu-item>\n              <a-menu-item>\n                <a @click=\"handleCloseTabPage('all')\">关闭全部</a>\n              </a-menu-item>\n            </a-menu>\n          </template>\n        </a-dropdown>\n        <div class=\"tabs-buttons\">\n          <Icon :icon=\"'octicon:screen-full-24'\" size=\"15\" style=\"opacity: 0; cursor: unset\" />\n          <Icon :icon=\"'icons8:refresh'\" :spin=\"loading\" size=\"15\" @click=\"handleRefreshTabPage\" />\n          <a-dropdown :trigger=\"trigger\">\n            <Icon :icon=\"'codicon:fold-down'\" size=\"13\" />\n            <template #overlay>\n              <a-menu>\n                <a-menu-item>\n                  <a @click=\"handleCloseTabPage('now')\">关闭当前</a>\n                </a-menu-item>\n                <a-menu-item>\n                  <a @click=\"handleCloseTabPage('left')\">关闭左侧</a>\n                </a-menu-item>\n                <a-menu-item>\n                  <a @click=\"handleCloseTabPage('right')\">关闭右侧</a>\n                </a-menu-item>\n                <a-menu-item>\n                  <a @click=\"handleCloseTabPage('other')\">关闭其他</a>\n                </a-menu-item>\n                <a-menu-item>\n                  <a @click=\"handleCloseTabPage('all')\">关闭全部</a>\n                </a-menu-item>\n              </a-menu>\n            </template>\n          </a-dropdown>\n        </div>\n      </div>\n    </div>\n    <div\n      class=\"iframe-content\"\n      :class=\"contentClass + ' ' + screenClass + iframeClass\"\n      :style=\"contentWidth\"\n    >\n      <Icon\n        v-if=\"screenFlag\"\n        class=\"screen-icon\"\n        :icon=\"'iconamoon:screen-normal-thin'\"\n        size=\"26\"\n        @click=\"handleScreenTabPage\"\n      />\n      <div class=\"content\" :style=\"contentStyle\">\n        <Frame\n          @loadover=\"handleFrameLoadOver\"\n          :isLoadOver=\"loadOverFlag\"\n          :isFirstPage=\"firstPageFlag\"\n          :status=\"activePane.status\"\n          :style=\"iframeWidth\"\n          :url=\"activeKey\"\n        />\n      </div>\n    </div>\n  </main>\n</template>\n<script lang=\"ts\" setup>\n  import { onMounted, ref, watch, nextTick, getCurrentInstance, onUnmounted } from 'vue';\n  import Icon from '@/components/Icon/Icon.vue';\n  import { MsgManager } from '/@/message/MsgManager';\n  import { useUserStore } from '/@/store/modules/user';\n  import { buildUUID } from '/@/utils/uuid';\n  import Frame from '/@/components/Frame/Frame.vue';\n  import { ElLoading } from 'element-plus';\n  // import Workbench from '/@/views/workbench/Workbench.vue';\n\n  const props = defineProps({\n    path: { type: String, default: null },\n    menu: { type: Object, default: null },\n    mode: { type: String, default: 'single' },\n  });\n\n  const loading = ref(false);\n  const visible = ref(false);\n  const userStore = useUserStore();\n  const emit = defineEmits(['change']);\n  const pageurl = '/#/frame/workbench';\n  const cacheurl = '/#/frame/cachepage';\n  const workbench = {\n    title: '工作台',\n    key: 'workbench',\n    closable: false,\n    show: true,\n    status: true,\n    pageurl: pageurl,\n  };\n  const cachepage = {\n    title: '缓存',\n    key: 'cachepage',\n    closable: false,\n    show: true,\n    status: true,\n    pageurl: cacheurl,\n  };\n  const timestamp = new Date().getTime();\n  const panes = ref<any[]>([workbench]);\n  const paneMap = new Map();\n  const activeKey = ref(panes.value[0].key);\n  const tabWidth = ref('');\n  const trigger = ref(['click']);\n  const contentClass = ref('');\n  const contentStyle = ref('');\n  const contentWidth = ref('');\n  const iframeWidth = ref('width: 100%; height: 100%');\n  const instance = getCurrentInstance();\n  const menuTabMargin = ref(275);\n  const screenFlag = ref(false);\n  const screenClass = ref('');\n  const activePane = ref(cachepage); // Single-Iframe-Mode\n  const iframeClass = ref('');\n  const loadOverFlag = ref(false);\n  const firstPageFlag = ref(false);\n  const loadingInstance = ref();\n\n  // 处理Tab栏页签变更\n  const handleTabChange = async (key, options: any = null) => {\n    console.info('handleTabChange  :', new Date().getTime());\n    activeKey.value = key;\n    if (options) {\n      for (let pane of panes.value) {\n        pane.status = removeUrlRandom(pane.pageurl) === removeUrlRandom(key);\n        if (options && pane.status) {\n          pane.id = options.id;\n          activeKey.value = pane.pageurl;\n        }\n      }\n    }\n  };\n\n  // Tab栏关闭页签操作等\n  const handleTabEdit = (targetKey: string | MouseEvent, action: string) => {\n    if (action === 'remove') {\n      handleRemoveItem(targetKey as string);\n    }\n  };\n\n  // 计算iframe的Style样式\n  const handleIframeStyle = () => {\n    iframeWidth.value =\n      loadOverFlag.value && firstPageFlag.value\n        ? 'width: 100%; height: 100%;'\n        : 'width: 100%; height: 100%; opacity: 0;';\n  };\n\n  // 处理浏览器窗口Resize函数\n  const handleResize = () => {\n    setTimeout(() => {\n      if (window.screen.availWidth <= 1440 || window.outerWidth <= 1440) {\n        tabWidth.value = window.outerWidth - menuTabMargin.value - 25 + 'px';\n        contentClass.value = '';\n        contentStyle.value = '';\n        contentWidth.value = '';\n        handleIframeStyle();\n        return;\n      }\n      const swidth = window.screen.availWidth;\n      const cwidth = document.body.clientWidth;\n\n      const flag = cwidth === swidth;\n      if (!flag) {\n        tabWidth.value = cwidth - menuTabMargin.value - 25 + 'px';\n        contentClass.value = 'layout-xscroll';\n        contentStyle.value = `width: ${cwidth - 220}px;`;\n        contentWidth.value = `width: ${cwidth - 220}px;`;\n        handleIframeStyle();\n      } else {\n        tabWidth.value = cwidth - menuTabMargin.value - 25 + 'px';\n        contentClass.value = '';\n        contentStyle.value = '';\n        contentWidth.value = '';\n        handleIframeStyle();\n      }\n    }, 100);\n  };\n\n  // 处理删除页签元素函数\n  const handleRemoveItem = (targetKey: string) => {\n    if (targetKey == '/#/frame/workbench') {\n      return;\n    }\n    let lastIndex = 0;\n    panes.value.forEach((pane, i) => {\n      if (pane.pageurl === targetKey) {\n        lastIndex = i - 1;\n      }\n    });\n    panes.value = panes.value.filter((pane) => {\n      return pane.pageurl !== targetKey;\n    });\n    paneMap.delete(targetKey);\n    if (panes.value.length && activeKey.value === targetKey) {\n      if (lastIndex >= 0) {\n        activeKey.value = panes.value[lastIndex].pageurl;\n      } else {\n        activeKey.value = panes.value[0].pageurl;\n      }\n    }\n    handlePanesSingle();\n    panes.value.map((pane) => (pane.status = pane.pageurl === activeKey.value));\n    handleActivePath();\n  };\n\n  // 通过ID删除页签元素\n  const handleRemoveItemById = (id: string) => {\n    let lastIndex = 0;\n    let targetKey = '';\n    panes.value.forEach((pane, i) => {\n      if (pane.id === id) {\n        lastIndex = i - 1;\n        targetKey = pane.paneurl;\n      }\n    });\n    panes.value = panes.value.filter((pane) => {\n      return pane.id !== id;\n    });\n    paneMap.delete(targetKey);\n    if (panes.value.length && activeKey.value === targetKey) {\n      if (lastIndex >= 0) {\n        activeKey.value = panes.value[lastIndex].pageurl;\n      } else {\n        activeKey.value = panes.value[0].pageurl;\n      }\n    }\n    handlePanesSingle();\n    panes.value.map((pane) => (pane.status = pane.pageurl === activeKey.value));\n    handleActivePath();\n  };\n\n  // 处理路径函数\n  const handlePath = (value) => {\n    const path = value.startsWith('/') ? value : '/' + value;\n    let tempKey = path.replace('/da/', '/');\n    tempKey = tempKey.startsWith('/frame') ? tempKey : '/frame' + tempKey;\n    const key = tempKey.includes('/#') ? tempKey : '/#' + tempKey;\n    return key;\n  };\n\n  // 处理Tabs栏偏移量\n  function handleDivTransformOffset(element, offsetX) {\n    setTimeout(() => {\n      // 获取原有的transform属性值\n      const transformStyle = element.style.transform;\n      // 使用正则表达式匹配translate的值\n      const match = transformStyle.match(/translate\\((-?\\d+\\.?\\d*px),\\s*(-?\\d+\\.?\\d*px)\\)/);\n      if (match) {\n        // 提取出原有的偏移量\n        const currentX = parseFloat(match[1]);\n        const currentY = parseFloat(match[2]);\n        if (currentX) {\n          // 计算新的偏移量\n          const newX = currentX + offsetX;\n          // 更新transform属性值\n          element.style.transform = `translate(${newX}px, ${currentY}px)`;\n        }\n      }\n    }, 150);\n  }\n\n  // 处理新增Tab页签Page的函数\n  const handleNewTabPage = (value, name, menu) => {\n    if (!firstPageFlag.value) {\n      firstPageFlag.value = true;\n      handleIframeStyle();\n    }\n    // 首页加载完毕后，才能触发跳转页面等操作\n    if (loadOverFlag.value) {\n      const path = value.startsWith('/') ? value : '/' + value;\n      const id = menu && menu?.id && Reflect.has(menu, 'id') ? menu?.id : buildUUID();\n      const element = document.querySelector('.ant-tabs-nav-list');\n      let tempKey = path.replace('/da/', '/');\n      tempKey = tempKey.startsWith('/frame') ? tempKey : '/frame' + tempKey;\n      let key = tempKey.includes('/#') ? tempKey : '/#' + tempKey;\n      activePane.value.pageurl = cacheurl; // Single-Iframe-Mode\n\n      if (!handleKeyExist(paneMap, key)) {\n        const nkey: string = calcUrlRandom(key);\n        const pane = {\n          id: id,\n          title: name || props.menu.name,\n          show: true,\n          closable: true,\n          status: true,\n          pageurl: nkey,\n        };\n        paneMap.set(nkey, menu || props.menu);\n        panes.value.push(pane);\n        activeKey.value = nkey;\n      }\n\n      for (let pane of panes.value) {\n        pane.key = pane.key ? pane.key : new Date().getTime();\n        pane.status = removeUrlRandom(pane.pageurl) === removeUrlRandom(key);\n        if (pane.status) {\n          activeKey.value = pane.pageurl;\n        }\n      }\n      handleActivePath();\n      handleDivTransformOffset(element, -10);\n    }\n  };\n\n  // 处理URL变更的函数\n  const handleUrlChange = (key, loading = false) => {\n    nextTick(() => {\n      activePane.value.pageurl = key;\n      MsgManager.getInstance().sendMsg('iframe-url-change', {\n        url: key,\n        loading,\n      });\n    });\n  };\n\n  // 处理刷新当前页面的函数\n  const handleRefreshTabPage = () => {\n    loading.value = true;\n    for (let pane of panes.value) {\n      if (activeKey.value == pane.pageurl) {\n        pane.show = false;\n        pane.key = '';\n        nextTick(() => {\n          pane.key = new Date().getTime();\n          pane.show = true;\n          handleUrlChange(calcUrlRandom(activeKey.value), loading.value);\n        });\n        setTimeout(() => {\n          loading.value = false;\n        }, 1200);\n      }\n    }\n  };\n\n  // 判断Map中是否存在此Key值的函数\n  const handleKeyExist = (paneMap, key) => {\n    const keysArray = Array.from(paneMap.keys());\n    const result = keysArray.find((tkey) => {\n      const resultA = removeUrlRandom(tkey);\n      const resultB = removeUrlRandom(key);\n      return resultA == resultB;\n    });\n    return result ? true : false;\n  };\n\n  // 给url添加random函数\n  const calcUrlRandom = (url: string): string => {\n    const randomValue = Math.floor(Math.random() * 10000000);\n    const paramStr = `_random_=${randomValue}`;\n    if (url?.includes('_random_')) {\n      return url.replace(/_random_=[^&]*/, paramStr); // 替换_random_的值\n    } else {\n      return url?.includes('?') ? url + '&' + paramStr : url + '?' + paramStr; // 添加_random_参数\n    }\n  };\n\n  // 移除URL参数中随机数\n  const removeUrlRandom = (url) => {\n    return url\n      .replace(/([\\?&])_random_=[^&]*&?/, '$1')\n      .replace(/&$/, '')\n      .replace(/\\?$/, '');\n  };\n\n  // 处理Tab栏放大屏幕函数\n  const handleScreenTabPage = () => {\n    if (screenClass.value == '') {\n      screenFlag.value = true;\n      screenClass.value = 'iframe-screen';\n      MsgManager.getInstance().sendMsg('iframe-screen', { status: 'on' });\n    } else {\n      screenFlag.value = false;\n      screenClass.value = '';\n      MsgManager.getInstance().sendMsg('iframe-screen', { status: 'off' });\n    }\n    if (activeKey.value.includes('/frame/cockpit/')) {\n      nextTick(() => {\n        handleRefreshTabPage();\n      });\n    }\n  };\n\n  // 处理刷新当前页面的函数\n  const handleRefreshTabById = (id) => {\n    for (let pane of panes.value) {\n      if (pane.id === id) {\n        pane.show = false;\n        pane.key = '';\n        nextTick(() => {\n          pane.key = new Date().getTime();\n          pane.show = true;\n        });\n      }\n    }\n  };\n\n  // 关闭当前页签页面\n  const handleCloseTabPage = (action) => {\n    const element = JSON.parse(JSON.stringify(workbench));\n    element.status = false;\n    const currentIndex = panes.value.findIndex((pane) => pane.pageurl === activeKey.value);\n    switch (action) {\n      case 'now':\n        if (activeKey.value !== workbench.pageurl) {\n          handleRemoveItem(activeKey.value);\n        }\n        break;\n      case 'left':\n        panes.value = panes.value.filter((item, index) => {\n          return index == 0 || index >= currentIndex;\n        });\n        break;\n      case 'right':\n        panes.value = panes.value.slice(0, currentIndex + 1);\n        break;\n      case 'other':\n        panes.value = panes.value.filter((item, index) => {\n          return index == 0 || index == currentIndex;\n        });\n        break;\n      case 'all':\n        activeKey.value = pageurl;\n        panes.value = panes.value.filter((item, index) => {\n          return index == 0;\n        });\n        break;\n      default:\n        break;\n    }\n    // 重新构建 paneMap\n    paneMap.clear();\n    handlePanesSingle();\n    panes.value.forEach((pane) => {\n      pane.status = pane.pageurl === activeKey.value;\n      paneMap.set(pane.pageurl, pane);\n    });\n    handleActivePath();\n  };\n\n  // 处理激活当前路由函数\n  const handleActivePath = () => {\n    userStore.setCurrentPath(activeKey.value);\n    handleUrlChange(activeKey.value);\n    emit('change', activeKey.value, paneMap.get(activeKey.value));\n  };\n\n  // 删除注释节点函数\n  const handleDeleteCommentNode = () => {\n    setTimeout(() => {\n      const pnode = document.querySelector('.ant-tabs-nav-list');\n      const inkBar = document.querySelector('.ant-tabs-nav-list .ant-tabs-ink-bar');\n      if (pnode && inkBar) {\n        const dom = pnode.childNodes[pnode.childNodes.length - 2];\n        pnode.removeChild(dom);\n        inkBar.parentNode.removeChild(inkBar);\n      }\n    }, 300);\n  };\n\n  // 处理推送Tab栏消息函数\n  const handleTabMessage = (event) => {\n    console.info('handleTabMessage:', new Date().getTime());\n    const message = Reflect.has(event, 'type') && Reflect.has(event, 'data') ? event : event.data;\n    const { data } = message;\n    handlePanesEmpty();\n    // 处理接收到的消息\n    if (message.type === 'addTabPage') {\n      handleNewTabPage(data.path, data.name, { id: data.id });\n    } else if (message.type === 'addTabAndClose') {\n      // 关闭原页面\n      if (typeof data.closeID == 'undefined' || data.closeID == null || data.closeID == '') {\n        handleRemoveItem(activeKey.value); // 默认关闭当前页面\n      } else {\n        if (paneMap.has(data.closeID)) {\n          handleRemoveItem(data.closeID);\n        } else {\n          handleRemoveItemById(data.closeID);\n        }\n      }\n      // 打开新页面 如果页面已打开过，则切换到相应页签；否则新打开一个页签\n      if (paneMap.has(data.path)) {\n        console.info('handleTabChange  :', new Date().getTime());\n        handleTabChange(data.path, { id: data.id });\n      } else {\n        console.info('handleNewTabPage:', new Date().getTime());\n        handleNewTabPage(data.path, data.name, { id: data.id });\n      }\n      // 检查是否需要刷新页面\n      if (data.refresh) {\n        handleRefreshTabPage();\n      }\n    } else if (message.type === 'closeTabPage') {\n      handleRemoveItem(data.path);\n    } else if (message.type === 'closeCurrentTab') {\n      handleRemoveItem(activeKey.value);\n    } else if (message.type === 'closeTabById') {\n      handleRemoveItemById(data.id);\n    } else if (message.type === 'refreshTabPage') {\n      handleRefreshTabPage();\n    } else if (message.type === 'reloadTabById') {\n      handleRefreshTabById(data.id);\n    }\n  };\n\n  // 处理Reload函数\n  const handleReload = () => {\n    if (instance?.proxy) {\n      nextTick(() => {\n        instance?.proxy.$forceUpdate();\n        handleResize();\n      });\n    } else {\n      nextTick(() => {\n        window.location.hostname === 'localhost' ? null : window.location.reload();\n      });\n    }\n    if (activeKey.value.includes('/frame/cockpit/')) {\n      nextTick(() => {\n        handleRefreshTabPage();\n      });\n    }\n  };\n\n  // 刷新Tab栏菜单\n  const handleRefreshMenuAll = async () => {\n    console.info('start loading refresh');\n    setTimeout(() => {\n      handleCloseTabPage('all');\n    }, 100);\n  };\n\n  // 处理菜单折叠函数\n  const handleMenuCollapsed = (message) => {\n    const { status } = message;\n    if (status === 'collapsed') {\n      menuTabMargin.value = 115;\n    } else if (status === 'expand') {\n      menuTabMargin.value = 275;\n    }\n    handleResize();\n    if (activeKey.value.includes('/frame/cockpit/')) {\n      nextTick(() => {\n        setTimeout(() => {\n          handleRefreshTabPage();\n        }, 500);\n      });\n    }\n  };\n\n  // 判断当前页面是否在 iframe 中显示\n  const checkInIframe = () => {\n    try {\n      return window.self !== window.top;\n    } catch (e) {\n      return true;\n    }\n  };\n\n  // 设置Mask的ZIndex样式函数\n  const handleMaskZindex = (message) => {\n    if (checkInIframe()) {\n      return;\n    }\n    const { type } = message;\n    if (type == 'open') {\n      iframeClass.value = 'mask-zindex';\n    } else if (type == 'remove') {\n      iframeClass.value = '';\n    }\n  };\n\n  const handlePanesEmpty = () => {\n    if (!panes.value || panes.value.length <= 1) {\n      panes.value = [workbench];\n      paneMap.set(panes.value[0].pageurl, panes.value[0]);\n      activeKey.value = panes.value[0].pageurl;\n    } else if (panes.value[0].pageurl != pageurl) {\n      panes.value = [workbench, ...panes.value];\n      paneMap.set(panes.value[0].pageurl, panes.value[0]);\n      activeKey.value = panes.value[0].pageurl;\n    }\n  };\n\n  const handleFrameLoadOver = (data: any) => {\n    if (data?.status === true) {\n      loadOverFlag.value = data?.status;\n      handleIframeStyle();\n      handlePanesEmpty();\n      loadingInstance.value.close();\n    }\n  };\n\n  // 处理是否显示隐藏Mask函数\n  const handleMask = (message) => {\n    if (checkInIframe()) {\n      return;\n    }\n    const { type } = message;\n    if (type == 'open') {\n      visible.value = true;\n    } else if (type == 'remove') {\n      visible.value = false;\n    }\n  };\n\n  const handlePanesSingle = () => {\n    try {\n      handlePanesEmpty();\n    } catch {\n      //\n    }\n  };\n\n  watch(\n    () => props.path,\n    () => {\n      handlePanesEmpty();\n      const path = handlePath(props.path);\n      if (props.path == '') {\n        return;\n      }\n      if (handleKeyExist(paneMap, path)) {\n        handleTabChange(path, props.menu);\n      } else {\n        handleNewTabPage(props.path, props.menu.name, props.menu);\n      }\n    },\n  );\n\n  defineExpose({\n    handleTabChange,\n  });\n\n  onMounted(() => {\n    try {\n      loadingInstance.value = ElLoading.service({\n        fullscreen: false,\n        background: '#90909010',\n        text: '正在加载框架...',\n      });\n      paneMap.set(panes.value[0].pageurl, panes.value[0]);\n      iframeWidth.value = `width: 100%; height: 100%; opacity: 0;`;\n      activeKey.value = panes.value[0].pageurl; //  + '?_tail=' + timestamp;\n      tabWidth.value = document.body.clientWidth - menuTabMargin.value + 'px';\n      panes.value[0].show = false;\n      panes.value[0].pageurl = '';\n      setTimeout(() => {\n        panes.value[0].show = true;\n        panes.value[0].pageurl = pageurl;\n        activePane.value.pageurl = pageurl;\n      }, 100);\n    } catch {\n      //\n    }\n    MsgManager.getInstance().listen('iframe-tabs-message', handleTabMessage);\n    MsgManager.getInstance().listen('iframe-tabs-refresh-all', handleRefreshMenuAll);\n    MsgManager.getInstance().listen('iframe-screen-emit', handleScreenTabPage);\n    MsgManager.getInstance().listen('system-menu-collapse', handleMenuCollapsed);\n    handleActivePath();\n    handleResize();\n    handleDeleteCommentNode();\n    screenFlag.value = false;\n    window.addEventListener('resize', handleReload);\n\n    // 监听是否打开Dialog\n    MsgManager.getInstance().listen('modal-open', (message) => {\n      handleMaskZindex(message);\n      handleMask(message);\n    });\n    // 监听是否打开Drawer\n    MsgManager.getInstance().listen('drawer-open', (message) => {\n      handleMaskZindex(message);\n      handleMask(message);\n    });\n    // 监听loadover函数\n    MsgManager.getInstance().listen('workbench-loadover', (message) => {\n      if (message === true) {\n        loadOverFlag.value = message;\n        handleIframeStyle();\n        handlePanesEmpty();\n        loadingInstance.value.close();\n      }\n    });\n    // 清空Tab栏\n    setTimeout(() => {\n      handlePanesEmpty();\n    }, 1000);\n  });\n\n  onUnmounted(() => {\n    firstPageFlag.value = false;\n    loadOverFlag.value = false;\n    loadingInstance.value.close();\n  });\n</script>\n<style lang=\"less\">\n  .theme1 {\n    .app-content {\n      .tabs-content {\n        border-bottom: 1px solid transparent;\n\n        .ant-tabs-tab {\n          margin-right: 3px;\n\n          &:last-of-type {\n            margin-right: 15px !important;\n          }\n        }\n\n        .ant-tabs {\n          background-color: transparent;\n        }\n\n        .tabs-buttons {\n          span {\n            border-left: 1px solid rgb(255 255 255 / 16%);\n          }\n        }\n      }\n    }\n  }\n\n  .theme3 {\n    .app-content {\n      .tabs-content {\n        border-bottom: 1px solid #f0f0f0;\n\n        .ant-tabs-tab {\n          margin-right: 3px;\n\n          &:last-of-type {\n            margin-right: 15px !important;\n          }\n        }\n\n        .tabs-buttons {\n          span {\n            border-left: 1px solid #f0f0f0;\n          }\n        }\n      }\n    }\n  }\n\n  .anticon-close {\n    width: 1.05rem;\n    height: 30px;\n    padding: 0 1rem 0 0;\n    line-height: 30px;\n  }\n</style>\n<style>\n  .ant-tabs-nav-list div.ant-tabs-tab:last-of-type {\n    padding-right: 6px;\n    border-radius: 0;\n  }\n</style>\n<style lang=\"less\" scoped>\n  .theme1 {\n    .tabs-content {\n      border-bottom: 1px solid rgb(222 222 222 / 3%);\n    }\n  }\n\n  .theme3 {\n    .tabs-content {\n      border-bottom: 0.01rem solid #f9f9f9;\n    }\n  }\n\n  .ant-tabs-top {\n    :deep(.ant-tabs-nav) {\n      &::before {\n        border-bottom: 0 solid transparent;\n      }\n    }\n  }\n\n  .modal-mask {\n    display: flex;\n    position: fixed;\n    z-index: 1000;\n    top: 0;\n    left: 0;\n    align-items: center;\n    justify-content: center;\n    width: 100%;\n    height: 100%;\n    background-color: rgb(0 0 0 / 15%);\n\n    .modal-mask-container {\n      display: flex;\n      position: absolute;\n      z-index: 1000;\n      top: 0;\n      left: 0;\n      align-items: center;\n      justify-content: center;\n      width: 100%;\n      height: 100%;\n      background-color: rgb(0 0 0 / 15%);\n    }\n  }\n\n  :deep(.iframe-component) {\n    position: absolute;\n    z-index: 1000;\n    width: 100%;\n    height: calc(100vh - 85px);\n    overflow-y: scroll;\n  }\n\n  .app-content {\n    flex: 1;\n\n    /* padding: 0.1rem 0 0.2rem 0.2rem; */\n\n    .ant-tabs {\n      &.ant-tabs-card {\n        .ant-tabs-nav {\n          :deep(.ant-tabs-tab) {\n            &:last-child {\n              padding-right: 5px;\n            }\n          }\n        }\n      }\n    }\n\n    :deep(.vben-multiple-tabs .ant-tabs-tab.ant-tabs-tab-active .ant-tabs-tab-btn) {\n      color: #f0f0f0;\n    }\n\n    :deep(.ant-tabs-tab:first-child .ant-tabs-tab-btn) {\n      margin: 0 0.3rem 0 0.1rem;\n    }\n\n    :deep(.ant-tabs-tab .ant-tabs-tab-btn) {\n      margin: 0 0.05rem 0 0.3rem;\n    }\n\n    .vben-multiple-tabs {\n      position: relative;\n\n      &.iframe-screen-tabs {\n        background: transparent;\n      }\n    }\n\n    .tabs-content {\n      display: flex;\n      flex-direction: row;\n      align-items: left;\n      justify-content: space-between;\n\n      .tabs-buttons {\n        // width: 90px;\n\n        span {\n          display: inline-flex;\n          padding: 5px;\n          cursor: pointer;\n        }\n      }\n    }\n\n    .iframe-content {\n      position: relative;\n      width: 100%;\n      height: calc(100vh - 3.25rem - 32px);\n\n      &.mask-zindex {\n        z-index: 10000 !important;\n      }\n\n      .screen-icon {\n        position: absolute;\n        top: 0.5rem;\n        right: 1rem;\n        color: transparent;\n\n        &:hover {\n          background: #fefefe;\n          color: #333;\n        }\n      }\n\n      .content {\n        width: 100%;\n        height: 100%;\n        margin: 0 !important;\n\n        &.mask-zindex {\n          z-index: 10000 !important;\n        }\n\n        iframe {\n          width: 100%;\n          height: 100%;\n        }\n      }\n\n      &.iframe-screen {\n        height: calc(100vh);\n      }\n    }\n\n    .layout-xscroll {\n      overflow-x: scroll !important;\n      overflow-y: hidden;\n    }\n  }\n\n  .theme1 {\n    .app-content {\n      .iframe-content {\n        .screen-icon {\n          color: transparent;\n\n          &:hover {\n            background: #000;\n            color: #fff;\n          }\n        }\n      }\n    }\n  }\n</style>\n<style lang=\"less\">\n  @import url('../default/tabs/index.less');\n</style>\n","import { defHttp } from '@/utils/http/axios';\n\n\n// 根据编码获取系统参数信息\nexport function getParameterByCode(code: string) {\n  return defHttp.get({ url: '/system/parameter/get-code?code=' + code }, { isOnlyResult: true });\n}\n","<template>\n  <div class=\"main-layout\">\n    <template v-if=\"mode\">\n      <Header v-show=\"!screenFlag\" @click=\"handleModuleClick\" />\n      <div class=\"main-content\">\n        <Menu\n          v-show=\"!screenFlag\"\n          :menus=\"menuList\"\n          @click=\"handleMenuClick\"\n          :theme=\"systemTheme\"\n        />\n        <Content\n          :path=\"currentPath\"\n          :menu=\"currentMenu\"\n          :style=\"contentStyle\"\n          @change=\"handleTabsClick\"\n        />\n      </div>\n    </template>\n  </div>\n</template>\n<script lang=\"ts\" setup>\n  import { nextTick, onMounted, reactive, ref, getCurrentInstance, watch } from 'vue';\n  import Header from './Header.vue';\n  import Menu from './Menu.vue';\n  import Content from './Content.vue';\n  import { handleRouteGo, listenOfflineMessage, handleInstanceUpdated } from '/@/utils/route';\n  import { MsgManager } from '/@/message/MsgManager';\n  import { CacheManager } from '/@/message/CacheManager';\n  import { getDownloadURL } from '@/utils/upload';\n  import * as ParameterApi from '@/api/system/parameter';\n  import * as FileApi from '@/api/infra/file';\n  import { useUserStore } from '/@/store/modules/user';\n  import { DICT_TYPE } from '@/utils/dict';\n  import { throttle } from '@/utils/limits';\n  import { message } from '@/utils/tooltips';\n  import { sleep } from '@/utils/http/axios/axiosRetry';\n\n  const instance = getCurrentInstance();\n  const currentModule = ref(null);\n  const menuList = ref([]);\n  const systemTheme = ref('');\n  const currentPath = ref('');\n  const currentMenu = ref();\n  const contentClass = ref('');\n  const contentStyle = ref('');\n  const state = reactive({\n    path: '',\n    menu: null,\n  });\n  const screenFlag = ref(false);\n  const mode = ref(false);\n  const pageURL = ref('');\n  const userStore = useUserStore();\n\n  // 处理顶部模块点击函数\n  const handleModuleClick = (cmodule, menus) => {\n    menuList.value = menus;\n    currentModule.value = cmodule;\n  };\n\n  // 处理菜单点击函数\n  const handleMenuClick = (key, menu, event) => {\n    try {\n      currentPath.value = '';\n      nextTick(() => {\n        try {\n          currentPath.value = menu.url;\n          currentMenu.value = menu;\n        } catch (error) {\n          console.error('menu click nexttick error:', error);\n        }\n      });\n    } catch (error) {\n      console.error('menu click error:', error);\n    }\n    // MsgManager.getInstance().sendMsg('check-iframe-framepage', {});\n  };\n\n  // 处理页签切换点击函数\n  const handleTabsClick = (key, menu) => {\n    try {\n      const preKey = !currentPath.value.includes('/#')\n        ? '/#' + currentPath.value\n        : currentPath.value;\n      if (key != preKey && currentPath.value) {\n        state.path = key;\n        state.menu = menu;\n      }\n    } catch (error){\n      console.error('tab change error', error);\n    }\n    // MsgManager.getInstance().sendMsg('check-iframe-framepage', {});\n  };\n\n  // 处理浏览器窗口Resize函数\n  const handleResize = () => {\n    setTimeout(() => {\n      if (window.screen.availWidth <= 1440 || window.outerWidth <= 1440) {\n        contentClass.value = '';\n        contentStyle.value = '';\n        return;\n      }\n      const owidth = window.outerWidth;\n      const swidth = window.screen.availWidth;\n      const flag = owidth === swidth;\n      if (!flag) {\n        contentClass.value = 'layout-xscroll';\n        contentStyle.value = `width: ${swidth - 220}px;`;\n      } else {\n        contentClass.value = '';\n        contentStyle.value = '';\n      }\n    }, 100);\n  };\n\n  // 处理屏幕消息\n  const handleScreenMessage = (message) => {\n    const { status } = message;\n    if (status == 'on') {\n      screenFlag.value = true;\n    } else if (status == 'off') {\n      screenFlag.value = false;\n    }\n  };\n\n  const handleLoadUserExtra = async () => {\n    try {\n      const code = DICT_TYPE.SYSTEM_MULTI_ORGANIZATION;\n      const userInfo = userStore.getUserInfo;\n      const multiOrganization = await ParameterApi.getParameterByCode(code);\n      const flag =\n        multiOrganization.value == 'false' || multiOrganization.value == false ? false : true;\n      const resp = await FileApi.getFiles({ bizId: userInfo?.userId });\n      const path = getDownloadURL(resp[0].url);\n      userInfo.avatar = path;\n      userStore.setMultiOrganization(flag);\n      userStore.setUserInfo(userInfo);\n      CacheManager.getInstance().setCache('AVATAR', path);\n    } catch (error) {\n      //\n    }\n  };\n\n  // 处理重新加载\n  const handleReloadFn = throttle(async () => {\n    message.loading('', '新版本已发版，正在重新加载框架...', 1000);\n    await sleep(1000);\n    window.location.hostname === 'localhost' ? null : window.location.reload();\n  }, 5000);\n\n  // Mounted时加载函数\n  onMounted(() => {\n    mode.value = true;\n    systemTheme.value = 'light';\n    window.name = window.name === '' ? 'frame' : window.name;\n\n    handleRouteGo();\n    handleResize();\n    listenOfflineMessage();\n    handleLoadUserExtra();\n\n    MsgManager.getInstance().listen('iframe-screen', handleScreenMessage);\n    MsgManager.getInstance().listen('RELOAD_FRAMEWORK', handleReloadFn);\n\n    window.addEventListener('resize', () => {\n      handleInstanceUpdated(instance, handleResize);\n    });\n  });\n</script>\n<style lang=\"less\">\n  .theme1 {\n    .main-layout {\n      background: url('../../assets/images/background4.png') no-repeat center/100% 100%;\n    }\n  }\n\n  .theme3 {\n    .main-layout {\n      background-color: #f0f2f5;\n    }\n  }\n</style>\n<style lang=\"less\" scoped>\n  .main-layout {\n    display: flex;\n    flex-direction: column;\n    height: 100vh; /* 100%视窗高度，使布局充满整个屏幕 */\n    overflow-y: hidden;\n    overflow-x: hidden;\n\n    .page-frame {\n      width: 100%;\n      height: 100%;\n    }\n  }\n\n  .layout-xscroll {\n    overflow-x: scroll !important;\n    overflow-y: hidden;\n  }\n\n  .main-content {\n    display: flex;\n    flex: 1; /* Content 占据剩余空间 */\n  }\n</style>\n<style lang=\"less\">\n  @import url('../default/tabs/index.less');\n</style>\n"],"file":"assets/MainLayout-d1031c1e.js"}