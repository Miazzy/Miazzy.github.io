var m=(i,n,t)=>new Promise((_,d)=>{var v=r=>{try{u(t.next(r))}catch(p){d(p)}},l=r=>{try{u(t.throw(r))}catch(p){d(p)}},u=r=>r.done?_(r.value):Promise.resolve(r.value).then(v,l);u((t=t.apply(i,n)).next())});import{a0 as L,a5 as z,b as H,au as V,a7 as j,av as g,at as f,ax as K,az as W,aA as q,_ as U}from"./index.js";import{P as Z}from"./index-20519caf.js";import{s as $,a as G}from"./stationTree-56a32762.js";import{B as J}from"./BasicTable-0434a334.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1ba7be9e.js";import"./index-085d06c7.js";import{u as Q}from"./useTable-109483b3.js";import"./antd-15ac76ed.js";import"./index-316f6ffb.js";import{u as X}from"./useRender-21ce56fb.js";import{d as Y,k as C,o as ee,al as te,x as ae,Z as y,a9 as x,aa as c,f as b,$ as ne,u as o,E as h,ad as I,v as T}from"./vue-71d1abb3.js";import"./useContentViewHeight-7f845167.js";import"./useWindowSizeFn-13b1b8a2.js";import"./CommonTree-c4ed7838.js";import"./index-3801a970.js";import"./useForm-dea3ed18.js";import"./uniqBy-92d3bc7f.js";import"./index-f4fc48e6.js";import"./useTabs-2b062e85.js";import"./download-03e71dd5.js";import"./index-5d49b7a7.js";import"./SearchBox-22bb02d6.js";import"./UploadBox-636ecf02.js";import"./Dialog-0a006d82.js";import"./DictSelectBox.vue_vue_type_script_setup_true_lang-e03e9fe8.js";import"./OrganDialog-dd1023ce.js";import"./sortable.esm-4ae27e0b.js";import"./dict-c04c0dd8.js";function se(i){return z.get({url:"/po/inspection-pause/page",params:i})}function oe(i){return z.put({url:"/po/inspection-pause/update?id="+i.id+"&status="+i.bizStatus})}const ie={0:"#dc0000",1:"#338ed1",2:"#30ca5a",3:"#929292",4:"#929292",5:"#929292",6:"#fda941"},re=[{title:"单据编号",dataIndex:"billCode",width:160,sorter:!0,resizable:!0},{title:"所属公司",dataIndex:"stationOrganName",align:"left",headAlign:"center",width:160,sorter:!0,resizable:!0,ifShow:L().isMultiOrganization},{title:"电站名称",align:"left",headAlign:"center",dataIndex:"stationName",width:160,sorter:!0,resizable:!0},{title:"巡检区域",dataIndex:"inspectionAreaTypeText",width:160,sorter:!0,resizable:!0},{title:"暂停开始时间",dataIndex:"startDate",width:120,sorter:!0,resizable:!0},{title:"暂停结束时间",dataIndex:"endDate",width:120,sorter:!0,resizable:!0},{title:"审批状态",dataIndex:"statusText",width:100,sorter:!0,resizable:!0,customRender:({text:i,record:n})=>X.renderTag(i,ie[n.status])},{title:"创建人",dataIndex:"personMemberName",width:100,sorter:!0,resizable:!0},{title:"创建时间",dataIndex:"fillinDate",sorter:!0,resizable:!0}],le=[{label:"单据编号",field:"billCode",component:"Input",colProps:{span:8}},{label:"巡检区域",field:"inspectionAreaType",component:"DictSelectBox",componentProps:{type:"commDeviceCategory"},colProps:{span:8}},{label:"状态",field:"status",component:"DictSelectBox",componentProps:{type:"bpm_process_instance_result"},colProps:{span:8}}],ce={class:"right-table-layout"},de=Y({__name:"index",setup(i){let n=C("");const t=C({status:"",inspectionAreaType:"",bizStatus:"",pageNo:1,pageSize:10,sortField:"fillinDate",sortOrder:"desc"}),{t:_}=H(),{createConfirm:d}=V(),[v,{reload:l,getSelectRowKeys:u,getPaginationRef:r,getSelectRows:p}]=Q({title:"巡检暂停",api:()=>m(this,null,function*(){const e=r();return t.value.pageNo=e.current,t.value.pageSize=e.pageSize,(yield se(t.value)).result}),columns:re,rowKey:"id",bordered:!0,formConfig:{labelWidth:120,schemas:le,showAdvancedButton:!1,autoAdvancedLine:1},sortFn:e=>{e.order?(t.value.sortField=e.field.replace("Text",""),t.value.sortOrder=e.order.replace("end","")):(t.value.sortField="fillinDate",t.value.sortOrder="desc")},useSearchForm:!0,showTableSetting:!0,rowSelection:{type:"radio",fixed:!0,onSelect:D},handleSearchInfoFn(e){for(const a in e)t.value[a]=e[a]}});function D(e,a){a?n.value=e.id:n.value=""}function P({keys:e,rows:a}){if(a&&a.length>0){const s=a[0];n.value=s.id}else n.value=""}function k(e){G(e,t,{stationType:""},l)}function O(){if(!t.value.stationId){f.getInstance().info("请选中电站添加");return}K("/po/inspection/inspectionpause/create?id=","添加巡检暂停",{stationId:t.value.stationId,stationName:t.value.stationName,stationType:t.value.stationType,stationOrganId:t.value.stationOrganId,stationOrganName:t.value.stationOrganName})}const N=(e,a,s)=>{A(e)};function A(e){W(e.id)}const B=()=>m(this,null,function*(){let e=p();if(e.length!=1){f.getInstance().success("请选择一行数据");return}let a=e[0];d({title:"提示",iconType:"warning",content:"确定要删除选中的记录？",onOk(){return m(this,null,function*(){if(a.status!=0){f.getInstance().success("非草稿状态不能删除");return}yield q(a.processInstanceId),f.getInstance().success("删除成功"),l()})}})});function R(){S(1)}function E(){S(0)}function S(e){let a=u();if(a.length!==1)return f.getInstance().info("请选择一条数据."),!1;let s=e==1?"启用":"禁用";d({title:s,iconType:"warning",content:_("确定要"+s+"数据？"),onOk(){return m(this,null,function*(){oe({id:a[0],bizStatus:e}).then(()=>{l()})})}}),l()}return ee(()=>{j.getInstance().listen("inspection-pause",()=>{l()})}),(e,a)=>{const s=te("a-button"),w=ae("auth");return y(),x(o(Z),{dense:"",contentFullHeight:"",fixedHeight:"",contentClass:"flex",style:{position:"relative"}},{default:c(()=>[b($,{onSelectTree:k}),ne("div",ce,[b(o(J),{onRegister:o(v),class:"fix-basic-table",onResizeColumn:a[0]||(a[0]=(F,M)=>M.width=F),onSelectionChange:P,onRowDbClick:N},{toolbar:c(()=>[b(s,{type:"primary",preIcon:o(g).ADD,onClick:O},{default:c(()=>[h(I("添加"))]),_:1},8,["preIcon"]),b(s,{class:"red-btn",disabled:o(n)=="",preIcon:o(g).DELETE,onClick:B},{default:c(()=>[h(I("删除"))]),_:1},8,["disabled","preIcon"]),T((y(),x(s,{class:"green-btn",disabled:o(n)=="",preIcon:o(g).ENABLE,onClick:R},{default:c(()=>[h(I("启用"))]),_:1},8,["disabled","preIcon"])),[[w,"po:inspectionPause:enable"]]),T((y(),x(s,{class:"grey-btn",disabled:o(n)=="",preIcon:o(g).DISABLE,onClick:E},{default:c(()=>[h(I("禁用"))]),_:1},8,["disabled","preIcon"])),[[w,"po:inspectionPause:disabled"]])]),_:1},8,["onRegister"])])]),_:1})}}});const He=U(de,[["__scopeId","data-v-18b7a47c"]]);export{He as default};
//# sourceMappingURL=index-2340383c.js.map
