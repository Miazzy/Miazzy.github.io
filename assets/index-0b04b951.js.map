{"version":3,"file":"index-0b04b951.js","sources":["../../src/views/oa/addressbook/index.ts","../../src/views/oa/addressbook/index.vue"],"sourcesContent":["import { defHttp } from '@/utils/http/axios';\nimport { BasicColumn, FormSchema } from '@/components/Table';\n\nenum Api {\n  getExecutionPage = '/oa/addressbook/page',\n  treeData = '/system/org/list-tree',\n}\n\n// 查询\nexport function getPage(params) {\n  return defHttp.get({ url: Api.getExecutionPage, params });\n}\n\n// 组织树数据\nexport const getTreeData = (params) =>\n  defHttp.post(\n    {\n      url: Api.treeData,\n      params,\n    },\n    {},\n  );\nexport const columns: BasicColumn[] = [\n  {\n    title: '账号',\n    dataIndex: 'code',\n    width: 160,\n    headAlign: 'center',\n    align: 'left',\n    resizable: true,\n    sorter: true,\n  },\n  {\n    title: '姓名',\n    dataIndex: 'name',\n    width: 120,\n    headAlign: 'center',\n    align: 'left',\n    resizable: true,\n    sorter: true,\n  },\n  {\n    title: '公司',\n    dataIndex: 'orgName',\n    width: 120,\n    headAlign: 'center',\n    align: 'left',\n    resizable: true,\n    sorter: true,\n  },\n  {\n    title: '部门',\n    dataIndex: 'deptName',\n    width: 120,\n    headAlign: 'center',\n    align: 'left',\n    resizable: true,\n    sorter: true,\n  },\n  {\n    title: '岗位',\n    dataIndex: 'positionName',\n    width: 120,\n    headAlign: 'center',\n    align: 'left',\n    resizable: true,\n    sorter: true,\n  },\n  {\n    title: '电话',\n    dataIndex: 'mobilePhone',\n    width: 120,\n    headAlign: 'center',\n    align: 'left',\n    resizable: true,\n    sorter: true,\n  },\n  {\n    title: '邮箱',\n    dataIndex: 'email',\n    width: 120,\n    headAlign: 'center',\n    align: 'left',\n    resizable: true,\n    sorter: true,\n  },\n];\n\nexport const searchFormSchema: FormSchema[] = [\n  { label: '姓名', field: 'name', component: 'Input', colProps: { span: 8 } },\n];\n","<template>\n  <PageWrapper dense contentFullHeight fixedHeight contentClass=\"flex\" style=\"position: relative\">\n    <CommonTree\n      title=\"组织树\"\n      @select=\"handleSelect\"\n      :value=\"treeData\"\n      class=\"left-tree-layout\"\n      :toolbar=\"true\"\n      :canEdit=\"false\"\n      :canAdd=\"false\"\n      :canDelete=\"false\"\n      :isShowOperationBtns=\"false\"\n      :fieldNames=\"{ key: 'id', title: 'name' }\"\n    />\n    <div class=\"right-table-layout\">\n      <BasicTable\n        class=\"fix-basic-table\"\n        @register=\"table\"\n        @resize-column=\"(w, col) => (col.width = w)\"\n      />\n    </div>\n  </PageWrapper>\n</template>\n\n<script lang=\"ts\" setup>\n  import { PageWrapper } from '/@/components/Page';\n  import { BasicTable, useTable, SorterResult } from '@/components/Table';\n  import { ref, onMounted } from 'vue';\n  import { TreeItem } from '/@/components/Tree';\n  import { columns, searchFormSchema, getPage, getTreeData } from './index';\n  import CommonTree from '@/components/Framework/Tree/CommonTree.vue';\n\n  const treeData = ref<TreeItem[]>([]); // 左侧电站树数据\n  const queryParam: any = ref({\n    name: null,\n    fullId: null,\n    pageNo: 1,\n    pageSize: 10,\n  });\n\n  // 查询左侧电站树数据\n  async function queryDeptTreeList() {\n    const deptList = (await getTreeData({\n      orgKindIds: 'ogn,dpt',\n      showPosition: true,\n      status: 1,\n    })) as unknown as TreeItem[];\n    treeData.value = deptList.result;\n    reload();\n  }\n\n  // 左侧树状菜单选中事件\n  function handleSelect(node = {}) {\n    queryParam.value.fullId = node.fullId;\n    reload();\n  }\n\n  const [table, { reload, getPaginationRef }] = useTable({\n    title: '通讯录',\n    api: async () => {\n      const paginationRef = getPaginationRef() as any;\n      queryParam.value.pageNo = paginationRef.current;\n      queryParam.value.pageSize = paginationRef.pageSize;\n      let dataObj = await getPage(queryParam.value);\n      return dataObj.result;\n    },\n    columns,\n    bordered: true,\n    rowKey: 'id',\n    formConfig: { labelWidth: 120, showAdvancedButton: false, schemas: searchFormSchema },\n    useSearchForm: true,\n    showTableSetting: true,\n    pagination: {\n      pageSize: 20,\n    },\n    handleSearchInfoFn(info) {\n      for (const key in info) {\n        queryParam.value[key] = info[key];\n      }\n    },\n    sortFn: (sortInfo: SorterResult) => {\n      if (sortInfo.order) {\n        queryParam.value.sortField = sortInfo.field;\n        queryParam.value.sortOrder = sortInfo.order.replace('end', '');\n      } else {\n        queryParam.value.sortField = null;\n        queryParam.value.sortOrder = null;\n      }\n    },\n  });\n\n  // 启动执行代码\n  onMounted(() => {\n    queryDeptTreeList();\n  });\n</script>\n\n<style lang=\"less\" scoped>\n  .left-tree-layout {\n    flex-shrink: 0;\n    width: 298px;\n    border-radius: 2px;\n  }\n\n  .right-table-layout {\n    width: calc(100% - 308px);\n  }\n\n  .fix-basic-table {\n    :deep(&.vben-basic-table .ant-table-wrapper) {\n      padding: 10px 16px 12px;\n    }\n\n    :deep(.table-settings) {\n      margin-right: 0;\n    }\n\n    :deep(.table-settings .anticon-setting) {\n      margin-right: 0;\n    }\n  }\n</style>\n"],"names":["getPage","params","defHttp","getTreeData","columns","searchFormSchema","treeData","ref","queryParam","queryDeptTreeList","__async","deptList","reload","handleSelect","node","table","getPaginationRef","useTable","paginationRef","info","key","sortInfo","onMounted"],"mappings":"srCASO,SAASA,EAAQC,EAAQ,CAC9B,OAAOC,EAAQ,IAAI,CAAE,IAAK,uBAAsB,OAAAD,EAAQ,CAC1D,CAGa,MAAAE,EAAeF,GAC1BC,EAAQ,KACN,CACE,IAAK,wBACL,OAAAD,CACF,EACA,CAAC,CACH,EACWG,EAAyB,CACpC,CACE,MAAO,KACP,UAAW,OACX,MAAO,IACP,UAAW,SACX,MAAO,OACP,UAAW,GACX,OAAQ,EACV,EACA,CACE,MAAO,KACP,UAAW,OACX,MAAO,IACP,UAAW,SACX,MAAO,OACP,UAAW,GACX,OAAQ,EACV,EACA,CACE,MAAO,KACP,UAAW,UACX,MAAO,IACP,UAAW,SACX,MAAO,OACP,UAAW,GACX,OAAQ,EACV,EACA,CACE,MAAO,KACP,UAAW,WACX,MAAO,IACP,UAAW,SACX,MAAO,OACP,UAAW,GACX,OAAQ,EACV,EACA,CACE,MAAO,KACP,UAAW,eACX,MAAO,IACP,UAAW,SACX,MAAO,OACP,UAAW,GACX,OAAQ,EACV,EACA,CACE,MAAO,KACP,UAAW,cACX,MAAO,IACP,UAAW,SACX,MAAO,OACP,UAAW,GACX,OAAQ,EACV,EACA,CACE,MAAO,KACP,UAAW,QACX,MAAO,IACP,UAAW,SACX,MAAO,OACP,UAAW,GACX,OAAQ,EACV,CACF,EAEaC,EAAiC,CAC5C,CAAE,MAAO,KAAM,MAAO,OAAQ,UAAW,QAAS,SAAU,CAAE,KAAM,EAAI,CAC1E,8DC1DQ,MAAAC,EAAWC,EAAgB,CAAA,CAAE,EAC7BC,EAAkBD,EAAI,CAC1B,KAAM,KACN,OAAQ,KACR,OAAQ,EACR,SAAU,EAAA,CACX,EAGD,SAAeE,GAAoB,QAAAC,EAAA,sBAC3B,MAAAC,EAAY,MAAMR,EAAY,CAClC,WAAY,UACZ,aAAc,GACd,OAAQ,CAAA,CACT,EACDG,EAAS,MAAQK,EAAS,OACnBC,GACT,GAGS,SAAAC,EAAaC,EAAO,GAAI,CACpBN,EAAA,MAAM,OAASM,EAAK,OACxBF,GACT,CAEA,KAAM,CAACG,EAAO,CAAE,OAAAH,EAAQ,iBAAAI,CAAkB,CAAA,EAAIC,EAAS,CACrD,MAAO,MACP,IAAK,IAAYP,EAAA,sBACf,MAAMQ,EAAgBF,IACX,OAAAR,EAAA,MAAM,OAASU,EAAc,QAC7BV,EAAA,MAAM,SAAWU,EAAc,UAC5B,MAAMlB,EAAQQ,EAAW,KAAK,GAC7B,MACjB,GACA,QAAAJ,EACA,SAAU,GACV,OAAQ,KACR,WAAY,CAAE,WAAY,IAAK,mBAAoB,GAAO,QAASC,CAAiB,EACpF,cAAe,GACf,iBAAkB,GAClB,WAAY,CACV,SAAU,EACZ,EACA,mBAAmBc,EAAM,CACvB,UAAWC,KAAOD,EAChBX,EAAW,MAAMY,CAAG,EAAID,EAAKC,CAAG,CAEpC,EACA,OAASC,GAA2B,CAC9BA,EAAS,OACAb,EAAA,MAAM,UAAYa,EAAS,MACtCb,EAAW,MAAM,UAAYa,EAAS,MAAM,QAAQ,MAAO,EAAE,IAE7Db,EAAW,MAAM,UAAY,KAC7BA,EAAW,MAAM,UAAY,KAEjC,CAAA,CACD,EAGD,OAAAc,EAAU,IAAM,CACIb,GAAA,CACnB"}