{"version":3,"file":"RealStatus-344d80cd.js","sources":["../../src/views/da/stationOperation/device/RealStatus.vue"],"sourcesContent":["<template>\n  <div class=\"real-status\">\n    <div class=\"device-status-info-layout\">\n      <DeviceStatusInfo3\n        :icon=\"baseInfo.icon\"\n        :total=\"readStatus.total\"\n        :online=\"readStatus.online\"\n        :leave=\"readStatus.leave\"\n        :offline=\"readStatus.offline\"\n        :label=\"baseInfo.label\"\n        :showLeave=\"false\"\n      />\n    </div>\n    <div class=\"content-layout\">\n      <div class=\"data-box\">\n        <div class=\"list-box\">\n          <div\n            v-for=\"(item, itemIndex) in readList\"\n            :key=\"itemIndex\"\n            @click=\"handleClick(item, itemIndex, tabIndex)\"\n            :class=\"['list-item', selectedIndex === itemIndex ? 'selected' : null]\"\n          >\n            <div\n              class=\"list-item-label\"\n              :title=\"`${item.stationShortName}-${item[baseInfo.field]}`\"\n            >\n              {{ item.stationShortName }}-{{ item[baseInfo.field] }}\n            </div>\n            <div :class=\"`list-item-status ${item.status}`\">{{ item.statusText }}</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import { ref, onMounted, watch } from 'vue';\n  import DeviceStatusInfo3 from '/@/components/Framework/OperationScreen/DeviceStatusInfo3.vue';\n  import * as SmartDeviceApi from '/@/api/monitor/smartdevice';\n  import { MsgManager } from '@/message/MsgManager';\n\n  const props = defineProps({\n    tabIndex: {\n      type: String,\n      require: true,\n      default: () => '',\n    },\n  });\n  const deviceType = {\n    '2': { code: 'ewc', field: 'userName', icon: 'dianzigongpai', label: '电子工牌' },\n    '3': { code: 'ii', field: 'deviceName', icon: 'xunjianzhongduan', label: '巡检仪' },\n    '4': { code: 'dr', field: 'plateNumber', icon: 'hangchejiluyi', label: '行车记录仪' },\n  };\n  const baseInfo = ref({\n    icon: deviceType[props.tabIndex].icon,\n    label: deviceType[props.tabIndex].label,\n    field: deviceType[props.tabIndex].field,\n  });\n  const readStatus = ref({ total: 0, online: 0, leave: 0, offline: 0 });\n  const readStatusShow = ref({ leave: false });\n  const readList = ref([]) as any;\n  const selectedIndex = ref<number>(-1);\n\n  const getParams = () => {\n    // const stationId = '2116b59ddbeb2682f24d0ee498758209';\n    const stationId = localStorage.getItem('OPERATION_SCREEN_STATION_UUID');\n    return { stationId: stationId };\n  };\n\n  const initReadStatus = async (index) => {\n    const params = getParams();\n    readStatus.value = { total: 0, online: 0, leave: 0, offline: 0 };\n    readStatusShow.value.leave = false;\n    readList.value = [];\n    selectedIndex.value = -1;\n    if (index === '2') {\n      // 电子工牌\n      SmartDeviceApi.getEwcRealStatusCount(params).then((data) => {\n        readStatus.value = data;\n        readStatusShow.value.leave = false;\n      });\n      readList.value = await SmartDeviceApi.getEwcList(params);\n    } else if (index === '3') {\n      // 巡检仪\n      SmartDeviceApi.getIiRealStatusCount(params).then((data) => {\n        readStatus.value = data;\n        readStatusShow.value.leave = true;\n      });\n      readList.value = await SmartDeviceApi.getIiList(params);\n    } else if (index === '4') {\n      // 行车记录仪\n      SmartDeviceApi.getDrRealStatusCount(params).then((data) => {\n        readStatus.value = data;\n        readStatusShow.value.leave = true;\n      });\n      readList.value = await SmartDeviceApi.getDrList(params);\n    }\n\n    // 推送智能设备全部点位信息\n    MsgManager.getInstance().sendMsg('smart-device-all-point-mark', {\n      type: deviceType[index].code,\n      data: readList.value,\n    });\n  };\n\n  const handleClick = (row, index, tabIndex) => {\n    selectedIndex.value = index;\n    // 推送智能设备单个点位信息\n    MsgManager.getInstance().sendMsg('smart-device-point-mark', {\n      type: deviceType[tabIndex].code,\n      record: row,\n    });\n  };\n\n  onMounted(() => {\n    initReadStatus(props.tabIndex);\n  });\n\n  watch(\n    () => props.tabIndex,\n    (newValue) => {\n      baseInfo.value.icon = deviceType[newValue].icon;\n      baseInfo.value.label = deviceType[newValue].label;\n      baseInfo.value.field = deviceType[newValue].field;\n      initReadStatus(newValue);\n    },\n  );\n</script>\n\n<style lang=\"less\" scoped>\n  .real-status {\n    .device-status-info-layout {\n      width: 100%;\n      margin-bottom: 0.18rem;\n      padding: 0.28rem 0.36rem 0;\n    }\n\n    .content-layout {\n      padding: 0 0.36rem;\n\n      .list-box {\n        height: 68vh;\n        overflow-y: auto;\n        background-color: rgb(6 26 51 / 60%);\n\n        .list-item {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          height: 0.35rem;\n          padding: 0 0.04rem;\n          border-bottom: 1px solid rgb(255 255 255 / 10%);\n          font-size: 0.12rem;\n          cursor: pointer;\n\n          .list-item-label {\n            width: 90%;\n            overflow: hidden;\n            color: rgb(255 255 255 / 80%);\n            text-overflow: ellipsis;\n            white-space: nowrap;\n          }\n\n          .list-item-status {\n            &.online {\n              color: #52c41a;\n            }\n\n            &.offline {\n              color: #ff4d4f;\n            }\n          }\n\n          &.selected,\n          &:hover {\n            background-color: rgb(24 144 255 / 8%);\n\n            .list-item-label {\n              color: rgb(24 144 255 / 80%);\n            }\n          }\n        }\n      }\n    }\n  }\n</style>\n"],"names":["deviceType","baseInfo","ref","props","readStatus","readStatusShow","readList","selectedIndex","getParams","initReadStatus","index","__async","params","SmartDeviceApi.getEwcRealStatusCount","data","SmartDeviceApi.getEwcList","SmartDeviceApi.getIiRealStatusCount","SmartDeviceApi.getIiList","SmartDeviceApi.getDrRealStatusCount","SmartDeviceApi.getDrList","MsgManager","handleClick","row","tabIndex","onMounted","watch","newValue"],"mappings":"4wBAiDQA,EAAa,CACjB,EAAK,CAAE,KAAM,MAAO,MAAO,WAAY,KAAM,gBAAiB,MAAO,MAAO,EAC5E,EAAK,CAAE,KAAM,KAAM,MAAO,aAAc,KAAM,mBAAoB,MAAO,KAAM,EAC/E,EAAK,CAAE,KAAM,KAAM,MAAO,cAAe,KAAM,gBAAiB,MAAO,OAAQ,CAAA,EAE3EC,EAAWC,EAAI,CACnB,KAAMF,EAAWG,EAAM,QAAQ,EAAE,KACjC,MAAOH,EAAWG,EAAM,QAAQ,EAAE,MAClC,MAAOH,EAAWG,EAAM,QAAQ,EAAE,KAAA,CACnC,EACKC,EAAaF,EAAI,CAAE,MAAO,EAAG,OAAQ,EAAG,MAAO,EAAG,QAAS,CAAG,CAAA,EAC9DG,EAAiBH,EAAI,CAAE,MAAO,EAAO,CAAA,EACrCI,EAAWJ,EAAI,CAAA,CAAE,EACjBK,EAAgBL,EAAY,EAAE,EAE9BM,EAAY,KAGT,CAAE,UADS,aAAa,QAAQ,+BAA+B,CACxC,GAG1BC,EAAwBC,GAAUC,EAAA,sBACtC,MAAMC,EAASJ,IACJJ,EAAA,MAAQ,CAAE,MAAO,EAAG,OAAQ,EAAG,MAAO,EAAG,QAAS,CAAE,EAC/DC,EAAe,MAAM,MAAQ,GAC7BC,EAAS,MAAQ,GACjBC,EAAc,MAAQ,GAClBG,IAAU,KAEZG,EAAqCD,CAAM,EAAE,KAAME,GAAS,CAC1DV,EAAW,MAAQU,EACnBT,EAAe,MAAM,MAAQ,EAAA,CAC9B,EACDC,EAAS,MAAQ,MAAMS,EAA0BH,CAAM,GAC9CF,IAAU,KAEnBM,EAAoCJ,CAAM,EAAE,KAAME,GAAS,CACzDV,EAAW,MAAQU,EACnBT,EAAe,MAAM,MAAQ,EAAA,CAC9B,EACDC,EAAS,MAAQ,MAAMW,EAAyBL,CAAM,GAC7CF,IAAU,MAEnBQ,EAAoCN,CAAM,EAAE,KAAME,GAAS,CACzDV,EAAW,MAAQU,EACnBT,EAAe,MAAM,MAAQ,EAAA,CAC9B,EACDC,EAAS,MAAQ,MAAMa,EAAyBP,CAAM,GAI7CQ,EAAA,YAAA,EAAc,QAAQ,8BAA+B,CAC9D,KAAMpB,EAAWU,CAAK,EAAE,KACxB,KAAMJ,EAAS,KAAA,CAChB,CAAA,GAGGe,EAAc,CAACC,EAAKZ,EAAOa,IAAa,CAC5ChB,EAAc,MAAQG,EAEXU,EAAA,YAAA,EAAc,QAAQ,0BAA2B,CAC1D,KAAMpB,EAAWuB,CAAQ,EAAE,KAC3B,OAAQD,CAAA,CACT,CAAA,EAGH,OAAAE,EAAU,IAAM,CACdf,EAAeN,EAAM,QAAQ,CAAA,CAC9B,EAEDsB,EACE,IAAMtB,EAAM,SACXuB,GAAa,CACZzB,EAAS,MAAM,KAAOD,EAAW0B,CAAQ,EAAE,KAC3CzB,EAAS,MAAM,MAAQD,EAAW0B,CAAQ,EAAE,MAC5CzB,EAAS,MAAM,MAAQD,EAAW0B,CAAQ,EAAE,MAC5CjB,EAAeiB,CAAQ,CACzB,CAAA"}