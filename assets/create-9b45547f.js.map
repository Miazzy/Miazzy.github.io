{"version":3,"file":"create-9b45547f.js","sources":["../../src/views/po/assess/filling/create.vue"],"sourcesContent":["<template>\n  <PageWrapper\n    :detail=\"true\"\n    dense\n    contentFullHeight\n    fixedHeight\n    contentClass=\"fix-detail-page\"\n    style=\"position: relative\"\n  >\n    <div class=\"load\">\n      <a-spin :spinning=\"formState.spinning\" tip=\"Loading...\">\n        <div class=\"process-box\">\n          <!-- 标题和操作按钮 -->\n          <div class=\"header-box\">\n            <BillTitle :options=\"billTitleOption\" />\n            <WfApproveBox\n              @save=\"onSave\"\n              @submit=\"onSubmit\"\n              :processInstanceId=\"formState.processInstanceId\"\n              :processStatus=\"formState.status\"\n              :listenMessage=\"formState.listenMessage\"\n            />\n            <!-- <PrintButton style=\"margin-left: 10px\" v-if=\"formState.status === 2\" /> -->\n          </div>\n          <!-- 表单内容 -->\n          <div class=\"content\">\n            <a-form ref=\"formRef\" :model=\"formState\" labelAlign=\"right\" autocomplete=\"off\">\n              <a-card title=\"基本信息\" :bordered=\"false\">\n                <a-row :gutter=\"32\">\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"stationName\"\n                      label=\"电站名称\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                    >\n                      <a-input v-model:value=\"formState.stationName\" disabled />\n                    </a-form-item>\n                  </a-col>\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"periodName\"\n                      label=\"期数\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                      :rules=\"[{ required: true, message: '请选择期数' }]\"\n                    >\n                      <SearchBox\n                        v-model:value=\"formState.periodName\"\n                        :columns=\"searchBoxColumns\"\n                        :data=\"searchBoxData\"\n                        :vfield=\"`periodName`\"\n                        :pagination=\"false\"\n                        @select=\"tableBoxSelect\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n\n                <a-row :gutter=\"32\">\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"desulfurizationPrice\"\n                      label=\"本期脱硫电价(元)\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                    >\n                      <a-input v-model:value=\"formState.desulfurizationPrice\" disabled />\n                    </a-form-item>\n                  </a-col>\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"assessCycle\"\n                      label=\"考核月份\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                      :rules=\"[{ required: true, message: '请输入考核月份' }]\"\n                    >\n                      <a-date-picker\n                        v-model:value=\"formState.assessCycle\"\n                        picker=\"month\"\n                        format=\"YYYY-MM\"\n                        value-format=\"YYYY-MM\"\n                        :style=\"`width: 100%`\"\n                        :maxlength=\"7\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n\n                <a-row :gutter=\"32\">\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"assessKind\"\n                      label=\"考核类型\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                      :rules=\"[{ required: true, message: '请选择考核类型' }]\"\n                    >\n                      <DictSelectBox\n                        v-model:value=\"formState.assessKind\"\n                        :type=\"`assess_kind`\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n              </a-card>\n\n              <a-card title=\"考核结果\" :bordered=\"false\">\n                <a-row :gutter=\"32\">\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"totalAmount\"\n                      label=\"考核总费用(万元)\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                    >\n                      <a-input v-model:value=\"formState.totalAmount\" disabled />\n                    </a-form-item>\n                  </a-col>\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"returnAmount\"\n                      label=\"返还总费用(万元)\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                    >\n                      <a-input v-model:value=\"formState.returnAmount\" disabled />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n\n                <a-row :gutter=\"32\">\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"compensateShareAmount\"\n                      label=\"分摊总费用(万元)\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                    >\n                      <a-input v-model:value=\"formState.compensateShareAmount\" disabled />\n                    </a-form-item>\n                  </a-col>\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"compensateTotalAmount\"\n                      label=\"补偿总费用(万元)\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                    >\n                      <a-input v-model:value=\"formState.compensateTotalAmount\" disabled />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n\n                <a-row :gutter=\"32\">\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"totalElectricity\"\n                      label=\"总考核电量(MWH)\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                    >\n                      <a-input v-model:value=\"formState.totalElectricity\" disabled />\n                    </a-form-item>\n                  </a-col>\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"netIncome\"\n                      label=\"净收入(万元)\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                    >\n                      <a-input v-model:value=\"formState.netIncome\" disabled />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n\n                <a-row :gutter=\"32\">\n                  <a-col v-show=\"true\" :span=\"24\">\n                    <a-form-item name=\"remark\" label=\"备注\" :labelCol=\"{ class: 'detail-label-8' }\">\n                      <a-textarea\n                        v-model:value=\"formState.remark\"\n                        :rows=\"4\"\n                        :maxlength=\"500\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n              </a-card>\n\n              <a-card :bordered=\"false\">\n                <BasicTable title=\"细则明细\" @register=\"registerDetailTable\">\n                  <template #assessResult><div class=\"customer_require\">发布结果</div></template>\n                  <template #bodyCell=\"{ column, record }\">\n                    <template v-if=\"column.dataIndex === 'assessResult'\">\n                      <a-input\n                        v-model:value=\"record[column.dataIndex]\"\n                        :maxlength=\"200\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </template>\n                    <template v-if=\"column.dataIndex === 'assessElectricity'\">\n                      <a-input-number\n                        v-model:value=\"record[column.dataIndex]\"\n                        :min=\"0\"\n                        :max=\"999999.999999\"\n                        :precision=\"6\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </template>\n                    <template v-if=\"column.dataIndex === 'assessAmount'\">\n                      <a-input-number\n                        v-model:value=\"record[column.dataIndex]\"\n                        :min=\"0\"\n                        :max=\"99999999.999999\"\n                        :precision=\"6\"\n                        :disabled=\"disabledInput\"\n                        @change=\"(value) => changeAssessAmount(value, record)\"\n                      />\n                    </template>\n                    <template v-if=\"column.dataIndex === 'situationAnalysis'\">\n                      <a-input\n                        v-model:value=\"record[column.dataIndex]\"\n                        :maxlength=\"200\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </template>\n                    <template v-if=\"column.dataIndex === 'remark'\">\n                      <a-input\n                        v-model:value=\"record[column.dataIndex]\"\n                        :maxlength=\"200\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </template>\n                  </template>\n                </BasicTable>\n              </a-card>\n\n              <a-card :bordered=\"false\">\n                <BasicTable title=\"细则汇总\" @register=\"registerSummaryTable\">\n                  <template #toolbar v-if=\"!disabledInput\">\n                    <a-button type=\"primary\" @click=\"handleSummary\" v-if=\"!disabledInput\">\n                      <CalculatorOutlined />\n                      {{ '汇总' }}\n                    </a-button>\n                  </template>\n                </BasicTable>\n              </a-card>\n\n              <a-card title=\"附件资料\" :bordered=\"false\">\n                <UploadBox\n                  :width=\"800\"\n                  :height=\"550\"\n                  :maxCount=\"20\"\n                  :maxSize=\"100 * 1024 * 1024\"\n                  :application=\"`po`\"\n                  :module=\"`assessFilling`\"\n                  :vmode=\"formState.status === 0 && !disabledInput ? `box` : `view`\"\n                  :bizId=\"formState.bizFileId\"\n                />\n              </a-card>\n            </a-form>\n          </div>\n        </div>\n      </a-spin>\n    </div>\n  </PageWrapper>\n</template>\n<script lang=\"ts\" setup>\n  import { onMounted, reactive, ref, UnwrapRef, toRaw } from 'vue';\n  import { useUserStore } from '/@/store/modules/user';\n  import { CalculatorOutlined } from '@ant-design/icons-vue';\n  import { ValidateErrorEntity } from 'ant-design-vue/es/form/interface';\n  import { FormInstance } from 'ant-design-vue';\n  import { useI18n } from '@/hooks/web/useI18n';\n  import { SysMessage } from '/@/hooks/web/useMessage';\n  // import PrintButton from '/@/components/Framework/Button/PrintButton.vue';\n  import { BasicTable, useTable } from '/@/components/Table';\n  import BillTitle from '/@/components/Framework/BillTitle/BillTitle.vue';\n  import SearchBox from '@/components/Framework/Combox/SearchBox.vue';\n  import DictSelectBox from '@/components/Framework/Combox/DictSelectBox.vue';\n  import UploadBox from '@/components/Framework/Combox/UploadBox.vue';\n  import WfApproveBox from '/@/components/Framework/WorkFlow/WfApproveBox.vue';\n  import { buildShortUUID } from '@/utils/uuid';\n  import {\n    detailColumns,\n    summaryColumns,\n    getDetailList,\n    getSummaryList,\n    saveData,\n    getData,\n    searchBoxColumns,\n  } from './filling.data';\n  import * as TemplateApi from '../template/template.data';\n  import * as ProcessInstanceApi from '@/api/bpm/processInstance';\n  import { assign } from 'lodash-es';\n  import { trim } from 'xe-utils';\n  import { closeCurrentTab } from '@/utils/route';\n  import { MsgManager } from '/@/message/MsgManager';\n  import { Memory } from '@/router/index';\n\n  const { t } = useI18n();\n  const userStore = useUserStore();\n  const userInfo = toRaw(userStore.getUserInfo);\n  const query = Memory.getInstance().getQuery(); // route.query;\n  const formRef = ref<FormInstance>();\n  const formState: UnwrapRef<any> = reactive({\n    spinning: false,\n    status: 0,\n    listenMessage: query.processInstanceId ? undefined : 'assess-filling',\n  });\n  const searchBoxData = ref([]);\n  const detailDataSource = ref<any[]>();\n  const billTitleOption = reactive<any>({ subject: '细则填报申请' });\n  const disabledInput = ref<boolean>(true);\n\n  const onSave = () => {\n    doSave(0);\n  };\n\n  const onSubmit = () => {\n    const value = formRef.value;\n    if (!value) {\n      return;\n    }\n    value\n      .validateFields()\n      .then(() => {\n        const detailData = getDetailDataSource();\n        if (detailData.length === 0) {\n          error(`请${t('common.action.create')}项目明细`);\n          return;\n        }\n        for (let i = 0; i < detailData.length; i++) {\n          const item = detailData[i];\n          if (!trim(item.assessIndexKind)) {\n            error('项目明细，类别不能为空');\n            return;\n          }\n          if (!trim(item.assessIndexName)) {\n            error('项目明细，类型不能为空');\n            return;\n          }\n          if (!trim(item.assessDetail)) {\n            error('项目明细，分项不能为空');\n            return;\n          }\n          if (!trim(item.indexId) || !trim(item.indexName) || !trim(item.indexSort)) {\n            error('项目明细，细则指标不能为空');\n            return;\n          }\n        }\n        doSave(1);\n      })\n      .catch((errorObj: ValidateErrorEntity<any>) => {\n        console.log('onSubmit=》error', errorObj);\n        const errorFields = errorObj.errorFields;\n        // 表单滚动到第一个报错处(antd),解决form中scrollToFirstError配置无效\n        document\n          .querySelector('.ant-form-item-has-error')\n          ?.scrollIntoView({ behavior: 'smooth', block: 'center' });\n        if (errorFields && errorFields.length > 0) {\n          error(errorFields[0].errors[0]);\n          return;\n        }\n      });\n  };\n\n  const doSave = async (status: number) => {\n    formState.spinning = true;\n    try {\n      if (!calculateSummaryData(status === 1)) {\n        return;\n      }\n      await saveBiz(status);\n    } catch (error) {\n      formState.spinning = false;\n      console.log('error', error);\n    }\n  };\n\n  const saveBiz = async (status) => {\n    const formData = toRaw(formState) as any;\n    formData.status = status;\n    formData.detailList = getDetailDataSource();\n    formData.summaryList = getSummaryDataSource();\n    await saveData(formData)\n      .then((res) => {\n        formState.id = res.result;\n        if (status === 1) {\n          disabledInput.value = true;\n        }\n        formState.spinning = false;\n        if (status === 0 || status === 1) {\n          success('操作成功');\n        }\n        reloadBizTable(status);\n      })\n      .catch(() => {\n        formState.spinning = false;\n      });\n  };\n\n  const reloadBizTable = (status: number) => {\n    if (status === 0 || status === 1) {\n      setTimeout(() => {\n        if (status === 1) {\n          closeCurrentTab();\n        }\n        MsgManager.getInstance().sendMsg('assess-filling', {});\n      }, 200);\n    }\n  };\n\n  const error = (content) => {\n    formState.spinning = false;\n    SysMessage.getInstance().error(content);\n  };\n\n  const success = (content) => {\n    SysMessage.getInstance().success(content);\n  };\n\n  const isApplyEdit = () => {\n    const isEdit =\n      formState.status === 0 &&\n      (!formState.personMemberId || formState.personMemberId.indexOf(userInfo.userId) > -1);\n    disabledInput.value = !isEdit;\n  };\n\n  const tableBoxSelect = (node) => {\n    formState.periodId = node.record.periodId;\n    formState.templateId = node.record.key;\n    formState.desulfurizationPrice = node.record.desulfurizationPrice;\n    initOriginalDetail(formState.templateId);\n  };\n\n  const initOriginalDetail = async (templateId: string) => {\n    const detail = await TemplateApi.getDetailList({ templateId: templateId });\n    detailDataSource.value = detail.result;\n  };\n\n  const getRecordable = async () => {\n    const res = await getData({ id: query.id });\n    if (res.result) {\n      assign(formState, res.result);\n      formState.status = Number(formState.status);\n      if (!formState.processInstanceId) {\n        formState.processInstanceId = query.processInstanceId;\n      }\n      const { billCode, fillinDate, personMemberName, deptName } = res.result;\n      Object.assign(billTitleOption, { billCode, fillinDate, personMemberName, deptName });\n      isApplyEdit();\n    }\n  };\n\n  const [registerDetailTable, { getDataSource: getDetailDataSource }] = useTable({\n    dataSource: detailDataSource,\n    columns: detailColumns,\n    pagination: false,\n    striped: false,\n    bordered: true,\n    canResize: false,\n  });\n\n  const summaryDataSource = ref<any[]>();\n  const [registerSummaryTable, { getDataSource: getSummaryDataSource }] = useTable({\n    dataSource: summaryDataSource,\n    columns: summaryColumns,\n    pagination: false,\n    striped: false,\n    bordered: true,\n    canResize: false,\n  });\n\n  const initTableData = async () => {\n    const detailObj = await getDetailList({ fillingId: formState.id });\n    detailDataSource.value = detailObj.result;\n\n    const summaryObj = await getSummaryList({ fillingId: formState.id });\n    summaryDataSource.value = summaryObj.result;\n  };\n\n  function changeAssessAmount(value: number | string, record) {\n    record.reverseCalculationAmount = value;\n  }\n\n  function initStationPeriodOptions() {\n    TemplateApi.getPage({\n      stationId: formState.stationId,\n      businessStatus: 1,\n      sortField: 'finishedDate',\n      sortOrder: 'desc',\n      pageNo: 1,\n      pageSize: 100,\n    }).then((res) => {\n      searchBoxData.value = res.result.list;\n    });\n  }\n\n  const getBizParamId = async () => {\n    let id = query.id;\n    if (!id && query.processInstanceId) {\n      const processInstance = (await ProcessInstanceApi.getProcessInstance(\n        query.processInstanceId as string,\n      )) as any;\n      const businessKey = processInstance?.businessKey;\n      query.id = businessKey;\n      id = businessKey;\n    }\n    return id;\n  };\n\n  function handleSummary() {\n    calculateSummaryData(false);\n  }\n\n  function calculateSummaryData(isSubmit: boolean) {\n    if (!validateDetailData(isSubmit)) {\n      return false;\n    }\n    // 考核结果\n    const detailData = getDetailDataSource();\n    calculateResult(detailData);\n    // 细则汇总\n    const groupData = detailData.reduce((result, item) => {\n      const key = item.indexId;\n      if (!result[key]) {\n        result[key] = {\n          key,\n          assessAmount: 0,\n          assessElectricity: 0,\n          reverseCalculationAmount: 0,\n          indexType: item.indexType,\n          indexId: item.indexId,\n          indexName: item.indexName,\n        };\n      }\n      result[key].assessAmount = (\n        Number(result[key].assessAmount) + Number(item.assessAmount || 0)\n      ).toFixed(6);\n      result[key].assessElectricity = (\n        Number(result[key].assessElectricity) + Number(item.assessElectricity || 0)\n      ).toFixed(6);\n      result[key].reverseCalculationAmount = (\n        Number(result[key].reverseCalculationAmount) + Number(item.reverseCalculationAmount || 0)\n      ).toFixed(6);\n      return result;\n    }, {});\n\n    let summaryList = [] as any;\n    for (const key in groupData) {\n      summaryList.push(groupData[key]);\n    }\n    summaryList.sort((a, b) => {\n      if (a.sort && b.sort) {\n        return a.indexSort - b.indexSort;\n      }\n      return -1;\n    });\n    summaryDataSource.value = summaryList;\n\n    return true;\n  }\n\n  function calculateResult(data) {\n    // 考核总费用(万元)\n    let totalAmount = 0;\n    // 返还总费用(万元)\n    let returnAmount = 0;\n    // 分摊总费用(万元)\n    let compensateShareAmount = 0;\n    // 补偿总费用(万元)\n    let compensateTotalAmount = 0;\n    // 总考核电量(MWH)\n    let totalElectricity = 0;\n    data.forEach(function (item) {\n      if (item.indexType === 'check') {\n        totalAmount = Number(totalAmount) + Number(item.assessAmount || 0);\n      } else if (item.indexType === 'return') {\n        returnAmount = Number(returnAmount) + Number(item.assessAmount || 0);\n      } else if (item.indexType === 'share') {\n        compensateShareAmount = Number(compensateShareAmount) + Number(item.assessAmount || 0);\n      } else if (item.indexType === 'compensate') {\n        compensateTotalAmount = Number(compensateTotalAmount) + Number(item.assessAmount || 0);\n      }\n      totalElectricity = Number(totalElectricity) + Number(item.assessElectricity || 0);\n    });\n    formState.totalAmount = totalAmount.toFixed(6);\n    formState.returnAmount = returnAmount.toFixed(6);\n    formState.compensateShareAmount = compensateShareAmount.toFixed(6);\n    formState.compensateTotalAmount = compensateTotalAmount.toFixed(6);\n    formState.totalElectricity = totalElectricity.toFixed(6);\n    // 净收入(万元)\n    formState.netIncome = (\n      returnAmount +\n      compensateTotalAmount -\n      (totalAmount + compensateShareAmount)\n    ).toFixed(6);\n  }\n\n  function validateDetailData(isSubmit: boolean) {\n    const detailData = getDetailDataSource();\n    if (detailData.length === 0) {\n      error('细则明细不存在，请选择期数');\n      return false;\n    }\n    if (!isSubmit) {\n      return true;\n    }\n    for (let i = 0; i < detailData.length; i++) {\n      const item = detailData[i];\n      if (!trim(item.assessResult)) {\n        error('细则明细，发布结果不能为空');\n        return false;\n      }\n    }\n    return true;\n  }\n\n  const initFormState = async () => {\n    query.id = await getBizParamId();\n    await getRecordable();\n    if (!query.id) {\n      assign(formState, query);\n      disabledInput.value = false;\n      formState.bizFileId = buildShortUUID();\n    }\n  };\n\n  function initSelectOptions() {\n    initStationPeriodOptions();\n  }\n\n  onMounted(async () => {\n    await initFormState();\n    initSelectOptions();\n    initTableData();\n  });\n</script>\n<style lang=\"less\" scoped>\n  @import '/@/design/biz/bizForm.less';\n</style>\n"],"names":["t","useI18n","userStore","useUserStore","userInfo","toRaw","query","Memory","formRef","ref","formState","reactive","searchBoxData","detailDataSource","billTitleOption","disabledInput","onSave","doSave","onSubmit","value","detailData","getDetailDataSource","error","i","item","trim","errorObj","errorFields","_a","status","__async","calculateSummaryData","saveBiz","formData","getSummaryDataSource","saveData","res","success","reloadBizTable","closeCurrentTab","MsgManager","content","SysMessage","isApplyEdit","isEdit","tableBoxSelect","node","initOriginalDetail","templateId","detail","TemplateApi.getDetailList","getRecordable","getData","assign","billCode","fillinDate","personMemberName","deptName","registerDetailTable","useTable","detailColumns","summaryDataSource","registerSummaryTable","summaryColumns","initTableData","detailObj","getDetailList","summaryObj","getSummaryList","changeAssessAmount","record","initStationPeriodOptions","TemplateApi.getPage","getBizParamId","id","processInstance","ProcessInstanceApi.getProcessInstance","businessKey","handleSummary","isSubmit","validateDetailData","calculateResult","groupData","result","key","summaryList","a","b","data","totalAmount","returnAmount","compensateShareAmount","compensateTotalAmount","totalElectricity","initFormState","buildShortUUID","initSelectOptions","onMounted"],"mappings":"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"}