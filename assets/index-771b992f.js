var b=(v,_,d)=>new Promise((i,r)=>{var l=a=>{try{u(d.next(a))}catch(m){r(m)}},w=a=>{try{u(d.throw(a))}catch(m){r(m)}},u=a=>a.done?i(a.value):Promise.resolve(a.value).then(l,w);u((d=d.apply(v,_)).next())});import{B as U}from"./BasicTable-0434a334.js";import{T as A}from"./BasicForm.vue_vue_type_style_index_0_lang-1ba7be9e.js";import"./index-085d06c7.js";import{u as H}from"./useTable-109483b3.js";import{a2 as h}from"./antd-15ac76ed.js";import{au as $,b as K,a7 as W,av as y,ax as S,_ as X}from"./index.js";import{e as Z}from"./download-03e71dd5.js";import{u as j,d as G,e as J,g as Q,c as Y,f as ee}from"./data-d72417b4.js";import{P as te}from"./index-20519caf.js";import{a as oe}from"./assign-37f1c13d.js";import{d as ae,r as ne,k as E,o as re,al as D,Z as C,a9 as I,aa as c,f as p,u as o,E as g,ad as x,ac as F}from"./vue-71d1abb3.js";import"./useForm-dea3ed18.js";import"./uniqBy-92d3bc7f.js";import"./index-316f6ffb.js";import"./useWindowSizeFn-13b1b8a2.js";import"./index-f4fc48e6.js";import"./useTabs-2b062e85.js";import"./index-5d49b7a7.js";import"./SearchBox-22bb02d6.js";import"./UploadBox-636ecf02.js";import"./Dialog-0a006d82.js";import"./DictSelectBox.vue_vue_type_script_setup_true_lang-e03e9fe8.js";import"./OrganDialog-dd1023ce.js";import"./sortable.esm-4ae27e0b.js";import"./dict-c04c0dd8.js";import"./useContentViewHeight-7f845167.js";const ie=ae({__name:"index",setup(v){const{createConfirm:_,createMessage:d}=$(),{t:i}=K(),r=ne({});let l=E("");re(()=>{W.getInstance().listen("power_station",a)});const[w,{getSelectRows:u,reload:a,clearSelectedRowKeys:m,getDataSource:R}]=H({title:"电站信息列表",api:Q,columns:Y,bordered:!0,useSearchForm:!0,formConfig:ee,tableSetting:{redo:!1,size:!1,setting:!0,fullScreen:!1},fetchSetting:{listField:"list",pageField:"pageNo",sizeField:"pageSize",totalField:"total"},handleSearchInfoFn(e){return oe(r,e),e},rowSelection:{type:"radio",fixed:!0,onSelect:O},pagination:{pageSize:20},showTableSetting:!0,showIndexColumn:!0,indexColumnProps:{fixed:"left"},sortFn:e=>{e.order?(r.sortField=e.field,r.sortOrder=e.order.replace("end","")):(r.sortField="",r.sortOrder="")}});function P(){const e=R(),t=E([]);e.forEach(n=>{if(!n.sequence)throw h.error("排序不能为空"),Error("排序不能为空");t.value.push({id:n.id,sequence:n.sequence})}),j(t.value).then(()=>{h.success("保存排序成功"),a()})}function M(){S("/baseset/operation/powerstation/create","添加电站设置")}function z(){const e=T();e.id&&S(`/baseset/operation/powerstation/create?id=${e.id}`,"修改电站设置")}function k(e){e.id&&S("/baseset/operation/powerstation/create","查看电站设置",{id:e.id,type:"view",page_readonly:"true",ifShow:!1})}function T(){const e=u();return e.length==0?(h.error("请选择一行数据"),!1):e[0]}function B({keys:e,rows:t}){if(t&&t.length>0){const n=t[0];l.value=n.id}else l.value=""}function O(e,t){t?l.value=e.id:l.value=""}function q(){return b(this,null,function*(){const e=T();e.id&&_({title:"提示",iconType:"warning",content:"确定要删除选中记录？",onOk(){return b(this,null,function*(){G(e.id).then(()=>{h.success("已删除"),m(),a()})})}})})}function N(){_({title:i("common.exportTitle"),iconType:"warning",content:i("common.exportMessage"),onOk(){return b(this,null,function*(){yield J(r).then(t=>{Z(t==null?void 0:t.data,"电站信息.xls")}),d.success(i("common.exportSuccessText"))})}})}return(e,t)=>{const n=D("a-button"),V=D("a-input-number");return C(),I(o(te),{dense:"",contentFullHeight:"",fixedHeight:"",contentClass:"flex",style:{position:"relative"}},{default:c(()=>[p(o(U),{onRegister:o(w),searchInfo:r,onResizeColumn:t[1]||(t[1]=(s,f)=>f.width=s),onRowDbClick:t[2]||(t[2]=s=>k(s)),onSelectionChange:B},{toolbar:c(()=>[p(n,{type:"primary",preIcon:o(y).ADD,onClick:t[0]||(t[0]=s=>M())},{default:c(()=>[g(x(o(i)("common.action.create")),1)]),_:1},8,["preIcon"]),p(n,{type:"primary",disabled:o(l)=="",preIcon:o(y).EDIT,onClick:z},{default:c(()=>[g(x(o(i)("common.action.edit")),1)]),_:1},8,["disabled","preIcon"]),p(n,{class:"red-btn",disabled:o(l)=="",preIcon:o(y).DELETE,onClick:q},{default:c(()=>[g(x(o(i)("common.delText")),1)]),_:1},8,["disabled","preIcon"]),p(n,{type:"primary",onClick:P},{default:c(()=>[g(x("保存排序号"))]),_:1}),p(n,{class:"yellow-btn",preIcon:o(y).EXPORT,onClick:N},{default:c(()=>[g(x(o(i)("common.action.export")),1)]),_:1},8,["preIcon"])]),bodyCell:c(({column:s,record:f})=>[s.dataIndex==="sequence"?(C(),I(V,{key:0,value:f[s.dataIndex],"onUpdate:value":L=>f[s.dataIndex]=L,class:"input-center",min:1,max:999,step:1,precision:0,status:"error"},null,8,["value","onUpdate:value"])):F("",!0),s.key==="action"?(C(),I(o(A),{key:1,actions:[{label:"查看",icon:"clarity:bullet-list-line",onClick:k.bind(null,f)}]},null,8,["actions"])):F("",!0)]),_:1},8,["onRegister","searchInfo"])]),_:1})}}});const ze=X(ie,[["__scopeId","data-v-08ee540b"]]);export{ze as default};
//# sourceMappingURL=index-771b992f.js.map
