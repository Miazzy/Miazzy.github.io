{"version":3,"file":"Security-1e1454b2.js","sources":["../../src/views/da/groupOperation/operation/Security.vue"],"sourcesContent":["<template>\n  <div class=\"security\">\n    <SmallModule title=\"安全工器具统计\">\n      <!-- <template #titleRight>\n        <div class=\"right-title-layout\">\n          <div class=\"operation-screen-select\">\n            <a-select\n              ref=\"select\"\n              label-in-value\n              allow-clear\n              v-model:value=\"securitySearchInfo.selectSecurityValue\"\n              :options=\"optionsSecurity\"\n              style=\"margin-right: 0.3rem\"\n              @change=\"handleSecurityChange\"\n            />\n          </div>\n          <div class=\"detail-text\"\n            ><span class=\"text\">详情</span><span class=\"arrow\">&gt;</span></div\n          >\n        </div>\n      </template> -->\n      <template #content>\n        <div class=\"content-layout\">\n          <div class=\"data-layout\">\n            <DataIndicator\n              label=\"待检\"\n              @click=\"toBiReport('withinNum')\"\n              :value=\"securityIndexData.withinNum\"\n            />\n            <DataIndicator\n              label=\"超期未检\"\n              @click=\"toBiReport('unInspectedNum')\"\n              :value=\"securityIndexData.unInspectedNum\"\n            />\n            <DataIndicator label=\"合格率(%)\" :value=\"securityIndexData.qualifiedRate\" />\n          </div>\n          <div style=\"transform: scale(0.85); transform-origin: 0 0\">\n            <EchartLineBarChart\n              :data=\"securityData\"\n              :colors=\"securityData.chartColors\"\n              :width=\"`26.14vw`\"\n              :height=\"`23.36vh`\"\n              :category=\"securityData.categories\"\n              ybgcolor=\"#01B7D730\"\n              :name=\"securityData.barChartSeriesName\"\n              :dataZoomDisabled=\"false\"\n              :dataZoomMaxValueSpan=\"securityData.categories.length\"\n              :dataZoomDefaultValueRange=\"[0, 4]\"\n            />\n          </div>\n        </div>\n      </template>\n    </SmallModule>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import SmallModule from '/@/components/Framework/OperationScreen/SmallModule.vue';\n  import DataIndicator from '/@/components/Framework/OperationScreen/DataIndicator.vue';\n  import EchartLineBarChart from '/@/components/Framework/Chart/EchartLineBarChart.vue';\n  import { reactive, UnwrapRef, ref, onMounted } from 'vue';\n  import { getSecurityData } from './data';\n  import { assign } from 'lodash-es';\n  import { addTabPage } from '@/utils/route';\n\n  const securitySearchInfo: UnwrapRef<any> = reactive({});\n  const securityIndexData: UnwrapRef<any> = reactive({});\n\n  onMounted(() => {\n    securitySearchInfo.selectSecurityValue = 'tools';\n    querySecurityData();\n  });\n\n  // const handleSecurityChange = (value: string) => {\n  //   securitySearchInfo.selectSecurityValue = value.value;\n  //   querySecurityData();\n  // };\n\n  const securityData = ref({\n    barData: [[], []],\n    categories: [],\n    lineData: [[]],\n    chartColors: [\n      ['#488FF6', '#60D1F3'],\n      ['#078c5d', '#68e4b8'],\n      ['#E59837', '#FAE895'],\n      ['#E59837', '#68E4B8'],\n      ['#e59837', '#fae895'],\n    ],\n    barChartSeriesName: [['待检', '超期未检'], ['合格率']],\n  });\n\n  const querySecurityData = async () => {\n    securitySearchInfo.selectValue = securitySearchInfo.selectSecurityValue;\n    let data = await getSecurityData(securitySearchInfo);\n    if (data.result) {\n      assign(securityIndexData, data.result);\n      securityData.value.barData = data.result.barData;\n      securityData.value.categories = data.result.categories;\n      if (data.result.lineData.length) {\n        securityData.value.lineData[0] = data.result.lineData;\n      } else {\n        securityData.value.lineData = [];\n      }\n    }\n  };\n\n  // 穿透方法\n  const toBiReport = async (type: string) => {\n    // 参数处理\n    let param = {};\n    let url = '';\n    if (securitySearchInfo.selectSecurityValue == 'tools') {\n      url = '/bi/safetytools/index';\n    } else {\n      url = '/bi/integrated/vehicle';\n    }\n    // if (type === 'withinNum') {\n    //   url = '/bi/safetytools/index';\n    // } else if (type === 'unInspectedNum') {\n    //   url = '/bi/safetytools/index';\n    // }\n    addTabPage(url, '', param);\n  };\n</script>\n\n<style lang=\"less\" scoped>\n  .right-title-layout {\n    display: flex;\n    align-items: center;\n    padding: 0.2rem 0.16rem 0 0;\n\n    .detail-text {\n      margin-left: 0.14rem;\n      color: #fff;\n      font-size: 0.12rem;\n      line-height: 1;\n      cursor: pointer;\n\n      .text {\n        margin-right: 0.04rem;\n      }\n\n      .arrow {\n        opacity: 0.6;\n      }\n    }\n  }\n\n  .content-layout {\n    height: 100%;\n    padding: 0 0.14rem;\n\n    .data-layout {\n      display: flex;\n      align-items: flex-end;\n      justify-content: space-between;\n      height: 20.74%;\n      margin-top: -0.12rem;\n      padding: 0 0.73rem;\n    }\n  }\n</style>\n"],"names":["securitySearchInfo","reactive","securityIndexData","onMounted","querySecurityData","securityData","ref","__async","data","getSecurityData","assign","toBiReport","type","param","url","addTabPage"],"mappings":"m3BAiEQ,MAAAA,EAAqCC,EAAS,CAAA,CAAE,EAChDC,EAAoCD,EAAS,CAAA,CAAE,EAErDE,EAAU,IAAM,CACdH,EAAmB,oBAAsB,QACvBI,GAAA,CACnB,EAOD,MAAMC,EAAeC,EAAI,CACvB,QAAS,CAAC,CAAC,EAAG,EAAE,EAChB,WAAY,CAAC,EACb,SAAU,CAAC,CAAA,CAAE,EACb,YAAa,CACX,CAAC,UAAW,SAAS,EACrB,CAAC,UAAW,SAAS,EACrB,CAAC,UAAW,SAAS,EACrB,CAAC,UAAW,SAAS,EACrB,CAAC,UAAW,SAAS,CACvB,EACA,mBAAoB,CAAC,CAAC,KAAM,MAAM,EAAG,CAAC,KAAK,CAAC,CAAA,CAC7C,EAEKF,EAAoB,IAAYG,EAAA,sBACpCP,EAAmB,YAAcA,EAAmB,oBAChD,IAAAQ,EAAO,MAAMC,EAAgBT,CAAkB,EAC/CQ,EAAK,SACAE,EAAAR,EAAmBM,EAAK,MAAM,EACxBH,EAAA,MAAM,QAAUG,EAAK,OAAO,QAC5BH,EAAA,MAAM,WAAaG,EAAK,OAAO,WACxCA,EAAK,OAAO,SAAS,OACvBH,EAAa,MAAM,SAAS,CAAC,EAAIG,EAAK,OAAO,SAEhCH,EAAA,MAAM,SAAW,GAElC,GAIIM,EAAoBC,GAAiBL,EAAA,sBAEzC,IAAIM,EAAQ,CAAA,EACRC,EAAM,GACNd,EAAmB,qBAAuB,QACtCc,EAAA,wBAEAA,EAAA,yBAOGC,EAAAD,EAAK,GAAID,CAAK,CAAA"}