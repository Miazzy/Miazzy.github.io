{"version":3,"file":"areaDataComparison-89cfbeca.js","sources":["../../src/views/monitor/PVArea/subareaOverview/areaDataComparison.vue"],"sourcesContent":["<!--\n * @Description: 区域弹窗-数据对比\n * @Date: 2023-10-20 14:33:10\n * @LastEditTime: 2023-10-20 15:16:46\n * @FilePath: \\ygwl-framework\\src\\views\\monitor\\boosterStation\\boosterStationOverview\\dataComparison.vue\n-->\n<template>\n  <div class=\"data-comparison\">\n    <div class=\"header-box\">\n      <div class=\"header-left\">\n        <div class=\"date-picker-box\">\n          <RangePicker\n            v-model:value=\"dateRange\"\n            valueFormat=\"YYYY-MM-DD\"\n            @change=\"handleChangeDateRange\"\n          />\n        </div>\n        <div class=\"select-box\">\n          <Select\n            v-model:value=\"target\"\n            style=\"min-width: 206px\"\n            placeholder=\"选择指标\"\n            :options=\"targetOptions\"\n            :max-tag-count=\"2\"\n            showArrow\n            @change=\"handleTargetChange\"\n          />\n        </div>\n      </div>\n    </div>\n    <div class=\"content-box\">\n      <div class=\"chart-box\">\n        <div style=\"margin-top: 20px; transform: scale(0.85); transform-origin: 0 0\">\n          <EchartLineChart\n            :data=\"pchartData\"\n            :colors=\"pchartData.colors\"\n            :width=\"1200\"\n            :height=\"712\"\n          /> </div\n      ></div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import { ref, reactive, onMounted } from 'vue';\n  import { Select, RangePicker } from 'ant-design-vue';\n  import Icon from '@/components/Icon/Icon.vue';\n  import type { SelectProps } from 'ant-design-vue';\n  import dayjs, { Dayjs } from 'dayjs';\n  import { formatDate } from '/@/utils/dateUtil';\n  import EchartLineChart from '/@/components/Framework/Chart/EchartLineChart.vue';\n  import { getAreaDialogChartData } from '../../monitorApi.ts';\n  // 父组件穿过来的表格字段，指标列表\n  interface Props {\n    index?: [];\n    areaId?: String;\n  }\n  const pchartData = reactive({\n    barData: [],\n    lineData: [],\n    categories: [],\n    seriesName: [],\n    units: [],\n    colors: [\n      ['#078C5D', '#68E4B8'],\n      ['#E59837', '#FAE895'],\n      ['#078C5D', '#68E4B8'],\n    ],\n  });\n  const props = withDefaults(defineProps<Props>(), {});\n  // 选择日期\n  type RangeValue = [Dayjs, Dayjs];\n  const dateRange = ref<RangeValue>();\n  const handleChangeDateRange = (value) => {\n    console.log('选择日期范围', value);\n    loadChartData();\n  };\n\n  // 选择指标\n  const target = ref('');\n  const targetOptions = ref<SelectProps['options']>([]);\n\n  const handleTargetChange = (value: string[]) => {\n    console.log(`selected ${value}`);\n    target.value = value;\n    loadChartData();\n  };\n\n  const loadBaseInfo = async () => {\n    let tempOptions = [];\n    if (props.index?.length > 0) {\n      props.index.forEach((item) => {\n        if (target.value == '') {\n          target.value = item.value;\n        }\n        tempOptions.push(item);\n      });\n    }\n\n    targetOptions.value = tempOptions;\n    // 初始化日期\n    let current = formatDate(new Date());\n    dateRange.value = [dayjs(current, 'YYYY-MM-DD'), dayjs(current, 'YYYY-MM-DD')];\n    loadChartData();\n  };\n  // 获取数据\n  const loadChartData = async () => {\n    let params = {};\n    let esns = [];\n    esns.push(props.esn);\n    params.queryField = target.value;\n    params.startDate = formatDate(dateRange.value[0]);\n    params.endDate = formatDate(dateRange.value[1]);\n    params.areaId = props.areaId;\n    params.isCrossTian = true;\n    let res = await getAreaDialogChartData(params);\n    pchartData.lineData = res.lineData;\n    pchartData.categories = res.timeList;\n    pchartData.units = res.unitList;\n    pchartData.seriesName = res.seriesName;\n  };\n\n  // 启动执行代码\n  onMounted(() => {\n    loadBaseInfo();\n  });\n</script>\n\n<style lang=\"less\" scoped>\n  .data-comparison {\n    .header-box {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      padding: 10px 15px 0;\n\n      .header-left {\n        display: flex;\n        align-items: center;\n      }\n    }\n\n    .date-picker-box {\n      margin-right: 20px;\n    }\n  }\n</style>\n"],"names":["pchartData","reactive","dateRange","ref","handleChangeDateRange","value","loadChartData","target","targetOptions","handleTargetChange","loadBaseInfo","__async","tempOptions","_a","props","item","current","formatDate","dayjs","params","res","getAreaDialogChartData","onMounted"],"mappings":"+6BA0DQA,EAAaC,EAAS,CAC1B,QAAS,CAAC,EACV,SAAU,CAAC,EACX,WAAY,CAAC,EACb,WAAY,CAAC,EACb,MAAO,CAAC,EACR,OAAQ,CACN,CAAC,UAAW,SAAS,EACrB,CAAC,UAAW,SAAS,EACrB,CAAC,UAAW,SAAS,CACvB,CAAA,CACD,EAIKC,EAAYC,IACZC,EAAyBC,GAAU,CAC/B,QAAA,IAAI,SAAUA,CAAK,EACbC,GAAA,EAIVC,EAASJ,EAAI,EAAE,EACfK,EAAgBL,EAA4B,CAAA,CAAE,EAE9CM,EAAsBJ,GAAoB,CACtC,QAAA,IAAI,YAAYA,CAAK,EAAE,EAC/BE,EAAO,MAAQF,EACDC,GAAA,EAGVI,EAAe,IAAYC,EAAA,4BAC/B,IAAIC,EAAc,CAAA,IACdC,EAAAC,EAAM,QAAN,YAAAD,EAAa,QAAS,GAClBC,EAAA,MAAM,QAASC,GAAS,CACxBR,EAAO,OAAS,KAClBA,EAAO,MAAQQ,EAAK,OAEtBH,EAAY,KAAKG,CAAI,CAAA,CACtB,EAGHP,EAAc,MAAQI,EAEtB,IAAII,EAAUC,EAAe,IAAA,IAAM,EACzBf,EAAA,MAAQ,CAACgB,EAAMF,EAAS,YAAY,EAAGE,EAAMF,EAAS,YAAY,CAAC,EAC/DV,GAAA,GAGVA,EAAgB,IAAYK,EAAA,sBAChC,IAAIQ,EAAS,CAAA,EACF,CAAA,EACN,KAAKL,EAAM,GAAG,EACnBK,EAAO,WAAaZ,EAAO,MAC3BY,EAAO,UAAYF,EAAWf,EAAU,MAAM,CAAC,CAAC,EAChDiB,EAAO,QAAUF,EAAWf,EAAU,MAAM,CAAC,CAAC,EAC9CiB,EAAO,OAASL,EAAM,OACtBK,EAAO,YAAc,GACjB,IAAAC,EAAM,MAAMC,EAAuBF,CAAM,EAC7CnB,EAAW,SAAWoB,EAAI,SAC1BpB,EAAW,WAAaoB,EAAI,SAC5BpB,EAAW,MAAQoB,EAAI,SACvBpB,EAAW,WAAaoB,EAAI,UAAA,GAI9B,OAAAE,EAAU,IAAM,CACDZ,GAAA,CACd"}