var c=(U,g,v)=>new Promise((I,y)=>{var p=e=>{try{b(v.next(e))}catch(m){y(m)}},C=e=>{try{b(v.throw(e))}catch(m){y(m)}},b=e=>e.done?I(e.value):Promise.resolve(e.value).then(p,C);b((v=v.apply(U,g)).next())});import{d as L,k as h,ax as q,u as w,r as N,o as O,al as f,Z as j,a9 as K,aa as t,$ as _,f as a,v as d,A as u}from"./vue-71d1abb3.js";import{B as V}from"./BillTitle-d17ab3e4.js";import{b as J,ak as Q,aB as Z,at as $,a7 as G,aC as X,bP as ee,_ as ae}from"./index.js";import{W as le}from"./WfApproveBox-a3448232.js";import{U as te}from"./UploadBox-636ecf02.js";import{w as se,x as B,t as oe}from"./index-caeea670.js";import{P as ne}from"./index-20519caf.js";import{a as W}from"./assign-37f1c13d.js";import"./antd-15ac76ed.js";import"./index.esm-c216ed00.js";import"./index-fda2d66c.js";import"./BasicTable-0434a334.js";import"./useForm-dea3ed18.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1ba7be9e.js";import"./index-f4fc48e6.js";import"./index-316f6ffb.js";import"./useWindowSizeFn-13b1b8a2.js";import"./useTabs-2b062e85.js";import"./download-03e71dd5.js";import"./index-5d49b7a7.js";import"./SearchBox-22bb02d6.js";import"./DictSelectBox.vue_vue_type_script_setup_true_lang-e03e9fe8.js";import"./Dialog-0a006d82.js";import"./OrganDialog-dd1023ce.js";import"./uniqBy-92d3bc7f.js";import"./index-085d06c7.js";import"./sortable.esm-4ae27e0b.js";import"./dict-c04c0dd8.js";import"./useTable-109483b3.js";import"./index-c0893416.js";import"./index-33af41d1.js";import"./tree-fc0e156a.js";import"./useRender-21ce56fb.js";import"./useContentViewHeight-7f845167.js";const ie={class:"load"},re={class:"process-box"},de={class:"header-box"},ue={class:"content"},pe={class:"left-panel"},me=L({__name:"yearReportCreate",setup(U){const g=h(!1),{t:v}=J(),I=q(),{currentRoute:y}=I;w(y);const p=Q.getInstance().getQuery(),C=h(null),b=h(),e=N({status:0}),m=N({});m.subject="生产年报",m.infoItems=[];const x=()=>c(this,null,function*(){if(e.yearCycle==null)return;e.requestType="year";let s=yield oe(e);e.genElec=s.result.genElec,e.offlineElec=s.result.offlineElec,e.onlineElec=s.result.onlineElec,e.theoElec=s.result.theoElec,e.facUsed=s.result.facUsed,e.totalLoss=s.result.totalLoss,e.validHours=s.result.validHours,e.facRatio=s.result.facRatio,e.sysEfficiency=s.result.sysEfficiency,e.avgTemp=s.result.avgTemp,e.avgWind=s.result.avgWind,e.radiation=s.result.radiation,e.connectCapacity=s.result.connectCapacity});function T(){x()}const S=()=>{R(0)},z=()=>{R(1)},R=s=>{b.value.validateFields().then(()=>{let l=e;l.status=s,se(l).then(n=>{$.getInstance().success(v("common.saveSuccessText")),e.id=n.result,E(),s>=1&&setTimeout(function(){G.getInstance().sendMsg("day-report",{key:"year"}),X()},200)}).catch(()=>{})})},k=s=>c(this,null,function*(){let{billCode:l,fillinDate:n,personMemberName:i,deptName:r}=s;Object.assign(m,{billCode:l,fillinDate:n,personMemberName:i,deptName:r})}),E=()=>c(this,null,function*(){let s=yield B(e.id);g.value=s.status>0,k(s),W(e,s),e.processInstanceId||(e.processInstanceId=p.processInstanceId)}),F=()=>c(this,null,function*(){let s=yield B("");k(s),e.billCode=s.billCode,e.fillinDate=s.fillinDate,e.stationId=p.stationId,e.stationName=p.stationName,e.periodId=p.periodId,e.periodName=p.periodName,e.stationOrganId=p.organId,e.stationOrganName=p.organName,x(),D()}),D=()=>c(this,null,function*(){ee().then(s=>{e.bizFileId=s})});return O(()=>c(this,null,function*(){W(e,p),p.id?yield E():p.processInstanceId?(C.value=p.processInstanceId,e.processInstanceId=p.processInstanceId,Z(e.processInstanceId).then(s=>c(this,null,function*(){e.id=s.businessKey,yield E()}))):F()})),(s,l)=>{const n=f("a-input"),i=f("a-form-item"),r=f("a-col"),H=f("a-date-picker"),M=f("a-textarea"),P=f("a-row"),A=f("a-card"),Y=f("a-form");return j(),K(w(ne),{detail:!0,dense:"",contentFullHeight:"",fixedHeight:"",contentClass:"fix-detail-page",style:{position:"relative"}},{default:t(()=>[_("div",ie,[_("div",re,[_("div",de,[a(V,{options:m},null,8,["options"]),a(le,{onSave:S,onSubmit:z,processStatus:e.status,processInstanceId:e.processInstanceId},null,8,["processStatus","processInstanceId"])]),_("div",ue,[_("div",pe,[a(Y,{ref_key:"yearReportFormRef",ref:b,model:e,name:"yearReportForm",scrollToFirstError:"true"},{default:t(()=>[a(A,{title:"基本信息",bordered:!1},{default:t(()=>[a(P,{gutter:32},{default:t(()=>[d(a(r,{span:12},{default:t(()=>[a(i,{label:"电站名称",name:"stationName",labelAlign:"right",labelCol:{span:4}},{default:t(()=>[a(n,{disabled:"",value:e.stationName,"onUpdate:value":l[0]||(l[0]=o=>e.stationName=o),style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1},512),[[u,!0]]),d(a(r,{span:12},{default:t(()=>[a(i,{label:"分期",name:"periodName",labelAlign:"right",labelCol:{span:4}},{default:t(()=>[a(n,{disabled:"",value:e.periodName,"onUpdate:value":l[1]||(l[1]=o=>e.periodName=o)},null,8,["value"])]),_:1})]),_:1},512),[[u,!0]]),d(a(r,{span:12},{default:t(()=>[a(i,{label:"年报周期",name:"yearCycle",labelAlign:"right",labelCol:{span:4},rules:[{required:!0,message:"请选择年份"}]},{default:t(()=>[a(H,{value:e.yearCycle,"onUpdate:value":l[2]||(l[2]=o=>e.yearCycle=o),"value-format":"YYYY",onChange:T,style:{"min-width":"100%"},disabled:g.value,picker:"year"},null,8,["value","disabled"])]),_:1})]),_:1},512),[[u,!0]]),d(a(r,{span:12},{default:t(()=>[a(i,{label:"年发电量(kWh)",name:"genElec",labelAlign:"right",labelCol:{span:4}},{default:t(()=>[a(n,{disabled:"",value:e.genElec,"onUpdate:value":l[3]||(l[3]=o=>e.genElec=o)},null,8,["value"])]),_:1})]),_:1},512),[[u,!0]]),d(a(r,{span:12},{default:t(()=>[a(i,{label:"理论发电(kWh)",name:"theoElec",labelAlign:"right",labelCol:{span:4}},{default:t(()=>[a(n,{disabled:"",value:e.theoElec,"onUpdate:value":l[4]||(l[4]=o=>e.theoElec=o)},null,8,["value"])]),_:1})]),_:1},512),[[u,!0]]),d(a(r,{span:12},{default:t(()=>[a(i,{label:"外接厂用电(kWh)",name:"facUsed",labelAlign:"right",labelCol:{span:4}},{default:t(()=>[a(n,{disabled:"",value:e.facUsed,"onUpdate:value":l[5]||(l[5]=o=>e.facUsed=o)},null,8,["value"])]),_:1})]),_:1},512),[[u,!0]]),d(a(r,{span:12},{default:t(()=>[a(i,{label:"上网电量(kWh)",name:"onlineElec",labelAlign:"right",labelCol:{span:4}},{default:t(()=>[a(n,{disabled:"",value:e.onlineElec,"onUpdate:value":l[6]||(l[6]=o=>e.onlineElec=o)},null,8,["value"])]),_:1})]),_:1},512),[[u,!0]]),d(a(r,{span:12},{default:t(()=>[a(i,{label:"下网电量(kWh)",name:"offlineElec",labelAlign:"right",labelCol:{span:4}},{default:t(()=>[a(n,{disabled:"",value:e.offlineElec,"onUpdate:value":l[7]||(l[7]=o=>e.offlineElec=o)},null,8,["value"])]),_:1})]),_:1},512),[[u,!0]]),d(a(r,{span:12},{default:t(()=>[a(i,{label:"损失电量(kWh)",name:"totalLoss",labelAlign:"right",labelCol:{span:4}},{default:t(()=>[a(n,{disabled:"",value:e.totalLoss,"onUpdate:value":l[8]||(l[8]=o=>e.totalLoss=o)},null,8,["value"])]),_:1})]),_:1},512),[[u,!0]]),d(a(r,{span:12},{default:t(()=>[a(i,{label:"利用小时数(h)",name:"validHours",labelAlign:"right",labelCol:{span:4}},{default:t(()=>[a(n,{disabled:"",value:e.validHours,"onUpdate:value":l[9]||(l[9]=o=>e.validHours=o)},null,8,["value"])]),_:1})]),_:1},512),[[u,!0]]),d(a(r,{span:12},{default:t(()=>[a(i,{label:"综合厂用电率(%)",name:"facRatio",labelAlign:"right",labelCol:{span:4}},{default:t(()=>[a(n,{disabled:"",value:e.facRatio,"onUpdate:value":l[10]||(l[10]=o=>e.facRatio=o)},null,8,["value"])]),_:1})]),_:1},512),[[u,!0]]),d(a(r,{span:12},{default:t(()=>[a(i,{label:"系统效率(%)",name:"sysEfficiency",labelAlign:"right",labelCol:{span:4}},{default:t(()=>[a(n,{disabled:"",value:e.sysEfficiency,"onUpdate:value":l[11]||(l[11]=o=>e.sysEfficiency=o)},null,8,["value"])]),_:1})]),_:1},512),[[u,!0]]),d(a(r,{span:12},{default:t(()=>[a(i,{label:"平均温度(℃)",name:"avgTemp",labelAlign:"right",labelCol:{span:4}},{default:t(()=>[a(n,{disabled:"",value:e.avgTemp,"onUpdate:value":l[12]||(l[12]=o=>e.avgTemp=o)},null,8,["value"])]),_:1})]),_:1},512),[[u,!0]]),d(a(r,{span:12},{default:t(()=>[a(i,{label:"平均风速(m/s)",name:"avgWind",labelAlign:"right",labelCol:{span:4}},{default:t(()=>[a(n,{disabled:"",value:e.avgWind,"onUpdate:value":l[13]||(l[13]=o=>e.avgWind=o)},null,8,["value"])]),_:1})]),_:1},512),[[u,!0]]),d(a(r,{span:12},{default:t(()=>[a(i,{label:"年辐照值(万KJ/㎡)",name:"radiation",labelAlign:"right",labelCol:{span:4}},{default:t(()=>[a(n,{disabled:"",value:e.radiation,"onUpdate:value":l[14]||(l[14]=o=>e.radiation=o)},null,8,["value"])]),_:1})]),_:1},512),[[u,!0]]),d(a(r,{span:24,class:"textarea-item"},{default:t(()=>[a(i,{label:"生产数据分析",name:"remark",labelAlign:"right",labelCol:{span:2},rules:[{required:!0,message:"请输入生产数据分析"}]},{default:t(()=>[a(M,{rows:10,value:e.remark,"onUpdate:value":l[15]||(l[15]=o=>e.remark=o),placeholder:"1000字以内",maxlength:1e3,disabled:g.value,"show-count":""},null,8,["value","disabled"])]),_:1})]),_:1},512),[[u,!0]])]),_:1})]),_:1})]),_:1},8,["model"]),a(A,{title:"运维管理年度总结",bordered:!1},{default:t(()=>[a(te,{width:800,height:550,maxCount:20,maxSize:100*1024*1024,application:"po",module:"yearReport",vmode:e.status==0?"box":"view",bizId:e.bizFileId},null,8,["vmode","bizId"])]),_:1})])])])])]),_:1})}}});const Je=ae(me,[["__scopeId","data-v-44e78839"]]);export{Je as default};
//# sourceMappingURL=yearReportCreate-654a97b4.js.map
