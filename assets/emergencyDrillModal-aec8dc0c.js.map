{"version":3,"file":"emergencyDrillModal-aec8dc0c.js","sources":["../../src/views/po/safety/emergencydrill/emergencyDrillModal.vue"],"sourcesContent":["<template>\n  <div class=\"load\">\n    <a-spin :spinning=\"detailFormState.spinning\" tip=\"Loading...\">\n      <div class=\"process-box\">\n        <!-- 标题 -->\n        <div class=\"header-box\">\n          <BillTitle :options=\"billTitleOption\" />\n          <WfApproveBox\n            v-if=\"detailFormState.status != 10\"\n            @save=\"onSave\"\n            @submit=\"onSubmit\"\n            :processInstanceId=\"detailFormState.processInstanceId\"\n            :processStatus=\"detailFormState.status\"\n          />\n        </div>\n        <!-- 表单内容 -->\n        <div class=\"content\">\n          <a-form ref=\"formRef\" :model=\"detailFormState\" labelAlign=\"right\" autocomplete=\"off\">\n            <a-card title=\"基本信息\" :bordered=\"false\">\n              <a-row :gutter=\"24\">\n                <a-col v-show=\"true\" :span=\"12\">\n                  <a-form-item\n                    name=\"stationName\"\n                    label=\"电站名称\"\n                    :labelCol=\"{ span: 6 }\"\n                    :rules=\"[{ required: true, message: '请输入电站名称' }]\"\n                  >\n                    <a-input\n                      disabled\n                      v-model:value=\"detailFormState.stationName\"\n                      placeholder=\"请输入电站名称\"\n                    />\n                    <a-input disabled v-model:value=\"detailFormState.id\" v-if=\"false\" />\n                  </a-form-item>\n                </a-col>\n                <a-col v-show=\"true\" :span=\"12\">\n                  <a-form-item\n                    name=\"name\"\n                    label=\"主题\"\n                    :labelCol=\"{ span: 6 }\"\n                    :rules=\"[{ required: true, message: '请输入主题' }]\"\n                  >\n                    <a-input\n                      v-model:value=\"detailFormState.name\"\n                      placeholder=\"请输入主题\"\n                      :disabled=\"detailFormState.status != 0\"\n                    />\n                  </a-form-item>\n                </a-col>\n              </a-row>\n\n              <a-row :gutter=\"24\">\n                <a-col v-show=\"true\" :span=\"12\">\n                  <a-form-item\n                    name=\"drillType\"\n                    label=\"演练类型\"\n                    :labelCol=\"{ span: 6 }\"\n                    :rules=\"[{ required: true, message: '请选择演练类型' }]\"\n                  >\n                    <DictSelectBox\n                      :type=\"`EmergencyDrillType`\"\n                      @change=\"`()=> detailFormState.drillType = value`\"\n                      v-model:value=\"detailFormState.drillType\"\n                      style=\"width: 100%\"\n                      :disabled=\"detailFormState.status != 0\"\n                    />\n                  </a-form-item>\n                </a-col>\n                <a-col v-show=\"true\" :span=\"12\">\n                  <a-form-item\n                    name=\"drillMode\"\n                    label=\"演练方式\"\n                    :labelCol=\"{ span: 6 }\"\n                    :rules=\"[{ required: true, message: '请选择演练方式' }]\"\n                  >\n                    <DictSelectBox\n                      :type=\"`EmergencyDrillMode`\"\n                      @change=\"`()=> detailFormState.drillMode = value`\"\n                      v-model:value=\"detailFormState.drillMode\"\n                      style=\"width: 100%\"\n                      :disabled=\"detailFormState.status != 0\"\n                    />\n                  </a-form-item>\n                </a-col>\n              </a-row>\n\n              <a-row :gutter=\"24\">\n                <a-col v-show=\"true\" :span=\"12\">\n                  <a-form-item\n                    name=\"commanderName\"\n                    label=\"指挥人\"\n                    :labelCol=\"{ span: 6 }\"\n                    :rules=\"[{ required: true, message: '请选择指挥人' }]\"\n                  >\n                    <a-select\n                      v-model:value=\"detailFormState.commanderName\"\n                      show-search\n                      allow-clear\n                      style=\"width: 100%\"\n                      placeholder=\"请选择操作人\"\n                      :options=\"stationPersonOptions\"\n                      @change=\"handleChangeOperator\"\n                      :disabled=\"disabledInput\"\n                    />\n                  </a-form-item>\n                </a-col>\n                <a-col v-show=\"true\" :span=\"12\">\n                  <a-form-item\n                    name=\"startTime\"\n                    label=\"开始时间\"\n                    :labelCol=\"{ span: 6 }\"\n                    :rules=\"[{ required: true, message: '请选择开始时间' }]\"\n                  >\n                    <a-date-picker\n                      v-model:value=\"detailFormState.startTime\"\n                      format=\"YYYY-MM-DD HH:mm\"\n                      value-format=\"YYYY-MM-DD HH:mm:00\"\n                      show-time\n                      style=\"width: 100%\"\n                      :disabled=\"detailFormState.status != 0\"\n                    />\n                  </a-form-item>\n                </a-col>\n              </a-row>\n\n              <a-row :gutter=\"24\">\n                <a-col v-show=\"true\" :span=\"12\">\n                  <a-form-item\n                    name=\"endTime\"\n                    label=\"结束时间\"\n                    :labelCol=\"{ span: 6 }\"\n                    :rules=\"[{ required: true, message: '请选择结束时间' }]\"\n                  >\n                    <a-date-picker\n                      v-model:value=\"detailFormState.endTime\"\n                      format=\"YYYY-MM-DD HH:mm\"\n                      value-format=\"YYYY-MM-DD HH:mm:00\"\n                      show-time\n                      style=\"width: 100%\"\n                      :disabled=\"detailFormState.status != 0\"\n                    />\n                  </a-form-item>\n                </a-col>\n                <a-col v-show=\"true\" :span=\"12\">\n                  <a-form-item\n                    name=\"totalCount\"\n                    label=\"参加总人数\"\n                    :labelCol=\"{ span: 6 }\"\n                    :rules=\"[{ required: true, message: '参加总人数' }]\"\n                  >\n                    <a-input disabled v-model:value=\"detailFormState.totalCount\" />\n                  </a-form-item>\n                </a-col>\n              </a-row>\n            </a-card>\n\n            <a-card :bordered=\"false\">\n              <BasicTable title=\"参加成员\" @register=\"registerTaskTable\">\n                <template #toolbar>\n                  <a-button\n                    v-if=\"!disabledInput\"\n                    type=\"primary\"\n                    :preIcon=\"IconEnum.ADD\"\n                    @click=\"handleAddItem()\"\n                  >\n                    {{ t('common.action.create') }}\n                  </a-button>\n                </template>\n\n                <template #bodyCell=\"{ column, record }\">\n                  <template v-if=\"column.dataIndex === 'roleName'\">\n                    <a-input\n                      v-model:value=\"record[column.dataIndex]\"\n                      :maxLength=\"1000\"\n                      :disabled=\"disabledInput\"\n                    />\n                  </template>\n                  <template v-if=\"column.dataIndex === 'innerPersonNames'\">\n                    <a-select\n                      v-model:value=\"record[column.dataIndex]\"\n                      show-search\n                      allow-clear\n                      mode=\"multiple\"\n                      style=\"width: 100%\"\n                      :options=\"stationPersonOptions\"\n                      @change=\"handleChange\"\n                      :disabled=\"disabledInput\"\n                      labelInValue\n                    />\n                  </template>\n                  <template v-if=\"column.dataIndex === 'outerPersonNames'\">\n                    <a-input\n                      v-model:value=\"record[column.dataIndex]\"\n                      :maxLength=\"1000\"\n                      :disabled=\"disabledInput\"\n                    />\n                  </template>\n                  <template v-if=\"column.dataIndex === 'count'\">\n                    <a-input-number\n                      v-model:value=\"record[column.dataIndex]\"\n                      :maxLength=\"1000\"\n                      :disabled=\"disabledInput\"\n                      :max=\"999\"\n                      :min=\"0\"\n                      :precision=\"0\"\n                    />\n                  </template>\n                  <template v-if=\"column.dataIndex === 'action'\">\n                    <TableAction\n                      :actions=\"[\n                        {\n                          tooltip: '删除',\n                          color: 'error',\n                          icon: 'ant-design:delete-outlined',\n                          ifShow: !disabledInput,\n                          onClick: handleDeleteItem.bind(null, record),\n                        },\n                      ]\"\n                    />\n                  </template>\n                </template>\n              </BasicTable>\n\n              <a-card title=\"演练过程\" :bordered=\"false\">\n                <div style=\"margin: 10px 0 0 20px\">\n                  <Tinymce\n                    v-if=\"visible\"\n                    v-model=\"detailFormState.content\"\n                    :width=\"`calc(100% - 17px)`\"\n                    :height=\"300\"\n                    :maxChars=\"5000\"\n                    :disabled=\"detailFormState.status != 0\"\n                  />\n                </div>\n              </a-card>\n            </a-card>\n            <a-card title=\"上传附件\" :bordered=\"false\">\n              <div style=\"margin: 5px 16px 20px 10px\">\n                <UploadTable\n                  ref=\"uploadTable\"\n                  :rows=\"uploadRows\"\n                  :colwidths=\"['15%', '70%', '15%']\"\n                  :application=\"`po`\"\n                  :module=\"`emergencyDrill`\"\n                  :mode=\"detailFormState.status == 0 ? `normal` : `view`\"\n                />\n              </div>\n            </a-card>\n          </a-form>\n        </div>\n      </div>\n    </a-spin>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import { reactive, ref, onMounted, onActivated, unref, toRaw, nextTick } from 'vue';\n  import {\n    saveData,\n    getIndex,\n    getStationPerson,\n    getDetailList,\n    detailColumns,\n    detailTableProps,\n    getOrgTree,\n  } from './emergencyDrill';\n  import { FormInstance, SelectProps, message } from 'ant-design-vue';\n  import { useRouter } from 'vue-router';\n  import WfApproveBox from '/@/components/Framework/WorkFlow/WfApproveBox.vue';\n  import { assign, cloneDeep } from 'lodash-es';\n  import * as ProcessInstanceApi from '@/api/bpm/processInstance';\n  import BillTitle from '/@/components/Framework/BillTitle/BillTitle.vue';\n  import {\n    BasicTable,\n    useTable,\n    TableAction,\n    EditRecordRow,\n    BasicColumn,\n  } from '/@/components/Table';\n  import type { TreeSelectProps } from 'ant-design-vue';\n  import DictSelectBox from '@/components/Framework/Combox/DictSelectBox.vue';\n  import { IconEnum } from '@/enums/appEnum';\n  import { useI18n } from '@/hooks/web/useI18n';\n  import { Tinymce } from '/@/components/Tinymce/index';\n  import * as FileApi from '@/api/infra/file';\n  import { closeCurrentTab } from '@/utils/route';\n  import { MsgManager } from '/@/message/MsgManager';\n  import { useUserStore } from '/@/store/modules/user';\n  import UploadTable from '/@/components/Framework/Table/UploadTable.vue';\n  import { Memory } from '@/router/index';\n\n  const uploadTable = ref();\n  const uploadRows = ref<any[]>([]);\n  const visible = ref(true);\n  const detailFormState = reactive({ spinning: false });\n  const userStore = useUserStore();\n  const getUserInfo = toRaw(userStore.getUserInfo);\n\n  const orgTreeData = ref<TreeSelectProps['treeData']>();\n  const { t } = useI18n();\n  const detailDataSource = ref<any[]>();\n  const stationPersonOptions = ref<SelectProps['options']>([]) as any;\n  const disabledInput = ref<boolean>(true);\n  const billTitleOption = reactive<any>({});\n  billTitleOption.subject = '应急预案演练';\n  billTitleOption.infoItems = [];\n  const router = useRouter();\n  const { currentRoute } = router;\n  const route = unref(currentRoute);\n  const query = Memory.getInstance().getQuery(); // route.query;\n\n  function handleChangeOperator(value: string, option) {\n    detailFormState.commanderName = option.value;\n    detailFormState.commanderId = option.lable;\n  }\n\n  function handleChange(value: string, option) {\n    // detailFormState.performTeamIds = option.map((item) => item.lable);\n  }\n\n  function initStationPersonOptions() {\n    getStationPerson('?stationId=' + detailFormState.stationId).then((res) => {\n      if (res.result && res.result.length > 0) {\n        res.result.forEach((item) => {\n          stationPersonOptions.value.push({ value: item.name, lable: item.userId });\n        });\n      }\n    });\n  }\n  const formRef = ref<FormInstance>();\n\n  const initOrgTree = async () => {\n    const typeList = await getOrgTree({\n      orgId: detailFormState.stationOrganId,\n      orgKindIds: 'ogn,dpt,pos,psm',\n      showPosition: true,\n      status: 1,\n    });\n    orgTreeData.value = dig(typeList.result);\n  };\n\n  function dig(data) {\n    const list: TreeSelectProps['treeData'] = [];\n    for (let i = 0; i < data.length; i++) {\n      const item = data[i];\n      const treeNode: TreeSelectProps['treeData'][number] = {\n        label: item.name,\n        value: item.id,\n        disabled: item.orgKindId !== 'psm',\n      };\n\n      if (item.children && item.children.length > 0) {\n        treeNode.children = dig(item.children);\n      }\n\n      list.push(treeNode);\n    }\n    return list;\n  }\n\n  function save(status) {\n    const dtlList = ref<any>([]);\n    let totalCount = 0;\n    let cansave = true;\n    let postTaskData = cloneDeep(getTaskDataSource());\n    postTaskData.forEach((data) => {\n      const dtl = ref<any>({});\n      let innerPersonNames = [];\n      let innerPersonIds = [];\n\n      if (Array.isArray(data.innerPersonNames)) {\n        data.innerPersonNames.forEach((item) => {\n          if (item.option != undefined) {\n            innerPersonNames.push(item.option.value);\n            innerPersonIds.push(item.option.lable);\n          }\n        });\n\n        if (innerPersonNames.length > 0) {\n          let pen = innerPersonNames.join(',');\n          let pei = innerPersonIds.join(',');\n          data.innerPersonNames = pen;\n          data.innerPersonIds = pei;\n        } else {\n          let pen = data.innerPersonNames.join(',');\n          let pei = data.innerPersonIds.join(',');\n          data.innerPersonNames = pen;\n          data.innerPersonIds = pei;\n        }\n      }\n\n      if (data.count != null) {\n        totalCount = totalCount + data.count;\n      } else {\n        cansave = false;\n      }\n      assign(dtl.value, data);\n      dtlList.value.push(dtl.value);\n    });\n\n    if (!cansave) {\n      message.warning('请添加参加成员明细人数。');\n      return;\n    }\n\n    if (totalCount == 0) {\n      message.warning('请添加参加成员明细。');\n      return;\n    }\n\n    detailFormState.dtlList = dtlList.value;\n    detailFormState.spinning = true;\n    detailFormState.totalCount = totalCount;\n    try {\n      status = status || 0;\n\n      formRef.value.validateFields().then(() => {\n        detailFormState.status = status;\n        saveData(detailFormState).then((data) => {\n          detailFormState.id = data;\n          getIndex({ id: data }).then((data) => {\n            assign(detailFormState, data.result);\n          });\n          message.success(status == 1 ? '提交成功。' : '保存成功');\n          MsgManager.getInstance().sendMsg('emergencydrill', {});\n          if (status == 1) {\n            disabledInput.value = true;\n            closeCurrentTab();\n          }\n        });\n      });\n    } catch (error) {\n      console.log('error', error);\n    } finally {\n      detailFormState.spinning = false;\n    }\n  }\n\n  const [registerTaskTable, { getDataSource: getTaskDataSource }] = useTable(\n    assign(\n      {\n        dataSource: detailDataSource,\n        columns: detailColumns,\n      },\n      detailTableProps,\n    ),\n  );\n\n  const initTableData = async () => {\n    detailDataSource.value = await getTaskData({});\n  };\n\n  const getTaskData = async (paramObj) => {\n    const param = await getDetailQueryParam(paramObj);\n    const dataObj = await getDetailList(param);\n    dataObj.result.forEach((item) => {\n      if (item.innerPersonNames) {\n        item.innerPersonNames = item.innerPersonNames.split(',');\n      } else {\n        item.innerPersonNames = [];\n      }\n      if (item.innerPersonIds) {\n        item.innerPersonIds = item.innerPersonIds.split(',');\n      } else {\n        item.innerPersonIds = [];\n      }\n    });\n\n    return dataObj.result;\n  };\n\n  const getDetailQueryParam = async (paramObj) => {\n    const id = await getBizParamId();\n    return { emergencyDrillId: paramObj.emergencyDrillId ? paramObj.id : id + '' };\n  };\n\n  function handleAddItem() {\n    const addRow: EditRecordRow = {};\n    pushItemRow(addRow);\n  }\n\n  function pushItemRow(addRow: EditRecordRow) {\n    const data = getTaskDataSource();\n    data.push(addRowOption(addRow));\n  }\n\n  function addRowOption(addRow: EditRecordRow) {\n    addRow.editable = true;\n    addRow.isNew = true;\n    addRow.key = `${Date.now()}`;\n    // addRow.roleName = '';\n    // addRow.innerPersonNames = '';\n    // addRow.outerPersonNames = '';\n    // addRow.count = '';\n    return addRow;\n  }\n\n  function handleDeleteItem(record) {\n    const data = getTaskDataSource();\n    let index = data.indexOf(record);\n    if (index !== -1) {\n      data.splice(index, 1);\n    }\n  }\n\n  function onSubmit() {\n    let canSubmit = true;\n    getUserInfo.orgs.forEach((data) => {\n      if (data.id == detailFormState.personMemberId) {\n        canSubmit = true;\n      }\n    });\n    if (detailFormState.personMemberId != null && !canSubmit) {\n      message.warning('只有创建人可提交。');\n      return;\n    }\n    save(1);\n  }\n\n  function onSave() {\n    save(0);\n  }\n  assign(detailFormState, {\n    processInstanceId: '',\n    id: '',\n    billCode: '',\n    fillinDate: '',\n    organId: '',\n    organName: '',\n    deptId: '',\n    deptName: '',\n    positionId: '',\n    positionName: '',\n    personMemberId: '',\n    personMemberName: '',\n    fullId: '',\n    status: 0,\n    bizFileId: '',\n    subject: '',\n    finishedDate: '',\n    name: '',\n    drillType: '',\n    drillMode: '',\n    commanderId: '',\n    commanderName: '',\n    startTime: '',\n    endTime: '',\n    totalCount: '',\n    content: '',\n  });\n\n  const getBizParamId = async () => {\n    let id = query.id;\n    if (!id && query.processInstanceId) {\n      const processInstance = await ProcessInstanceApi.getProcessInstance(\n        query.processInstanceId as string,\n      );\n      const businessKey = processInstance.businessKey;\n      query.id = businessKey;\n      id = businessKey;\n    }\n    return id;\n  };\n\n  const getRecordable = async () => {\n    disabledInput.value = detailFormState.status != 0;\n    billTitleOption.title = '应急预案演练';\n    detailFormState.processInstanceId = query.processInstanceId;\n    let { billCode, fillinDate, personMemberName, deptName } = detailFormState;\n    assign(billTitleOption, { billCode, fillinDate, personMemberName, deptName });\n  };\n\n  //==================================附件资料  begin ==================================\n\n  const getBizFileId = async () => {\n    FileApi.getBizId().then((res) => {\n      detailFormState.bizFileId = res;\n      handleAttachmentCreate();\n    });\n  };\n\n  const fileList = ref([]);\n  const handleAttachmentCreate = async () => {\n    initUploadRows(detailFormState.bizFileId);\n  };\n  const initUploadRows = (bizId: string) => {\n    const fileTypes = ['应急预案演练'];\n    const fileKindIds = ['emergencyDrill'];\n    const base = {\n      fileKindId: '',\n      filetype: '',\n      bizId: bizId,\n      maxCount: 20,\n      maxSize: 20 * 1024 * 1024,\n      required: false,\n      readonly: true,\n    };\n    const rows = [] as any;\n\n    for (let i = 0; i < 1; i++) {\n      let row = { ...base };\n      row.fileKindId = fileKindIds[i];\n      row.filetype = fileTypes[i];\n      row.readonly = disabledInput.value;\n      rows.push(row);\n    }\n\n    uploadRows.value = rows;\n  };\n\n  const attachmentColumns: BasicColumn[] = [\n    {\n      title: '附件类型',\n      dataIndex: 'fileType',\n      align: 'left',\n      width: 150,\n    },\n    {\n      title: '附件',\n      dataIndex: 'bizFileId',\n      align: 'left',\n      width: 600,\n    },\n  ];\n\n  const [registerAttachmentTable, { getDataSource: getAttachmentDataSource }] = useTable({\n    columns: attachmentColumns,\n    pagination: false,\n    showIndexColumn: false,\n    showTableSetting: false,\n    tableSetting: { fullScreen: true },\n    dataSource: fileList,\n  });\n  //==================================附件资料  end ==================================\n\n  const initPageInfo = async () => {\n    query.id = await getBizParamId();\n\n    await getIndex({ id: query.id }).then((data) => {\n      if (query.id) {\n        assign(detailFormState, data.result);\n        if (\n          detailFormState.status == 0 &&\n          detailFormState.personMemberId.substring(0, 32) != getUserInfo.userId\n        ) {\n          detailFormState.status = 10;\n        }\n      } else {\n        assign(detailFormState, query);\n        detailFormState.spinning = false;\n        detailFormState.status = 0;\n        detailFormState.billCode = data.result.billCode;\n        detailFormState.personMemberName = data.result.personMemberName;\n        detailFormState.fillinDate = data.result.fillinDate;\n        detailFormState.deptName = data.result.deptName;\n      }\n\n      if (detailFormState.status == 1) {\n        disabledInput.value = true;\n      }\n    });\n\n    if (!query.id) {\n      disabledInput.value = false;\n    }\n    await getRecordable();\n\n    initStationPersonOptions();\n    initTableData();\n    initOrgTree();\n\n    if (\n      detailFormState.bizFileId == null ||\n      detailFormState.bizFileId == undefined ||\n      detailFormState.bizFileId == ''\n    ) {\n      getBizFileId();\n    } else {\n      handleAttachmentCreate();\n    }\n  };\n\n  onActivated(() => {\n    visible.value = false;\n    nextTick(() => {\n      visible.value = true;\n    });\n  });\n\n  onMounted(async () => {\n    initPageInfo();\n  });\n</script>\n<style lang=\"less\" scoped></style>\n"],"names":["uploadTable","ref","uploadRows","visible","detailFormState","reactive","userStore","useUserStore","getUserInfo","toRaw","orgTreeData","t","useI18n","detailDataSource","stationPersonOptions","disabledInput","billTitleOption","router","useRouter","currentRoute","unref","query","Memory","handleChangeOperator","value","option","handleChange","initStationPersonOptions","getStationPerson","res","item","formRef","initOrgTree","__async","typeList","getOrgTree","dig","data","list","treeNode","save","status","dtlList","totalCount","cansave","cloneDeep","getTaskDataSource","dtl","innerPersonNames","innerPersonIds","pen","pei","assign","message","saveData","getIndex","MsgManager","closeCurrentTab","error","registerTaskTable","useTable","detailColumns","detailTableProps","initTableData","getTaskData","paramObj","param","getDetailQueryParam","dataObj","getDetailList","id","getBizParamId","handleAddItem","pushItemRow","addRow","addRowOption","handleDeleteItem","record","index","onSubmit","canSubmit","onSave","businessKey","ProcessInstanceApi.getProcessInstance","getRecordable","billCode","fillinDate","personMemberName","deptName","getBizFileId","FileApi.getBizId","handleAttachmentCreate","fileList","initUploadRows","bizId","fileTypes","fileKindIds","base","rows","i","row","__spreadValues","initPageInfo","onActivated","nextTick","onMounted"],"mappings":"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"}