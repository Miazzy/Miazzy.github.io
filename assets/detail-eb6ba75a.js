var c=(h,e,f)=>new Promise((x,D)=>{var I=m=>{try{v(f.next(m))}catch(y){D(y)}},o=m=>{try{v(f.throw(m))}catch(y){D(y)}},v=m=>m.done?x(m.value):Promise.resolve(m.value).then(I,o);v((f=f.apply(h,e)).next())});import{d as X,r as B,k as C,ax as ee,u as k,o as ae,al as p,Z as F,_ as O,f as a,aa as l,$ as w,E as P,ac as te,v as r,A as u,aG as le,aH as se}from"./vue-71d1abb3.js";import{d as ne,a as oe,g as E,b as de,c as ie,s as re,e as ue}from"./index-2fa2e6e6.js";import{B as pe}from"./BasicTable-0434a334.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1ba7be9e.js";import"./index-085d06c7.js";import{u as me}from"./useTable-109483b3.js";import{a2 as ce}from"./antd-15ac76ed.js";import{bP as fe,aC as ve,a7 as be,_ as _e}from"./index.js";import{U as ge}from"./UploadBox-636ecf02.js";import{a as Y}from"./assign-37f1c13d.js";import"./index-316f6ffb.js";import"./useWindowSizeFn-13b1b8a2.js";import"./useRender-21ce56fb.js";import"./useForm-dea3ed18.js";import"./uniqBy-92d3bc7f.js";import"./index-f4fc48e6.js";import"./useTabs-2b062e85.js";import"./download-03e71dd5.js";import"./index-5d49b7a7.js";import"./SearchBox-22bb02d6.js";import"./DictSelectBox.vue_vue_type_script_setup_true_lang-e03e9fe8.js";import"./Dialog-0a006d82.js";import"./OrganDialog-dd1023ce.js";import"./sortable.esm-4ae27e0b.js";import"./dict-c04c0dd8.js";const he=h=>(le("data-v-4ca4ad8f"),h=h(),se(),h),Ce={class:"load"},De={class:"process-box"},Ie={class:"header-box"},ye=he(()=>w("div",{class:"header-left"},"行车记录仪",-1)),we={key:0,class:"header-right"},Ye={class:"content"},xe={class:"clearfix",style:{"padding-left":"15px"}},Me=X({__name:"detail",setup(h){const e=B({spinning:!1}),f=C([]),x=C(!1),D=C(),I=C([]),o=C(!0),v=B({});v.title="行车记录仪设置",v.infoItems=[];const m=ee(),{currentRoute:y}=m,b=k(y).query;function V(s,t){t!=null?(e.identificationCode=t.lable,e.plateNumber=t.value):(e.identificationCode=null,e.plateNumber=null)}function L(){de({}).then(s=>{s.result&&s.result.length>0&&s.result.forEach(t=>{f.value.push({value:t.powerStationName,lable:t.id})})})}function A(s,t){e.stationId!=t.value&&(e.identificationCode=null,e.plateNumber=null),e.stationId=t.lable,q()}function q(){I.value=[],ie("?stationId="+e.stationId).then(s=>{s.result&&s.result.length>0&&s.result.forEach(t=>{I.value.push({lable:t.identificationCode,value:t.plateNumber})})})}const U=C();function j(){ve()}function G(){e.spinning=!0;try{U.value.validateFields().then(()=>{re(e).then(s=>{e.id=s,E({id:s}).then(t=>{Y(e,t.result),T()}),ce.success("保存成功"),be.getInstance().sendMsg("drivingRecorder",{})})})}catch(s){console.log("error",s)}finally{e.spinning=!1}}const[H,{reload:Se}]=me(Y({dataSource:D,columns:ne},oe)),T=()=>c(this,null,function*(){D.value=yield Q({})}),Q=s=>c(this,null,function*(){const t=yield Z(s);return(yield ue(t)).result}),Z=s=>c(this,null,function*(){const t=yield z();return{drivingRecorderId:s.drivingRecorderId?s.id:t+""}});ae(()=>c(this,null,function*(){b.id=yield z(),b.id?yield E({id:b.id}).then(s=>{Y(e,s.result)}):(Y(e,b),e.spinning=!1,e.status=1),o.value=b.disabledInput!="false",yield $(),q(),T(),L(),(e.bizFileId==null||e.bizFileId==null||e.bizFileId=="")&&J()}));const z=()=>c(this,null,function*(){let s=b.id;return!s&&e.id&&(b.id=e.id,s=e.id),s}),$=()=>c(this,null,function*(){v.title="行车记录仪设置"}),J=()=>c(this,null,function*(){fe().then(s=>{e.bizFileId=s})});return(s,t)=>{const M=p("a-button"),_=p("a-input"),d=p("a-form-item"),i=p("a-col"),g=p("a-row"),N=p("a-date-picker"),R=p("a-select"),S=p("a-card"),K=p("a-form"),W=p("a-spin");return F(),O("div",Ce,[a(W,{spinning:e.spinning,tip:"Loading..."},{default:l(()=>[w("div",De,[w("div",Ie,[ye,o.value?te("",!0):(F(),O("div",we,[a(M,{onClick:j},{default:l(()=>[P(" 取消")]),_:1}),a(M,{class:"!ml-4",type:"primary",onClick:G,loading:x.value},{default:l(()=>[P(" 保存")]),_:1},8,["loading"])]))]),w("div",Ye,[a(K,{ref_key:"formRef",ref:U,model:e,labelAlign:"right",autocomplete:"off"},{default:l(()=>[a(S,{title:"基本信息",bordered:!1},{default:l(()=>[a(g,{gutter:24},{default:l(()=>[r(a(i,{span:12},{default:l(()=>[a(d,{name:"assetCode",label:"资产编号",labelCol:{span:6},rules:[{required:!1,message:"请输入资产编号"}]},{default:l(()=>[a(_,{disabled:"",value:e.assetCode,"onUpdate:value":t[0]||(t[0]=n=>e.assetCode=n)},null,8,["value"])]),_:1})]),_:1},512),[[u,!0]]),r(a(i,{span:12},{default:l(()=>[a(d,{name:"deviceType",label:"智能设备类型",labelCol:{span:6},rules:[{required:!0,message:"请输入智能设备类型"}]},{default:l(()=>[a(_,{value:e.deviceType,"onUpdate:value":t[1]||(t[1]=n=>e.deviceType=n),placeholder:"请输入智能设备类型",disabled:""},null,8,["value"])]),_:1})]),_:1},512),[[u,!0]])]),_:1}),a(g,{gutter:24},{default:l(()=>[r(a(i,{span:12},{default:l(()=>[a(d,{name:"deviceCode",label:"设备编号",labelCol:{span:6},rules:[{required:!0,message:"请输入设备编号"}]},{default:l(()=>[a(_,{disabled:o.value,value:e.deviceCode,"onUpdate:value":t[2]||(t[2]=n=>e.deviceCode=n),placeholder:"请输入设备编号",maxlength:100},null,8,["disabled","value"])]),_:1})]),_:1},512),[[u,!0]]),r(a(i,{span:12},{default:l(()=>[a(d,{name:"brand",label:"品牌",labelCol:{span:6},rules:[{required:!0,message:"请输入品牌"}]},{default:l(()=>[a(_,{value:e.brand,"onUpdate:value":t[3]||(t[3]=n=>e.brand=n),placeholder:"请输入品牌",disabled:o.value,maxlength:50},null,8,["value","disabled"])]),_:1})]),_:1},512),[[u,!0]])]),_:1}),a(g,{gutter:24},{default:l(()=>[r(a(i,{span:12},{default:l(()=>[a(d,{name:"model",label:"型号",labelCol:{span:6},rules:[{required:!0,message:"请输入型号"}]},{default:l(()=>[a(_,{value:e.model,"onUpdate:value":t[4]||(t[4]=n=>e.model=n),placeholder:"请输入型号",disabled:o.value,maxlength:50},null,8,["value","disabled"])]),_:1})]),_:1},512),[[u,!0]]),r(a(i,{span:12},{default:l(()=>[a(d,{name:"simNumber",label:"SIM卡号",labelCol:{span:6},rules:[{required:!0,message:"请输入SIM卡号"}]},{default:l(()=>[a(_,{disabled:o.value,value:e.simNumber,"onUpdate:value":t[5]||(t[5]=n=>e.simNumber=n),placeholder:"请输入SIM卡号",maxlength:50},null,8,["disabled","value"])]),_:1})]),_:1},512),[[u,!0]])]),_:1}),a(g,{gutter:24},{default:l(()=>[r(a(i,{span:12},{default:l(()=>[a(d,{name:"purchaseDate",label:"购买日期",labelCol:{span:6},rules:[{required:!0,message:"请选择购买日期"}]},{default:l(()=>[a(N,{value:e.purchaseDate,"onUpdate:value":t[6]||(t[6]=n=>e.purchaseDate=n),format:"YYYY-MM-DD","value-format":"YYYY-MM-DD 00:00:00",style:{width:"100%"},disabled:o.value},null,8,["value","disabled"])]),_:1})]),_:1},512),[[u,!0]]),r(a(i,{span:12},{default:l(()=>[a(d,{name:"startDate",label:"启用日期",labelCol:{span:6},rules:[{required:!0,message:"请选择启用日期"}]},{default:l(()=>[a(N,{value:e.startDate,"onUpdate:value":t[7]||(t[7]=n=>e.startDate=n),format:"YYYY-MM-DD","value-format":"YYYY-MM-DD 00:00:00",style:{width:"100%"},disabled:o.value},null,8,["value","disabled"])]),_:1})]),_:1},512),[[u,!0]])]),_:1}),a(g,{gutter:24},{default:l(()=>[r(a(i,{span:12},{default:l(()=>[a(d,{name:"endDate",label:"有效期止",labelCol:{span:6},rules:[{required:!0,message:"请选择有效期止"}]},{default:l(()=>[a(N,{value:e.endDate,"onUpdate:value":t[8]||(t[8]=n=>e.endDate=n),format:"YYYY-MM-DD","value-format":"YYYY-MM-DD 00:00:00",style:{width:"100%"},disabled:o.value},null,8,["value","disabled"])]),_:1})]),_:1},512),[[u,!0]]),r(a(i,{span:12},{default:l(()=>[a(d,{name:"stationName",label:"所属电站",labelCol:{span:6},rules:[{required:!0,message:"请选择所属电站"}]},{default:l(()=>[a(R,{value:e.stationName,"onUpdate:value":t[9]||(t[9]=n=>e.stationName=n),"allow-clear":"","show-search":"",style:{width:"100%"},placeholder:"请选择电站",options:f.value,disabled:o.value,onChange:A},null,8,["value","options","disabled"])]),_:1})]),_:1},512),[[u,!0]])]),_:1}),a(g,{gutter:24},{default:l(()=>[r(a(i,{span:12},{default:l(()=>[a(d,{name:"plateNumber",label:"当前车牌号",labelCol:{span:6},rules:[{required:!0,message:"请选择当前车牌号"}]},{default:l(()=>[a(R,{value:e.plateNumber,"onUpdate:value":t[10]||(t[10]=n=>e.plateNumber=n),"show-search":"","allow-clear":"",style:{width:"100%"},placeholder:"请选择当前车牌号",options:I.value,onChange:V,disabled:o.value},null,8,["value","options","disabled"])]),_:1})]),_:1},512),[[u,!0]])]),_:1}),a(g,{gutter:24},{default:l(()=>[r(a(i,{span:24},{default:l(()=>[a(d,{name:"remark",label:"备注",labelCol:{span:3},rules:[{required:!1,message:"备注"}]},{default:l(()=>[a(_,{maxlength:500,disabled:o.value,value:e.remark,"onUpdate:value":t[11]||(t[11]=n=>e.remark=n)},null,8,["disabled","value"])]),_:1})]),_:1},512),[[u,!0]])]),_:1})]),_:1}),a(S,{title:"车辆记录",bordered:!1},{default:l(()=>[a(k(pe),{onRegister:k(H)},null,8,["onRegister"])]),_:1}),a(S,{title:"附件信息",bordered:!1},{default:l(()=>[w("div",xe,[a(ge,{width:800,height:550,maxCount:20,maxSize:100*1024*1024,application:"base",module:"drivingRecorder",vmode:o.value?"view":"box",bizId:e.bizFileId},null,8,["vmode","bizId"])])]),_:1})]),_:1},8,["model"])])])]),_:1},8,["spinning"])])}}});const ta=_e(Me,[["__scopeId","data-v-4ca4ad8f"]]);export{ta as default};
//# sourceMappingURL=detail-eb6ba75a.js.map
