{"version":3,"file":"trainingCreate-9d218a7a.js","sources":["../../src/views/po/integrated/training/trainingCreate.vue"],"sourcesContent":["<template>\n  <PageWrapper\n    :detail=\"true\"\n    dense\n    contentFullHeight\n    fixedHeight\n    contentClass=\"fix-detail-page\"\n    style=\"position: relative\"\n  >\n    <div class=\"load\">\n      <a-spin :spinning=\"formState.spinning\" tip=\"Loading...\">\n        <div class=\"process-box\">\n          <!-- 标题和操作按钮 -->\n          <div class=\"header-box\">\n            <BillTitle :options=\"billTitleOption\" />\n            <WfApproveBox\n              @save=\"onSave\"\n              @submit=\"onSubmit\"\n              :processInstanceId=\"formState.processInstanceId\"\n              :processStatus=\"formState.status\"\n            />\n          </div>\n          <!-- 表单内容 -->\n          <div class=\"content\">\n            <a-form ref=\"formRef\" :model=\"formState\" labelAlign=\"right\" autocomplete=\"off\">\n              <a-card title=\"基本信息\" :bordered=\"false\">\n                <a-row :gutter=\"24\">\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"stationName\"\n                      label=\"电站名称\"\n                      :labelCol=\"{ span: 6 }\"\n                      :rules=\"[{ required: false }]\"\n                    >\n                      <a-input disabled v-model:value=\"formState.id\" v-if=\"false\" />\n                      <a-input disabled v-model:value=\"formState.stationId\" v-if=\"false\" />\n                      <a-input disabled v-model:value=\"formState.stationName\" />\n                      <a-input disabled v-model:value=\"formState.stationOrganId\" v-if=\"false\" />\n                      <a-input disabled v-model:value=\"formState.stationOrganName\" v-if=\"false\" />\n                    </a-form-item>\n                  </a-col>\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"trainingType\"\n                      label=\"培训类型\"\n                      :labelCol=\"{ span: 6 }\"\n                      :rules=\"[{ required: true, message: '请选择培训类型' }]\"\n                    >\n                      <DictSelectBox\n                        v-model:value=\"formState.trainingType\"\n                        :type=\"`trainingType`\"\n                        :style=\"`width: 100%`\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n                <a-row :gutter=\"24\">\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"startTime\"\n                      label=\"培训开始时间\"\n                      :labelCol=\"{ span: 6 }\"\n                      :rules=\"[{ required: true, message: '请选择培训开始时间' }]\"\n                    >\n                      <a-date-picker\n                        v-model:value=\"formState.startTime\"\n                        show-time\n                        format=\"YYYY-MM-DD HH:mm:ss\"\n                        value-format=\"YYYY-MM-DD HH:mm:ss\"\n                        :style=\"`width: 100%`\"\n                        :disabled=\"disabledInput\"\n                        @change=\"getHoursByStartTime\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"endTime\"\n                      label=\"培训结束时间\"\n                      :labelCol=\"{ span: 6 }\"\n                      :rules=\"[{ required: true, message: '请选择培训结束时间' }]\"\n                    >\n                      <a-date-picker\n                        v-model:value=\"formState.endTime\"\n                        show-time\n                        format=\"YYYY-MM-DD HH:mm:ss\"\n                        value-format=\"YYYY-MM-DD HH:mm:ss\"\n                        :style=\"`width: 100%`\"\n                        :disabled=\"disabledInput\"\n                        @change=\"getHoursByEndTime\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n                <a-row :gutter=\"24\">\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"trainingHours\"\n                      label=\"培训学时\"\n                      :labelCol=\"{ span: 6 }\"\n                      :rules=\"[{ required: false }]\"\n                    >\n                      <a-input disabled v-model:value=\"formState.trainingHours\" />\n                    </a-form-item>\n                  </a-col>\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"trainingWay\"\n                      label=\"培训方式\"\n                      :labelCol=\"{ span: 6 }\"\n                      :rules=\"[{ required: true, message: '请选择培训方式' }]\"\n                    >\n                      <DictSelectBox\n                        v-model:value=\"formState.trainingWay\"\n                        :type=\"`trainingMethod`\"\n                        :style=\"`width: 100%`\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n                <a-row :gutter=\"24\">\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"plannedNumber\"\n                      label=\"计划人数\"\n                      :labelCol=\"{ span: 6 }\"\n                      :rules=\"[{ required: true, message: '请输入计划人数' }]\"\n                    >\n                      <a-input\n                        v-model:value=\"formState.plannedNumber\"\n                        placeholder=\"请输入计划人数\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"actualNumber\"\n                      label=\"实到人数\"\n                      :labelCol=\"{ span: 6 }\"\n                      :rules=\"[{ required: true, message: '请输入实到人数' }]\"\n                    >\n                      <a-input\n                        v-model:value=\"formState.actualNumber\"\n                        placeholder=\"请输入实到人数\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n                <a-row :gutter=\"24\">\n                  <a-col v-show=\"true\" :span=\"24\">\n                    <a-form-item\n                      name=\"subject\"\n                      label=\"主题\"\n                      :labelCol=\"{ span: 3 }\"\n                      :rules=\"[{ required: true, message: '请输入主题' }]\"\n                    >\n                      <a-input\n                        v-model:value=\"formState.subject\"\n                        placeholder=\"请输入主题\"\n                        :disabled=\"disabledInput\"\n                        :maxlength=\"100\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n              </a-card>\n\n              <a-card title=\"培训目的及内容\" :bordered=\"false\">\n                <div style=\"margin: 10px 0 0 40px\">\n                  <Tinymce\n                    v-model=\"formState.content\"\n                    :width=\"`calc(100% - 20px)`\"\n                    :height=\"300\"\n                    :maxChars=\"20000\"\n                    :disabled=\"formState.status == 0 ? false : true\"\n                  />\n                </div>\n              </a-card>\n\n              <a-card title=\"内外部信息\" :bordered=\"false\">\n                <div id=\"training-tab-content\" class=\"tab-table-div tab-table-content\">\n                  <a-tabs v-model:activeKey=\"activeKey\" @change=\"changeTab()\">\n                    <a-tab-pane key=\"internal\" tab=\"内部信息\">\n                      <BasicTable @register=\"registerInternalTable\">\n                        <template #toolbar>\n                          <a-button\n                            type=\"primary\"\n                            @click=\"handleOpenModal('Internal')\"\n                            :preIcon=\"IconEnum.ADD\"\n                            v-if=\"!disabledInput\"\n                            >{{ t('common.action.create') }}</a-button\n                          >\n                        </template>\n                        <template #bodyCell=\"{ column, record }\">\n                          <template v-if=\"column.key === 'action'\">\n                            <TableAction\n                              :actions=\"[\n                                {\n                                  icon: 'clarity:note-edit-line',\n                                  tooltip: '编辑',\n                                  onClick: handleEdit.bind(null, {\n                                    type: 'Internal',\n                                    data: record,\n                                  }),\n                                },\n                                {\n                                  icon: 'ant-design:delete-outlined',\n                                  color: 'error',\n                                  tooltip: '删除',\n                                  popConfirm: {\n                                    title: '是否确认删除',\n                                    placement: 'left',\n                                    confirm: handleDelete.bind(null, {\n                                      type: 'Internal',\n                                      data: record,\n                                    }),\n                                  },\n                                },\n                              ]\"\n                            />\n                          </template>\n                        </template>\n                      </BasicTable>\n                    </a-tab-pane>\n                    <a-tab-pane key=\"external\" tab=\"外部信息\" force-render>\n                      <BasicTable @register=\"registerExternalTable\">\n                        <template #toolbar>\n                          <a-button\n                            type=\"primary\"\n                            @click=\"handleOpenModal('External')\"\n                            :preIcon=\"IconEnum.ADD\"\n                            v-if=\"!disabledInput\"\n                            >{{ t('common.action.create') }}</a-button\n                          >\n                        </template>\n                        <template #bodyCell=\"{ column, record }\">\n                          <template v-if=\"column.key === 'action'\">\n                            <TableAction\n                              :actions=\"[\n                                {\n                                  icon: 'clarity:note-edit-line',\n                                  tooltip: '编辑',\n                                  ifShow: !disabledInput,\n                                  onClick: handleEdit.bind(null, {\n                                    type: 'External',\n                                    data: record,\n                                  }),\n                                },\n                                {\n                                  icon: 'ant-design:delete-outlined',\n                                  color: 'error',\n                                  tooltip: '删除',\n                                  ifShow: !disabledInput,\n                                  popConfirm: {\n                                    title: '是否确认删除',\n                                    placement: 'left',\n                                    confirm: handleDelete.bind(null, {\n                                      type: 'External',\n                                      data: record,\n                                    }),\n                                  },\n                                },\n                              ]\"\n                            />\n                          </template>\n                        </template>\n                      </BasicTable>\n                    </a-tab-pane>\n                  </a-tabs>\n                </div>\n              </a-card>\n\n              <!-- 内部弹窗页面 -->\n              <Dialog\n                v-model:visible=\"internalModal\"\n                :title=\"internalTitle\"\n                :height=\"400\"\n                :width=\"600\"\n                smode=\"normal\"\n                @ok=\"handleInternalFrom()\"\n                @cancel=\"handleClosedModal('Internal')\"\n              >\n                <a-form ref=\"modalInternalFormRef\" :model=\"inModalFormState\">\n                  <a-row :gutter=\"24\">\n                    <a-col v-show=\"true\" :span=\"24\">\n                      <a-form-item\n                        name=\"teacher\"\n                        label=\"讲师\"\n                        :labelCol=\"{ span: 6 }\"\n                        :rules=\"[{ required: true }]\"\n                      >\n                        <a-tree-select\n                          v-model:value=\"inModalFormState.teacher\"\n                          show-search\n                          style=\"width: 320px\"\n                          allow-clear\n                          tree-default-expand-all\n                          :tree-data=\"orgTeacherData\"\n                          tree-node-filter-prop=\"label\"\n                          @change=\"handleChangeTree\"\n                        />\n                        <a-input\n                          disabled\n                          v-model:value=\"inModalFormState.trainingType\"\n                          v-if=\"false\"\n                        />\n                      </a-form-item>\n                    </a-col>\n                  </a-row>\n                  <a-row :gutter=\"24\">\n                    <a-col v-show=\"true\" :span=\"24\">\n                      <a-form-item\n                        name=\"startTime\"\n                        label=\"开始时间\"\n                        :labelCol=\"{ span: 6 }\"\n                        :rules=\"[{ required: true, message: '请选择开始时间' }]\"\n                      >\n                        <a-date-picker\n                          v-model:value=\"inModalFormState.startTime\"\n                          show-time\n                          format=\"YYYY-MM-DD HH:mm\"\n                          value-format=\"YYYY-MM-DD HH:mm\"\n                          style=\"width: 320px\"\n                          @change=\"getInHoursByStartTime\"\n                        />\n                      </a-form-item>\n                    </a-col>\n                  </a-row>\n                  <a-row :gutter=\"24\">\n                    <a-col v-show=\"true\" :span=\"24\">\n                      <a-form-item\n                        name=\"endTime\"\n                        label=\"结束时间\"\n                        :labelCol=\"{ span: 6 }\"\n                        :rules=\"[{ required: true, message: '请选择结束时间' }]\"\n                      >\n                        <a-date-picker\n                          v-model:value=\"inModalFormState.endTime\"\n                          show-time\n                          format=\"YYYY-MM-DD HH:mm\"\n                          value-format=\"YYYY-MM-DD HH:mm\"\n                          style=\"width: 320px\"\n                          @change=\"getInHoursByEndTime\"\n                        />\n                      </a-form-item>\n                    </a-col>\n                  </a-row>\n                  <a-row :gutter=\"24\">\n                    <a-col v-show=\"true\" :span=\"24\">\n                      <a-form-item\n                        name=\"trainingHours\"\n                        label=\"时长\"\n                        :labelCol=\"{ span: 6 }\"\n                        :rules=\"[{ required: false, message: '请选择结束时间' }]\"\n                      >\n                        <a-input\n                          disabled\n                          v-model:value=\"inModalFormState.trainingHours\"\n                          style=\"width: 320px\"\n                        />\n                      </a-form-item>\n                    </a-col>\n                  </a-row>\n                </a-form>\n              </Dialog>\n\n              <!-- 外部弹窗页面 -->\n              <Dialog\n                v-model:visible=\"externalModal\"\n                :title=\"externalTitle\"\n                :height=\"500\"\n                :width=\"600\"\n                smode=\"normal\"\n                @ok=\"handleExternalFrom()\"\n                @cancel=\"handleClosedModal('External')\"\n              >\n                <a-form ref=\"modalExternalFormRef\" :model=\"exModalFormState\">\n                  <a-row :gutter=\"24\">\n                    <a-col v-show=\"true\" :span=\"24\">\n                      <a-form-item\n                        name=\"trainingCompanyName\"\n                        label=\"外部单位\"\n                        :labelCol=\"{ span: 6 }\"\n                        :rules=\"[{ required: true }]\"\n                      >\n                        <a-input\n                          v-model:value=\"exModalFormState.trainingCompanyName\"\n                          style=\"width: 320px\"\n                        />\n                      </a-form-item>\n                    </a-col>\n                  </a-row>\n                  <a-row :gutter=\"24\">\n                    <a-col v-show=\"true\" :span=\"24\">\n                      <a-form-item\n                        name=\"trainingCost\"\n                        label=\"培训费用\"\n                        :labelCol=\"{ span: 6 }\"\n                        :rules=\"[{ required: true }]\"\n                      >\n                        <a-input\n                          v-model:value=\"exModalFormState.trainingCost\"\n                          style=\"width: 320px\"\n                        />\n                      </a-form-item>\n                    </a-col>\n                  </a-row>\n\n                  <a-row :gutter=\"24\">\n                    <a-col v-show=\"true\" :span=\"24\">\n                      <a-form-item\n                        name=\"teacher\"\n                        label=\"讲师\"\n                        :labelCol=\"{ span: 6 }\"\n                        :rules=\"[{ required: true }]\"\n                      >\n                        <a-input v-model:value=\"exModalFormState.teacher\" style=\"width: 320px\" />\n                        <a-input\n                          disabled\n                          v-model:value=\"exModalFormState.trainingType\"\n                          v-if=\"false\"\n                        />\n                      </a-form-item>\n                    </a-col>\n                  </a-row>\n                  <a-row :gutter=\"24\">\n                    <a-col v-show=\"true\" :span=\"24\">\n                      <a-form-item\n                        name=\"startTime\"\n                        label=\"开始时间\"\n                        :labelCol=\"{ span: 6 }\"\n                        :rules=\"[{ required: true, message: '请选择开始时间' }]\"\n                      >\n                        <a-date-picker\n                          v-model:value=\"exModalFormState.startTime\"\n                          show-time\n                          format=\"YYYY-MM-DD HH:mm\"\n                          value-format=\"YYYY-MM-DD HH:mm\"\n                          style=\"width: 320px\"\n                          @change=\"getExHoursByStartTime\"\n                        />\n                      </a-form-item>\n                    </a-col>\n                  </a-row>\n                  <a-row :gutter=\"24\">\n                    <a-col v-show=\"true\" :span=\"24\">\n                      <a-form-item\n                        name=\"endTime\"\n                        label=\"结束时间\"\n                        :labelCol=\"{ span: 6 }\"\n                        :rules=\"[{ required: true, message: '请选择结束时间' }]\"\n                      >\n                        <a-date-picker\n                          v-model:value=\"exModalFormState.endTime\"\n                          show-time\n                          format=\"YYYY-MM-DD HH:mm\"\n                          value-format=\"YYYY-MM-DD HH:mm\"\n                          style=\"width: 320px\"\n                          @change=\"getExHoursByEndTime\"\n                        />\n                      </a-form-item>\n                    </a-col>\n                  </a-row>\n                  <a-row :gutter=\"24\">\n                    <a-col v-show=\"true\" :span=\"24\">\n                      <a-form-item\n                        name=\"trainingHours\"\n                        label=\"时长\"\n                        :labelCol=\"{ span: 6 }\"\n                        :rules=\"[{ required: false, message: '请选择结束时间' }]\"\n                      >\n                        <a-input\n                          disabled\n                          v-model:value=\"exModalFormState.trainingHours\"\n                          style=\"width: 320px\"\n                        />\n                      </a-form-item>\n                    </a-col>\n                  </a-row>\n                </a-form>\n              </Dialog>\n\n              <a-card title=\"培训记录附件\" :bordered=\"false\">\n                <UploadBox\n                  :width=\"800\"\n                  :height=\"550\"\n                  :maxCount=\"20\"\n                  :maxSize=\"100 * 1024 * 1024\"\n                  :application=\"`po`\"\n                  :module=\"`training`\"\n                  :vmode=\"formState.status == 0 ? `box` : `view`\"\n                  :bizId=\"formState.bizFileId\"\n                />\n              </a-card>\n            </a-form>\n          </div>\n        </div>\n      </a-spin>\n    </div>\n  </PageWrapper>\n</template>\n<script lang=\"ts\" setup>\n  import { reactive, onMounted, UnwrapRef, ref, toRaw, unref } from 'vue';\n  import { useRouter } from 'vue-router';\n  import BillTitle from '/@/components/Framework/BillTitle/BillTitle.vue';\n  import WfApproveBox from '/@/components/Framework/WorkFlow/WfApproveBox.vue';\n  import DictSelectBox from '@/components/Framework/Combox/DictSelectBox.vue';\n  import { ValidateErrorEntity } from 'ant-design-vue/es/form/interface';\n  import * as ProcessInstanceApi from '@/api/bpm/processInstance';\n  import { FormInstance, TreeSelectProps } from 'ant-design-vue';\n  import { SysMessage } from '/@/hooks/web/useMessage';\n  import { assign } from 'lodash-es';\n  import { Tinymce } from '/@/components/Tinymce/index';\n  import { Dayjs } from 'dayjs';\n  import { IconEnum } from '@/enums/appEnum';\n  import { useI18n } from '@/hooks/web/useI18n';\n  import { forEach } from 'min-dash';\n  import { BasicTable, useTable, TableAction, EditRecordRow } from '/@/components/Table';\n  import {\n    getTraining,\n    saveTraining,\n    internalColumns,\n    externalColumns,\n    detailTableProps,\n    getTrainingDtl,\n    getTeacherData,\n  } from './data';\n  import UploadBox from '@/components/Framework/Combox/UploadBox.vue';\n  import * as FileApi from '@/api/infra/file';\n  import { closeCurrentTab } from '@/utils/route';\n  import { MsgManager } from '@/message/MsgManager';\n  import Dialog from '@/components/Framework/Modal/Dialog.vue';\n  import { PageWrapper } from '/@/components/Page';\n  import { Memory } from '@/router/index';\n\n  const { t } = useI18n();\n  const router = useRouter();\n  const { currentRoute } = router;\n  const route = unref(currentRoute);\n  const query = Memory.getInstance().getQuery(); // route.query;\n  const formState: UnwrapRef<any> = reactive({ spinning: false, status: 0 });\n  const formRef = ref<FormInstance>();\n  const disabledInput = ref<boolean>(true);\n  const billTitleOption = reactive<any>({ subject: '培训记录' });\n  billTitleOption.subject = '培训记录';\n\n  const inModalFormState: UnwrapRef<any> = reactive({});\n  const internalModal = ref<boolean>(false);\n  const modalInternalFormRef = ref<FormInstance>();\n  const internalTitle = ref('');\n\n  const exModalFormState: UnwrapRef<any> = reactive({});\n  const externalModal = ref<boolean>(false);\n  const modalExternalFormRef = ref<FormInstance>();\n  const externalTitle = ref('');\n\n  const activeKey = ref('internal');\n\n  const orgTeacherData = ref<TreeSelectProps['treeData']>();\n\n  //组织树初始化getData\n  const initTeacherTree = async () => {\n    const typeList = await getTeacherData({\n      // orgId: '91EEFF16B1FF4F5CBF5CECDB928689DB',\n      orgKindIds: 'ogn,dpt,pos,psm',\n      showPosition: true,\n      status: 1,\n    });\n    orgTeacherData.value = dig(typeList.result);\n  };\n\n  function dig(data) {\n    const list: TreeSelectProps['treeData'] = [];\n    for (let i = 0; i < data.length; i++) {\n      const item = data[i];\n      const treeNode: TreeSelectProps['treeData'][number] = {\n        label: item.name,\n        value: item.id,\n        disabled: item.orgKindId !== 'psm',\n      };\n\n      if (item.children && item.children.length > 0) {\n        treeNode.children = dig(item.children);\n      }\n      list.push(treeNode);\n    }\n    return list;\n  }\n\n  function handleChangeTree(value, label) {\n    inModalFormState.teacherId = value;\n    inModalFormState.teacher = label[0];\n  }\n\n  // tab\n  function changeTab() {\n    if (activeKey.value == 'internal') {\n      getInternalDataSource();\n    } else if (activeKey.value == 'external') {\n      getExternalDataSource();\n    }\n  }\n\n  // const tableRef = ref<{ getTableDataSource: () => any } | null>(null);\n  // 设置富文本框数据绑定对象\n  const content = ref('');\n  // 处理富文本输入框change事件\n  // function handleRichTextChange(value) {\n  // }\n  const internalDataSource = ref<any[]>();\n  const externalDataSource = ref<any[]>();\n\n  onMounted(async () => {\n    assign(formState, query);\n    query.id = await getBizParamId();\n    await getRecordable();\n    if (!query.id) {\n      disabledInput.value = false;\n      getBizFileId();\n    }\n\n    //获取明细数据\n    internalDataSource.value = await getTrainingDtl({\n      poTrainingRecordId: query.id,\n      trainingType: 'Internal',\n    });\n\n    externalDataSource.value = await getTrainingDtl({\n      poTrainingRecordId: query.id,\n      trainingType: 'External',\n    });\n\n    initTeacherTree();\n  });\n\n  const getBizFileId = async () => {\n    FileApi.getBizId().then((res) => {\n      formState.bizFileId = res;\n    });\n  };\n\n  //内部\n  const [registerInternalTable, { getDataSource: getInternalDataSource }] = useTable(\n    assign(\n      {\n        columns: internalColumns,\n        dataSource: internalDataSource,\n        target: '#training-tab-content',\n        targetTabKey: 'internal',\n        targetTabValue: activeKey,\n      },\n      detailTableProps,\n    ),\n  );\n\n  //外部\n  const [registerExternalTable, { getDataSource: getExternalDataSource }] = useTable(\n    assign(\n      {\n        columns: externalColumns,\n        dataSource: externalDataSource,\n        target: '#training-tab-content',\n        targetTabKey: 'external',\n        targetTabValue: activeKey,\n      },\n      detailTableProps,\n    ),\n  );\n\n  //新增\n  function handleOpenModal(type) {\n    if (type === 'Internal') {\n      //打开弹窗\n      internalModal.value = true;\n\n      inModalFormState.teacher = '';\n      inModalFormState.startTime = '';\n      inModalFormState.endTime = '';\n      inModalFormState.trainingHours = '';\n      inModalFormState.trainingType = 'Internal';\n      internalTitle.value = '添加内部信息';\n    }\n    if (type === 'External') {\n      externalModal.value = true;\n      externalTitle.value = '添加外部信息';\n      exModalFormState.trainingType = 'External';\n      exModalFormState.trainingCompanyName = '';\n      exModalFormState.trainingCost = '';\n      exModalFormState.teacher = '';\n      exModalFormState.startTime = '';\n      exModalFormState.endTime = '';\n      exModalFormState.trainingHours = '';\n    }\n  }\n\n  //内部保存\n  function handleInternalFrom() {\n    modalInternalFormRef.value.validateFields().then(() => {\n      const addRow: EditRecordRow = {\n        id: inModalFormState.id,\n        trainingType: inModalFormState.trainingType,\n        teacher: inModalFormState.teacher,\n        startTime: inModalFormState.startTime,\n        endTime: inModalFormState.endTime,\n        trainingHours: inModalFormState.trainingHours,\n        key: inModalFormState.key,\n      };\n      pushItemRow(addRow, 'Internal');\n      handleClosedModal('Internal');\n      assign(inModalFormState, null);\n    });\n  }\n\n  //外部保存\n  function handleExternalFrom() {\n    modalExternalFormRef.value.validateFields().then(() => {\n      const addRow: EditRecordRow = {\n        id: exModalFormState.id,\n        trainingType: exModalFormState.trainingType,\n        trainingCompanyName: exModalFormState.trainingCompanyName,\n        trainingCost: exModalFormState.trainingCost,\n        teacher: exModalFormState.teacher,\n        startTime: exModalFormState.startTime,\n        endTime: exModalFormState.endTime,\n        trainingHours: exModalFormState.trainingHours,\n        key: exModalFormState.key,\n      };\n      pushItemRow(addRow, 'External');\n      assign(exModalFormState, null);\n      handleClosedModal('External');\n    });\n  }\n\n  //编辑\n  function handleEdit({ type, data }) {\n    if (type === 'Internal') {\n      internalTitle.value = '修改内部信息';\n      internalModal.value = true;\n      inModalFormState.id = data.id;\n      inModalFormState.teacher = data.teacher;\n      inModalFormState.startTime = data.startTime;\n      inModalFormState.endTime = data.endTime;\n      inModalFormState.trainingHours = data.trainingHours;\n      inModalFormState.trainingType = data.trainingType;\n      inModalFormState.key = data.key;\n    }\n    if (type === 'External') {\n      externalTitle.value = '修改外部信息';\n      externalModal.value = true;\n      exModalFormState.trainingType = data.trainingType;\n      exModalFormState.trainingCompanyName = data.trainingCompanyName;\n      exModalFormState.trainingCost = data.trainingCost;\n      exModalFormState.teacher = data.teacher;\n      exModalFormState.startTime = data.startTime;\n      exModalFormState.endTime = data.endTime;\n      exModalFormState.trainingHours = data.trainingHours;\n      exModalFormState.key = data.key;\n    }\n  }\n\n  //删除\n  function handleDelete({ type, data }) {\n    const tableData = getDataSource(type);\n    let index = tableData.indexOf(data);\n    if (index !== -1) {\n      tableData.splice(index, 1);\n    }\n  }\n\n  //关闭弹框\n  function handleClosedModal(type) {\n    if (type === 'Internal') {\n      internalModal.value = false;\n    }\n    if (type === 'External') {\n      externalModal.value = false;\n    }\n  }\n\n  function pushItemRow(addRow: EditRecordRow, type: string) {\n    const data = getDataSource(type);\n    if (addRow.key) {\n      forEach(data, function (def) {\n        if (def.key === addRow.key) {\n          def.trainingType = addRow.trainingType;\n          def.trainingCompanyName = addRow.trainingCompanyName;\n          def.trainingCost = addRow.trainingCost;\n          def.teacher = addRow.teacher;\n          def.startTime = addRow.startTime;\n          def.endTime = addRow.endTime;\n          def.trainingHours = addRow.trainingHours;\n          def.isNew = addRow.isNew;\n        }\n      });\n    } else {\n      data.push(addRowOption(addRow));\n    }\n\n    if (addRow.trainingType == 'Internal') {\n      inModalFormState.teacher = '';\n      inModalFormState.startTime = '';\n      inModalFormState.endTime = '';\n      inModalFormState.trainingHours = '';\n      inModalFormState.trainingType = 'Internal';\n      inModalFormState.key = '';\n    } else {\n      exModalFormState.trainingType = 'External';\n      exModalFormState.trainingCompanyName = '';\n      exModalFormState.trainingCost = '';\n      exModalFormState.teacher = '';\n      exModalFormState.startTime = '';\n      exModalFormState.endTime = '';\n      exModalFormState.trainingHours = '';\n      exModalFormState.key = '';\n    }\n  }\n\n  function getDataSource(type) {\n    if (type === 'Internal') {\n      return getInternalDataSource();\n    }\n    if (type === 'External') {\n      return getExternalDataSource();\n    }\n    return [];\n  }\n\n  function addRowOption(addRow: EditRecordRow) {\n    addRow.isNew = true;\n    addRow.key = `${Date.now()}`;\n    return addRow;\n  }\n\n  //计算时长\n  function countHours(startTime, endTime) {\n    if (startTime != '' && endTime != '') {\n      var dateStart = new Date(startTime);\n      var dateEnd = new Date(endTime);\n      var dateDiff = dateEnd.getTime() - dateStart.getTime();\n      return (dateDiff / (3600 * 1000)).toFixed(2);\n    }\n  }\n\n  function getInHoursByStartTime(date: Dayjs | string, dateString: string) {\n    inModalFormState.trainingHours = countHours(dateString, inModalFormState.endTime);\n  }\n\n  const getInHoursByEndTime = (date: Dayjs | string, dateString: string) => {\n    inModalFormState.trainingHours = countHours(inModalFormState.startTime, dateString);\n  };\n\n  const getExHoursByStartTime = (date: Dayjs | string, dateString: string) => {\n    exModalFormState.trainingHours = countHours(dateString, exModalFormState.endTime);\n  };\n  const getExHoursByEndTime = (date: Dayjs | string, dateString: string) => {\n    exModalFormState.trainingHours = countHours(exModalFormState.startTime, dateString);\n  };\n\n  const getHoursByStartTime = (date: Dayjs | string, dateString: string) => {\n    formState.trainingHours = countHours(\n      dateString,\n      formState.endTime == undefined ? '' : formState.endTime,\n    );\n  };\n  const getHoursByEndTime = (date: Dayjs | string, dateString: string) => {\n    formState.trainingHours = countHours(\n      formState.startTime == undefined ? '' : formState.startTime,\n      dateString,\n    );\n  };\n\n  //保存\n  const onSave = () => {\n    const value = formRef.value;\n    if (!value) {\n      return;\n    }\n    value\n      .validateFields()\n      .then(() => {\n        doSave(0);\n      })\n      .catch((error: ValidateErrorEntity<any>) => {\n        console.log('onSubmit=》error', error);\n      });\n  };\n\n  //提交\n  const onSubmit = () => {\n    const value = formRef.value;\n    if (!value) {\n      return;\n    }\n    value\n      .validateFields()\n      .then(() => {\n        const formData = toRaw(formState) as any;\n        if (!compareDate(formData.endTime, formData.startTime)) {\n          error('请确认开始时间和结束时间。');\n          return;\n        }\n\n        if (formData.trainingWay === 'internalTraining') {\n          if (getInternalDataSource().length == 0) {\n            error('内部培训-内部信息不能为空。');\n            return;\n          }\n        }\n        if (formData.trainingWay === 'externalTraining') {\n          if (getExternalDataSource().length == 0) {\n            error('外部培训-外部信息不能为空。');\n            return;\n          }\n        }\n\n        doSave(1);\n      })\n      .catch((error: ValidateErrorEntity<any>) => {\n        console.log('onSubmit=》error', error);\n      });\n  };\n\n  const compareDate = (d1, d2) => {\n    let date1 = new Date(Date.parse(d1));\n    let date2 = new Date(Date.parse(d2));\n    return date1 > date2;\n  };\n\n  const doSave = async (status) => {\n    formState.spinning = true;\n    try {\n      await saveBizData(status);\n    } catch (error) {\n      formState.spinning = false;\n    }\n  };\n\n  function saveBizData(status) {\n    const formData = toRaw(formState) as any;\n    formData.status = status;\n    formData.internalData = getInternalDataSource();\n    formData.externalData = getExternalDataSource();\n    saveTraining(formData)\n      .then((res) => {\n        formState.id = res;\n        getTraining({ id: res }).then((data) => {\n          assign(formState, data.result);\n        });\n        if (status == 1) {\n          disabledInput.value = true;\n          setTimeout(() => {\n            closeCurrentTab();\n            MsgManager.getInstance().sendMsg('training-record', {});\n          }, 100);\n        }\n        formState.spinning = false;\n        success('操作成功');\n      })\n      .catch(() => {\n        formState.spinning = false;\n      });\n  }\n\n  const error = (content) => {\n    SysMessage.getInstance().error(content);\n    formState.spinning = false;\n  };\n\n  const success = (content) => {\n    SysMessage.getInstance().success(content);\n  };\n\n  const getBizParamId = async () => {\n    let id = query.id;\n    if (!id && query.processInstanceId) {\n      const processInstance = await ProcessInstanceApi.getProcessInstance(\n        query.processInstanceId as string,\n      );\n      const businessKey = processInstance.businessKey;\n      query.id = businessKey;\n      id = businessKey;\n    }\n    return id;\n  };\n\n  const getRecordable = async () => {\n    const res = await getTraining({ id: query.id });\n    if (res.result) {\n      if (query.id != '') {\n        assign(formState, res.result);\n      }\n      disabledInput.value = formState.status != 0;\n      if (!formState.processInstanceId) {\n        formState.processInstanceId = query.processInstanceId;\n      }\n      let { billCode, fillinDate, personMemberName, deptName } = res.result;\n      Object.assign(billTitleOption, { billCode, fillinDate, personMemberName, deptName });\n    }\n  };\n</script>\n<style lang=\"less\" scoped>\n  .fix-detail-page {\n    :deep(&.vben-page-wrapper-content.detail-content) {\n      margin: 0;\n    }\n  }\n\n  .process-box {\n    :deep(.vben-basic-table-header__toolbar > button.ant-btn:last-child) {\n      margin-right: 0;\n    }\n\n    :deep(.ant-card) {\n      .ant-tabs-tabpane-active {\n        width: 100%;\n      }\n\n      .ant-card-body {\n        .ant-tabs-nav {\n          padding-right: 16px;\n          padding-left: 16px;\n        }\n      }\n    }\n\n    & > .content {\n      padding-bottom: 10px;\n    }\n  }\n</style>\n"],"names":["t","useI18n","router","useRouter","currentRoute","unref","query","Memory","formState","reactive","formRef","ref","disabledInput","billTitleOption","inModalFormState","internalModal","modalInternalFormRef","internalTitle","exModalFormState","externalModal","modalExternalFormRef","externalTitle","activeKey","orgTeacherData","initTeacherTree","__async","typeList","getTeacherData","dig","data","list","i","item","treeNode","handleChangeTree","value","label","changeTab","getInternalDataSource","getExternalDataSource","internalDataSource","externalDataSource","onMounted","assign","getBizParamId","getRecordable","getBizFileId","getTrainingDtl","FileApi.getBizId","res","registerInternalTable","useTable","internalColumns","detailTableProps","registerExternalTable","externalColumns","handleOpenModal","type","handleInternalFrom","addRow","pushItemRow","handleClosedModal","handleExternalFrom","handleEdit","handleDelete","tableData","getDataSource","index","forEach","def","addRowOption","countHours","startTime","endTime","dateStart","dateEnd","dateDiff","getInHoursByStartTime","date","dateString","getInHoursByEndTime","getExHoursByStartTime","getExHoursByEndTime","getHoursByStartTime","getHoursByEndTime","onSave","doSave","error","onSubmit","formData","toRaw","compareDate","d1","d2","date1","date2","status","saveBizData","saveTraining","getTraining","closeCurrentTab","MsgManager","success","content","SysMessage","id","businessKey","ProcessInstanceApi.getProcessInstance","billCode","fillinDate","personMemberName","deptName"],"mappings":"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"}