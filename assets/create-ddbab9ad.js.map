{"version":3,"file":"create-ddbab9ad.js","sources":["../../src/views/po/assess/template/create.vue"],"sourcesContent":["<template>\n  <PageWrapper\n    :detail=\"true\"\n    dense\n    contentFullHeight\n    fixedHeight\n    contentClass=\"fix-detail-page\"\n    style=\"position: relative\"\n  >\n    <div class=\"load\">\n      <a-spin :spinning=\"formState.spinning\" tip=\"Loading...\">\n        <div class=\"process-box\">\n          <!-- 标题和操作按钮 -->\n          <div class=\"header-box\">\n            <BillTitle :options=\"billTitleOption\" />\n            <WfApproveBox\n              @save=\"onSave\"\n              @submit=\"onSubmit\"\n              :processInstanceId=\"formState.processInstanceId\"\n              :processStatus=\"formState.status\"\n              :listenMessage=\"formState.listenMessage\"\n            />\n            <!-- <PrintButton style=\"margin-left: 10px\" v-if=\"formState.status === 2\" /> -->\n          </div>\n          <!-- 表单内容 -->\n          <div class=\"content\">\n            <a-form ref=\"formRef\" :model=\"formState\" labelAlign=\"right\" autocomplete=\"off\">\n              <a-card title=\"基本信息\" :bordered=\"false\">\n                <a-row :gutter=\"32\">\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"stationName\"\n                      label=\"电站名称\"\n                      :labelCol=\"{ class: 'detail-label' }\"\n                    >\n                      <a-input v-model:value=\"formState.stationName\" disabled />\n                    </a-form-item>\n                  </a-col>\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"periodNames\"\n                      label=\"期数\"\n                      :labelCol=\"{ class: 'detail-label' }\"\n                      :rules=\"[{ required: true, message: '请选择期数' }]\"\n                    >\n                      <a-select\n                        v-model:value=\"formState.periodNames\"\n                        show-search\n                        allow-clear\n                        mode=\"multiple\"\n                        style=\"width: 100%\"\n                        :options=\"stationPeriodOptions\"\n                        @change=\"handleChangePeriodNames\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n\n                <a-row :gutter=\"32\">\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"regulatoryUnitName\"\n                      label=\"监管单位\"\n                      :labelCol=\"{ class: 'detail-label' }\"\n                      :rules=\"[{ required: true, message: '请输入监管单位' }]\"\n                    >\n                      <a-input\n                        v-model:value=\"formState.regulatoryUnitName\"\n                        :maxlength=\"50\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"assessmentUnitName\"\n                      label=\"考核单位\"\n                      :labelCol=\"{ class: 'detail-label' }\"\n                      :rules=\"[{ required: true, message: '请输入考核单位' }]\"\n                    >\n                      <a-input\n                        v-model:value=\"formState.assessmentUnitName\"\n                        :maxlength=\"100\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n\n                <a-row :gutter=\"32\">\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"effectiveDate\"\n                      label=\"考核生效时间\"\n                      :labelCol=\"{ class: 'detail-label' }\"\n                      :rules=\"[{ required: true, message: '请输入考核生效时间' }]\"\n                    >\n                      <a-date-picker\n                        v-model:value=\"formState.effectiveDate\"\n                        picker=\"month\"\n                        format=\"YYYY-MM\"\n                        value-format=\"YYYY-MM\"\n                        :style=\"`width: 100%`\"\n                        :maxlength=\"7\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"desulfurizationPrice\"\n                      label=\"脱硫电价(元)\"\n                      :labelCol=\"{ class: 'detail-label' }\"\n                      :rules=\"[{ required: true, message: '请输入脱硫电价(元)' }]\"\n                    >\n                      <a-input-number\n                        v-model:value=\"formState.desulfurizationPrice\"\n                        :min=\"0.0001\"\n                        :max=\"999.9999\"\n                        :precision=\"4\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n\n                <a-row :gutter=\"32\">\n                  <a-col v-show=\"true\" :span=\"24\">\n                    <a-form-item\n                      name=\"subject\"\n                      label=\"主题\"\n                      :labelCol=\"{ class: 'detail-label' }\"\n                      :rules=\"[{ required: true, message: '请输入主题' }]\"\n                    >\n                      <a-input\n                        v-model:value=\"formState.subject\"\n                        :maxlength=\"100\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n\n                <a-row :gutter=\"32\">\n                  <a-col v-show=\"true\" :span=\"24\">\n                    <a-form-item\n                      name=\"remark\"\n                      label=\"设置说明\"\n                      :labelCol=\"{ class: 'detail-label' }\"\n                    >\n                      <a-textarea\n                        v-model:value=\"formState.remark\"\n                        show-count\n                        :rows=\"4\"\n                        :maxlength=\"1000\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n              </a-card>\n\n              <a-card :bordered=\"false\">\n                <BasicTable title=\"项目明细\" @register=\"registerDetailTable\">\n                  <template #toolbar v-if=\"!disabledInput\">\n                    <a-button\n                      type=\"primary\"\n                      :preIcon=\"IconEnum.ADD\"\n                      @click=\"handleAddItem\"\n                      v-if=\"!disabledInput\"\n                    >\n                      {{ t('common.action.create') }}\n                    </a-button>\n                    <a-button\n                      type=\"primary\"\n                      :preIcon=\"IconEnum.EXPORT\"\n                      @click=\"handleImportItem\"\n                      v-if=\"!disabledInput\"\n                    >\n                      {{ '引用' }}\n                    </a-button>\n                  </template>\n\n                  <template #bodyCell=\"{ column, record }\">\n                    <template v-if=\"column.dataIndex === 'assessIndexKind'\">\n                      <a-textarea\n                        v-model:value=\"record[column.dataIndex]\"\n                        auto-size\n                        :maxlength=\"100\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </template>\n                    <template v-if=\"column.dataIndex === 'assessIndexName'\">\n                      <a-textarea\n                        v-model:value=\"record[column.dataIndex]\"\n                        auto-size\n                        :maxlength=\"100\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </template>\n                    <template v-if=\"column.dataIndex === 'assessDetail'\">\n                      <a-textarea\n                        v-model:value=\"record[column.dataIndex]\"\n                        auto-size\n                        :maxlength=\"1024\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </template>\n                    <template v-if=\"column.dataIndex === 'indexName'\">\n                      <a-select\n                        v-model:value=\"record[column.dataIndex]\"\n                        show-search\n                        allow-clear\n                        style=\"width: 100%; text-align: left\"\n                        :options=\"indexNameOptions\"\n                        @change=\"\n                          (value: string, option) => handleChangeIndexName(value, option, record)\n                        \"\n                        :disabled=\"disabledInput\"\n                      />\n                    </template>\n                    <template v-if=\"column.dataIndex === 'sort'\">\n                      <a-input-number\n                        v-model:value=\"record[column.dataIndex]\"\n                        class=\"input-center\"\n                        :min=\"1\"\n                        :max=\"1000\"\n                        :step=\"1\"\n                        :precision=\"0\"\n                        :disabled=\"disabledInput\"\n                      />\n                    </template>\n                    <template v-if=\"column.dataIndex === 'action'\">\n                      <TableAction\n                        :actions=\"[\n                          {\n                            tooltip: '删除',\n                            color: 'error',\n                            icon: 'ant-design:delete-outlined',\n                            ifShow: !disabledInput,\n                            onClick: handleDeleteItem.bind(null, record),\n                          },\n                        ]\"\n                      />\n                    </template>\n                  </template>\n                </BasicTable>\n              </a-card>\n\n              <a-card title=\"附件资料\" :bordered=\"false\">\n                <UploadBox\n                  :width=\"800\"\n                  :height=\"550\"\n                  :maxCount=\"20\"\n                  :maxSize=\"100 * 1024 * 1024\"\n                  :application=\"`po`\"\n                  :module=\"`assessTemplate`\"\n                  :vmode=\"formState.status === 0 && !disabledInput ? `box` : `view`\"\n                  :bizId=\"formState.bizFileId\"\n                />\n              </a-card>\n            </a-form>\n          </div>\n        </div>\n      </a-spin>\n      <!-- 弹窗页面 -->\n      <Dialog v-model:visible=\"historyItemModal\" title=\"细则模板\" @ok=\"handleOk\" :height=\"600\">\n        <BasicTable\n          class=\"table-in-dialog\"\n          @register=\"registerModalTable\"\n          :searchInfo=\"searchInfo\"\n          :maxHeight=\"340\"\n        />\n      </Dialog>\n    </div>\n  </PageWrapper>\n</template>\n<script lang=\"ts\" setup>\n  import { onMounted, reactive, ref, UnwrapRef, toRaw } from 'vue';\n  import { useUserStore } from '/@/store/modules/user';\n  import { IconEnum } from '@/enums/appEnum';\n  import { useI18n } from '@/hooks/web/useI18n';\n  import { SysMessage } from '@/hooks/web/useMessage';\n  import { ValidateErrorEntity } from 'ant-design-vue/es/form/interface';\n  import type { SelectProps } from 'ant-design-vue';\n  import { FormInstance } from 'ant-design-vue';\n  // import PrintButton from '/@/components/Framework/Button/PrintButton.vue';\n  import Dialog from '@/components/Framework/Modal/Dialog.vue';\n  import { BasicTable, useTable, TableAction, EditRecordRow } from '/@/components/Table';\n  import BillTitle from '/@/components/Framework/BillTitle/BillTitle.vue';\n  import UploadBox from '@/components/Framework/Combox/UploadBox.vue';\n  import WfApproveBox from '/@/components/Framework/WorkFlow/WfApproveBox.vue';\n  import { buildShortUUID } from '@/utils/uuid';\n  import {\n    detailColumns,\n    getDetailList,\n    saveData,\n    getData,\n    getStationPeriod,\n    itemModalColumns,\n    getPage,\n    getTypeIndexList,\n    modalSearchForm,\n    validateDuplicate,\n  } from './template.data';\n  import * as ProcessInstanceApi from '@/api/bpm/processInstance';\n  import { assign } from 'lodash-es';\n  import { trim } from 'xe-utils';\n  import { closeCurrentTab } from '@/utils/route';\n  import { MsgManager } from '/@/message/MsgManager';\n  import { Memory } from '@/router/index';\n\n  const { t } = useI18n();\n  const userStore = useUserStore();\n  const userInfo = toRaw(userStore.getUserInfo);\n  const query = Memory.getInstance().getQuery(); // route.query;\n  console.log(111, query);\n  const formRef = ref<FormInstance>();\n  const formState: UnwrapRef<any> = reactive({\n    spinning: false,\n    status: 0,\n    listenMessage: query.processInstanceId ? undefined : 'assess-template',\n  });\n  const historyItemModal = ref<boolean>(false);\n  const stationPeriodOptions = ref<SelectProps['options']>([]) as any;\n  const indexNameOptions = ref<SelectProps['options']>([]) as any;\n  const billTitleOption = reactive<any>({ subject: '细则模板申请' });\n  const searchInfo = reactive<any>({});\n  const disabledInput = ref<boolean>(true);\n\n  const onSave = () => {\n    doSave(0);\n  };\n\n  const onSubmit = () => {\n    const value = formRef.value;\n    if (!value) {\n      return;\n    }\n    value\n      .validateFields()\n      .then(() => {\n        const detailData = getDetailDataSource();\n        if (detailData.length === 0) {\n          error(`请${t('common.action.create')}项目明细`);\n          return;\n        }\n        for (let i = 0; i < detailData.length; i++) {\n          const item = detailData[i];\n          if (!trim(item.assessIndexKind)) {\n            error('项目明细，类别不能为空');\n            return;\n          }\n          if (!trim(item.assessIndexName)) {\n            error('项目明细，类型不能为空');\n            return;\n          }\n          if (!trim(item.assessDetail)) {\n            error('项目明细，分项不能为空');\n            return;\n          }\n          if (!trim(item.indexId) || !trim(item.indexName) || !trim(item.indexSort)) {\n            error('项目明细，细则指标不能为空');\n            return;\n          }\n          if (!item.sort) {\n            error('项目明细，排序不能为空');\n            return;\n          }\n        }\n        doSave(1);\n      })\n      .catch((errorObj: ValidateErrorEntity<any>) => {\n        console.log('onSubmit=》error', errorObj);\n        const errorFields = errorObj.errorFields;\n        // 表单滚动到第一个报错处(antd),解决form中scrollToFirstError配置无效\n        document\n          .querySelector('.ant-form-item-has-error')\n          ?.scrollIntoView({ behavior: 'smooth', block: 'center' });\n        if (errorFields && errorFields.length > 0) {\n          error(errorFields[0].errors[0]);\n          return;\n        }\n      });\n  };\n\n  const doSave = async (status) => {\n    formState.spinning = true;\n    try {\n      await saveBiz(status);\n    } catch (error) {\n      formState.spinning = false;\n      console.log('error', error);\n    }\n  };\n\n  const saveBiz = async (status) => {\n    convertStr(['Id', 'Name']);\n    const formData = toRaw(formState) as any;\n    formData.status = status;\n    formData.detailList = getDetailDataSource();\n    await saveData(formData)\n      .then((res) => {\n        formState.id = res.result;\n        if (status === 0) {\n          initTableData();\n        } else if (status === 1) {\n          disabledInput.value = true;\n        }\n        formState.spinning = false;\n        if (status === 0 || status === 1) {\n          success('操作成功');\n        }\n        reloadBizTable(status);\n      })\n      .catch(() => {\n        formState.spinning = false;\n      });\n  };\n\n  const reloadBizTable = (status: number) => {\n    if (status === 0 || status === 1) {\n      setTimeout(() => {\n        if (status === 1) {\n          closeCurrentTab();\n        }\n        MsgManager.getInstance().sendMsg('assess-template', {});\n      }, 200);\n    }\n  };\n\n  const error = (content) => {\n    formState.spinning = false;\n    SysMessage.getInstance().error(content);\n  };\n\n  const success = (content) => {\n    SysMessage.getInstance().success(content);\n  };\n\n  const isApplyEdit = () => {\n    const isEdit =\n      formState.status === 0 &&\n      (!formState.personMemberId || formState.personMemberId.indexOf(userInfo.userId) > -1);\n    disabledInput.value = !isEdit;\n  };\n\n  const getRecordable = async () => {\n    const res = await getData({ id: query.id });\n    if (res.result) {\n      assign(formState, res.result);\n      formState.status = Number(formState.status);\n      if (!formState.processInstanceId) {\n        formState.processInstanceId = query.processInstanceId;\n      }\n      const { billCode, fillinDate, personMemberName, deptName } = res.result;\n      Object.assign(billTitleOption, { billCode, fillinDate, personMemberName, deptName });\n      convertArr(['Id', 'Name']);\n      isApplyEdit();\n    }\n  };\n\n  const detailDataSource = ref<any[]>();\n  const [registerDetailTable, { setProps, getDataSource: getDetailDataSource }] = useTable({\n    dataSource: detailDataSource,\n    columns: detailColumns,\n    pagination: false,\n    striped: false,\n    bordered: true,\n    canResize: false,\n  });\n\n  const initTableData = async () => {\n    const dataObj = await getDetailList({ templateId: formState.id });\n    detailDataSource.value = dataObj.result;\n  };\n\n  const getItemModalData = async () => {\n    const paginationRef = getPaginationRef() as any;\n    const param = {\n      stationId: formState.stationId,\n      status: 2,\n      pageNo: paginationRef.current,\n      pageSize: paginationRef.pageSize,\n      sortField: 'fillinDate',\n      sortOrder: 'desc',\n    };\n    assign(param, searchInfo);\n    const dataObj = await getPage(param);\n    return dataObj.result;\n  };\n\n  const [registerModalTable, { getPaginationRef, getSelectRows }] = useTable({\n    api: getItemModalData,\n    columns: itemModalColumns,\n    pagination: true,\n    striped: false,\n    useSearchForm: true,\n    formConfig: modalSearchForm,\n    handleSearchInfoFn(info) {\n      assign(searchInfo, info);\n      return info;\n    },\n    showTableSetting: false,\n    bordered: true,\n    showIndexColumn: true,\n    canResize: true,\n    rowSelection: {\n      type: 'radio',\n    },\n  });\n\n  function handleOk() {\n    const rows = getSelectRows();\n    if (rows.length == 0) {\n      SysMessage.getInstance().error('请选择细则模板');\n      return;\n    }\n    getDetailList({ templateId: rows[0].id }).then((res) => {\n      pushItemRows(res.result);\n      historyItemModal.value = false;\n    });\n  }\n\n  function handleAddItem() {\n    const data = getDetailDataSource();\n    const sort = data.length + 1;\n    pushItemRows([\n      {\n        assessIndexKind: '',\n        assessIndexName: '',\n        assessDetail: '',\n        indexId: '',\n        indexName: '',\n        indexType: '',\n        indexSort: 0,\n        sort: sort,\n      },\n    ]);\n  }\n\n  function pushItemRows(rows: Array<any>) {\n    const data = getDetailDataSource();\n    rows.forEach((item) => {\n      const addRow: EditRecordRow = {\n        assessIndexKind: item.assessIndexKind,\n        assessIndexName: item.assessIndexName,\n        assessDetail: item.assessDetail,\n        indexId: item.indexId,\n        indexName: item.indexName,\n        indexType: item.indexType,\n        indexSort: item.indexSort,\n        sort: item.sort,\n        isNew: true,\n        key: `${Date.now()}`,\n      };\n      data.push(addRow);\n    });\n  }\n\n  function handleDeleteItem(record) {\n    const data = getDetailDataSource();\n    let index = data.indexOf(record);\n    if (index !== -1) {\n      data.splice(index, 1);\n    }\n  }\n\n  const handleChangePeriodNames = async (value: string, option) => {\n    formState.periodIds = option.map((item) => item.lable);\n    try {\n      await validateDuplicate({\n        id: formState.id,\n        stationId: formState.stationId,\n        periodId: formState.periodIds.join(','),\n      });\n    } catch (error) {\n      formState.periodIds = [];\n      formState.periodNames = [];\n    }\n  };\n\n  function handleChangeIndexName(value: string, option, record) {\n    record.indexId = option?.lable;\n    record.indexType = option?.type;\n    record.indexSort = option?.sort;\n  }\n\n  function initStationPeriodOptions() {\n    getStationPeriod({ stationId: formState.stationId }).then((res) => {\n      if (res.result && res.result.length > 0) {\n        res.result.forEach((item) => {\n          stationPeriodOptions.value.push({ value: item.name, lable: item.id });\n        });\n      }\n    });\n  }\n\n  function initIndexNameOptions() {\n    getTypeIndexList({}).then((res) => {\n      if (res.result && res.result.length > 0) {\n        res.result.forEach((item) => {\n          indexNameOptions.value.push({\n            value: item.name,\n            lable: item.id,\n            sort: item.sort,\n            type: item.type,\n          });\n        });\n      }\n    });\n  }\n\n  function convertStr(suffixs: Array<string>) {\n    suffixs.forEach((suffix) => {\n      const fields = ref<Array<string>>(['period']);\n      fields.value.forEach((item) => {\n        const value = formState[item + suffix + 's'];\n        if (value && value.length > 0) {\n          formState[item + suffix] = value.join(',');\n        }\n      });\n    });\n  }\n\n  function convertArr(suffixs: Array<string>) {\n    suffixs.forEach((suffix) => {\n      const fields = ref<Array<string>>(['period']);\n      fields.value.forEach((item) => {\n        const value = formState[item + suffix];\n        if (value) {\n          formState[item + suffix + 's'] = value.split(',');\n        }\n      });\n    });\n  }\n\n  function handleImportItem() {\n    historyItemModal.value = true;\n  }\n\n  const getBizParamId = async () => {\n    let id = query.id;\n    if (!id && query.processInstanceId) {\n      const processInstance = (await ProcessInstanceApi.getProcessInstance(\n        query.processInstanceId as string,\n      )) as any;\n      const businessKey = processInstance.businessKey;\n      query.id = businessKey;\n      id = businessKey;\n    }\n    return id;\n  };\n\n  function setTableProps() {\n    setProps({\n      actionColumn: {\n        width: 80,\n        title: '操作',\n        dataIndex: 'action',\n        ifShow: !disabledInput.value,\n      },\n    });\n  }\n\n  onMounted(async () => {\n    query.id = await getBizParamId();\n    await getRecordable();\n    if (!query.id) {\n      assign(formState, query);\n      disabledInput.value = false;\n      formState.bizFileId = buildShortUUID();\n    }\n    initStationPeriodOptions();\n    initIndexNameOptions();\n    initTableData();\n    setTableProps();\n  });\n</script>\n<style lang=\"less\" scoped>\n  @import '/@/design/biz/bizForm.less';\n</style>\n"],"names":["t","useI18n","userStore","useUserStore","userInfo","toRaw","query","Memory","formRef","ref","formState","reactive","historyItemModal","stationPeriodOptions","indexNameOptions","billTitleOption","searchInfo","disabledInput","onSave","doSave","onSubmit","value","detailData","getDetailDataSource","error","i","item","trim","errorObj","errorFields","_a","status","__async","saveBiz","convertStr","formData","saveData","res","initTableData","success","reloadBizTable","closeCurrentTab","MsgManager","content","SysMessage","isApplyEdit","isEdit","getRecordable","getData","assign","billCode","fillinDate","personMemberName","deptName","convertArr","detailDataSource","registerDetailTable","setProps","useTable","detailColumns","dataObj","getDetailList","getItemModalData","paginationRef","getPaginationRef","param","getPage","registerModalTable","getSelectRows","itemModalColumns","modalSearchForm","info","handleOk","rows","pushItemRows","handleAddItem","sort","data","addRow","handleDeleteItem","record","index","handleChangePeriodNames","option","validateDuplicate","handleChangeIndexName","initStationPeriodOptions","getStationPeriod","initIndexNameOptions","getTypeIndexList","suffixs","suffix","handleImportItem","getBizParamId","id","businessKey","ProcessInstanceApi.getProcessInstance","setTableProps","onMounted","buildShortUUID"],"mappings":"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"}