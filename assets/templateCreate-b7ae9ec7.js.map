{"version":3,"file":"templateCreate-b7ae9ec7.js","sources":["../../src/views/po/integrated/assessmentevaluation/template/templateCreate.vue"],"sourcesContent":["<template>\n  <PageWrapper\n    :detail=\"true\"\n    dense\n    contentFullHeight\n    fixedHeight\n    contentClass=\"fix-detail-page\"\n    style=\"position: relative\"\n  >\n    <div class=\"load\">\n      <div class=\"process-box\">\n        <div class=\"header-box\">\n          <!-- 标题 -->\n          <BillTitle :options=\"billTitleOptions\" />\n          <!-- <PrintButton v-if=\"formState.status === 2 ? true : false\" /> -->\n          <WfApproveBox\n            @save=\"onSave\"\n            @submit=\"onSubmit\"\n            :processStatus=\"formState.status\"\n            :processInstanceId=\"formState.processInstanceId\"\n          />\n        </div>\n\n        <!-- 表单内容 -->\n        <div class=\"content\">\n          <div class=\"left-panel\">\n            <a-form ref=\"templateFormRef\" :model=\"formState\" name=\"Form\">\n              <!-- <a-divider orientation=\"left\" orientation-margin=\"10px\">\n              <Icon icon=\"clarity:bookmark-line\" />基础信息</a-divider\n            > -->\n\n              <a-card title=\"基本信息\" :bordered=\"false\">\n                <a-row>\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      label=\"主题\"\n                      name=\"subject\"\n                      labelAlign=\"right\"\n                      :labelCol=\"{ span: 4 }\"\n                      :rules=\"[{ required: true, message: '请输入主题' }]\"\n                    >\n                      <a-input\n                        v-model:value=\"formState.subject\"\n                        :disabled=\"iProcess\"\n                        style=\"width: 100%\"\n                        maxlength=\"128\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      label=\"生效月份\"\n                      name=\"effectiveMonth\"\n                      labelAlign=\"right\"\n                      :labelCol=\"{ span: 4 }\"\n                      :rules=\"[{ required: true, message: '请选择月份' }]\"\n                    >\n                      <a-date-picker\n                        v-model:value=\"formState.effectiveMonth\"\n                        value-format=\"YYYY-MM\"\n                        :disabled=\"iProcess\"\n                        @change=\"changeReportDay\"\n                        style=\"min-width: 100%\"\n                        picker=\"month\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                  <a-col v-show=\"true\" :span=\"24\" class=\"textarea-item\">\n                    <a-form-item\n                      label=\"设置说明\"\n                      name=\"description\"\n                      labelAlign=\"right\"\n                      :labelCol=\"{ span: 2 }\"\n                    >\n                      <a-textarea\n                        :rows=\"1\"\n                        v-model:value=\"formState.description\"\n                        :maxlength=\"1000\"\n                        :disabled=\"iProcess\"\n                        show-count\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n              </a-card>\n            </a-form>\n\n            <a-card title=\"指标构成\" :bordered=\"false\">\n              <template #extra\n                ><a-button\n                  class=\"tab-button\"\n                  type=\"primary\"\n                  :disabled=\"iProcess\"\n                  :preIcon=\"IconEnum.ADD\"\n                  @click=\"openIndexModel\"\n                  >选择指标</a-button\n                >\n                <a-button\n                  class=\"tab-button\"\n                  type=\"primary\"\n                  :disabled=\"iProcess\"\n                  :preIcon=\"IconEnum.ADD\"\n                  @click=\"openTemplateHis\"\n                  >获取历史版本</a-button\n                >\n                <a-button\n                  style=\"margin-right: 18px\"\n                  class=\"tab-button red-btn\"\n                  :preIcon=\"IconEnum.DELETE\"\n                  :disabled=\"!hasSelected || iProcess\"\n                  @click=\"delIndex\"\n                  >删除\n                </a-button></template\n              >\n\n              <a-table\n                style=\"margin: 0 9px 0 8px\"\n                :columns=\"indexColumns\"\n                :data-source=\"indexList\"\n                :pagination=\"false\"\n                size=\"small\"\n                bordered\n                rowKey=\"id\"\n                :row-selection=\"{ selectedRowKeys: selectedRowKeys, onChange: onSelectChange }\"\n                :scroll=\"{ x: 480, y: 300 }\"\n              >\n                <template #bodyCell=\"{ column, text, record }\">\n                  <template v-if=\"['score', 'maxAdditionalScore'].includes(column.dataIndex)\"\n                    ><div>\n                      <a-input-number\n                        v-if=\"true\"\n                        v-model:value=\"record[column.dataIndex]\"\n                        @change=\"colProportion(record)\"\n                        :min=\"0\"\n                        :max=\"9999\"\n                        :disabled=\"iProcess\"\n                        :controls=\"false\"\n                        style=\"margin: -5px 0\"\n                      />\n                    </div>\n                  </template>\n                </template>\n              </a-table>\n            </a-card>\n\n            <a-card title=\"指标占比\" :bordered=\"false\">\n              <a-table\n                style=\"margin: 0 9px 0 8px\"\n                :columns=\"proportionColumns\"\n                :data-source=\"proportionList\"\n                :pagination=\"false\"\n                size=\"small\"\n                bordered\n                :scroll=\"{ x: 480, y: 400 }\"\n              >\n                <template #summary>\n                  <a-table-summary-row>\n                    <a-table-summary-cell type=\"success\">合计</a-table-summary-cell>\n                    <a-table-summary-cell>\n                      <a-typography-text type=\"success\">{{ totals.totalScore }}</a-typography-text>\n                    </a-table-summary-cell>\n                    <a-table-summary-cell>\n                      <a-typography-text type=\"success\">{{\n                        totals.totalProportion\n                      }}</a-typography-text>\n                    </a-table-summary-cell>\n                  </a-table-summary-row>\n                </template>\n                <template #bodyCell=\"{ column, text, record }\">\n                  <template v-if=\"'proportion' == column.dataIndex\"\n                    ><div>\n                      <a-input-number\n                        v-if=\"true\"\n                        v-model:value=\"record[column.dataIndex]\"\n                        :min=\"1\"\n                        :max=\"9999\"\n                        :disabled=\"iProcess\"\n                        :controls=\"false\"\n                        style=\"margin: -5px 0\"\n                      />\n                      <template v-else>\n                        {{ text }}\n                      </template></div\n                    >\n                  </template>\n                </template>\n              </a-table>\n            </a-card>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 指标选择弹窗 -->\n    <indexModel\n      @register=\"registerModal\"\n      :minHeight=\"500\"\n      :maxWidth=\"200\"\n      @selected-index=\"selectedIndex\"\n      :fIndexList=\"indexList\"\n    />\n    <!-- 历史模板弹窗 -->\n    <templateHisModel\n      @register=\"registerModalHis\"\n      :minHeight=\"500\"\n      :width=\"800\"\n      @selected-temp-id=\"selectedTempId\"\n    />\n  </PageWrapper>\n</template>\n<script lang=\"ts\" setup>\n  import { computed, onMounted, reactive, ref, unref, UnwrapRef } from 'vue';\n  import BillTitle from '/@/components/Framework/BillTitle/BillTitle.vue';\n  import { useI18n } from '@/hooks/web/useI18n';\n  import { useMessage } from '@/hooks/web/useMessage';\n  import { useRouter } from 'vue-router';\n  import { useModal } from '/@/components/Modal';\n  import indexModel from './indexModel.vue';\n  import templateHisModel from './templateHisModel.vue';\n  import { IconEnum } from '@/enums/appEnum';\n  import { assign } from 'lodash-es';\n  import * as ProcessInstanceApi from '@/api/bpm/processInstance';\n  import { PageWrapper } from '/@/components/Page';\n  // import { Icon } from '@iconify/vue';\n  import Icon from '@/components/Icon/Icon.vue';\n  import { message, FormInstance } from 'ant-design-vue';\n  import { PlusOutlined, RestOutlined } from '@ant-design/icons-vue';\n  import WfApproveBox from '/@/components/Framework/WorkFlow/WfApproveBox.vue';\n  import PrintButton from '/@/components/Framework/Button/PrintButton.vue';\n  import {\n    getDetailColumns,\n    getproportionColumns,\n    getDetailList,\n    saveTemplate,\n    getTemplate,\n  } from './template';\n  import { useTabs } from '/@/hooks/web/useTabs';\n  import { addTabPage, closeCurrentTab } from '@/utils/route';\n  import { SysMessage } from '/@/hooks/web/useMessage';\n  import { MsgManager } from '@/message/MsgManager';\n  import { Memory } from '@/router/index';\n\n  const { closeCurrentPage } = useTabs();\n  defineOptions({ name: 'LeaveCreate' });\n  const { t } = useI18n();\n  const router = useRouter();\n  const { currentRoute } = router;\n  const route = unref(currentRoute);\n  const query = Memory.getInstance().getQuery(); // route.query;\n  interface FormState {}\n  const processInstanceId = ref(null);\n  const iProcess = ref<boolean>(false);\n  const templateId = ref('');\n  const indexColumns = getDetailColumns();\n  const proportionColumns = getproportionColumns();\n  const indexList = ref([]);\n  const proportionList = ref([]);\n  const templateFormRef = ref<FormInstance>();\n  const formState: UnwrapRef<FormState> = reactive({ status: 0 });\n  const modalOptions = { width: 1200, height: 600, visible: true }; // 弹框属性\n  const [registerModal, { openModal: openModelIndex }] = useModal();\n  const modalOptionsHis = { width: 1200, height: 600, visible: true }; // 弹框属性\n  const [registerModalHis, { openModal: opModelHis }] = useModal();\n\n  const flowData = ref([]);\n\n  const selectedIndex = (selectedIndex: []) => {\n    let selectedTempArr = [];\n    selectedIndex.forEach((item) => {\n      let temp = {\n        indexCode: item.code,\n        indexKind: item.kind,\n        indexName: item.name,\n        evaluationIndexId: item.id,\n        indexKindText: item.kindText,\n        evaluationMethod: item.evaluationMethod,\n        assessTarget: item.assessTarget,\n        scoreRuleDesc: item.scoreRuleDesc,\n        allowOverrun: item.allowOverrun,\n      };\n      selectedTempArr.push(temp);\n    });\n    // selectedIndex.map((item) => {\n    //   item.indexCode = item.code;\n    //   item.indexKind = item.kind;\n    //   item.indexName = item.name;\n    //   item.evaluationIndexId = item.id;\n    //   item.indexKindText = item.kindText;\n    // });\n    let indexIdList = indexList.value.map((item) => item.evaluationIndexId);\n    selectedTempArr.forEach((item) => {\n      if (indexIdList.indexOf(item.evaluationIndexId) == -1) {\n        indexList.value.push(item);\n      }\n    });\n    // 计算占比数据\n    colProportion();\n  };\n\n  const selectedTempId = (selectedTempId: string) => {\n    // 根据模板获取模板明细数据\n    templateId.value = selectedTempId;\n    // 计算占比数据\n    loadDetailList();\n  };\n  const billTitleOptions = reactive<any>({});\n  billTitleOptions.subject = '评价模板';\n  billTitleOptions.infoItems = [];\n\n  //-------------------------------------------------------计算-------------------------------------------------------------\n  //-------------------------------------------------------模板明细相关-------------------------------------------------------------\n\n  type Key = string | number;\n  const state = reactive<{\n    selectedRowKeys: Key[];\n    loading: boolean;\n  }>({\n    selectedRowKeys: [], // Check here to configure the default column\n    loading: false,\n  });\n  const hasSelected = computed(() => state.selectedRowKeys.length > 0);\n  const start = () => {\n    state.loading = true;\n    // ajax request after empty completing\n    setTimeout(() => {\n      state.loading = false;\n      state.selectedRowKeys = [];\n    }, 1000);\n  };\n  const onSelectChange = (selectedRowKeys: Key[]) => {\n    console.log('selectedRowKeys changed: ', selectedRowKeys);\n    state.selectedRowKeys = selectedRowKeys;\n  };\n\n  // 打开指标选择弹窗\n  function openIndexModel() {\n    openModelIndex(modalOptions, {});\n  }\n\n  // 打开指标选择弹窗\n  function openTemplateHis() {\n    opModelHis(modalOptionsHis, {});\n  }\n\n  // 删除明细\n  function delIndex() {\n    indexList.value = indexList.value.filter((item) => state.selectedRowKeys.indexOf(item.id) == -1);\n    // 计算占比数据\n    colProportion();\n  }\n\n  // 根据模板id获取明细列表\n  function loadDetailList() {\n    getDetailList({ evaluationTemplateId: templateId.value }).then((data) => {\n      indexList.value = data;\n      colProportion();\n    });\n  }\n  // 输入分数计算占比数据\n  function colProportion() {\n    if (indexList.value.length == 0) {\n      return;\n    }\n    let indexTempList = indexList.value;\n    let kindArr = [];\n    indexTempList.forEach(function (v, i) {\n      if (!kindArr.includes(v.indexKind)) {\n        kindArr.push(v.indexKind);\n      }\n    });\n    let proporTempList = [];\n    if (kindArr.length > 0) {\n      let totalScore: number = 0;\n      kindArr.forEach(function (pv) {\n        let curScore: number = 0;\n        let curItem = {};\n        let kindName: string;\n        indexTempList.forEach(function (iv) {\n          if (iv.indexKind == pv) {\n            curScore = curScore + (iv.score == null ? 0 : iv.score);\n            kindName = iv.indexKindText;\n          }\n        });\n        totalScore = totalScore + curScore;\n        curItem.presetScore = curScore;\n        curItem.kindName = kindName;\n        curItem.indexKind = pv;\n        proporTempList.push(curItem);\n      });\n      // 占比计算\n      // 除最后一项的占比总和\n      let preTotal: number = 0;\n      for (let i = 0; i < proporTempList.length - 1; i++) {\n        if (proporTempList[i].presetScore > 0) {\n          let proportion = (proporTempList[i].presetScore / totalScore) * 100;\n          proporTempList[i].proportion = Math.round(proportion);\n          preTotal = preTotal + Math.round(proportion);\n          proporTempList[i].presetTotalScore = totalScore;\n        } else {\n          proporTempList[i].proportion = 0;\n        }\n      }\n      // 总数-前项总数= 最后一项占比，避免总占比和不为100;\n      let lastProportion: number =\n        preTotal > 0\n          ? 100 - preTotal\n          : proporTempList[proporTempList.length - 1].presetScore > 0\n          ? 100\n          : 0;\n      proporTempList[proporTempList.length - 1].proportion = lastProportion;\n      proporTempList[proporTempList.length - 1].presetTotalScore = totalScore;\n      proportionList.value = proporTempList;\n    }\n  }\n\n  // 占比合计行数据\n  const totals = computed(() => {\n    let totalScore: number = 0;\n    proportionList.value.forEach((item) => {\n      totalScore += item.presetScore;\n    });\n    let totalProportion: number = totalScore > 0 ? 100 : 0;\n    return { totalScore, totalProportion };\n  });\n  //-------------------------------------------------------流程相关操作-------------------------------------------------------------\n\n  const onSave = () => {\n    doSave(0);\n  };\n\n  const onSubmit = () => {\n    doSave(1);\n  };\n\n  const doSave = (status: number) => {\n    templateFormRef.value.validateFields().then(() => {\n      // 校验是否有指标明细\n      if (indexList.value.length == 0) {\n        message.error('必须选择指标明细。');\n        return;\n      }\n      // 校验是否有为填分值的数据\n\n      let item = indexList.value.find((item) => {\n        if (item.score == null) {\n          message.error('必须填写分值。');\n          return true;\n        }\n      });\n      if (item != null) {\n        return true;\n      }\n      // 校验是否设置占比数据\n      if (proportionList.value.length == 0) {\n        message.error('必须设置占比数据。');\n        return;\n      }\n      // 校验占比数据是否异常\n      let totalPro = 0;\n      proportionList.value.forEach((item) => {\n        totalPro = totalPro + item.proportion;\n      });\n      if (totalPro != 100) {\n        message.error('占比总和必须为100。');\n        return;\n      }\n      formState.detailList = indexList.value;\n      formState.proportionList = proportionList.value;\n      saveTemplate({ ...formState, status: status })\n        .then((data) => {\n          formState.status = status;\n          if (status >= 1) {\n            setTimeout(function () {\n              MsgManager.getInstance().sendMsg('evaluation-template', {});\n              closeCurrentTab();\n            }, 500);\n          } else {\n            SysMessage.getInstance().success('保存成功');\n            templateId.value = data.result;\n            formState.id = data.result;\n            loadTemplate();\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    });\n  };\n\n  const loadBizBaseInfo = async (res: any) => {\n    let { billCode, fillinDate, personMemberName, deptName } = res;\n    Object.assign(billTitleOptions, { billCode, fillinDate, personMemberName, deptName });\n  };\n\n  // 填充流程数和业务数据\n  function loadTemplate() {\n    getTemplate(templateId.value).then((res) => {\n      // 填充业务数据\n      assign(formState, res);\n      if (!formState.processInstanceId) {\n        formState.processInstanceId = query.processInstanceId;\n      }\n      iProcess.value = res.status > 0;\n      loadBizBaseInfo(res);\n      // 加载明细数据；\n      loadDetailList();\n    });\n  }\n\n  onMounted(async () => {\n    assign(formState, query);\n    if (query.id) {\n      templateId.value = query.id;\n      await loadTemplate();\n    } else if (query.processInstanceId) {\n      processInstanceId.value = query.processInstanceId as unknown as string;\n      ProcessInstanceApi.getProcessInstance(processInstanceId.value).then((res) => {\n        templateId.value = res.businessKey;\n        loadTemplate();\n      });\n    } else {\n      let res = await getTemplate('');\n      loadBizBaseInfo(res);\n      formState.billCode = res.billCode;\n      formState.fillinDate = res.fillinDate;\n    }\n  });\n</script>\n<style lang=\"less\" scoped>\n  .tab-button {\n    margin: 4px 5px;\n  }\n\n  .fix-detail-page {\n    :deep(&.vben-page-wrapper-content.detail-content) {\n      margin: 0;\n    }\n  }\n</style>\n"],"names":["useTabs","useI18n","router","useRouter","currentRoute","unref","query","Memory","processInstanceId","ref","iProcess","templateId","indexColumns","getDetailColumns","proportionColumns","getproportionColumns","indexList","proportionList","templateFormRef","formState","reactive","modalOptions","registerModal","openModelIndex","useModal","modalOptionsHis","registerModalHis","opModelHis","selectedIndex","selectedTempArr","item","temp","indexIdList","colProportion","selectedTempId","loadDetailList","billTitleOptions","state","hasSelected","computed","onSelectChange","selectedRowKeys","openIndexModel","openTemplateHis","delIndex","getDetailList","data","indexTempList","kindArr","v","i","proporTempList","totalScore","pv","curScore","curItem","kindName","iv","preTotal","proportion","lastProportion","totals","totalProportion","onSave","doSave","onSubmit","status","message","totalPro","saveTemplate","__spreadProps","__spreadValues","MsgManager","closeCurrentTab","SysMessage","loadTemplate","err","loadBizBaseInfo","res","__async","billCode","fillinDate","personMemberName","deptName","getTemplate","assign","onMounted","ProcessInstanceApi.getProcessInstance"],"mappings":"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"}