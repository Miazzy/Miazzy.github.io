var f=(S,d,i)=>new Promise((v,t)=>{var y=l=>{try{_(i.next(l))}catch(c){t(c)}},C=l=>{try{_(i.throw(l))}catch(c){t(c)}},_=l=>l.done?v(l.value):Promise.resolve(l.value).then(y,C);_((i=i.apply(S,d)).next())});import{d as K,r as W,k as T,o as L,al as u,Z as m,_ as p,f as e,aa as a,$ as R,u as B,F as I,ad as w,ac as M,a5 as U,v as b,A as h}from"./vue-71d1abb3.js";import{K as O}from"./antd-15ac76ed.js";import{D as Z}from"./Dialog-0a006d82.js";import{B as G}from"./BasicTable-0434a334.js";import{m as J}from"./BasicForm.vue_vue_type_style_index_0_lang-1ba7be9e.js";import"./index-085d06c7.js";import{u as Q}from"./useTable-109483b3.js";import{a7 as X,at as ee,ax as V,_ as te}from"./index.js";import{i as ae,j as se,k as oe}from"./data-70d59c19.js";import{a as q}from"./assign-37f1c13d.js";import"./useForm-dea3ed18.js";import"./uniqBy-92d3bc7f.js";import"./index-316f6ffb.js";import"./useWindowSizeFn-13b1b8a2.js";import"./index-f4fc48e6.js";import"./useTabs-2b062e85.js";import"./download-03e71dd5.js";import"./index-5d49b7a7.js";import"./SearchBox-22bb02d6.js";import"./UploadBox-636ecf02.js";import"./DictSelectBox.vue_vue_type_script_setup_true_lang-e03e9fe8.js";import"./OrganDialog-dd1023ce.js";import"./sortable.esm-4ae27e0b.js";import"./dict-c04c0dd8.js";const ne={class:"card-content"},le={class:"table-box"},ie=["onClick","title"],re=["title"],de=["onClick"],ue=K({__name:"WorkReminder",setup(S){const d=W({open:T(!1)}),i=T(!1),v=T(),t=W({}),y={0:"red-text",1:"blue-text"},C=[{title:"类型",dataIndex:"type",width:80,customRender:({record:s})=>s.typeText},{title:"内容",dataIndex:"content",headAlign:"center",align:"left",width:220},{title:"时间",dataIndex:"reminderTime",width:100},{title:"状态",dataIndex:"status",width:60}],_=()=>f(this,null,function*(){const s=O().format("YYYY-MM-DD");return yield oe({workDate:s})}),[l,{reload:c}]=Q({api:_,columns:C,pagination:!1,striped:!1,useSearchForm:!1,showTableSetting:!1,bordered:!1,showIndexColumn:!0,canResize:!1}),H=()=>f(this,null,function*(){const s=v.value;s&&s.validateFields().then(()=>f(this,null,function*(){i.value=!0,yield ae(t).then(()=>{ee.getInstance().success("保存成功"),c(),d.open=!1,i.value=!1}).catch(()=>{i.value=!1})}))}),Y=()=>{d.open=!1},$=s=>f(this,null,function*(){const o=yield se(s.workScheduleId,s.stationId);o.id?(q(t,o),t.type=s.type,t.typeText=s.typeText,t.content=s.content):q(t,s),t.status=o.status?String(o.status):null,d.open=!0}),N=s=>{V(s.url)},P=()=>{V("/oa/schedule/work/record/index")};return L(()=>{X.getInstance().listen("home-page-work-schedule",()=>{c()})}),(s,o)=>{const j=u("a-card"),F=u("a-input"),k=u("a-form-item"),x=u("a-col"),g=u("a-row"),z=u("a-time-picker"),A=u("a-form");return m(),p(I,null,[e(j,{title:"工作安排",bordered:!1},{extra:a(()=>[R("span",{onClick:P},"更多 >")]),default:a(()=>[R("div",ne,[R("div",le,[e(B(G),{onRegister:B(l)},{bodyCell:a(({text:n,column:D,record:r})=>[D.dataIndex==="content"?(m(),p(I,{key:0},[r.url?(m(),p("a",{key:0,onClick:E=>N(r),title:n},w(n),9,ie)):(m(),p("span",{key:1,title:n},w(n),9,re))],64)):M("",!0),D.dataIndex==="status"?(m(),p(I,{key:1},[r.type==="site_work"?(m(),p("span",{key:0,class:U(y[r.status]),style:{cursor:"pointer"},onClick:E=>$(r)},w(r.statusText),11,de)):(m(),p("span",{key:1,class:U(y[r.status])},w(r.statusText),3))],64)):M("",!0)]),_:1},8,["onRegister"])])])]),_:1}),e(Z,{visible:d.open,"onUpdate:visible":o[4]||(o[4]=n=>d.open=n),title:"工作安排",smode:"default",onOk:H,onCancel:Y,width:520,height:380},{default:a(()=>[e(A,{ref_key:"modalFormRef",ref:v,model:t,name:"recordForm",autocomplete:"off"},{default:a(()=>[e(g,null,{default:a(()=>[b(e(x,{span:24},{default:a(()=>[e(k,{label:"类型",name:"typeText",labelCol:{style:{width:"124px"}},rules:[{required:!1}]},{default:a(()=>[e(F,{value:t.typeText,"onUpdate:value":o[0]||(o[0]=n=>t.typeText=n),disabled:!0},null,8,["value"])]),_:1})]),_:1},512),[[h,!0]])]),_:1}),e(g,null,{default:a(()=>[b(e(x,{span:24},{default:a(()=>[e(k,{label:"内容",name:"content",labelCol:{style:{width:"124px"}},rules:[{required:!1}]},{default:a(()=>[e(F,{value:t.content,"onUpdate:value":o[1]||(o[1]=n=>t.content=n),disabled:!0},null,8,["value"])]),_:1})]),_:1},512),[[h,!0]])]),_:1}),e(g,null,{default:a(()=>[b(e(x,{span:24},{default:a(()=>[e(k,{label:"执行时间",name:"executionTime",labelCol:{style:{width:"124px"}},rules:[{required:!0}]},{default:a(()=>[e(z,{value:t.executionTime,"onUpdate:value":o[2]||(o[2]=n=>t.executionTime=n),style:{width:"100%"},format:"HH:mm","value-format":"HH:mm"},null,8,["value"])]),_:1})]),_:1},512),[[h,!0]])]),_:1}),e(g,null,{default:a(()=>[b(e(x,{span:24},{default:a(()=>[e(k,{label:"状态",name:"status",labelCol:{style:{width:"124px"}},rules:[{required:!0,message:"请选择状态！"}]},{default:a(()=>[e(J,{value:t.status,"onUpdate:value":o[3]||(o[3]=n=>t.status=n),type:"work_record_status"},null,8,["value"])]),_:1})]),_:1},512),[[h,!0]])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])],64)}}});const qe=te(ue,[["__scopeId","data-v-d7b0c3e6"]]);export{qe as default};
//# sourceMappingURL=WorkReminder-421d3e80.js.map
