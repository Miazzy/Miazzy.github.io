var w=(K,c,_)=>new Promise((b,u)=>{var i=s=>{try{m(_.next(s))}catch(l){u(l)}},g=s=>{try{m(_.throw(s))}catch(l){u(l)}},m=s=>s.done?b(s.value):Promise.resolve(s.value).then(i,g);m((_=_.apply(K,c)).next())});import{d as se,k as p,r as y,o as re,al as v,Z as V,a9 as ie,aa as n,f as o,$ as ce,u as r,E as k,ad as D,v as R,A as B,_ as ue,ac as me}from"./vue-71d1abb3.js";import{b as de,au as fe,av as E,at as C,_ as pe}from"./index.js";import{D as _e}from"./Dialog-0a006d82.js";import{B as ve}from"./BasicTable-0434a334.js";import{m as ge}from"./BasicForm.vue_vue_type_style_index_0_lang-1ba7be9e.js";import"./index-085d06c7.js";import{u as be}from"./useTable-109483b3.js";import"./antd-15ac76ed.js";import{P as he}from"./index-20519caf.js";import{S as we}from"./SearchBox-22bb02d6.js";import{C as ye}from"./CommonTree-c4ed7838.js";import{c as Ce,s as Fe,g as Se,a as xe,b as Te,d as Ie,e as Ne,f as ke}from"./menu.data-50891193.js";import{x as De}from"./index-66d20ba6.js";import{a as P}from"./assign-37f1c13d.js";import"./useForm-dea3ed18.js";import"./uniqBy-92d3bc7f.js";import"./index-316f6ffb.js";import"./useWindowSizeFn-13b1b8a2.js";import"./index-f4fc48e6.js";import"./useTabs-2b062e85.js";import"./download-03e71dd5.js";import"./index-5d49b7a7.js";import"./UploadBox-636ecf02.js";import"./DictSelectBox.vue_vue_type_script_setup_true_lang-e03e9fe8.js";import"./OrganDialog-dd1023ce.js";import"./sortable.esm-4ae27e0b.js";import"./dict-c04c0dd8.js";import"./useContentViewHeight-7f845167.js";import"./index-3801a970.js";const Re={class:"right-table-layout"},Be={key:0,class:"dialog-mask"},Ee=se({__name:"index",setup(K){const{t:c}=de(),{createConfirm:_}=fe(),b=p([]),u=y({}),i=y({}),g=p(!0),m=p(!1),s=p("工作菜单设置"),l=y({open:p(!1),title:p("")}),h=p(!1),a=y({}),F=p(),z=e=>{const t=r(u);if(e){const d=W();t.pageNo=d.current,t.pageSize=d.pageSize}return t.sortField||(t.sortField="createTime",t.sortOrder="desc"),t},L=()=>({}),M=()=>w(this,null,function*(){return yield Te(z(!0))}),[A,{getSelectRows:H,getPaginationRef:W,clearSelectedRowKeys:O,reload:S}]=be({title:s.value,api:M,columns:Ce,useSearchForm:!0,formConfig:Fe,showTableSetting:!0,bordered:!0,rowKey:"id",rowSelection:{type:"radio"},handleSearchInfoFn(e){return u.menuName=e.menuName,e},sortFn:e=>{var d;const t=(d=e.order)==null?void 0:d.replace("end","");u.sortOrder=t,u.sortField=t?e.field:void 0}});function Y(e,t){t.width=e}function x(e){return e.id?c("common.action.edit"):c("common.action.create")}function Z(){const e=F.value;e&&e.validateFields().then(()=>{h.value=!0;const t=x(a);a.name=De.trim(a.name),Ie(a).then(()=>{C.getInstance().success(t+"成功"),U(),S(),l.open=!1,h.value=!1}).catch(()=>{h.value=!1})})}function j(){m.value=!1,l.open=!1,U()}function U(){var e;(e=F.value)==null||e.resetFields()}const $=()=>{m.value=!1;for(let e in a)a[e]=""};function G(){if($(),i.nodeKind!=="fun"){C.getInstance().error("请选择菜单树末级节点");return}P(a,{id:"",tableName:"",isFlow:""}),a.menuId=i.id,a.menuName=i.name,l.open=!0;const e=x({});l.title=`${e}${s.value}`}function q(){const e=H();return e.length==0?(C.getInstance().error("请选择一行数据"),!1):e[0]}function J(){$();const e=q();if(!e)return;P(a,e),a.isFlow=String(e.isFlow),l.open=!0;const t=x(e);l.title=`${t}${s.value}`}function Q(e){P(a,e),a.isFlow=String(e.isFlow),m.value=!0,l.open=!0,l.title=`查看${s.value}`}function X(){const e=q();e&&ee(function(){ke(e.id).then(()=>{C.getInstance().success(c("common.delSuccessText")),O(),S()})})}function ee(e){_({title:c("common.message.confirmTitle"),iconType:"warning",content:c("common.message.delMessage"),onOk(){return w(this,null,function*(){e()})}})}function te(){return w(this,null,function*(){const e=yield Ne({});b.value=e})}function ae(e){i.id=null,i.nodeKind=null,i.name=null,u.fullId=null,e&&(i.id=e.id,i.nodeKind=e.nodeKind,i.name=e.name,u.fullId=e.id),O(),S()}function oe({rows:e}){g.value=e.length===0}return re(()=>{te()}),(e,t)=>{const d=v("a-button"),ne=v("a-input"),T=v("a-form-item"),I=v("a-col"),N=v("a-row"),le=v("a-form");return V(),ie(r(he),{dense:"",contentFullHeight:"",fixedHeight:"",contentClass:"flex",style:{position:"relative"}},{default:n(()=>[o(ye,{ref:"treeRef",title:"菜单树",onSelect:ae,value:b.value,class:"left-tree-layout",toolbar:!0,canEdit:!1,canAdd:!1,canDelete:!1,isShowOperationBtns:!1,fieldNames:{key:"id",title:"name"}},null,8,["value"]),ce("div",Re,[o(r(ve),{onRegister:r(A),searchInfo:u,onResizeColumn:Y,onRowDbClick:t[0]||(t[0]=f=>Q(f)),class:"fix-basic-table",onSelectionChange:oe},{toolbar:n(()=>[o(d,{type:"primary",preIcon:r(E).ADD,onClick:G},{default:n(()=>[k(D(r(c)("common.action.create")),1)]),_:1},8,["preIcon"]),o(d,{disabled:g.value,type:"primary",preIcon:r(E).EDIT,onClick:J},{default:n(()=>[k(D(r(c)("common.action.edit")),1)]),_:1},8,["disabled","preIcon"]),o(d,{disabled:g.value,class:"red-btn",preIcon:r(E).DELETE,onClick:X},{default:n(()=>[k(D(r(c)("common.delText")),1)]),_:1},8,["disabled","preIcon"])]),_:1},8,["onRegister","searchInfo"])]),o(_e,{visible:l.open,"onUpdate:visible":t[4]||(t[4]=f=>l.open=f),title:l.title,"show-btm":!m.value,onOk:Z,onCancel:j,width:460,height:330,smode:"normal",overflowY:"auto"},{default:n(()=>[o(le,{ref_key:"modalFormRef",ref:F,model:a,name:"menuForm",autocomplete:"off"},{default:n(()=>[o(N,null,{default:n(()=>[R(o(I,{span:24},{default:n(()=>[o(T,{label:"菜单名称",name:"menuName",labelCol:{class:"detail-label"},rules:[{required:!1}]},{default:n(()=>[o(ne,{value:a.menuName,"onUpdate:value":t[1]||(t[1]=f=>a.menuName=f),disabled:!0},null,8,["value"])]),_:1})]),_:1},512),[[B,!0]])]),_:1}),o(N,null,{default:n(()=>[R(o(I,{span:24},{default:n(()=>[o(T,{label:"表名称",name:"tableName",labelCol:{class:"detail-label"},rules:[{required:!0}]},{default:n(()=>[o(we,{value:a.tableName,"onUpdate:value":t[2]||(t[2]=f=>a.tableName=f),api:r(Se),apiParamFunc:L,columns:r(xe),vfield:"tableName",searchKey:"keyword",pagination:!0,disabled:m.value},null,8,["value","api","columns","disabled"])]),_:1})]),_:1},512),[[B,!0]])]),_:1}),o(N,null,{default:n(()=>[R(o(I,{span:24},{default:n(()=>[o(T,{label:"是否是流程",name:"isFlow",labelCol:{class:"detail-label"},rules:[{required:!0}]},{default:n(()=>[o(ge,{value:a.isFlow,"onUpdate:value":t[3]||(t[3]=f=>a.isFlow=f),type:"yes_or_no",disabled:m.value,style:{"text-align":"left"}},null,8,["value","disabled"])]),_:1})]),_:1},512),[[B,!0]])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title","show-btm"]),h.value?(V(),ue("div",Be)):me("",!0)]),_:1})}}});const ut=pe(Ee,[["__scopeId","data-v-c2fcac48"]]);export{ut as default};
//# sourceMappingURL=index-fe442636.js.map
