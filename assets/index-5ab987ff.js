var p=(a,t,i)=>new Promise((d,c)=>{var _=n=>{try{u(i.next(n))}catch(m){c(m)}},v=n=>{try{u(i.throw(n))}catch(m){c(m)}},u=n=>n.done?d(n.value):Promise.resolve(n.value).then(_,v);u((i=i.apply(a,t)).next())});import{B as z}from"./BasicTable-0434a334.js";import{T as B}from"./BasicForm.vue_vue_type_style_index_0_lang-1ba7be9e.js";import"./index-085d06c7.js";import{u as F}from"./useTable-109483b3.js";import"./antd-15ac76ed.js";import{a5 as x,b as K,ax as R,_ as L}from"./index.js";import{P as H}from"./index-20519caf.js";import{C as V}from"./CommonTree-c4ed7838.js";import{r as S,d as j,k as l,o as E,Z as g,_ as f,f as h,aa as y,$ as U,u as b,F as W,ac as w,J as q}from"./vue-71d1abb3.js";import{a as J}from"./assign-37f1c13d.js";import"./useForm-dea3ed18.js";import"./uniqBy-92d3bc7f.js";import"./index-316f6ffb.js";import"./useWindowSizeFn-13b1b8a2.js";import"./index-f4fc48e6.js";import"./useTabs-2b062e85.js";import"./download-03e71dd5.js";import"./index-5d49b7a7.js";import"./SearchBox-22bb02d6.js";import"./UploadBox-636ecf02.js";import"./Dialog-0a006d82.js";import"./DictSelectBox.vue_vue_type_script_setup_true_lang-e03e9fe8.js";import"./OrganDialog-dd1023ce.js";import"./sortable.esm-4ae27e0b.js";import"./dict-c04c0dd8.js";import"./useContentViewHeight-7f845167.js";import"./index-3801a970.js";function M(a){return[{title:"电站",dataIndex:"useStationName",width:160,resizable:!0,sorter:!0,headAlign:"center",align:"left"},{title:"编号",dataIndex:"code",width:160,sorter:!0,resizable:!0,headAlign:"center",align:"left"},{title:"机场类别",dataIndex:"droneTypeText",width:160,headAlign:"center",align:"left",resizable:!0,sorter:!0},{title:"SN编码",dataIndex:"snNumber",width:160,headAlign:"center",align:"center",resizable:!0,sorter:!0},{title:"机场描述",dataIndex:"airportDescribe",width:160,headAlign:"center",align:"center",resizable:!0,sorter:!0},{title:"状态",dataIndex:"droneOnlineStatus",width:160,resizable:!0,sorter:!0}]}const Z=a=>x.post({url:"/baseset/common/list-orgStationTree",params:a},{}),$=a=>x.get({url:"/po/drone-archive/droneStatusPage",params:a},{}),G=a=>x.get({url:"/po/droneinspection/getPageUrl",params:a},{});S({spinning:!1});const I=S({spinning:!1}),Q={class:"right-table-layout"},X={key:0,style:{color:"green"}},Y={key:1,style:{color:"red"}},ee=j({__name:"index",setup(a){K();const t=S({}),i=l([]),d=l({}),c=l([]);l([]);const _=M(),v=l([]),u=()=>p(this,null,function*(){let e=yield $(t);return v.value=e.result,e.result});let n=l("");const m={showAdvancedButton:!1,baseColProps:{span:8},labelWidth:120,autoAdvancedLine:1,schemas:[{field:"droneOnlineStatus",label:"状态",component:"DictSelectBox",componentProps:{type:"droneOnlineStatus"}}]},[C,{reload:N,getPaginationRef:T}]=F({title:"无人机列表",api:()=>p(this,null,function*(){const e=T();return t.pageNo=e.current,t.pageSize=e.pageSize,yield u()}),columns:_,useSearchForm:!0,formConfig:m,showTableSetting:!0,bordered:!0,rowKey:"id",rowSelection:{type:"radio",onChange:P},handleSearchInfoFn(e){return J(t,e),e},sortFn:e=>{e.order?(t.sortField=e.field,t.sortOrder=e.order.replace("end","")):(t.sortField=null,t.sortOrder=null)},actionColumn:{width:200,title:"操作",dataIndex:"action",slots:{customRender:"action"}}}),A=e=>[{label:"查看",icon:"mdi:eye-outline",onClick:O.bind(null,e)}],O=e=>{const o={snNumber:e.snNumber};G(o).then(r=>{var s={content:r.result};R("/po/drone/droneinspection/content","查看巡检详情",q(s))})};function P(e,o){o.length>0?(c.value=[e[0]],n.value=e[0]):(c.value=[],n.value="")}function k(){return p(this,null,function*(){const e=yield Z({});i.value=e.result,N()})}function D(e={}){t.stationId=null,t.stationName=null,t.stationOrganId=null,t.stationOrganName=null,t.nodeKindId=null,d.value.nodeKindId=null,t.searchId=null,e!=null&&(t.stationOrganId=e.organId,t.stationOrganName=e.organName,e.nodeKindId=="station"&&(t.stationId=e.powerStationId,t.stationName=e.name,d.value.stationId=e.powerStationId,I.stationId=t.stationId,I.stationName=t.stationName,I.stationOrganId=t.stationOrganId,I.stationOrganName=t.stationOrganName),t.nodeKindId=e.nodeKindId,d.value.nodeKindId=e.nodeKindId,t.searchId=e.id),N()}return E(()=>{k()}),(e,o)=>(g(),f("div",null,[h(b(H),{dense:"",contentFullHeight:"",fixedHeight:"",contentClass:"flex",style:{position:"relative"}},{default:y(()=>[h(V,{title:"电站组织",onSelect:D,value:i.value,class:"left-tree-layout",toolbar:!0,canEdit:!1,canAdd:!1,canDelete:!1,isShowOperationBtns:!1,fieldNames:{key:"id",title:"name"}},null,8,["value"]),U("div",Q,[h(b(z),{class:"fix-basic-table",onRegister:b(C),searchInfo:t,onResizeColumn:o[0]||(o[0]=(r,s)=>s.width=r),onRowDbClick:o[1]||(o[1]=r=>O(r))},{bodyCell:y(({column:r,text:s})=>[r.dataIndex==="droneOnlineStatus"?(g(),f(W,{key:0},[s==!0?(g(),f("span",X,"在线")):w("",!0),s==!1?(g(),f("span",Y,"离线")):w("",!0)],64)):w("",!0)]),action:y(({record:r})=>[h(b(B),{actions:A(r)},null,8,["actions"])]),_:1},8,["onRegister","searchInfo"])])]),_:1})]))}});const Ae=L(ee,[["__scopeId","data-v-995c9abb"]]);export{Ae as default};
//# sourceMappingURL=index-5ab987ff.js.map
