{"version":3,"file":"stationTree-56a32762.js","sources":["../../src/views/po/stationtree/stationTree.ts","../../src/views/po/stationtree/stationTree.vue"],"sourcesContent":["import { defHttp } from '/@/utils/http/axios';\n\nenum Api {\n  getTreeData = '/baseset/common/list-orgStationTree',\n}\n\n// 组织树数据\nexport const getTreeDataApi = (params) =>\n  defHttp.post(\n    {\n      url: Api.getTreeData,\n      params,\n    },\n    {},\n  );\n\n/**\n *\n * @param data 左侧树选中的节点\n * @param queryParam 默认返回公司和电站\n * @param callback 要返回的其他属性的key,如{stationType:''}\n */\nexport function setStationAndOrgan(data, queryParam, otherKey, callback) {\n  if (!data) {\n    queryParam.value.stationOrganId = null;\n    queryParam.value.stationOrganName = null;\n    queryParam.value.stationId = null;\n    queryParam.value.stationName = null;\n    if (otherKey) {\n      for (const key in otherKey) {\n        queryParam.value[key] = null;\n      }\n    }\n  } else {\n    queryParam.value.stationOrganId = data.organId;\n    queryParam.value.stationOrganName = data.organName;\n    queryParam.value.stationId = data.powerStationId;\n    queryParam.value.stationName = data.powerStationName;\n    if (otherKey) {\n      for (const key in otherKey) {\n        queryParam.value[key] = data[key];\n      }\n    }\n  }\n  if (callback) {\n    callback();\n  }\n}\n","<template>\n  <!-- 电站组织树 -->\n  <CommonTree\n    title=\"电站组织\"\n    @select=\"handleSelect\"\n    :value=\"treeData\"\n    :canEdit=\"false\"\n    :canAdd=\"false\"\n    :canDelete=\"false\"\n    :selectedKeys=\"selectedKeys\"\n    :expandedKeys=\"expandedKeys\"\n    class=\"left-tree-layout\"\n    :isShowOperationBtns=\"false\"\n    :fieldNames=\"{ key: 'id', title: 'name' }\"\n  />\n</template>\n<script lang=\"ts\" setup>\n  import { onMounted, ref } from 'vue';\n  import { TreeItem } from '/@/components/Tree';\n  import CommonTree from '@/components/Framework/Tree/CommonTree.vue';\n  import { getTreeDataApi } from './stationTree'; // 左侧树数据\n\n  const treeData = ref<TreeItem[]>([]);\n    const props = defineProps({\n      stationOrganId: String, // 选中的树节点\n      stationId: String, // 选中的树节点\n    })\n  const emit = defineEmits(['select-tree']);\n\n  const getTreeData = async () => {\n    let param = {};\n    let rs = await getTreeDataApi(param);\n    setTreeNode(props.stationId || '');\n    treeData.value = rs.result;\n  };\n\n  // 左侧树状菜单选中事件\n  function handleSelect(node = {}) {\n    emit('select-tree', node);\n  }\n\n  const selectedKeys = ref<any>([props.stationOrganId]);\n  const expandedKeys = ref<Array<string>>([]);\n  const setTreeNode = async (stationId: string) => {\n    if (!stationId) {\n      return;\n    }\n  \n    let expandedId = '';\n    setTimeout(async () => {\n      treeData.value.forEach((item) => {\n    \n        if (item.children) {\n          item.children.forEach((element) => {\n            if (element.id === stationId) {\n              expandedId = item.id;\n            }\n          });\n        }\n      });\n      expandedKeys.value = [expandedId, stationId];\n      selectedKeys.value = [stationId];\n    }, 500);\n  };\n  // 启动执行代码\n  onMounted(() => {\n    getTreeData();\n  });\n</script>\n\n\n<style lang=\"less\" scoped>\n  .left-tree-layout {\n    width: 298px;\n    border-radius: 2px;\n  }\n  </style>\n"],"names":["getTreeDataApi","params","defHttp","setStationAndOrgan","data","queryParam","otherKey","callback","key","treeData","ref","getTreeData","__async","rs","setTreeNode","props","handleSelect","node","emit","selectedKeys","expandedKeys","stationId","expandedId","item","element","onMounted"],"mappings":"oWAOa,MAAAA,EAAkBC,GAC7BC,EAAQ,KACN,CACE,IAAK,sCACL,OAAAD,CACF,EACA,CAAC,CACH,EAQK,SAASE,EAAmBC,EAAMC,EAAYC,EAAUC,EAAU,CACvE,GAAKH,GAeH,GAJWC,EAAA,MAAM,eAAiBD,EAAK,QAC5BC,EAAA,MAAM,iBAAmBD,EAAK,UAC9BC,EAAA,MAAM,UAAYD,EAAK,eACvBC,EAAA,MAAM,YAAcD,EAAK,iBAChCE,EACF,UAAWE,KAAOF,EAChBD,EAAW,MAAMG,CAAG,EAAIJ,EAAKI,CAAG,UAhBpCH,EAAW,MAAM,eAAiB,KAClCA,EAAW,MAAM,iBAAmB,KACpCA,EAAW,MAAM,UAAY,KAC7BA,EAAW,MAAM,YAAc,KAC3BC,EACF,UAAWE,KAAOF,EACLD,EAAA,MAAMG,CAAG,EAAI,KAc1BD,GACOA,GAEb,kICzBQE,EAAWC,EAAgB,CAAA,CAAE,EAO7BC,EAAc,IAAYC,EAAA,sBAE1B,IAAAC,EAAK,MAAMb,EADH,CAAA,CACuB,EACvBc,EAAAC,EAAM,WAAa,EAAE,EACjCN,EAAS,MAAQI,EAAG,MAAA,GAIb,SAAAG,EAAaC,EAAO,GAAI,CAC/BC,EAAK,cAAeD,CAAI,CAC1B,CAEA,MAAME,EAAeT,EAAS,CAACK,EAAM,cAAc,CAAC,EAC9CK,EAAeV,EAAmB,CAAA,CAAE,EACpCI,EAAqBO,GAAsBT,EAAA,sBAC/C,GAAI,CAACS,EACH,OAGF,IAAIC,EAAa,GACjB,WAAW,IAAYV,EAAA,sBACZH,EAAA,MAAM,QAASc,GAAS,CAE3BA,EAAK,UACFA,EAAA,SAAS,QAASC,GAAY,CAC7BA,EAAQ,KAAOH,IACjBC,EAAaC,EAAK,GACpB,CACD,CACH,CACD,EACYH,EAAA,MAAQ,CAACE,EAAYD,CAAS,EAC9BF,EAAA,MAAQ,CAACE,CAAS,IAC9B,GAAG,CAAA,GAGR,OAAAI,EAAU,IAAM,CACFd,GAAA,CACb"}