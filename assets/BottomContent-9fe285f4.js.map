{"version":3,"file":"BottomContent-9fe285f4.js","sources":["../../src/views/da/cockpit/property/BottomContent.vue"],"sourcesContent":["<template>\n  <div class=\"bottom-content\" :key=\"instanceKey\">\n    <div class=\"left-section section-box\">\n      <div class=\"section-bg\">\n        <SubtitleBar :subtitle=\"`出入库统计`\">\n          <a-select\n            ref=\"select\"\n            v-model:value=\"searchInfo.selectOrderValue\"\n            :options=\"optionsDimension\"\n            style=\"width: 1.2rem; margin-right: 0.1rem\"\n            @change=\"handleOrderChange\"\n            v-show=\"optionsDimension.length > 1\"\n          />\n          <a-select\n            ref=\"select\"\n            v-model:value=\"searchInfo.selectOrderType\"\n            :options=\"optionsSpareType\"\n            style=\"width: 1.2rem\"\n            label-in-value\n            @change=\"handleOrderTypeChange\"\n          />\n        </SubtitleBar>\n        <div\n          v-if=\"donutDataByWarehouse?.pieData?.length || pchartDataByWarehouse?.barData?.length\"\n          class=\"chart-box\"\n        >\n          <!-- <DonutChart\n            :data=\"donutDataByWarehouse.pieData\"\n            width=\"2rem\"\n            height=\"2rem\"\n            radius=\"100\"\n          /> -->\n          <EchartPieChart\n            id=\"warehouse-stat-pie\"\n            :width=\"`10.4vw`\"\n            :height=\"tabStatus === 'on' ? `33.08vh` : `33.83vh`\"\n            :data=\"donutDataByWarehouse.pieData\"\n            :roseType=\"false\"\n            :radius=\"['50%', '70%']\"\n            showLegend\n            :legendOptions=\"{ top: '80%' }\"\n            :pieCenter=\"['50%', '50%']\"\n          />\n          <div style=\"width: 7.08rem; height: 2rem\">\n            <div\n              :style=\"\n                tabStatus === 'on'\n                  ? 'margin-top: -0.3rem; transform: scale(0.85)'\n                  : 'margin-top: -0.35rem; transform: scale(0.85)'\n              \"\n            >\n              <EchartPillarChart\n                :data=\"pchartDataByWarehouse\"\n                :colors=\"pchartDataByWarehouse.colors\"\n                :name=\"pchartName2\"\n                :width=\"`39.59vw`\"\n                :height=\"tabStatus === 'on' ? `40vh` : `44vh`\"\n                :tipsFormat=\"handleTipsContentWH\"\n                :dataZoomDisabled=\"false\"\n                :dataZoomDefaultValueRange=\"[0, 5]\"\n              />\n            </div>\n          </div>\n        </div>\n        <NoData v-else />\n      </div>\n    </div>\n    <div class=\"right-section section-box\">\n      <div class=\"section-bg\">\n        <SubtitleBar :subtitle=\"`备品备件统计`\">\n          <a-select\n            ref=\"select\"\n            v-model:value=\"searchInfo.selectSpareValue\"\n            :options=\"optionsDimension\"\n            style=\"width: 1.2rem; margin-right: 0.1rem\"\n            @change=\"handleSpareChange\"\n            v-show=\"optionsDimension.length > 1\"\n          />\n          <a-select\n            ref=\"select\"\n            v-model:value=\"searchInfo.selectSpareType\"\n            :options=\"optionsSpare\"\n            style=\"width: 1.2rem\"\n            label-in-value\n            @change=\"handleSpareTypeChange\"\n          />\n        </SubtitleBar>\n        <div\n          v-if=\"donutDataBySpare?.pieData?.length || barchartDataBySpare?.barData?.length\"\n          class=\"chart-box\"\n        >\n          <!-- <DonutChart :data=\"donutDataBySpare.pieData\" width=\"2rem\" height=\"2rem\" radius=\"100\" /> -->\n          <EchartPieChart\n            id=\"spare-stat-pie\"\n            :width=\"`10.4vw`\"\n            :height=\"tabStatus === 'on' ? `33.08vh` : `34.00vh`\"\n            :data=\"donutDataBySpare.pieData\"\n            :roseType=\"false\"\n            :radius=\"['50%', '70%']\"\n            :legendOptions=\"{ top: '72%' }\"\n            :pieCenter=\"['50%', '50%']\"\n            @click-item=\"handleSparePenetrate\"\n          />\n          <div style=\"width: 7.08rem; height: 2rem\">\n            <div\n              :style=\"\n                tabStatus === 'on'\n                  ? 'margin-top: -0.3rem; transform: scale(0.85)'\n                  : 'margin-top: -0.35rem; transform: scale(0.85)'\n              \"\n            >\n              <EchartStackBarChart\n                id=\"spare_stack_chart\"\n                :data=\"barchartDataBySpare\"\n                :category=\"barchartDataBySpare.categories\"\n                :width=\"`39.59vw`\"\n                :height=\"tabStatus === 'on' ? `40vh` : `44vh`\"\n                @click-item=\"handleSparePenetrate\"\n              />\n            </div>\n          </div>\n        </div>\n        <NoData v-else />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import { reactive, UnwrapRef, ref, onMounted, watch } from 'vue';\n  import SubtitleBar from '/@/components/Framework/Chart/SubtitleBar.vue';\n  // import DonutChart from '/@/components/Framework/Chart/DonutChart2.vue';\n  import EchartPillarChart from '/@/components/Framework/Chart/EchartPillarChart.vue';\n  import { assign } from 'lodash-es';\n  import { handleRouteChange } from '../../utils';\n  import {\n    optionsSpareType,\n    getSpareTypeData,\n    getWarehouseStatisticsData,\n    getSpareStatisticsData,\n  } from './data';\n  import * as CommonApi from '@/api/da/common';\n  import EchartPieChart from '/@/components/Framework/Chart/EchartPieChart.vue';\n  import NoData from '/@/components/Framework/Chart/NoData.vue';\n  import { buildUUID } from '@/utils/uuid';\n  import EchartStackBarChart from '/@/components/Framework/Chart/EchartStackBarChart.vue';\n\n  const searchInfo: UnwrapRef<any> = reactive({\n    //出入库统计\n    selectOrderValue: 'station',\n    selectOrderType: '1',\n    //备品备件\n    selectSpareValue: 'station',\n    // selectSpareType: '1',\n  });\n\n  interface Props {\n    searchInfoByTime?: {};\n    tabStatus?: '';\n  }\n  const props = withDefaults(defineProps<Props>(), {});\n  const instanceKey = ref(buildUUID());\n\n  watch(\n    () => props.searchInfoByTime,\n    (value) => {\n      assign(searchInfo, value);\n      queryOrderData();\n      if (searchInfo.selectSpareType) {\n        querySpareData();\n      }\n    },\n  );\n\n  const optionsDimension: any = ref([]);\n  const optionsSpare: any = ref([]);\n\n  onMounted(async () => {\n    const sts = await CommonApi.getDictDataMap({ dictType: 'cockpit_three_dimension' });\n    sts.result.forEach((e) => {\n      optionsDimension.value.push({ value: e.value, label: e.label });\n    });\n\n    const spareData = await getSpareTypeData({});\n    if (spareData.result) {\n      if (spareData.result?.length) {\n        searchInfo.selectSpareType = spareData.result[0].value;\n      }\n      spareData.result.forEach((e) => {\n        optionsSpare.value.push({ value: e.value, label: e.label });\n      });\n    }\n    querySpareData();\n  });\n\n  //=============================== 出入库统计=============================================\n  const donutDataByWarehouse = ref({\n    pieData: [],\n  });\n  const pchartDataByWarehouse = ref({\n    barData: [],\n    categories: [],\n    colors: [\n      ['#078C5D', '#68E4B8'],\n      ['#E59837', '#FAE895'],\n      ['#078C5D', '#68E4B8'],\n    ],\n  });\n  const pchartName2 = ref(['入库单']);\n  const handleTipsContentWH = (params) => {\n    const element = params[0];\n    const text = `电站：${element.name} \\n\\r</br>数量：${element.data.value}(张)`;\n    return text;\n  };\n  const queryOrderData = async () => {\n    searchInfo.dimension = searchInfo.selectOrderValue;\n    searchInfo.index = searchInfo.selectOrderType;\n    let data = await getWarehouseStatisticsData(searchInfo);\n    if (data.result) {\n      pchartDataByWarehouse.value.barData = data.result.barData;\n      pchartDataByWarehouse.value.categories = data.result.categories;\n      // donutDataByWarehouse.value.pieData = data.result.pieData;\n      let pieData = [];\n      data.result.pieData.forEach((item) => {\n        item.name = item.label;\n        pieData.push(item);\n      });\n      donutDataByWarehouse.value.pieData = pieData;\n    }\n  };\n  const handleOrderChange = (value: string) => {\n    searchInfo.selectOrderValue = value;\n    queryOrderData();\n  };\n  const handleOrderTypeChange = (value: string) => {\n    searchInfo.selectOrderType = value.value;\n    queryOrderData();\n    pchartName2.value.splice(0, 1, value.label);\n  };\n\n  //=============================== 备品备件统计=============================================\n  const donutDataBySpare = ref({\n    pieData: [],\n  });\n  const barchartDataBySpare = ref({\n    barData: [[]],\n    categories: [],\n    // units: [''],\n    // colors: [\n    //   ['#488FF6', '#60D1F3'],\n    //   ['#078C5D', '#68E4B8'],\n    //   ['#E59837', '#FAE895'],\n    //   '#f39c12',\n    //   '#f39c12',\n    // ],\n    barNames: [],\n  });\n\n  const handleSpareTipsContent = (params) => {\n    const element = params[0];\n    const text = `电站：${element.name} \\n\\r</br>数量：${element.data.value}`;\n    return text;\n  };\n\n  const querySpareData = async () => {\n    searchInfo.dimension = searchInfo.selectSpareValue;\n    searchInfo.index = searchInfo.selectSpareType;\n\n    let data = await getSpareStatisticsData(searchInfo);\n    if (data.result) {\n      barchartDataBySpare.value.barData = data.result.barData;\n      barchartDataBySpare.value.categories = data.result.categories;\n      barchartDataBySpare.value.barNames = data.result.barNames;\n      let pieData = [];\n      data.result.pieData.forEach((item) => {\n        item.name = item.label;\n        pieData.push(item);\n      });\n      donutDataBySpare.value.pieData = pieData;\n    }\n  };\n  const handleSpareChange = (value: string) => {\n    searchInfo.selectSpareValue = value;\n    querySpareData();\n  };\n  const handleSpareTypeChange = (value: string) => {\n    searchInfo.selectSpareType = value.value;\n    querySpareData();\n  };\n\n  //=============================== 数据穿透=============================================\n  function handleSparePenetrate() {\n    handleRouteChange('/bi/equipment/index', {\n      // selectType: rightSearchInfo.selectStationValue,\n      // id: params.data.id,\n    });\n  }\n\n  // 更新组件函数\n  const handleUpdate = () => {\n    instanceKey.value = buildUUID();\n  };\n\n  defineExpose({\n    handleUpdate,\n  });\n</script>\n\n<style lang=\"less\" scoped>\n  .bottom-content {\n    display: flex;\n    flex: 44.34%;\n    justify-content: space-between;\n    height: 44.34%;\n    padding-top: 0.93vh;\n\n    .section-box {\n      flex: 50%;\n      width: 50%;\n      height: 100%;\n    }\n\n    .section-bg {\n      width: 100%;\n      height: 100%;\n    }\n\n    .left-section {\n      padding-right: 0.41vw;\n\n      .section-bg {\n        background: url('../../../../assets/images/da/property_section_bg_2.png') no-repeat\n          center/100% 100%;\n      }\n\n      :deep(.subtitle-bar) {\n        padding-left: 0.2rem;\n      }\n    }\n\n    .right-section {\n      padding-left: 0.41vw;\n\n      .section-bg {\n        background: url('../../../../assets/images/da/property_section_bg_3.png') no-repeat\n          center/100% 100%;\n      }\n\n      :deep(.subtitle-bar) {\n        padding-left: 0.24rem;\n      }\n    }\n\n    :deep(.ant-select:not(.ant-select-customize-input) .ant-select-selector) {\n      height: 0.26rem !important;\n      border: 0.01rem solid #07a6ff70;\n      border-radius: 0;\n      background-color: transparent;\n    }\n\n    :deep(.ant-select-single .ant-select-selector .ant-select-selection-placeholder) {\n      height: 0.26rem;\n      line-height: 0.26rem;\n    }\n\n    :deep(.ant-select-arrow) {\n      color: rgb(255 255 255 / 50%);\n    }\n\n    .chart-box {\n      display: flex;\n      padding-left: 0.2rem;\n    }\n  }\n</style>\n"],"names":["searchInfo","reactive","instanceKey","ref","buildUUID","watch","props","value","assign","queryOrderData","querySpareData","optionsDimension","optionsSpare","onMounted","__async","CommonApi.getDictDataMap","e","spareData","getSpareTypeData","_a","donutDataByWarehouse","pchartDataByWarehouse","pchartName2","handleTipsContentWH","params","element","data","getWarehouseStatisticsData","pieData","item","handleOrderChange","handleOrderTypeChange","donutDataBySpare","barchartDataBySpare","getSpareStatisticsData","handleSpareChange","handleSpareTypeChange","handleSparePenetrate","handleRouteChange","__expose"],"mappings":"u0CAmJQA,EAA6BC,EAAS,CAE1C,iBAAkB,UAClB,gBAAiB,IAEjB,iBAAkB,SAAA,CAEnB,EAOKC,EAAcC,EAAIC,EAAA,CAAW,EAEnCC,EACE,IAAMC,EAAM,iBACXC,GAAU,CACTC,GAAOR,EAAYO,CAAK,EACTE,IACXT,EAAW,iBACEU,GAEnB,CAAA,EAGI,MAAAC,EAAwBR,EAAI,CAAA,CAAE,EAC9BS,EAAoBT,EAAI,CAAA,CAAE,EAEhCU,EAAU,IAAYC,EAAA,6BACR,MAAMC,GAAyB,CAAE,SAAU,yBAA2B,CAAA,GAC9E,OAAO,QAASC,GAAM,CACPL,EAAA,MAAM,KAAK,CAAE,MAAOK,EAAE,MAAO,MAAOA,EAAE,KAAA,CAAO,CAAA,CAC/D,EAED,MAAMC,EAAY,MAAMC,GAAiB,CAAA,CAAE,EACvCD,EAAU,UACRE,EAAAF,EAAU,SAAV,MAAAE,EAAkB,SACpBnB,EAAW,gBAAkBiB,EAAU,OAAO,CAAC,EAAE,OAEzCA,EAAA,OAAO,QAASD,GAAM,CACjBJ,EAAA,MAAM,KAAK,CAAE,MAAOI,EAAE,MAAO,MAAOA,EAAE,KAAA,CAAO,CAAA,CAC3D,GAEYN,GAAA,EAChB,EAGD,MAAMU,EAAuBjB,EAAI,CAC/B,QAAS,CAAC,CAAA,CACX,EACKkB,EAAwBlB,EAAI,CAChC,QAAS,CAAC,EACV,WAAY,CAAC,EACb,OAAQ,CACN,CAAC,UAAW,SAAS,EACrB,CAAC,UAAW,SAAS,EACrB,CAAC,UAAW,SAAS,CACvB,CAAA,CACD,EACKmB,EAAcnB,EAAI,CAAC,KAAK,CAAC,EACzBoB,EAAuBC,GAAW,CAChC,MAAAC,EAAUD,EAAO,CAAC,EAEjB,MADM,MAAMC,EAAQ,IAAI;AAAA,YAAgBA,EAAQ,KAAK,KAAK,KAC1D,EAEHhB,EAAiB,IAAYK,EAAA,sBACjCd,EAAW,UAAYA,EAAW,iBAClCA,EAAW,MAAQA,EAAW,gBAC1B,IAAA0B,EAAO,MAAMC,GAA2B3B,CAAU,EACtD,GAAI0B,EAAK,OAAQ,CACOL,EAAA,MAAM,QAAUK,EAAK,OAAO,QAC5BL,EAAA,MAAM,WAAaK,EAAK,OAAO,WAErD,IAAIE,EAAU,CAAA,EACdF,EAAK,OAAO,QAAQ,QAASG,GAAS,CACpCA,EAAK,KAAOA,EAAK,MACjBD,EAAQ,KAAKC,CAAI,CAAA,CAClB,EACDT,EAAqB,MAAM,QAAUQ,CACvC,CAAA,GAEIE,EAAqBvB,GAAkB,CAC3CP,EAAW,iBAAmBO,EACfE,GAAA,EAEXsB,EAAyBxB,GAAkB,CAC/CP,EAAW,gBAAkBO,EAAM,MACpBE,IACfa,EAAY,MAAM,OAAO,EAAG,EAAGf,EAAM,KAAK,CAAA,EAItCyB,EAAmB7B,EAAI,CAC3B,QAAS,CAAC,CAAA,CACX,EACK8B,EAAsB9B,EAAI,CAC9B,QAAS,CAAC,CAAA,CAAE,EACZ,WAAY,CAAC,EASb,SAAU,CAAC,CAAA,CACZ,EAQKO,EAAiB,IAAYI,EAAA,sBACjCd,EAAW,UAAYA,EAAW,iBAClCA,EAAW,MAAQA,EAAW,gBAE1B,IAAA0B,EAAO,MAAMQ,GAAuBlC,CAAU,EAClD,GAAI0B,EAAK,OAAQ,CACKO,EAAA,MAAM,QAAUP,EAAK,OAAO,QAC5BO,EAAA,MAAM,WAAaP,EAAK,OAAO,WAC/BO,EAAA,MAAM,SAAWP,EAAK,OAAO,SACjD,IAAIE,EAAU,CAAA,EACdF,EAAK,OAAO,QAAQ,QAASG,GAAS,CACpCA,EAAK,KAAOA,EAAK,MACjBD,EAAQ,KAAKC,CAAI,CAAA,CAClB,EACDG,EAAiB,MAAM,QAAUJ,CACnC,CAAA,GAEIO,EAAqB5B,GAAkB,CAC3CP,EAAW,iBAAmBO,EACfG,GAAA,EAEX0B,EAAyB7B,GAAkB,CAC/CP,EAAW,gBAAkBO,EAAM,MACpBG,GAAA,EAIjB,SAAS2B,GAAuB,CAC9BC,GAAkB,sBAAuB,CAAA,CAGxC,CACH,CAOa,OAAAC,EAAA,CACX,aALmB,IAAM,CACzBrC,EAAY,MAAQE,GAAU,CAI9B,CACD"}