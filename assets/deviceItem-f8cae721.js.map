{"version":3,"file":"deviceItem-f8cae721.js","sources":["../../src/views/monitor/component/deviceItem.vue"],"sourcesContent":["<template>\n  <div>\n    <Popover\n      v-if=\"data.seriesList && data.seriesList.length\"\n      placement=\"rightTop\"\n      overlayClassName=\"device-popover\"\n    >\n      <div class=\"device-item\">\n        <div\n          class=\"device-label\"\n          :style=\"{ background: deviceAbnormalTypeColors[data.deviceShowFlag] }\"\n          >{{ data[options.deviceLabelKey] }}</div\n        >\n        <div class=\"device-data-box\">\n          <div class=\"left\">\n            <div class=\"device-img-box\">\n              <!-- <img class=\"device-img\" :src=\"deviceImg\" /> -->\n              <i\n                class=\"iconfont\"\n                :class=\"getDeviceIcon\"\n                :style=\"{ color: deviceAbnormalTypeColors[data.deviceShowFlag], fontSize: '54px' }\"\n              ></i>\n            </div>\n            <div v-if=\"data.pvTotal > 0\" class=\"number-text\"\n              >{{ data[options.left || 'pvTotal'] }}kWp</div\n            >\n          </div>\n          <div v-if=\"data.actualDataList && data.actualDataList.length\" class=\"right\">\n            <div class=\"right-item\" v-for=\"(item, index) in data.actualDataList\" :key=\"index\">\n              <div class=\"right-label\">{{ item.addressDesc }}</div>\n              <div class=\"right-data\">\n                <span class=\"data-text\">{{ item.data }}</span>\n                <span class=\"unit-text\">{{ item.unit }}</span>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div v-if=\"props.showSeries\" class=\"device-status-list-outer\">\n          <div class=\"device-status-list\">\n            <!-- TODO 组串状态-->\n            <div\n              class=\"device-status-icon normal\"\n              :class=\"getSeriesStatusIcon(i)\"\n              v-for=\"(i, index) in data.seriesStatus\"\n              :key=\"index\"\n            ></div>\n            <!-- <div class=\"device-status-icon offline\"></div>\n            <div class=\"device-status-icon I-abnormal\"></div>\n            <div class=\"device-status-icon communication-outage\"></div>\n            <div class=\"device-status-icon unconnected\"></div> -->\n          </div>\n        </div>\n      </div>\n\n      <!-- 弹框内容 -->\n      <template #content>\n        <div>\n          <div class=\"date-box\">{{ data.time }}</div>\n          <ul class=\"info-list\">\n            <li class=\"info-title\">\n              <span>组串</span>\n              <span>电压</span>\n              <span>电流</span>\n            </li>\n            <li class=\"info-item\" v-for=\"(i, index) in data.seriesList\" :key=\"index\">\n              <span\n                class=\"device-status-color\"\n                :class=\"getSeriesStatusColor(data.seriesStatus[index])\"\n                >{{ i }}</span\n              >\n              <span\n                v-if=\"data.ulist && data.ulist.length\"\n                class=\"device-status-color\"\n                :class=\"getSeriesStatusColor(data.seriesStatus[index])\"\n                >{{ data.ulist[index] }}</span\n              >\n              <span\n                v-if=\"data.ilist && data.ilist.length\"\n                class=\"device-status-color\"\n                :class=\"getSeriesStatusColor(data.seriesStatus[index])\"\n                >{{ data.ilist[index] }}</span\n              >\n              <!--  黄色数字：class=\"warning-text\" -->\n            </li>\n          </ul>\n        </div>\n      </template>\n    </Popover>\n    <div v-else class=\"device-item\">\n      <div\n        class=\"device-label\"\n        :style=\"{ background: deviceAbnormalTypeColors[data.deviceShowFlag] }\"\n        >{{ data[options.deviceLabelKey || 'name'] }}</div\n      >\n      <div class=\"device-data-box\">\n        <div class=\"left\">\n          <div class=\"device-img-box\">\n            <i\n              class=\"iconfont\"\n              :class=\"getDeviceIcon\"\n              :style=\"{ color: deviceAbnormalTypeColors[data.deviceShowFlag], fontSize: '54px' }\"\n            ></i>\n          </div>\n          <div v-if=\"data.pvTotal > 0\" class=\"number-text\"\n            >{{ data[options.left || 'pvTotal'] }}kWp</div\n          >\n        </div>\n        <div v-if=\"data.actualDataList && data.actualDataList.length\" class=\"right\">\n          <div class=\"right-item\" v-for=\"(item, index) in data.actualDataList\" :key=\"index\">\n            <div class=\"right-label\">{{ item.addressDesc }}</div>\n            <div class=\"right-data\">\n              <span class=\"data-text\">{{ item.data }}</span>\n              <span class=\"unit-text\">{{ item.unit }}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import { computed, reactive, ref, toRefs } from 'vue';\n  // import deviceImg from './images/device.png';\n  import { Popover } from 'ant-design-vue';\n\n  const props = defineProps({\n    options: {\n      type: Object,\n    },\n    data: {\n      type: Object,\n      default: {},\n    },\n    showSeries: Boolean,\n    deviceType: { type: String, default: '' },\n  });\n  const { options, data, showSeries, deviceType } = toRefs(props);\n\n  // 设备状态颜色对应\n  const deviceAbnormalTypeColors = {\n    normal: '#019CFC', // 正常\n    halt: '#FF8184', // 停机\n    alarm: '#E3C700', // 告警\n    interrupt: '#D2D2D2', // 通讯中断\n  };\n\n  // 设备图标\n  const deviceIcons = {\n    StringFormation: 'icon-zuchuannibianqi', // 组串式逆变器\n    Transformer: 'icon-xiangbian', // 箱变\n    TransformerMeter: 'icon-xiangbiandianbiao', // 箱变电表\n    DataCollector: 'icon-shucai', // 数据采集器\n    Concentrate: 'icon-jizhongshinibianqi', // 集中式逆变器\n    CombinerDc: 'icon-huiliuxiang', // 直流汇流箱\n    DataCollector: 'icon-shucai', // 数据采集器\n    MeasureControl: 'icon-cekong', // 测控\n    Protect: 'icon-baohu', // 保护\n    EMSController: 'icon-tongyong', // EMS控制器\n    PowerConversionSystem: 'icon-tongyong', // PCS\n    BatteryManagementSystem: 'icon-BMS', // BMS\n    CombinerDc: 'icon-huiliuxiang', // 直流汇流箱\n    TrackingAxis: 'icon-genzongzhou', // 跟踪轴\n    Svg: 'icon-SVG', // SVG\n    Yanaco: 'icon-huanjingyi', // 环境仪\n    DcScreen: 'icon-zhiliuping', // 直流屏\n    LocalController: 'icon-tongyong', // 本地控制器\n    AGC: 'icon-tongyong', // AGC\n    ElectricityMeter: 'icon-dianbiao', // 电表\n  };\n\n  const getDeviceIcon = computed(() => {\n    return deviceIcons[deviceType.value] || 'icon-qitashebei';\n  });\n  // 获取组串状态图标\n  const getSeriesStatusIcon = (item) => {\n    switch (item) {\n      case 'normal':\n        if (props.data.deviceShowFlag === 'interrupt') {\n          return 'communication-outage';\n        }\n        return 'normal';\n        break;\n      case 'yield':\n        if (props.data.deviceShowFlag === 'interrupt') {\n          return 'communication-outage';\n        }\n        return 'offline';\n        break;\n      case 'lower':\n        if (props.data.deviceShowFlag === 'interrupt') {\n          return 'communication-outage';\n        }\n        return 'I-abnormal';\n        break;\n      case 'error':\n        if (props.data.deviceShowFlag === 'interrupt') {\n          return 'communication-outage';\n        }\n        return 'I-abnormal';\n        break;\n      case 'zero':\n        if (props.data.deviceShowFlag === 'interrupt') {\n          return 'communication-outage';\n        }\n        return 'I-abnormal';\n        break;\n      case 'invalid':\n        return 'communication-outage';\n        break;\n      default:\n        return 'unconnected';\n        break;\n    }\n  };\n\n  const getSeriesStatusColor = (item) => {\n    switch (item) {\n      case 'error':\n        return 'zero';\n        break;\n      case 'zero':\n        return 'zero';\n        break;\n      default:\n        return 'normal';\n        break;\n    }\n  };\n  const getSeriesValue = (item) => {\n    if (item === 'yield') {\n      return '--';\n    }\n  };\n</script>\n\n<style lang=\"less\" scoped>\n  .device-item {\n    width: 187px;\n    min-height: 208px;\n    border: 1px solid #e5e5e5;\n    border-radius: 2px;\n\n    &:hover,\n    &.active {\n      box-shadow: 0 0 6px 1px rgb(24 144 255 / 40%);\n    }\n\n    .device-label {\n      display: inline-block;\n      min-width: 88px;\n      height: 32px;\n      margin-top: 6px;\n      padding: 0 15px 0 9px;\n      border-radius: 0 4px 4px 0;\n      opacity: 0.8;\n      background: linear-gradient(45deg, #19add8 0%, #0e9ed3 0%, #4fb2e5 100%);\n      color: #fff;\n      font-size: 16px;\n      line-height: 32px;\n    }\n\n    .device-data-box {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      min-height: 120px;\n      padding: 6px 0 0;\n      line-height: 1;\n\n      .left {\n        margin-right: 16px;\n\n        &:last-child {\n          margin-right: 0;\n        }\n      }\n\n      .device-img-box {\n        margin-bottom: 16px;\n        text-align: center;\n\n        .device-img {\n          width: 68px;\n        }\n\n        &:last-child {\n          margin-bottom: 0;\n        }\n      }\n\n      .number-text {\n        color: #359eff;\n        font-size: 14px;\n        font-weight: 600;\n        text-align: center;\n      }\n\n      .right {\n        width: 51%;\n      }\n\n      .right-item {\n        margin-bottom: 8px;\n\n        .right-label {\n          margin-bottom: 4px;\n          overflow: hidden;\n          color: #666;\n          font-size: 12px;\n          white-space: nowrap;\n        }\n\n        .data-text {\n          color: #00b4e0;\n          font-size: 14px;\n          font-weight: 600;\n        }\n\n        .unit-text {\n          color: #666;\n          font-size: 14px;\n        }\n      }\n    }\n\n    .device-status-list {\n      display: flex;\n      flex-wrap: wrap;\n      margin: 0 -4px 0 6px;\n      padding-bottom: 6px;\n\n      .device-status-icon {\n        width: 18px;\n        height: 34px;\n        margin-top: 5px;\n        margin-right: 4px;\n        background: no-repeat center / 18px 34px;\n\n        &.normal {\n          background-image: url('./images/status-icon1.png');\n        }\n\n        &.offline {\n          background-image: url('./images/status-icon3.png');\n        }\n\n        &.I-abnormal {\n          background-image: url('./images/status-icon2.png');\n        }\n\n        &.communication-outage {\n          background-image: url('./images/status-icon4.png');\n        }\n\n        &.unconnected {\n          background-image: url('./images/status-icon5.png');\n        }\n      }\n    }\n\n    .device-status-list-outer {\n      position: relative;\n\n      &::after {\n        content: '';\n        display: block;\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: calc(100% - 12px);\n        height: 1px;\n        margin: 0 6px;\n      }\n    }\n  }\n</style>\n<style lang=\"less\">\n  .device-popover {\n    .ant-popover-inner-content {\n      color: #fff;\n      text-align: center;\n    }\n\n    .date-box {\n      font-size: 12px;\n    }\n\n    .info-list {\n      margin-bottom: 0;\n      padding-left: 0;\n\n      .info-title {\n        display: flex;\n        font-size: 13px;\n\n        & > span {\n          flex: 1;\n        }\n      }\n\n      .info-item {\n        display: flex;\n        font-size: 12px;\n\n        & > span {\n          flex: 1;\n          transform: scale(0.9);\n        }\n\n        .warning-text {\n          color: #eec02e;\n        }\n\n        .device-status-color {\n          &.normal {\n            color: #fff;\n          }\n\n          &.error {\n            color: #ff4d4f !important;\n          }\n\n          &.zero {\n            color: #ff4d4f !important;\n          }\n        }\n      }\n    }\n  }\n</style>\n"],"names":["options","data","showSeries","deviceType","toRefs","props","deviceAbnormalTypeColors","deviceIcons","getDeviceIcon","computed","getSeriesStatusIcon","item","getSeriesStatusColor"],"mappings":"4nCAyIQ,CAAE,QAAAA,EAAS,KAAAC,EAAM,WAAAC,GAAY,WAAAC,GAAeC,EAAOC,CAAK,EAGxDC,EAA2B,CAC/B,OAAQ,UACR,KAAM,UACN,MAAO,UACP,UAAW,SAAA,EAIPC,EAAc,CAClB,gBAAiB,uBACjB,YAAa,iBACb,iBAAkB,yBAClB,cAAe,cACf,YAAa,0BACb,WAAY,mBACZ,cAAe,cACf,eAAgB,cAChB,QAAS,aACT,cAAe,gBACf,sBAAuB,gBACvB,wBAAyB,WACzB,WAAY,mBACZ,aAAc,mBACd,IAAK,WACL,OAAQ,kBACR,SAAU,kBACV,gBAAiB,gBACjB,IAAK,gBACL,iBAAkB,eAAA,EAGdC,EAAgBC,EAAS,IACtBF,EAAYJ,EAAW,KAAK,GAAK,iBACzC,EAEKO,EAAuBC,GAAS,CACpC,OAAQA,EAAM,CACZ,IAAK,SACC,OAAAN,EAAM,KAAK,iBAAmB,YACzB,uBAEF,SAET,IAAK,QACC,OAAAA,EAAM,KAAK,iBAAmB,YACzB,uBAEF,UAET,IAAK,QACC,OAAAA,EAAM,KAAK,iBAAmB,YACzB,uBAEF,aAET,IAAK,QACC,OAAAA,EAAM,KAAK,iBAAmB,YACzB,uBAEF,aAET,IAAK,OACC,OAAAA,EAAM,KAAK,iBAAmB,YACzB,uBAEF,aAET,IAAK,UACI,MAAA,uBAET,QACS,MAAA,aAEX,CAAA,EAGIO,EAAwBD,GAAS,CACrC,OAAQA,EAAM,CACZ,IAAK,QACI,MAAA,OAET,IAAK,OACI,MAAA,OAET,QACS,MAAA,QAEX,CAAA"}