var R=(p,$,b)=>new Promise((S,n)=>{var P=v=>{try{y(b.next(v))}catch(k){n(k)}},h=v=>{try{y(b.throw(v))}catch(k){n(k)}},y=v=>v.done?S(v.value):Promise.resolve(v.value).then(P,h);y((b=b.apply(p,$)).next())});import ae from"./VideoMonitor-7dfc3af5.js";import ne from"./RealStatus-344d80cd.js";import ce from"./RealStatusModal-01f4bc53.js";import{am as G,I as x,a7 as O,a5 as Z,_ as re}from"./index.js";import{E as C,g as L,d as j}from"./flvtools-b93f1fee.js";import{a as B}from"./assign-37f1c13d.js";import{d as de,k as r,r as z,o as ue,al as ve,Z as u,_,$ as o,F as A,ae as J,a5 as me,ad as T,a9 as H,ac as E,f,aa as D,E as N,aG as fe,aH as pe}from"./vue-71d1abb3.js";import"./DeviceStatusInfo3-c6f9bba6.js";import"./index-0c1c0ee9.js";import"./MonitorVideoItem-196e081b.js";import"./antd-15ac76ed.js";import"./TrackReplay-432cfa35.js";import"./TimeSlider-bdb1df9d.js";import"./HistoryVideo-cec157e4.js";import"./BasicTable-0434a334.js";import"./useForm-dea3ed18.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1ba7be9e.js";import"./index-f4fc48e6.js";import"./index-316f6ffb.js";import"./useWindowSizeFn-13b1b8a2.js";import"./useTabs-2b062e85.js";import"./download-03e71dd5.js";import"./index-5d49b7a7.js";import"./SearchBox-22bb02d6.js";import"./UploadBox-636ecf02.js";import"./Dialog-0a006d82.js";import"./DictSelectBox.vue_vue_type_script_setup_true_lang-e03e9fe8.js";import"./OrganDialog-dd1023ce.js";import"./uniqBy-92d3bc7f.js";import"./index-085d06c7.js";import"./sortable.esm-4ae27e0b.js";import"./dict-c04c0dd8.js";import"./useTable-109483b3.js";const be=p=>(fe("data-v-5369b74c"),p=p(),pe(),p),he={class:"left-bg-box"},ye={class:"tab-box"},_e=["onClick"],ge={class:"tab-content-box"},ke={key:0,class:"right-content",style:{opacity:"1","background-color":"#04284c"}},Ie={class:"right-bg-box"},xe={id:"gridView",class:"video-list-layout"},Te=["id"],Se={class:"monitor-video-item",style:{width:"100%",height:"100%","background-color":"black"}},we=["id","onClick","onDblclick"],Ve={class:"title-box"},Ce={id:"fullView",class:"monitor-video-item hidden"},Le={class:"video-box"},Be=be(()=>o("div",{id:"fullVideo",style:{width:"100%",height:"76vh","min-height":"650px","background-color":"black"}},null,-1)),Ee={class:"title-box"},De={style:{position:"absolute",right:"20px",bottom:"97px"}},Ne={style:{display:"flex","flex-direction":"column","align-items":"center"}},$e={style:{height:"20px"}},Pe={style:{display:"flex","flex-direction":"column","align-items":"center"}},Me={style:{display:"flex","flex-direction":"column","align-items":"center","margin-top":"20px"}},ze={style:{"flex-direction":"column","margin-top":"10px","text-align":"center"}},Ae=de({__name:"Device",props:{searchStationInfo:{}},setup(p,{expose:$}){const b=p,S=r(G()),n=r("1"),P=r([{tabIndex:"1",tabLabel:"视频监控"},{tabIndex:"2",tabLabel:"电子工牌"},{tabIndex:"3",tabLabel:"巡检终端"},{tabIndex:"4",tabLabel:"行车记录仪"}]),h=r(!1),y=r({}),v=({type:e,record:t,removeEvent:i})=>{y.value=t,y.value.bizType=e,h.value=!0,i()},k=()=>{h.value=!1},Q=()=>{O.getInstance().listen("smart-device-modal-info",v),O.getInstance().listen("smart-device-modal",e=>{h.value=e})},U=r([]),I=z({});let a=0;const c=z({}),q=r(!1),w=r(null),m=r([]),F=z({});function W(e,t){B(I,e),a=t}const K=()=>{for(let e=0;e<l.value.length;e++){const t=r(null);setTimeout(function(){if(l.value[e].url!=null&&l.value[e].url!=""){const i=l.value[e],s=[i.id,i.url,i.accessToken,!0,C.HTTP];t.value=L(...s),m.value.push(t.value)}},300),m.value.push(t.value)}};function X(e,t){V(m.value[t]),setTimeout(function(){const i=[e.id,e.url,e.accessToken,!0,C.HTTP];m.value[t]=L(...i)},10)}function Y(e){e!=null&&e.nodeKindId!="station"&&setTimeout(function(){I.id!=null&&I.id!=""&&(V(m.value[a]),e.url!=null&&e.url!=""&&(l.value[a].cameraName=e.name,l.value[a].stationName=e.powerStationName,l.value[a].url=e.url,l.value[a].accessToken=e.accessToken,l.value[a].deviceSerial=e.deviceSerial,l.value[a].channelNo=e.channelNo,l.value[a].id=e.id+new Date,V(m.value[a]),setTimeout(function(){const t=[I.id,e.url,e.accessToken,!0,C.HTTP];m.value[a]=L(...t)},300),B(I,l.value[a])))},300)}function ee(e){B(c,e);var t=document.getElementById("fullView");t.classList.remove("hidden");var i=document.getElementById("gridView");i.classList.add("hidden"),i.classList.remove("video-list-layout"),q.value=!0,setTimeout(function(){document.querySelectorAll(".arrowButton").forEach(function(s){s.classList.remove("ant-btn")}),c.url!=null&&c.url!=""&&setTimeout(function(){w.value=L("fullVideo",e.url,e.accessToken,!0,C.HTTP)},300)},300)}function te(){var e=document.getElementById("fullView");e.classList.add("hidden");var t=document.getElementById("gridView");t.classList.remove("hidden"),t.classList.add("video-list-layout"),V(w.value),q.value=!1}function V(e){e!=null&&(e.destroy(),e=null)}function g(e,t){e.direction=t,oe(e)}const oe=e=>Z.get({url:"/baseset/videoInfo/videoControl",params:e},{}),l=r(),le=e=>Z.get({url:"/baseset/videoInfo/list",params:e},{isOnlyResult:!0}),ie=e=>{n.value=e.tabIndex,h.value=!1,e.tabIndex==1&&setTimeout(function(){K(),document.querySelectorAll(".grid-item").forEach(function(t){t.addEventListener("click",function(){document.querySelectorAll(".grid-item.selected").forEach(function(i){i.classList.remove("selected")}),this.classList.add("selected")})})},300)},se=()=>{try{const e=m.value;for(let t=0;t<e.length;t++)j(e[t]),e[t]=null;j(w.value),w.value=null,m.value=[]}catch(e){console.error("destory all player error: ",e)}};return $({handleUpdate:()=>{S.value=G()},destory:()=>{se()}}),ue(()=>R(this,null,function*(){Q(),B(F,b.searchStationInfo),U.value=yield le({nodeKindId:"station",searchId:F.stationUUId}),l.value=U.value.slice(0,9),setTimeout(function(){K(),document.querySelectorAll(".grid-item").forEach(function(e){e.addEventListener("click",function(){document.querySelectorAll(".grid-item.selected").forEach(function(t){t.classList.remove("selected")}),this.classList.add("selected")})})},300)})),(e,t)=>{const i=ve("a-button");return u(),_(A,null,[(u(),_("div",{class:"left-content",key:S.value},[o("div",he,[o("div",ye,[(u(!0),_(A,null,J(P.value,(s,d)=>(u(),_("div",{class:me(["tab-item",{active:n.value===s.tabIndex}]),key:d,onClick:M=>ie(s)},T(s.tabLabel),11,_e))),128))]),o("div",ge,[n.value==="1"?(u(),H(ae,{key:0,searchStationInfo:b.searchStationInfo,onSelect:Y},null,8,["searchStationInfo"])):E("",!0),n.value==="2"||n.value==="3"||n.value==="4"?(u(),H(ne,{key:1,tabIndex:n.value},null,8,["tabIndex"])):E("",!0)])])])),n.value==="1"?(u(),_("div",ke,[o("div",Ie,[o("div",xe,[(u(!0),_(A,null,J(l.value,(s,d)=>(u(),_("div",{class:"monitor-video-item-layout grid-item",key:d,id:"videoDiv"+d},[o("div",Se,[o("div",{id:l.value[d].id,class:"video-box",width:"100%",height:"100%",onClick:M=>W(s,d),onDblclick:M=>X(l.value[d],d)}," 视频 ",40,we),o("div",Ve,[o("span",null,T(l.value[d].stationName)+" - "+T(l.value[d].cameraName),1),f(x,{icon:"fluent-mdl2:scale-volume",style:{"font-size":"0.14rem"},onClick:M=>ee(s)},null,8,["onClick"])])])],8,Te))),128))]),o("div",Ce,[o("div",Le,[Be,o("div",Ee,[o("span",null,T(c.stationName)+" - "+T(c.cameraName),1),f(x,{class:"full",icon:"uil:compress-arrows",size:"20",onClick:t[0]||(t[0]=s=>te())})]),f(x,{class:"background-image",icon:"tabler:direction-arrows",size:"80"}),o("div",De,[o("div",Ne,[f(i,{class:"arrowButton",onClick:t[1]||(t[1]=s=>g(c,0))},{default:D(()=>[N("上")]),_:1})]),o("div",$e,[f(i,{class:"arrowButton",onClick:t[2]||(t[2]=s=>g(c,2))},{default:D(()=>[N("左")]),_:1}),f(i,{class:"arrowButton",onClick:t[3]||(t[3]=s=>g(c,3))},{default:D(()=>[N("右")]),_:1})]),o("div",Pe,[f(i,{class:"arrowButton",onClick:t[4]||(t[4]=s=>g(c,1))},{default:D(()=>[N("下")]),_:1})]),o("div",Me,[f(x,{class:"controlButton",icon:"material-symbols:add",size:"30",style:{display:"inline-block"},onClick:t[5]||(t[5]=s=>g(c,8))})]),o("div",ze,[f(x,{class:"controlButton",icon:"ant-design:line-outlined",size:"30",style:{display:"inline-block"},onClick:t[6]||(t[6]=s=>g(c,9))})])])])])])])):E("",!0),h.value?(u(),H(ce,{key:1,closeModal:k,infoData:y.value},null,8,["infoData"])):E("",!0)],64)}}});const kt=re(Ae,[["__scopeId","data-v-5369b74c"]]);export{kt as default};
//# sourceMappingURL=Device-ae4cbf21.js.map
