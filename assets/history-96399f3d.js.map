{"version":3,"file":"history-96399f3d.js","sources":["../../src/views/monitor/smartdevice/video/history.vue"],"sourcesContent":["<template>\n  <PageWrapper\n    dense\n    contentFullHeight\n    fixedHeight\n    contentClass=\"flex\"\n    style=\"display: flex; position: relative; height: 100%\"\n  >\n    <div class=\"w-2/6\">\n      <div class=\"info-content-box\">\n        <div class=\"device-info-box\">\n          <div class=\"info-row\">\n            <span class=\"label\" style=\"width: 5em\">开始时间：</span>\n            <a-date-picker\n              v-model:value=\"startTime\"\n              format=\"YYYY-MM-DD HH:mm\"\n              value-format=\"YYYY-MM-DD HH:mm\"\n              show-time\n              style=\"width: 100%\"\n            />\n          </div>\n          <div class=\"info-row\">\n            <span class=\"label\" style=\"width: 5em\">结束时间：</span>\n            <a-date-picker\n              v-model:value=\"endTime\"\n              format=\"YYYY-MM-DD HH:mm\"\n              value-format=\"YYYY-MM-DD HH:mm\"\n              show-time\n              style=\"width: 100%\"\n            />\n          </div>\n          <div class=\"info-row search-btn\">\n            <a-button class=\"operation-btn\" type=\"primary\" @click=\"handleSearch\">查询</a-button>\n          </div>\n          <div class=\"info-row\">\n            <BasicTable\n              @register=\"registerTable\"\n              @resize-column=\"(w, col) => (col.width = w)\"\n              @row-click=\"handleRowClick\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"w-4/6 box\">\n      <div id=\"Player\"></div>\n    </div>\n  </PageWrapper>\n</template>\n<script lang=\"ts\" setup>\n  import { onMounted, ref } from 'vue';\n  import { BasicTable, useTable } from '@/components/Table';\n  import { getVideoInfoUrl, columns, getIiFilePage } from './data';\n\n  const player = ref();\n  const startTime = ref();\n  const endTime = ref();\n\n  const getPageByParam = async () => {\n    const param = { startTime: startTime.value, endTime: endTime.value };\n    if (param.startTime) {\n      param.startTime = param.startTime + ':00';\n    }\n    if (param.endTime) {\n      param.endTime = param.endTime + ':59';\n    }\n    return await getIiFilePage(param);\n  };\n\n  const [registerTable, { reload }] = useTable({\n    api: getPageByParam,\n    columns: columns,\n    useSearchForm: false,\n    showTableSetting: false,\n    bordered: true,\n    pagination: false,\n    rowKey: 'id',\n    rowSelection: {\n      type: 'radio',\n    },\n  });\n\n  const handleSearch = () => {\n    reload();\n  };\n\n  const handleRowClick = (record) => {\n    console.log('record', record);\n    // 调用播放\n    player.value.play(record.filePath, 1);\n  };\n\n  const initWasmPlayer = () => {\n    player.value = new WasmPlayer(null, 'Player', callbackFun, {\n      cbUserPtr: this,\n      decodeType: 'auto',\n      live: true,\n      openAudio: 1,\n      closeAudio: 0,\n      BigPlay: false,\n      Height: true,\n    });\n    // 调用播放\n    player.value.play(getVideoInfoUrl, 1);\n  };\n\n  const callbackFun = (e) => {\n    console.log('callbackFun', e);\n  };\n\n  onMounted(() => {\n    initWasmPlayer();\n  });\n</script>\n<style lang=\"less\">\n[data-theme='dark'] .theme1 {\n  .info-content-box {\n      background-color: rgb(7 59 109 / 50%);\n      .info-row {\n        border-bottom: 1px solid rgb(255 255 255 / 16%);\n        .label {\n          color: rgb(255 255 255 / 60%);\n        }\n        .text {\n          color: #fff;\n        }\n      }\n    }\n}\n.theme3 {\n  .info-content-box {\n      background-color: rgba(24, 144, 255, 0.06);\n      .info-row {\n        border-bottom: 1px solid rgba(153, 153, 153, 0.1);\n        .label {\n          color: #777;\n        }\n        .text {\n          color: #262626;\n        }\n      }\n    }\n}\n</style>\n<style lang=\"less\" scoped>\n  .info-content-box {\n    padding: 20px;\n    border-radius: 2px;   \n\n    .search-btn {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n\n    .info-row {\n      display: flex;\n      align-items: center;\n      min-height: 50px;\n      padding: 10px 0;\n      font-size: 14px;\n\n      .label {\n        flex-shrink: 0;\n        margin-right: 6px;\n        text-align: right;\n      }\n\n      .operation-btn {\n        height: 24px;\n        padding: 0 9px;\n        font-size: 12px;\n\n        & + .operation-btn {\n          margin-left: 2px;\n        }\n      }\n    }\n  }\n</style>\n"],"names":["player","ref","startTime","endTime","getPageByParam","__async","param","getIiFilePage","registerTable","reload","useTable","columns","handleSearch","handleRowClick","record","initWasmPlayer","callbackFun","getVideoInfoUrl","onMounted"],"mappings":"miDAsDE,MAAMA,EAASC,IACTC,EAAYD,IACZE,EAAUF,IAEVG,EAAiB,IAAYC,EAAA,sBACjC,MAAMC,EAAQ,CAAE,UAAWJ,EAAU,MAAO,QAASC,EAAQ,OAC7D,OAAIG,EAAM,YACFA,EAAA,UAAYA,EAAM,UAAY,OAElCA,EAAM,UACFA,EAAA,QAAUA,EAAM,QAAU,OAE3B,MAAMC,EAAcD,CAAK,CAAA,GAG5B,CAACE,EAAe,CAAE,OAAAC,CAAQ,CAAA,EAAIC,EAAS,CAC3C,IAAKN,EACL,QAAAO,EACA,cAAe,GACf,iBAAkB,GAClB,SAAU,GACV,WAAY,GACZ,OAAQ,KACR,aAAc,CACZ,KAAM,OACR,CAAA,CACD,EAEKC,EAAe,IAAM,CAClBH,GAAA,EAGHI,EAAkBC,GAAW,CACzB,QAAA,IAAI,SAAUA,CAAM,EAE5Bd,EAAO,MAAM,KAAKc,EAAO,SAAU,CAAC,CAAA,EAGhCC,EAAiB,IAAM,CAC3Bf,EAAO,MAAQ,IAAI,WAAW,KAAM,SAAUgB,EAAa,CACzD,UAAW,KACX,WAAY,OACZ,KAAM,GACN,UAAW,EACX,WAAY,EACZ,QAAS,GACT,OAAQ,EAAA,CACT,EAEMhB,EAAA,MAAM,KAAKiB,EAAiB,CAAC,CAAA,EAGhCD,EAAe,GAAM,CACjB,QAAA,IAAI,cAAe,CAAC,CAAA,EAG9B,OAAAE,EAAU,IAAM,CACCH,GAAA,CAChB"}