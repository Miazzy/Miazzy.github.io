{"version":3,"file":"create-34eca8a4.js","sources":["../../src/views/po/workorder/create.vue"],"sourcesContent":["<template>\n  <PageWrapper\n    :detail=\"true\"\n    dense\n    contentFullHeight\n    fixedHeight\n    contentClass=\"fix-detail-page\"\n    style=\"position: relative\"\n  >\n    <div class=\"load\">\n      <a-spin :spinning=\"formState.spinning\" tip=\"Loading...\">\n        <div class=\"process-box\">\n          <!-- 标题和操作按钮 -->\n          <div class=\"header-box\">\n            <BillTitle :options=\"billTitleOption\" />\n            <WfApproveBox\n              @save=\"onSave\"\n              @submit=\"onSubmit\"\n              @before=\"onBefore\"\n              :processInstanceId=\"formState.processInstanceId\"\n              :processStatus=\"formState.status\"\n              :mode=\"getApproveBoxMode\"\n              :businessStatus=\"businessStatus\"\n              :listenMessage=\"listenMessage\"\n            />\n            <!-- <PrintButton style=\"margin-left: 10px\" v-if=\"formState.status === 2\" /> -->\n          </div>\n          <!-- 表单内容 -->\n          <div class=\"content\">\n            <a-form ref=\"formRef\" :model=\"formState\" labelAlign=\"right\" autocomplete=\"off\">\n              <FaultWorkOrder\n                ref=\"childWorkOrderRef\"\n                :formState=\"formState\"\n                :disabledInput=\"disabledInput\"\n                :showProcess=\"process.process.show\"\n                :disabledProcessInput=\"process.process.disabled\"\n                :stationPersonOptions=\"stationPersonOptions\"\n                v-if=\"isFault\"\n              />\n\n              <HiddenWorkOrder\n                ref=\"childWorkOrderRef\"\n                :formState=\"formState\"\n                :disabledInput=\"disabledInput\"\n                :showProcess=\"process.process.show\"\n                :disabledProcessInput=\"process.process.disabled\"\n                :stationPersonOptions=\"stationPersonOptions\"\n                v-else-if=\"isHidden\"\n              />\n\n              <DailyWorkOrder\n                ref=\"childWorkOrderRef\"\n                :formState=\"formState\"\n                :disabledInput=\"disabledInput\"\n                :showProcess=\"process.process.show\"\n                :disabledProcessInput=\"process.process.disabled\"\n                :stationPersonOptions=\"stationPersonOptions\"\n                v-else-if=\"isDaily\"\n              />\n\n              <a-card title=\"结果确认\" :bordered=\"false\" v-if=\"process.confirm.show\">\n                <a-row :gutter=\"32\">\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"result\"\n                      label=\"验证结果\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                      :rules=\"[{ required: true, message: '请选择验证结果' }]\"\n                    >\n                      <DictSelectBox\n                        v-model:value=\"formState.result\"\n                        :type=\"`validate_result`\"\n                        :disabled=\"process.confirm.disabled\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"confirmByName\"\n                      label=\"确认人\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                      :rules=\"[{ required: true, message: '请选择确认人' }]\"\n                    >\n                      <a-select\n                        v-model:value=\"formState.confirmByName\"\n                        show-search\n                        allow-clear\n                        style=\"width: 100%\"\n                        :options=\"stationPersonOptions\"\n                        @change=\"handleChangeConfirmByName\"\n                        :disabled=\"process.confirm.disabled\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n\n                <a-row :gutter=\"32\">\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"confirmDate\"\n                      label=\"确认时间\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                      :rules=\"[{ required: true, message: '请输入确认时间' }]\"\n                    >\n                      <a-date-picker\n                        v-model:value=\"formState.confirmDate\"\n                        show-time\n                        format=\"YYYY-MM-DD HH:mm\"\n                        value-format=\"YYYY-MM-DD HH:mm\"\n                        :style=\"`width: 100%`\"\n                        :disabled=\"process.confirm.disabled\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"duration\"\n                      label=\"处理时长(h)\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                      :rules=\"[{ required: true, message: '请输入处理时长(h)' }]\"\n                    >\n                      <a-input-number\n                        v-model:value=\"formState.duration\"\n                        :min=\"1\"\n                        :max=\"100000000\"\n                        :precision=\"2\"\n                        :disabled=\"process.confirm.disabled\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n\n                <a-row :gutter=\"32\" v-if=\"formState.workOrderType === 'qx'\">\n                  <a-col v-show=\"true\" :span=\"12\">\n                    <a-form-item\n                      name=\"lossTotal\"\n                      label=\"产生损耗电量(kWh)\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                      :rules=\"[{ required: true, message: '请输入产生损耗电量(kWh)' }]\"\n                    >\n                      <a-input-number\n                        v-model:value=\"formState.lossTotal\"\n                        :min=\"0\"\n                        :max=\"99999999\"\n                        :precision=\"4\"\n                        :disabled=\"process.confirm.disabled\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n\n                <a-row :gutter=\"32\">\n                  <a-col v-show=\"true\" :span=\"24\">\n                    <a-form-item\n                      name=\"resultDescription\"\n                      label=\"结果确认\"\n                      :labelCol=\"{ class: 'detail-label-8' }\"\n                      :rules=\"[{ required: true, message: '请输入结果确认' }]\"\n                    >\n                      <a-textarea\n                        v-model:value=\"formState.resultDescription\"\n                        show-count\n                        :rows=\"4\"\n                        :maxlength=\"1000\"\n                        :disabled=\"process.confirm.disabled\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n\n                <a-row :gutter=\"32\">\n                  <a-col v-show=\"true\" :span=\"24\">\n                    <a-form-item name=\"remark\" label=\"备注\" :labelCol=\"{ class: 'detail-label-8' }\">\n                      <a-textarea\n                        v-model:value=\"formState.remark\"\n                        show-count\n                        :rows=\"4\"\n                        :maxlength=\"1000\"\n                        :disabled=\"process.confirm.disabled\"\n                      />\n                    </a-form-item>\n                  </a-col>\n                </a-row>\n              </a-card>\n\n              <a-card title=\"附件资料\" :bordered=\"false\">\n                <div class=\"detail-upload-table\">\n                  <UploadTable\n                    ref=\"uploadTable\"\n                    :rows=\"uploadRows\"\n                    :colwidths=\"['15%', '70%', '15%']\"\n                    :application=\"`po`\"\n                    :module=\"`workorder`\"\n                    :mode=\"\n                      !disabledInput || !process.process.disabled || !process.confirm.disabled\n                        ? `normal`\n                        : `view`\n                    \"\n                  />\n                </div>\n              </a-card>\n            </a-form>\n          </div>\n        </div>\n      </a-spin>\n    </div>\n  </PageWrapper>\n</template>\n<script lang=\"ts\" setup>\n  import { onMounted, reactive, ref, UnwrapRef, toRaw, computed } from 'vue';\n  import { ValidateErrorEntity } from 'ant-design-vue/es/form/interface';\n  import type { SelectProps } from 'ant-design-vue';\n  import { FormInstance } from 'ant-design-vue';\n  import { SysMessage } from '/@/hooks/web/useMessage';\n  // import PrintButton from '/@/components/Framework/Button/PrintButton.vue';\n  import BillTitle from '/@/components/Framework/BillTitle/BillTitle.vue';\n  import DictSelectBox from '@/components/Framework/Combox/DictSelectBox.vue';\n  import UploadTable from '/@/components/Framework/Table/UploadTable.vue';\n  import WfApproveBox from '/@/components/Framework/WorkFlow/WfApproveBox.vue';\n  import FaultWorkOrder from './FaultWorkOrder.vue';\n  import HiddenWorkOrder from './HiddenWorkOrder.vue';\n  import DailyWorkOrder from './DailyWorkOrder.vue';\n  import { saveData, getData, getStationPerson } from './workorder.data';\n  import * as ProcessInstanceApi from '@/api/bpm/processInstance';\n  import { assign } from 'lodash-es';\n  import { useUserStore } from '/@/store/modules/user';\n  import { closeCurrentTab } from '@/utils/route';\n  import { MsgManager } from '@/message/MsgManager';\n  import { buildShortUUID } from '@/utils/uuid';\n  import { Memory } from '@/router/index';\n\n  const userStore = useUserStore();\n  const userInfo = toRaw(userStore.getUserInfo);\n  const query = Memory.getInstance().getQuery(); // route.query;\n  const formRef = ref<FormInstance>();\n  const formState: UnwrapRef<any> = reactive({\n    spinning: false,\n    status: 0,\n    fault: {},\n    hidden: {},\n    daily: {},\n  });\n  const stationPersonOptions = ref<SelectProps['options']>([]) as any;\n  const billTitleOption = reactive<any>({ subject: '工单申请' });\n  const isHidden = ref<boolean>(false);\n  const isFault = ref<boolean>(false);\n  const isDaily = ref<boolean>(false);\n  const disabledInput = ref<boolean>(true);\n  const process = reactive({\n    // 处理人节点\n    process: {\n      show: false,\n      disabled: true,\n    },\n    // 确认人节点\n    confirm: {\n      show: false,\n      disabled: true,\n    },\n  });\n  const childWorkOrderRef = ref();\n  // 流程操作类型\n  const businessStatus = ref('');\n  const listenMessage = ref(query.processInstanceId ? undefined : 'work-order');\n  const getApproveBoxMode = computed(() => {\n    return !process.process.disabled || !process.confirm.disabled ? 'before' : 'default';\n  });\n  // 流程操作前\n  const onBefore = (flowData, beforeOperationType) => {\n    const action = beforeOperationType.replace('before', '').toLowerCase();\n    onSubmit(flowData, action);\n  };\n  const validateProcessForm = (formData, flowData, action) => {\n    if (action !== 'agree') {\n      return true;\n    }\n    // 过程数据校验\n    if (!process.process.disabled) {\n      if (\n        !(formData.workOrderType === 'qx' || formData.workOrderType === 'yh') &&\n        !compareDate(formData.daily.endDate, formData.daily.startDate)\n      ) {\n        error('开始时间必须小于结束时间');\n        return false;\n      }\n      if (formData.isInvoicing === '1') {\n        const tableData = childWorkOrderRef.value.getTicketList();\n        if (tableData.length === 0) {\n          error('请关联开具两票数据');\n          return false;\n        }\n      }\n    }\n    return true;\n  };\n\n  const onSave = () => {\n    doSave('save', 0);\n  };\n\n  const onSubmit = async (flowData, action) => {\n    const value = formRef.value;\n    if (!value) {\n      return;\n    }\n    // 校验表单数据\n    if (action === 'submit' || action === 'agree') {\n      let pass = true;\n      await value.validateFields().catch((errorObj: ValidateErrorEntity<any>) => {\n        console.log('onSubmit=》error', errorObj);\n        const errorFields = errorObj.errorFields;\n        // 表单滚动到第一个报错处(antd),解决form中scrollToFirstError配置无效\n        document\n          .querySelector('.ant-form-item-has-error')\n          ?.scrollIntoView({ behavior: 'smooth', block: 'center' });\n        if (errorFields && errorFields.length > 0) {\n          error(errorFields[0].errors[0]);\n          pass = false;\n          return;\n        }\n      });\n      if (!pass) {\n        return;\n      }\n      const formData = toRaw(formState);\n      assign(formData, childWorkOrderRef.value.childFormState);\n      if (!compareDate(formData.planEndDate, formData.planStartDate)) {\n        error('计划开始时间必须小于计划完成时间');\n        return;\n      }\n      if (!validateProcessForm(formData, flowData, action)) {\n        return;\n      }\n    }\n    const status = action ? null : 1;\n    doSave(action, status);\n  };\n\n  ////////////表格附件/////////////\n  const uploadTable = ref();\n  const uploadRows = ref<any[]>([]);\n  const initUploadRows = (type: string) => {\n    if (!formState.bizFileId) {\n      formState.bizFileId = buildShortUUID();\n    }\n    const fileTypes = {\n      qx: ['缺陷情况', '消缺处理', '消缺确认'],\n      yh: ['隐患发现', '整改处理', '结果确认'],\n      cc: ['除草方案', '处理过程', '结果确认'],\n      zjqx: ['清洗方案', '处理过程', '结果确认'],\n      lsjg: ['紧固方案', '处理过程', '结果确认'],\n      ff: ['防腐方案', '处理过程', '结果确认'],\n    };\n    const base = {\n      fileKindId: '',\n      filetype: '',\n      bizId: formState.bizFileId,\n      maxCount: 20,\n      maxSize: 20 * 1024 * 1024,\n      required: false,\n      readonly: true,\n    };\n    const rows = [] as any;\n    // 申请节点\n    let row = { ...base };\n    row.fileKindId = 'apply';\n    row.filetype = fileTypes[type][0];\n    row.readonly = disabledInput.value;\n    rows.push(row);\n    // 过程节点\n    if (process.process.show) {\n      let processRow = { ...base };\n      processRow.fileKindId = 'process';\n      processRow.filetype = fileTypes[type][1];\n      processRow.readonly = process.process.disabled;\n      rows.push(processRow);\n    }\n    // 确认节点\n    if (process.confirm.show) {\n      let confirmRow = { ...base };\n      confirmRow.fileKindId = 'confirm';\n      confirmRow.filetype = fileTypes[type][2];\n      confirmRow.readonly = process.confirm.disabled;\n      rows.push(confirmRow);\n    }\n    uploadRows.value = rows;\n  };\n  ////////////表格附件/////////////\n\n  const compareDate = (d1, d2) => {\n    const date1 = new Date(Date.parse(d1));\n    const date2 = new Date(Date.parse(d2));\n    return date1 > date2;\n  };\n\n  const doSave = async (action, status) => {\n    formState.spinning = true;\n    try {\n      await saveBiz(action, status);\n    } catch (error) {\n      formState.spinning = false;\n      console.log('error', error);\n    }\n  };\n\n  const saveBiz = async (action, status) => {\n    const formData = toRaw(formState);\n    assign(formData, childWorkOrderRef.value.childFormState);\n    const isStart = status === 0 || status === 1;\n    if (isStart) {\n      formData.status = status;\n    }\n    if (!process.process.disabled) {\n      formData.ticketList = childWorkOrderRef.value.getTicketList();\n    }\n    await saveData(formData)\n      .then((res) => {\n        formState.id = res.result;\n        if (status == 1) {\n          disabledInput.value = true;\n        }\n        formState.spinning = false;\n        businessStatus.value = action;\n        if (isStart) {\n          success('操作成功');\n        }\n        reloadBizTable(status);\n      })\n      .catch(() => {\n        formState.spinning = false;\n      });\n  };\n\n  const reloadBizTable = (status: number) => {\n    if (status === 0 || status === 1) {\n      setTimeout(() => {\n        if (status === 1) {\n          closeCurrentTab();\n        }\n        MsgManager.getInstance().sendMsg('work-order', {});\n      }, 200);\n    }\n  };\n\n  const error = (content) => {\n    formState.spinning = false;\n    SysMessage.getInstance().error(content);\n  };\n\n  const success = (content) => {\n    SysMessage.getInstance().success(content);\n  };\n\n  const initNodeAuth = (node: string) => {\n    const processVariable = { ...formState.processVariable };\n    const isCurrentNodeAuth =\n      processVariable.taskDefinitionKey === node &&\n      processVariable.assigneeId.indexOf(userInfo.userId) > -1 &&\n      processVariable.status === 1;\n    const type = node.replace('Node', '');\n    process[type].disabled = !isCurrentNodeAuth;\n  };\n\n  // 处理任务实列节点是否显示\n  const handleTaskInstanceNode = () => {\n    const taskInstances = formState.taskInstances;\n    if (taskInstances?.length) {\n      taskInstances.forEach((item) => {\n        if (item.taskDefinitionKey === 'processNode') {\n          process.process.show = true;\n        }\n        if (item.taskDefinitionKey === 'confirmNode') {\n          process.confirm.show = true;\n        }\n      });\n    }\n    // 通过、不通过、终止业务节点全部显示\n    if (formState.status === 2 || formState.status === 3 || formState.status === 5) {\n      process.process.show = true;\n      process.confirm.show = true;\n    }\n  };\n\n  const isEdit = () => {\n    // 处理人节点\n    initNodeAuth('processNode');\n    // 确认人节点\n    initNodeAuth('confirmNode');\n    // 申请节点\n    const isApply =\n      (formState.status === 0 || formState.status === 6) &&\n      (!formState.personMemberId || formState.personMemberId.indexOf(userInfo.userId) > -1);\n    disabledInput.value = !isApply;\n    // 处理任务实列节点是否显示\n    handleTaskInstanceNode();\n  };\n\n  const getRecordable = async () => {\n    const res = await getData({ id: query.id, workOrderType: query.workOrderType });\n    if (res.result) {\n      assign(formState, res.result);\n      formState.status = Number(formState.status);\n      formState.isInvoicing = String(formState.isInvoicing != null ? formState.isInvoicing : '');\n      formState.processInstanceId = formState.processVariable?.processInstanceId;\n      if (!formState.processInstanceId) {\n        formState.processInstanceId = query.processInstanceId;\n      }\n      const { billCode, fillinDate, personMemberName, deptName } = res.result;\n      Object.assign(billTitleOption, { billCode, fillinDate, personMemberName, deptName });\n\n      isEdit();\n    }\n  };\n\n  function handleChangeConfirmByName(value: string, option) {\n    formState.confirmById = option.lable;\n  }\n\n  function initStationPersonOptions() {\n    getStationPerson('?stationId=' + formState.stationId).then((res) => {\n      if (res.result && res.result.length > 0) {\n        res.result.forEach((item) => {\n          stationPersonOptions.value.push({ value: item.name, lable: item.userId });\n        });\n      }\n    });\n  }\n\n  const getBizParamId = async () => {\n    let id = query.id;\n    if (!id && query.processInstanceId) {\n      const processInstance = (await ProcessInstanceApi.getProcessInstance(\n        query.processInstanceId as string,\n      )) as any;\n      const businessKey = processInstance.businessKey;\n      query.id = businessKey;\n      id = businessKey;\n    }\n    return id;\n  };\n\n  function initFormData() {\n    // 流程主题\n    const workOrderTypeText = formState.workOrderTypeText;\n    if (workOrderTypeText) {\n      billTitleOption.subject = `${workOrderTypeText}申请`;\n    }\n    // 工单类型\n    if (formState.workOrderType === 'qx') {\n      isFault.value = true;\n    } else if (formState.workOrderType === 'yh') {\n      isHidden.value = true;\n    } else {\n      isDaily.value = true;\n    }\n  }\n\n  onMounted(async () => {\n    query.id = await getBizParamId();\n    await getRecordable();\n    if (!query.id) {\n      assign(formState, query);\n      if (!formState.fault) {\n        formState.fault = {};\n      }\n      if (!formState.hidden) {\n        formState.hidden = {};\n      }\n      if (!formState.daily) {\n        formState.daily = {};\n      }\n      disabledInput.value = false;\n    }\n    initUploadRows(formState.workOrderType);\n    initFormData();\n    initStationPersonOptions();\n  });\n</script>\n<style lang=\"less\" scoped>\n  @import '/@/design/biz/bizForm.less';\n</style>\n"],"names":["userStore","useUserStore","userInfo","toRaw","query","Memory","formRef","ref","formState","reactive","stationPersonOptions","billTitleOption","isHidden","isFault","isDaily","disabledInput","process","childWorkOrderRef","businessStatus","listenMessage","getApproveBoxMode","computed","onBefore","flowData","beforeOperationType","action","onSubmit","validateProcessForm","formData","compareDate","error","onSave","doSave","__async","value","pass","errorObj","errorFields","_a","assign","uploadTable","uploadRows","initUploadRows","type","buildShortUUID","fileTypes","base","rows","row","__spreadValues","processRow","confirmRow","d1","d2","date1","date2","status","saveBiz","isStart","saveData","res","success","reloadBizTable","closeCurrentTab","MsgManager","content","SysMessage","initNodeAuth","node","processVariable","isCurrentNodeAuth","handleTaskInstanceNode","taskInstances","item","isEdit","isApply","getRecordable","getData","billCode","fillinDate","personMemberName","deptName","handleChangeConfirmByName","option","initStationPersonOptions","getStationPerson","getBizParamId","id","businessKey","ProcessInstanceApi.getProcessInstance","initFormData","workOrderTypeText","onMounted"],"mappings":"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"}