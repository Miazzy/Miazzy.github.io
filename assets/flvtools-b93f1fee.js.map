{"version":3,"file":"flvtools-b93f1fee.js","sources":["../../src/utils/flvtools.ts"],"sourcesContent":["export enum EzuiktProto {\n  HTTP = 'http',\n  EZOPEN = 'ezopen',\n}\n\nexport const checkIsFlvUrl = (url: string = '') => {\n  if (url !== null && url !== '' && url?.startsWith('http')) {\n    return true;\n  } else {\n    return false;\n  }\n};\n\nexport const isEmpty = (value) => {\n  return typeof value === 'undefined' || value === null || value === '';\n};\n\nexport const checkIsHttpUrl = (url: string = '') => {\n  if (url.startsWith('http')) {\n    return true;\n  }\n  return false;\n};\n\nexport const getEzuiKitUrl = (originUrl: string = '') => {\n  let temp = originUrl;\n  temp = temp.split('?')[0];\n  temp = temp.split('/openlive/')[1];\n  const steams = temp.split('_');\n  const url = `ezopen://open.ys7.com/${steams[0]}/${steams[1]}.live`;\n  return url;\n};\n\nexport const getEzuikitPlayer = (\n  id: string = '',\n  url: string = '',\n  accessToken: string = '',\n  isPlay: boolean = true,\n) => {\n  if (isEmpty(url)) {\n    return null;\n  }\n  if (checkIsHttpUrl(url)) {\n    url = getEzuiKitUrl(url);\n  }\n  if (url.startsWith('ezopen')) {\n    const player = new EZUIKit.EZUIKitPlayer({\n      id: id,\n      url: url,\n      accessToken: accessToken,\n      useHardDev: true,\n      enableSharedArrayBufferGuide: true,\n      handleError: (message) => {\n        console.error('EzuiKit Play Error:', message);\n        setTimeout(() => {\n          playVideo(player);\n        }, 3000);\n      },\n    });\n    player.containerID = id;\n    isPlay ? playVideo(player) : null;\n    return player;\n  }\n  return null;\n};\n\nexport const getEzuikitFLVPlayer = (\n  id: string = '',\n  url: string = '',\n  accessToken: string = '',\n  isPlay: boolean = true,\n) => {\n  if (isEmpty(url)) {\n    return null;\n  }\n  if (checkIsHttpUrl(url)) {\n    let player = new EzuikitFlv({\n      url: url,\n      container: document.getElementById(id),\n      accessToken: accessToken,\n      useMSE: true,\n      hasAudio: false,\n      debug: true,\n      isNotMute: false,\n      videoBuffer: 1,\n      loadingTimeout: 30,\n      decoder: \"decoder.js\", // 自定义解码库加载地址， 默认放置在服务器根目录下\n    });\n    player.containerID = id;\n    player.on(\"error\", (error) => {\n      console.error('EzuiKit Play Error:', error);\n    });\n    if (isPlay) {\n      setTimeout(() => {\n        playVideo(player);\n      }, 0);\n      setTimeout(() => {\n        destoryPlayer(player);\n      }, 10);\n      setTimeout(() => {\n        playVideo(player);\n      }, 20);\n    }\n    return player;\n  }\n  return null;\n};\n\nexport const getPlayer = (\n  id: string = '',\n  url: string = '',\n  accessToken: string = '',\n  isPlay: boolean = true,\n  protocol: string = '',\n) => {\n  let player = null;\n  if (protocol == EzuiktProto.HTTP) {\n    player = getEzuikitFLVPlayer(id, url, accessToken, isPlay);\n  } else if (protocol == EzuiktProto.EZOPEN) {\n    player = getEzuikitPlayer(id, url, accessToken, isPlay);\n  }\n  return player;\n};\n\nexport const playVideo = (player) => {\n  if (player) {\n    try {\n      player?.setScaleMode(0);\n      player?.play();\n    } catch (error) {\n      return false;\n    }\n  }\n  return false;\n};\n\nexport const destoryPlayer = (player: any = null) => {\n  if (player) {\n    try {\n      player?.stop();\n    } catch {\n      //\n    }\n    try {\n      player?.destory();\n    } catch {\n      //\n    }\n    player = null;\n  }\n};\n"],"names":["EzuiktProto","checkIsFlvUrl","url","isEmpty","value","checkIsHttpUrl","getEzuiKitUrl","originUrl","temp","steams","getEzuikitPlayer","id","accessToken","isPlay","player","message","playVideo","getEzuikitFLVPlayer","error","destoryPlayer","getPlayer","protocol"],"mappings":"AAAY,IAAAA,GAAAA,IACVA,EAAA,KAAO,OACPA,EAAA,OAAS,SAFCA,IAAAA,GAAA,CAAA,CAAA,EAKC,MAAAC,EAAgB,CAACC,EAAc,KACtC,GAAAA,IAAQ,MAAQA,IAAQ,KAAMA,GAAA,MAAAA,EAAK,WAAW,UAOvCC,EAAWC,GACf,OAAOA,GAAU,aAAeA,IAAU,MAAQA,IAAU,GAGxDC,EAAiB,CAACH,EAAc,KACvC,EAAAA,EAAI,WAAW,MAAM,EAMdI,EAAgB,CAACC,EAAoB,KAAO,CACvD,IAAIC,EAAOD,EACXC,EAAOA,EAAK,MAAM,GAAG,EAAE,CAAC,EACxBA,EAAOA,EAAK,MAAM,YAAY,EAAE,CAAC,EAC3B,MAAAC,EAASD,EAAK,MAAM,GAAG,EAEtB,MADK,yBAAyBC,EAAO,CAAC,CAAC,IAAIA,EAAO,CAAC,CAAC,OAE7D,EAEaC,EAAmB,CAC9BC,EAAa,GACbT,EAAc,GACdU,EAAsB,GACtBC,EAAkB,KACf,CACC,GAAAV,EAAQD,CAAG,EACN,OAAA,KAKL,GAHAG,EAAeH,CAAG,IACpBA,EAAMI,EAAcJ,CAAG,GAErBA,EAAI,WAAW,QAAQ,EAAG,CACtB,MAAAY,EAAS,IAAI,QAAQ,cAAc,CACvC,GAAAH,EACA,IAAAT,EACA,YAAAU,EACA,WAAY,GACZ,6BAA8B,GAC9B,YAAcG,GAAY,CAChB,QAAA,MAAM,sBAAuBA,CAAO,EAC5C,WAAW,IAAM,CACfC,EAAUF,CAAM,GACf,GAAI,CACT,CAAA,CACD,EACD,OAAAA,EAAO,YAAcH,EACZE,GAAAG,EAAUF,CAAM,EAClBA,CACT,CACO,OAAA,IACT,EAEaG,EAAsB,CACjCN,EAAa,GACbT,EAAc,GACdU,EAAsB,GACtBC,EAAkB,KACf,CACC,GAAAV,EAAQD,CAAG,EACN,OAAA,KAEL,GAAAG,EAAeH,CAAG,EAAG,CACnB,IAAAY,EAAS,IAAI,WAAW,CAC1B,IAAAZ,EACA,UAAW,SAAS,eAAeS,CAAE,EACrC,YAAAC,EACA,OAAQ,GACR,SAAU,GACV,MAAO,GACP,UAAW,GACX,YAAa,EACb,eAAgB,GAChB,QAAS,YAAA,CACV,EACD,OAAAE,EAAO,YAAcH,EACdG,EAAA,GAAG,QAAUI,GAAU,CACpB,QAAA,MAAM,sBAAuBA,CAAK,CAAA,CAC3C,EACGL,IACF,WAAW,IAAM,CACfG,EAAUF,CAAM,GACf,CAAC,EACJ,WAAW,IAAM,CACfK,EAAcL,CAAM,GACnB,EAAE,EACL,WAAW,IAAM,CACfE,EAAUF,CAAM,GACf,EAAE,GAEAA,CACT,CACO,OAAA,IACT,EAEaM,EAAY,CACvBT,EAAa,GACbT,EAAc,GACdU,EAAsB,GACtBC,EAAkB,GAClBQ,EAAmB,KAChB,CACH,IAAIP,EAAS,KACb,OAAIO,GAAY,OACdP,EAASG,EAAoBN,EAAIT,EAAKU,EAAaC,CAAM,EAChDQ,GAAY,WACrBP,EAASJ,EAAiBC,EAAIT,EAAKU,EAAaC,CAAM,GAEjDC,CACT,EAEaE,EAAaF,GAAW,CACnC,GAAIA,EACE,GAAA,CACFA,GAAA,MAAAA,EAAQ,aAAa,GACrBA,GAAA,MAAAA,EAAQ,aACDI,EAAO,CACP,MAAA,EACT,CAEK,MAAA,EACT,EAEaC,EAAgB,CAACL,EAAc,OAAS,CACnD,GAAIA,EAAQ,CACN,GAAA,CACFA,GAAA,MAAAA,EAAQ,MAAK,OACP,GAER,CACI,GAAA,CACFA,GAAA,MAAAA,EAAQ,SAAQ,OACV,GAER,CACSA,EAAA,IACX,CACF"}