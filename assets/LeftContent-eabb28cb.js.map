{"version":3,"file":"LeftContent-eabb28cb.js","sources":["../../src/views/da/cockpit/power/LeftContent.vue"],"sourcesContent":["<template>\n  <div class=\"left-content\" :key=\"instanceKey\">\n    <div class=\"top-section section-box\">\n      <div class=\"section-bg\">\n        <SubtitleBar :subtitle=\"`电量趋势（近12个月）`\">\n          <a-select\n            ref=\"select\"\n            label-in-value\n            v-model:value=\"searchInfo.selectPowerValue\"\n            :options=\"optionsPower\"\n            style=\"width: 1.2rem\"\n            @change=\"handlePowerChange\"\n          />\n        </SubtitleBar>\n        <div style=\"width: 100%; height: 1.85rem\">\n          <div style=\"margin-left: 0.16rem; transform: scale(0.85); transform-origin: 0 0\">\n            <EchartLineBarChart\n              :data=\"powerTrendChartData\"\n              :colors=\"powerTrendChartData.colors\"\n              :width=\"`26.06vw`\"\n              :height=\"tabStatus === 'on' ? `28.07vh` : `31.38vh`\"\n              :category=\"powerTrendChartData.categories\"\n              ybgcolor=\"#01B7D730\"\n              :rotate=\"0\"\n              @clickItem=\"handlePowerContrastByParams\"\n              xAxisLabelInterval=\"auto\"\n              :dataZoomDisabled=\"false\"\n              :dataZoomMaxValueSpan=\"powerTrendChartData.categories.length\"\n              :dataZoomDefaultValueRange=\"[0, 4]\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"middel-section section-box\">\n      <div class=\"section-bg\">\n        <SubtitleBar :subtitle=\"`损失排行`\" />\n        <div style=\"height: 1.85rem\">\n          <div style=\"margin-left: 0.16rem; transform: scale(0.85); transform-origin: 0 0\">\n            <EchartStackBarChart\n              :data=\"lossRankingChartData\"\n              :colors=\"lossRankingChartData.colors\"\n              :width=\"`26.06vw`\"\n              :height=\"tabStatus === 'on' ? `28.07vh` : `31.38vh`\"\n              :rotate=\"0\"\n              @clickItem=\"handleLossPowerByParams\"\n              xAxisLabelInterval=\"auto\"\n              :dataZoomDisabled=\"false\"\n              :dataZoomMaxValueSpan=\"lossRankingChartData.categories.length\"\n              :dataZoomDefaultValueRange=\"[0, 4]\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"bottom-section section-box\">\n      <div class=\"section-bg\">\n        <SubtitleBar :subtitle=\"`损失分布`\" />\n        <div style=\"height: 2rem\">\n          <div style=\"transform: scale(0.8); transform-origin: 0 0\">\n            <EchartPieChart\n              id=\"loss-stat-pie\"\n              :width=\"`29.59vw`\"\n              :height=\"tabStatus === 'on' ? `22.08vh` : `32.53vh`\"\n              :data=\"lossTypePieData.pieData\"\n              :roseType=\"false\"\n              :radius=\"tabStatus === 'on' ? ['50%', '70%'] : ['40%', '60%']\"\n              showLabel\n              showLegend\n              :pieCenter=\"tabStatus === 'on' ? ['50%', '60%'] : ['50%', '55%']\"\n              :legendOptions=\"{ top: 'center', bottom: 'auto', left: '80%', orient: 'vertical' }\"\n              @click-item=\"handleLossPower\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import { reactive, UnwrapRef, ref, onMounted, watch } from 'vue';\n  import SubtitleBar from '/@/components/Framework/Chart/SubtitleBar.vue';\n  import EchartLineBarChart from '/@/components/Framework/Chart/EchartLineBarChart.vue';\n  import EchartStackBarChart from '/@/components/Framework/Chart/EchartStackBarChart.vue';\n  import NtgaleChart from '/@/components/Framework/Chart/NtgaleChart.vue';\n  import { optionsPower, getPowerTrendData, getLossRankingData, getLossTypePieData } from './data';\n  import { assign } from 'lodash-es';\n  import { handleRouteChange } from '../../utils';\n  import { addTabPage } from '@/utils/route';\n  import EchartPieChart from '/@/components/Framework/Chart/EchartPieChart.vue';\n  import { buildUUID } from '@/utils/uuid';\n\n  //搜索参数\n  const searchInfo: UnwrapRef<any> = reactive({});\n  const instanceKey = ref(buildUUID());\n\n  interface Props {\n    searchInfoByTime?: {};\n    tabStatus?: '';\n  }\n  const props = withDefaults(defineProps<Props>(), {});\n\n  // =============================== 电量趋势==============================================\n  const powerTrendChartData = ref({\n    lineData: [[]],\n    categories: [],\n    units: ['(万Kw.h)', '(%)', '(%)'],\n    colors: [\n      ['#488FF6', '#60D1F3'],\n      ['#E59837', '#FAE895'],\n      ['#E59837', '#68E4B8'],\n      ['#e59837', '#fae895'],\n      ['#078C5D', '#68E4B8'],\n    ],\n  });\n  const handlePowerChange = (value: string) => {\n    searchInfo.selectPowerValue = value.value;\n    queryPowerTrendData();\n  };\n  const queryPowerTrendData = async () => {\n    searchInfo.index = searchInfo.selectPowerValue;\n    let data = await getPowerTrendData(searchInfo);\n    if (data.result) {\n      if (data.result.lineData.length) {\n        powerTrendChartData.value.lineData[0] = data.result.lineData;\n      } else {\n        powerTrendChartData.value.lineData = [];\n      }\n      powerTrendChartData.value.categories = data.result.categories;\n    }\n  };\n\n  // =============================== 损失排行==============================================\n  const lossRankingChartData = ref({\n    barData: [[], [], [], []],\n    lineData: [],\n    categories: [],\n    // units: ['(万Kw.h)', '(%)', '(%)'],\n    colors: [\n      ['#488FF6', '#60D1F3', '#8FD0F4', '#68E4B8'],\n      ['#E59837', '#FAE895'],\n    ],\n    barNames: [],\n    lineNames: ['同比'],\n  });\n  const queryLossRankingData = async () => {\n    let data = await getLossRankingData(searchInfo);\n    if (data.result) {\n      lossRankingChartData.value.barData = data.result.barData;\n      lossRankingChartData.value.lineData = data.result.lineData;\n      lossRankingChartData.value.categories = data.result.categories;\n      lossRankingChartData.value.barNames = data.result.barNames;\n    }\n  };\n\n  // =============================== 损失分布==============================================\n  const lossTypePieData = ref({\n    pieData: [],\n  });\n  const queryLossTypePieData = async () => {\n    let data = await getLossTypePieData(searchInfo);\n    if (data.result) {\n      lossTypePieData.value.pieData = data.result.pieData;\n    }\n  };\n\n  // =============================== 数据穿透==============================================\n  //电量趋势\n  function handlePowerContrastByParams(params) {\n    addTabPage('/bi/elec/powerContrast', '电量对比统计', {\n      dateType: 'month',\n      startDate: params.name,\n      endDate: params.name,\n    });\n  }\n  //损失排行\n  function handleLossPowerByParams(params) {\n    addTabPage('/bi/elec/lossPower', '损失电量统计', {\n      dateType: 'month',\n      startDate: params.name,\n      endDate: params.name,\n    });\n  }\n  //损失分布\n  function handleLossPower() {\n    handleRouteChange('/bi/elec/lossPower', {});\n  }\n\n  // 更新组件函数\n  const handleUpdate = () => {\n    instanceKey.value = buildUUID();\n  };\n\n  watch(\n    () => props.searchInfoByTime,\n    (value) => {\n      assign(searchInfo, value);\n      //电量趋势\n      queryPowerTrendData();\n      //损失排行\n      queryLossRankingData();\n      //损失分布\n      queryLossTypePieData();\n    },\n  );\n\n  defineExpose({\n    handleUpdate,\n  });\n\n  onMounted(() => {\n    assign(searchInfo, props.searchInfoByTime);\n    //电量趋势\n    searchInfo.selectPowerValue = 'theory';\n  });\n</script>\n\n<style lang=\"less\" scoped>\n  .left-content {\n    display: flex;\n    flex-direction: column;\n    width: 25vw;\n    height: 100%;\n    padding: 0 0.57vw 1.68vh 0.68vw;\n\n    .section-box {\n      flex: 1;\n      width: 100%;\n      height: 33.3333%;\n      overflow: hidden;\n\n      .section-bg {\n        width: 100%;\n        height: 100%;\n        background: url('../../../../assets/images/da/section_bg_1.png') no-repeat center/100% 100%;\n      }\n    }\n\n    .top-section {\n      padding-bottom: 0.62vh;\n    }\n\n    .middel-section {\n      padding: 0.31vh 0;\n    }\n\n    .bottom-section {\n      padding-top: 0.62vh;\n    }\n  }\n</style>\n"],"names":["searchInfo","reactive","instanceKey","ref","buildUUID","powerTrendChartData","handlePowerChange","value","queryPowerTrendData","__async","data","getPowerTrendData","lossRankingChartData","queryLossRankingData","getLossRankingData","lossTypePieData","queryLossTypePieData","getLossTypePieData","handlePowerContrastByParams","params","addTabPage","handleLossPowerByParams","handleLossPower","handleRouteChange","handleUpdate","watch","props","assign","__expose","onMounted"],"mappings":"wgDA8FQA,EAA6BC,EAAS,CAAA,CAAE,EACxCC,EAAcC,EAAIC,EAAA,CAAW,EAS7BC,EAAsBF,EAAI,CAC9B,SAAU,CAAC,CAAA,CAAE,EACb,WAAY,CAAC,EACb,MAAO,CAAC,UAAW,MAAO,KAAK,EAC/B,OAAQ,CACN,CAAC,UAAW,SAAS,EACrB,CAAC,UAAW,SAAS,EACrB,CAAC,UAAW,SAAS,EACrB,CAAC,UAAW,SAAS,EACrB,CAAC,UAAW,SAAS,CACvB,CAAA,CACD,EACKG,EAAqBC,GAAkB,CAC3CP,EAAW,iBAAmBO,EAAM,MAChBC,GAAA,EAEhBA,EAAsB,IAAYC,EAAA,sBACtCT,EAAW,MAAQA,EAAW,iBAC1B,IAAAU,EAAO,MAAMC,EAAkBX,CAAU,EACzCU,EAAK,SACHA,EAAK,OAAO,SAAS,OACvBL,EAAoB,MAAM,SAAS,CAAC,EAAIK,EAAK,OAAO,SAEhCL,EAAA,MAAM,SAAW,GAEnBA,EAAA,MAAM,WAAaK,EAAK,OAAO,WACrD,GAIIE,EAAuBT,EAAI,CAC/B,QAAS,CAAC,CAAC,EAAG,GAAI,CAAA,EAAI,CAAA,CAAE,EACxB,SAAU,CAAC,EACX,WAAY,CAAC,EAEb,OAAQ,CACN,CAAC,UAAW,UAAW,UAAW,SAAS,EAC3C,CAAC,UAAW,SAAS,CACvB,EACA,SAAU,CAAC,EACX,UAAW,CAAC,IAAI,CAAA,CACjB,EACKU,EAAuB,IAAYJ,EAAA,sBACnC,IAAAC,EAAO,MAAMI,EAAmBd,CAAU,EAC1CU,EAAK,SACcE,EAAA,MAAM,QAAUF,EAAK,OAAO,QAC5BE,EAAA,MAAM,SAAWF,EAAK,OAAO,SAC7BE,EAAA,MAAM,WAAaF,EAAK,OAAO,WAC/BE,EAAA,MAAM,SAAWF,EAAK,OAAO,SACpD,GAIIK,EAAkBZ,EAAI,CAC1B,QAAS,CAAC,CAAA,CACX,EACKa,EAAuB,IAAYP,EAAA,sBACnC,IAAAC,EAAO,MAAMO,EAAmBjB,CAAU,EAC1CU,EAAK,SACSK,EAAA,MAAM,QAAUL,EAAK,OAAO,QAC9C,GAKF,SAASQ,EAA4BC,EAAQ,CAC3CC,EAAW,yBAA0B,SAAU,CAC7C,SAAU,QACV,UAAWD,EAAO,KAClB,QAASA,EAAO,IAAA,CACjB,CACH,CAEA,SAASE,EAAwBF,EAAQ,CACvCC,EAAW,qBAAsB,SAAU,CACzC,SAAU,QACV,UAAWD,EAAO,KAClB,QAASA,EAAO,IAAA,CACjB,CACH,CAEA,SAASG,GAAkB,CACPC,EAAA,qBAAsB,CAAA,CAAE,CAC5C,CAGA,MAAMC,EAAe,IAAM,CACzBtB,EAAY,MAAQE,GAAU,EAGhC,OAAAqB,EACE,IAAMC,EAAM,iBACXnB,GAAU,CACToB,EAAO3B,EAAYO,CAAK,EAEJC,IAECK,IAEAG,GACvB,CAAA,EAGWY,EAAA,CACX,aAAAJ,CAAA,CACD,EAEDK,EAAU,IAAM,CACPF,EAAA3B,EAAY0B,EAAM,gBAAgB,EAEzC1B,EAAW,iBAAmB,QAAA,CAC/B"}