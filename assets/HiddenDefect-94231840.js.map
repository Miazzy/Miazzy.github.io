{"version":3,"file":"HiddenDefect-94231840.js","sources":["../../src/views/da/stationOperation/operation/HiddenDefect.vue"],"sourcesContent":["<template>\n  <div class=\"hidden-defect\">\n    <SmallModule title=\"隐患缺陷统计\" position=\"left\">\n      <template #titleRight>\n        <div class=\"right-title-layout\">\n          <a-radio-group\n            class=\"operation-screen-radio-group\"\n            v-model:value=\"defectType\"\n            size=\"small\"\n            @change=\"handleTrendChange\"\n          >\n            <a-radio-button value=\"hidden\">隐患</a-radio-button>\n            <a-radio-button value=\"defect\">缺陷</a-radio-button>\n          </a-radio-group>\n        </div>\n      </template>\n      <template #content>\n        <div class=\"content-layout\">\n          <div class=\"data-layout\">\n            <DataIndicator\n              label=\"待处理\"\n              :value=\"indexData.not_resolution_total\"\n              @click=\"handPenetrate('not_resolution_total')\"\n            />\n            <DataIndicator\n              label=\"处理中\"\n              :value=\"indexData.handle_total\"\n              @click=\"handPenetrate('handle_total')\"\n            />\n            <DataIndicator\n              label=\"今日新增\"\n              :value=\"indexData.day_create\"\n              @click=\"handPenetrate('day_create')\"\n            />\n            <DataIndicator label=\"今日解决\" :value=\"indexData.day_result\" />\n          </div>\n          <div class=\"table-layout\">\n            <a-table\n              class=\"operation-screen-table\"\n              :columns=\"faultAndHiddenColumns\"\n              :data-source=\"list\"\n              size=\"small\"\n              :pagination=\"false\"\n              :scroll=\"{ y: 'calc(23vh - 0.68rem)' }\"\n              :row-class-name=\"(_record, index) => (index % 2 === 0 ? 'table-striped' : null)\"\n            >\n              <template #bodyCell=\"{ column, record }\">\n                <template v-if=\"column.key === 'source'\">\n                  <span class=\"blue-text\">{{ record.source }}</span>\n                </template>\n                <template v-else-if=\"column.key === 'status'\">\n                  <span v-if=\"record.status === '处理中'\" class=\"blue-text\">{{\n                    record.status\n                  }}</span>\n                  <span v-if=\"record.status === '已完成'\" class=\"green-text\">{{\n                    record.status\n                  }}</span>\n                  <span v-if=\"record.status === '待处理'\" class=\"white-text\">{{\n                    record.status\n                  }}</span>\n                </template>\n              </template>\n            </a-table>\n          </div>\n        </div>\n      </template>\n    </SmallModule>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import SmallModule from '/@/components/Framework/OperationScreen/SmallModule.vue';\n  import DataIndicator from '/@/components/Framework/OperationScreen/DataIndicator.vue';\n  import { reactive, UnwrapRef, ref, onMounted } from 'vue';\n  import { assign } from 'lodash-es';\n  import { getFaultAndHiddenData, faultAndHiddenColumns } from './data';\n  import { addTabPage } from '/@/utils/route';\n  import { DateTools } from '/@/utils/dateUtil';\n\n  const indexData: UnwrapRef<any> = reactive({});\n  const defectType = ref('defect');\n  //搜索参数\n  const searchInfo: UnwrapRef<any> = reactive({});\n  interface Props {\n    operationSearchInfo?: {};\n  }\n  const props = withDefaults(defineProps<Props>(), {});\n\n  function handPenetrate(type: string) {\n    let param = { stationId: 'B6717C6744F44E53814F00AEEDEBFA74' };\n    let url = '/po/fault/index';\n    let pageName = '缺陷管理';\n    if (defectType.value == 'defect') {\n      url = '/po/fault/index';\n      pageName = '缺陷管理';\n      if (type === 'not_resolution_total') {\n        param.resolutionStatus = 0;\n      } else if (type === 'handle_total') {\n        param.resolutionStatus = 0;\n        param.isConvertWorkBill = 1;\n      } else if (type === 'day_create') {\n        let now = DateTools.format(new Date(), 'YYYY-MM-DD');\n        param.startFindDate = now;\n        param.endFindDate = now;\n      }\n    } else if (defectType.value == 'hidden') {\n      url = '/po/danger/index';\n      pageName = '隐患管理';\n      if (type === 'not_resolution_total') {\n        param.resolutionStatus = 0;\n      } else if (type === 'handle_total') {\n        param.resolutionStatus = 0;\n        param.isConvertWorkBill = 1;\n      } else if (type === 'day_create') {\n        let now = DateTools.format(new Date(), 'YYYY-MM-DD');\n        param.startHanppendDate = now;\n        param.endHanppendDate = now;\n      }\n    }\n\n    addTabPage(url, pageName, param);\n  }\n\n  const handleTrendChange = (e: Event) => {\n    searchInfo.selectTrendValue = e.target.value;\n    queryFaultAndHiddenData();\n  };\n\n  onMounted(() => {\n    assign(searchInfo, props.operationSearchInfo);\n    queryFaultAndHiddenData();\n  });\n\n  const list = ref([]);\n\n  const queryFaultAndHiddenData = async () => {\n    let data = await getFaultAndHiddenData(searchInfo);\n    if (data.result) {\n      if (defectType.value === 'defect') {\n        assign(indexData, data.result.faultTotal);\n        list.value = data.result.faultList;\n      } else if (defectType.value === 'hidden') {\n        assign(indexData, data.result.hiddenTotal);\n        list.value = data.result.hiddenList;\n      }\n    }\n  };\n\n  // const data = [\n  //   {\n  //     key: '1',\n  //     type: '隐患',\n  //     description: 'N-1#逆变器 绝缘阻抗低',\n  //     source: '巡检',\n  //     status: 'finish',\n  //     statusText: '已完成',\n  //   },\n  //   {\n  //     key: '2',\n  //     type: '缺陷',\n  //     description: 'N-1#逆变器 绝缘阻抗低',\n  //     source: '安全检查',\n  //     status: 'waiting',\n  //     statusText: '待处理',\n  //   },\n  //   {\n  //     key: '3',\n  //     type: '缺陷',\n  //     description: 'N-1#逆变器 绝缘阻抗低',\n  //     source: '安全检查',\n  //     status: 'waiting',\n  //     statusText: '待处理',\n  //   },\n  //   {\n  //     key: '4',\n  //     type: '缺陷',\n  //     description: 'N-1#逆变器 绝缘阻抗低',\n  //     source: '安全检查',\n  //     status: 'waiting',\n  //     statusText: '待处理',\n  //   },\n  //   {\n  //     key: '5',\n  //     type: '缺陷',\n  //     description: 'N-1#逆变器 绝缘阻抗低',\n  //     source: '安全检查',\n  //     status: 'waiting',\n  //     statusText: '待处理',\n  //   },\n  //   {\n  //     key: '6',\n  //     type: '缺陷',\n  //     description: 'N-1#逆变器 绝缘阻抗低',\n  //     source: '安全检查',\n  //     status: 'waiting',\n  //     statusText: '待处理',\n  //   },\n  //   {\n  //     key: '7',\n  //     type: '缺陷',\n  //     description: 'N-1#逆变器 绝缘阻抗低',\n  //     source: '系统告警',\n  //     status: 'transfer',\n  //     statusText: '已转工单',\n  //   },\n  // ];\n</script>\n\n<style lang=\"less\" scoped>\n  // .right-title-layout {\n  //   display: flex;\n  //   align-items: center;\n  //   padding: 0.2rem 0.16rem 0 0;\n\n  //   .detail-text {\n  //     margin-left: 0.14rem;\n  //     color: #fff;\n  //     font-size: 0.12rem;\n  //     line-height: 1;\n  //     cursor: pointer;\n\n  //     .text {\n  //       margin-right: 0.04rem;\n  //     }\n\n  //     .arrow {\n  //       opacity: 0.6;\n  //     }\n  //   }\n  // }\n  .right-title-layout {\n    padding-right: 0.16rem;\n  }\n\n  .content-layout {\n    height: 100%;\n\n    .data-layout {\n      display: flex;\n      align-items: flex-end;\n      justify-content: space-between;\n      height: 20.74%;\n      margin-top: -0.1rem;\n      padding: 0 0.55rem;\n    }\n\n    .table-layout {\n      width: 100%;\n      height: 79.26%;\n      margin-top: -1vh;\n      padding: 0 0.16rem;\n\n      .blue-text {\n        color: #03a9ff;\n      }\n\n      .white-text {\n        color: #fff;\n      }\n\n      .green-text {\n        color: #00ffa4;\n      }\n    }\n  }\n</style>\n"],"names":["indexData","reactive","defectType","ref","searchInfo","handPenetrate","type","param","url","pageName","now","DateTools","addTabPage","handleTrendChange","e","queryFaultAndHiddenData","onMounted","assign","props","list","__async","data","getFaultAndHiddenData"],"mappings":"k6BA+EQA,EAA4BC,EAAS,CAAA,CAAE,EACvCC,EAAaC,EAAI,QAAQ,EAEzBC,EAA6BH,EAAS,CAAA,CAAE,EAM9C,SAASI,EAAcC,EAAc,CAC/B,IAAAC,EAAQ,CAAE,UAAW,oCACrBC,EAAM,kBACNC,EAAW,OACX,GAAAP,EAAW,OAAS,UAGtB,GAFMM,EAAA,kBACKC,EAAA,OACPH,IAAS,uBACXC,EAAM,iBAAmB,UAChBD,IAAS,eAClBC,EAAM,iBAAmB,EACzBA,EAAM,kBAAoB,UACjBD,IAAS,aAAc,CAChC,IAAII,EAAMC,EAAU,OAAW,IAAA,KAAQ,YAAY,EACnDJ,EAAM,cAAgBG,EACtBH,EAAM,YAAcG,CACtB,UACSR,EAAW,OAAS,UAG7B,GAFMM,EAAA,mBACKC,EAAA,OACPH,IAAS,uBACXC,EAAM,iBAAmB,UAChBD,IAAS,eAClBC,EAAM,iBAAmB,EACzBA,EAAM,kBAAoB,UACjBD,IAAS,aAAc,CAChC,IAAII,EAAMC,EAAU,OAAW,IAAA,KAAQ,YAAY,EACnDJ,EAAM,kBAAoBG,EAC1BH,EAAM,gBAAkBG,CAC1B,EAGSE,EAAAJ,EAAKC,EAAUF,CAAK,CACjC,CAEM,MAAAM,EAAqBC,GAAa,CAC3BV,EAAA,iBAAmBU,EAAE,OAAO,MACfC,GAAA,EAG1BC,EAAU,IAAM,CACPC,EAAAb,EAAYc,EAAM,mBAAmB,EACpBH,GAAA,CACzB,EAEK,MAAAI,EAAOhB,EAAI,CAAA,CAAE,EAEbY,EAA0B,IAAYK,EAAA,sBACtC,IAAAC,EAAO,MAAMC,EAAsBlB,CAAU,EAC7CiB,EAAK,SACHnB,EAAW,QAAU,UAChBe,EAAAjB,EAAWqB,EAAK,OAAO,UAAU,EACnCF,EAAA,MAAQE,EAAK,OAAO,WAChBnB,EAAW,QAAU,WACvBe,EAAAjB,EAAWqB,EAAK,OAAO,WAAW,EACpCF,EAAA,MAAQE,EAAK,OAAO,YAE7B"}