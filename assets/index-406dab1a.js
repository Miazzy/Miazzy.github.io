var G=Object.defineProperty,Q=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var D=(s,t,n)=>t in s?G(s,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[t]=n,B=(s,t)=>{for(var n in t||(t={}))ee.call(t,n)&&D(s,n,t[n]);if(R)for(var n of R(t))te.call(t,n)&&D(s,n,t[n]);return s},P=(s,t)=>Q(s,Y(t));var h=(s,t,n)=>new Promise((d,l)=>{var x=c=>{try{p(n.next(c))}catch(m){l(m)}},C=c=>{try{p(n.throw(c))}catch(m){l(m)}},p=c=>c.done?d(c.value):Promise.resolve(c.value).then(x,C);p((n=n.apply(s,t)).next())});import{b as oe,au as ne,a0 as ae,a7 as re,av as g,ax as T,_ as se}from"./index.js";import{B as ce}from"./BasicTable-0434a334.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1ba7be9e.js";import"./index-085d06c7.js";import{u as ie}from"./useTable-109483b3.js";import"./antd-15ac76ed.js";import{P as le}from"./index-20519caf.js";import{e as de}from"./download-03e71dd5.js";import{u as me,c as O,e as ue,s as pe,d as fe,g as ge}from"./schedule.data-4e5a19b6.js";import{d as _e,r as be,k as $,J as he,o as ye,al as xe,Z as y,a9 as Ce,aa as i,f as u,u as r,E as _,ad as b,_ as S,F as Ie,ac as v}from"./vue-71d1abb3.js";import"./useForm-dea3ed18.js";import"./uniqBy-92d3bc7f.js";import"./index-316f6ffb.js";import"./useWindowSizeFn-13b1b8a2.js";import"./index-f4fc48e6.js";import"./useTabs-2b062e85.js";import"./index-5d49b7a7.js";import"./SearchBox-22bb02d6.js";import"./UploadBox-636ecf02.js";import"./Dialog-0a006d82.js";import"./DictSelectBox.vue_vue_type_script_setup_true_lang-e03e9fe8.js";import"./OrganDialog-dd1023ce.js";import"./sortable.esm-4ae27e0b.js";import"./dict-c04c0dd8.js";import"./useContentViewHeight-7f845167.js";import"./useRender-21ce56fb.js";const ke={key:0,style:{color:"#19be6b"}},we={key:1,style:{color:"red"}},Te=_e({__name:"index",setup(s){const{t}=oe(),n=ne(),d=be({}),l=$(!0),x=ae(),C=he(x.getUserInfo),p=e=>{const a=N(),o=P(B({},a.getFieldsValue()),{sortField:"createTime",sortOrder:"desc"});if(e){const f=V();o.pageNo=f.current,o.pageSize=f.pageSize}return d.sortField&&(o.sortField=d.sortField,o.sortOrder=d.sortOrder),o},c=()=>h(this,null,function*(){return yield ge(p(!0))}),m=$("工作安排设置"),[M,{getForm:N,getSelectRows:L,getPaginationRef:V,clearSelectedRowKeys:z,reload:I}]=ie({title:m,api:c,columns:O,useSearchForm:!0,formConfig:pe,showTableSetting:!0,bordered:!0,rowKey:"id",rowSelection:{type:"radio"},sortFn:e=>{var o;const a=(o=e.order)==null?void 0:o.replace("end","");d.sortOrder=a,d.sortField=a?e.field:void 0}});function A(e,a){a.width=e}function U(){T("/oa/schedule/work/schedule/create",w({}))}function k(){const e=L();return e.length==0?(n.error("请选择一行数据"),!1):e[0]}function q(){const e=k();e&&T(`/oa/schedule/work/schedule/create?id=${e.id}`,w(e))}function H(e){T(`/oa/schedule/work/schedule/create?id=${e.id}&isReadonly=true`,w(e,!0))}function K({rows:e}){let a="";e.length&&(a=e[0].creator),l.value=a!==C.userId}const w=(e,a)=>{const o=m.value;return a?`查看${o}`:e!=null&&e.id?`${t("common.action.edit")}${o}`:`${t("common.action.create")}${o}`};function J(){const e=k();e&&W(function(){fe(e.id).then(()=>{n.success(t("common.delSuccessText")),z(),I()})})}function W(e){n.createConfirm({title:t("common.message.confirmTitle"),iconType:"warning",content:t("common.message.delMessage"),onOk(){return h(this,null,function*(){e()})}})}function X(){E(1,"已启用")}function Z(){E(0,"已禁用")}function E(e,a){const o=k();o&&me(o.id,e).then(()=>{n.success(a),I()})}function j(){n.createConfirm({title:t("common.message.confirmTitle"),iconType:"warning",content:t("common.message.exportMessage"),onOk(){return h(this,null,function*(){const a=p(!1);a.filename=`${m.value}.xlsx`,a.excelList=O,yield ue(a).then(o=>{de(o==null?void 0:o.data,a.filename)}),n.success(t("common.exportSuccessText"))})}})}return ye(()=>{re.getInstance().listen("work-schedule",I)}),(e,a)=>{const o=xe("a-button");return y(),Ce(r(le),{dense:"",contentFullHeight:"",fixedHeight:"",contentClass:"flex",style:{position:"relative"}},{default:i(()=>[u(r(ce),{class:"fix-basic-table",onRegister:r(M),onResizeColumn:A,onRowDbClick:a[0]||(a[0]=f=>H(f)),onSelectionChange:K},{toolbar:i(()=>[u(o,{type:"primary",preIcon:r(g).ADD,onClick:U},{default:i(()=>[_(b(r(t)("common.action.create")),1)]),_:1},8,["preIcon"]),u(o,{disabled:l.value,type:"primary",preIcon:r(g).EDIT,onClick:q},{default:i(()=>[_(b(r(t)("common.action.edit")),1)]),_:1},8,["disabled","preIcon"]),u(o,{disabled:l.value,class:"red-btn",preIcon:r(g).DELETE,onClick:J},{default:i(()=>[_(b(r(t)("common.delText")),1)]),_:1},8,["disabled","preIcon"]),u(o,{disabled:l.value,class:"green-btn",preIcon:r(g).ENABLE,onClick:X},{default:i(()=>[_(b("启用"))]),_:1},8,["disabled","preIcon"]),u(o,{disabled:l.value,class:"grey-btn",preIcon:r(g).DISABLE,onClick:Z},{default:i(()=>[_(b("禁用"))]),_:1},8,["disabled","preIcon"]),u(o,{class:"yellow-btn",preIcon:r(g).EXPORT,onClick:j},{default:i(()=>[_(b(r(t)("common.action.export")),1)]),_:1},8,["preIcon"])]),bodyCell:i(({column:f,text:F})=>[f.dataIndex==="status"?(y(),S(Ie,{key:0},[F==1?(y(),S("span",ke,"启用")):v("",!0),F==0?(y(),S("span",we,"禁用")):v("",!0)],64)):v("",!0)]),_:1},8,["onRegister"])]),_:1})}}});const Ye=se(Te,[["__scopeId","data-v-47f5e309"]]);export{Ye as default};
//# sourceMappingURL=index-406dab1a.js.map
