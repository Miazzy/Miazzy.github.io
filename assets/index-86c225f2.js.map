{"version":3,"file":"index-86c225f2.js","sources":["../../src/views/oa/schedule/index.ts","../../src/views/oa/schedule/index.vue"],"sourcesContent":["import { defHttp } from '/@/utils/http/axios';\nimport { BasicColumn } from '/@/components/Table';\nimport { useRender } from '@/components/Table';\n\nenum Api {\n  areaList = '/oa/calendar-schedule/page',\n}\n\nexport function getScheduleListColumns(): BasicColumn[] {\n  return [\n    {\n      title: '提醒',\n      dataIndex: 'content',\n      width: 330,\n      headAlign: 'center',\n      align: 'left',\n      resizable: true,\n      sorter: true,\n      customHeaderCell: (column) => {\n        return {\n          class: 'text-center',\n        };\n      },\n    },\n    {\n      title: '开始时间',\n      dataIndex: 'startTime',\n      width: 100,\n      resizable: true,\n      sorter: true,\n      customRender: ({ text }) => {\n        return useRender.renderDate(text, 'YYYY-MM-DD HH:mm');\n      },\n    },\n    {\n      title: '创建人',\n      dataIndex: 'creator',\n      width: 120,\n      resizable: true,\n      sorter: true,\n    },\n  ];\n}\n\n// 列表数据\nexport const getScheduleList = (params) =>\n  defHttp.get(\n    {\n      url: Api.areaList,\n      params,\n    },\n    {},\n  );\n","<template>\n  <div>\n    <PageWrapper dense contentFullHeight fixedHeight contentClass=\"flex\" style=\"position: relative\">\n      <div class=\"w-6/6 tab-model\">\n        <div class=\"tab-button-div\">\n          <a-form\n            :model=\"searchInfo\"\n            name=\"searchInfo\"\n            layout=\"inline\"\n            autocomplete=\"off\"\n            class=\"search-form\"\n          >\n            <a-form-item\n              name=\"startDate\"\n              label=\"日期\"\n              :labelCol=\"{ span: 6 }\"\n              :rules=\"[{ required: false, message: '请选择日期' }]\"\n              style=\"width: 26.5%\"\n            >\n              <a-range-picker\n                v-model:value=\"searchTimeInfo.searchTime\"\n                format=\"YYYY-MM-DD\"\n                value-format=\"YYYY-MM-DD\"\n                style=\"width: 100%\"\n              />\n            </a-form-item>\n            <a-form-item\n              name=\"status\"\n              label=\"状态\"\n              :labelCol=\"{ span: 12 }\"\n              :rules=\"[{ required: false, message: '请输入状态' }]\"\n              style=\"width: 26.5%\"\n            >\n              <DictSelectBox\n                :type=\"`ScheduleStatus`\"\n                v-model:value=\"searchInfo.status\"\n                :width=\"'100%'\"\n              />\n            </a-form-item>\n            <a-form-item\n              name=\"content\"\n              label=\"内容\"\n              :labelCol=\"{ span: 12 }\"\n              :rules=\"[{ required: false, message: '请输入内容' }]\"\n              style=\"width: 26.5%\"\n            >\n              <a-input\n                v-model:value=\"searchInfo.content\"\n                placeholder=\"请输入内容\"\n                style=\"width: 100%\"\n              />\n            </a-form-item>\n\n            <a-form-item class=\"search-btns\">\n              <a-button style=\"margin: 0 8px\" @click=\"resetFrom\">重置</a-button>\n              <a-button type=\"primary\" class=\"tab-button\" @click=\"searchList\">查询</a-button>\n            </a-form-item>\n          </a-form>\n        </div>\n        <div class=\"tab-table-div\">\n          <BasicTable\n            @register=\"registerTable\"\n            class=\"w-1/1 xl:w-1/1\"\n            :height=\"630\"\n            @resize-column=\"(w, col) => (col.width = w)\"\n          >\n            <template #bodyCell=\"{ column, text, record }\">\n              <template v-if=\"column.key === 'action'\">\n                <TableAction\n                  :actions=\"[\n                    {\n                      icon: IconEnum.LOG,\n                      label: '查看',\n                      onClick: handleView.bind(null, record),\n                    },\n                  ]\"\n                />\n              </template>\n            </template>\n          </BasicTable>\n        </div>\n      </div>\n      <!-- 数据表格 -->\n    </PageWrapper>\n  </div>\n  <Schedule ref=\"schedule\" />\n</template>\n<script lang=\"ts\" setup>\n  import type { FormProps } from '/@/components/Form/src/types/form';\n  import { onMounted, reactive, ref } from 'vue';\n  import { BasicTable, useTable, TableAction, SorterResult } from '/@/components/Table';\n  import { PageWrapper } from '/@/components/Page';\n  import { getScheduleList, getScheduleListColumns } from './index';\n  import { IconEnum } from '@/enums/appEnum';\n  import Schedule from './Schedule.vue';\n  import DictSelectBox from '@/components/Framework/Combox/DictSelectBox.vue';\n  import { MsgManager } from '/@/message/MsgManager';\n  import moment from 'moment';\n\n  const searchInfo = reactive<any>({\n    content: null,\n    startDate: null,\n    endDate: null,\n    status: null,\n  }); // 查询信息\n\n  const schedule = ref();\n  function handleView(record: any) {\n    schedule.value.handleView({ id: record.id, type: record.type });\n  }\n\n  const searchTimeInfo = reactive<any>({\n    searchTime: null,\n  }); // 查询信息\n\n  const areaColumn = getScheduleListColumns();\n\n  const indexList = ref<Array<any>>([]);\n  const getScheduleListByParam = async () => {\n    let areaList = await getScheduleList(searchInfo);\n    indexList.value = areaList.result;\n    return areaList.result;\n  };\n  const searchForm: FormProps = {\n    baseColProps: { lg: 6, md: 8 },\n    labelWidth: 90,\n    schemas: [],\n  };\n\n  // 注册Drawer\n  // const [registerDrawer, { openDrawer: opensettlemenElecModal }] = useDrawer();\n\n  const [registerTable, { reload, getPaginationRef }] = useTable({\n    title: '日程安排列表',\n    api: async () => {\n      const paginationRef = getPaginationRef() as any;\n      searchInfo.pageNo = paginationRef.current;\n      searchInfo.pageSize = paginationRef.pageSize;\n      let dataObj = await getScheduleListByParam();\n      return dataObj;\n    },\n    columns: areaColumn,\n    useSearchForm: false,\n    formConfig: searchForm,\n    showTableSetting: true,\n    bordered: true,\n    // eslint-disable-next-line no-dupe-keys\n    rowKey: 'id',\n    actionColumn: {\n      width: 160,\n      title: '操作',\n      dataIndex: 'action',\n    },\n    sortFn: (sortInfo: SorterResult) => {\n      if (sortInfo.order) {\n        searchInfo.sortField = sortInfo.field;\n        searchInfo.sortOrder = sortInfo.order.replace('end', '');\n      } else {\n        searchInfo.sortField = null;\n        searchInfo.sortOrder = null;\n      }\n    },\n  });\n\n  function resetFrom() {\n    searchInfo.content = null;\n    searchInfo.startDate = null;\n    searchInfo.endDate = null;\n    searchInfo.status = null;\n    searchTimeInfo.searchTime = null;\n    reload();\n  }\n\n  // 查询\n  function searchList() {\n    if (searchTimeInfo.searchTime != null) {\n      searchInfo.startDate = searchTimeInfo.searchTime[0];\n      searchInfo.endDate = searchTimeInfo.searchTime[1];\n    }\n    reload();\n  }\n\n  // 启动执行代码\n  onMounted(() => {\n    let d = moment(new Date()).format('YYYY-MM-DD');\n    searchTimeInfo.searchTime = [d, d];\n    searchInfo.startDate = searchTimeInfo.searchTime[0];\n    searchInfo.endDate = searchTimeInfo.searchTime[1];\n\n    MsgManager.getInstance().listen('setMeeting', function () {\n      setTimeout(() => {\n        reload();\n      }, 500);\n    });\n  });\n</script>\n<style lang=\"less\" scoped>\n  .dialog-loading {\n    position: absolute;\n    z-index: 1000 !important;\n    top: 45%;\n    left: 45%;\n  }\n\n  .tab-model {\n    margin-top: 10px;\n    margin-right: 10px;\n    margin-left: 10px;\n  }\n\n  .tab-button-div {\n    padding-top: 12px;\n    padding-bottom: 12px;\n\n    :deep(.ant-form-item-label) {\n      width: 120px;\n      max-width: 120px;\n      text-align-last: right;\n    }\n  }\n\n  .tab-table-div {\n    margin-top: 10px;\n\n    :deep(.ant-table-placeholder) {\n      height: 591px;\n    }\n  }\n\n  .tab-button {\n    margin-right: 5px;\n\n    &:last-child {\n      margin-right: 0;\n    }\n  }\n\n  .dialog-mask {\n    position: absolute;\n    z-index: 1001 !important;\n    top: -1px;\n    width: 100%;\n    height: 100%;\n    opacity: 0.3;\n  }\n\n  .search-form {\n    position: relative;\n\n    .search-btns {\n      position: absolute;\n      right: 0;\n      bottom: 0;\n    }\n  }\n</style>\n"],"names":["getScheduleListColumns","column","text","useRender","getScheduleList","params","defHttp","searchInfo","reactive","schedule","ref","handleView","record","searchTimeInfo","areaColumn","indexList","getScheduleListByParam","__async","areaList","searchForm","registerTable","reload","getPaginationRef","useTable","paginationRef","sortInfo","resetFrom","searchList","onMounted","d","moment","MsgManager"],"mappings":"y1CAQO,SAASA,GAAwC,CAC/C,MAAA,CACL,CACE,MAAO,KACP,UAAW,UACX,MAAO,IACP,UAAW,SACX,MAAO,OACP,UAAW,GACX,OAAQ,GACR,iBAAmBC,IACV,CACL,MAAO,aAAA,EAGb,EACA,CACE,MAAO,OACP,UAAW,YACX,MAAO,IACP,UAAW,GACX,OAAQ,GACR,aAAc,CAAC,CAAE,KAAAC,KACRC,EAAU,WAAWD,EAAM,kBAAkB,CAExD,EACA,CACE,MAAO,MACP,UAAW,UACX,MAAO,IACP,UAAW,GACX,OAAQ,EACV,CAAA,CAEJ,CAGa,MAAAE,EAAmBC,GAC9BC,EAAQ,IACN,CACE,IAAK,6BACL,OAAAD,CACF,EACA,CAAC,CACH,oHC+CA,MAAME,EAAaC,EAAc,CAC/B,QAAS,KACT,UAAW,KACX,QAAS,KACT,OAAQ,IAAA,CACT,EAEKC,EAAWC,IACjB,SAASC,EAAWC,EAAa,CACtBH,EAAA,MAAM,WAAW,CAAE,GAAIG,EAAO,GAAI,KAAMA,EAAO,IAAA,CAAM,CAChE,CAEA,MAAMC,EAAiBL,EAAc,CACnC,WAAY,IAAA,CACb,EAEKM,EAAad,IAEbe,EAAYL,EAAgB,CAAA,CAAE,EAC9BM,EAAyB,IAAYC,EAAA,sBACrC,IAAAC,EAAW,MAAMd,EAAgBG,CAAU,EAC/C,OAAAQ,EAAU,MAAQG,EAAS,OACpBA,EAAS,MAAA,GAEZC,EAAwB,CAC5B,aAAc,CAAE,GAAI,EAAG,GAAI,CAAE,EAC7B,WAAY,GACZ,QAAS,CAAC,CAAA,EAMN,CAACC,EAAe,CAAE,OAAAC,EAAQ,iBAAAC,CAAkB,CAAA,EAAIC,EAAS,CAC7D,MAAO,SACP,IAAK,IAAYN,EAAA,sBACf,MAAMO,EAAgBF,IACtB,OAAAf,EAAW,OAASiB,EAAc,QAClCjB,EAAW,SAAWiB,EAAc,SACtB,MAAMR,GAEtB,GACA,QAASF,EACT,cAAe,GACf,WAAYK,EACZ,iBAAkB,GAClB,SAAU,GAEV,OAAQ,KACR,aAAc,CACZ,MAAO,IACP,MAAO,KACP,UAAW,QACb,EACA,OAASM,GAA2B,CAC9BA,EAAS,OACXlB,EAAW,UAAYkB,EAAS,MAChClB,EAAW,UAAYkB,EAAS,MAAM,QAAQ,MAAO,EAAE,IAEvDlB,EAAW,UAAY,KACvBA,EAAW,UAAY,KAE3B,CAAA,CACD,EAED,SAASmB,GAAY,CACnBnB,EAAW,QAAU,KACrBA,EAAW,UAAY,KACvBA,EAAW,QAAU,KACrBA,EAAW,OAAS,KACpBM,EAAe,WAAa,KACrBQ,GACT,CAGA,SAASM,GAAa,CAChBd,EAAe,YAAc,OACpBN,EAAA,UAAYM,EAAe,WAAW,CAAC,EACvCN,EAAA,QAAUM,EAAe,WAAW,CAAC,GAE3CQ,GACT,CAGA,OAAAO,EAAU,IAAM,CACd,IAAIC,EAAIC,EAAO,IAAI,IAAM,EAAE,OAAO,YAAY,EAC/BjB,EAAA,WAAa,CAACgB,EAAGA,CAAC,EACtBtB,EAAA,UAAYM,EAAe,WAAW,CAAC,EACvCN,EAAA,QAAUM,EAAe,WAAW,CAAC,EAEhDkB,EAAW,YAAY,EAAE,OAAO,aAAc,UAAY,CACxD,WAAW,IAAM,CACRV,KACN,GAAG,CAAA,CACP,CAAA,CACF"}