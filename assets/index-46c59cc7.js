var b=(s,h,e)=>new Promise((I,v)=>{var N=n=>{try{c(e.next(n))}catch(p){v(p)}},x=n=>{try{c(e.throw(n))}catch(p){v(p)}},c=n=>n.done?I(n.value):Promise.resolve(n.value).then(N,x);c((e=e.apply(s,h)).next())});import{B as j}from"./BasicTable-0434a334.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1ba7be9e.js";import"./index-085d06c7.js";import{u as B}from"./useTable-109483b3.js";import"./antd-15ac76ed.js";import{a5 as k,_ as V}from"./index.js";import"./index-316f6ffb.js";import{u as z}from"./useRender-21ce56fb.js";import{_ as E}from"./DictSelectBox.vue_vue_type_script_setup_true_lang-e03e9fe8.js";import{P}from"./index-20519caf.js";import{d as W,k as q,r as H,ax as $,u as w,o as U,al as y,Z as m,a9 as M,aa as l,$ as L,f as r,E as S,_,F as Z,ac as g}from"./vue-71d1abb3.js";import"./useForm-dea3ed18.js";import"./uniqBy-92d3bc7f.js";import"./useWindowSizeFn-13b1b8a2.js";import"./index-f4fc48e6.js";import"./useTabs-2b062e85.js";import"./download-03e71dd5.js";import"./index-5d49b7a7.js";import"./SearchBox-22bb02d6.js";import"./UploadBox-636ecf02.js";import"./Dialog-0a006d82.js";import"./OrganDialog-dd1023ce.js";import"./sortable.esm-4ae27e0b.js";import"./dict-c04c0dd8.js";import"./useContentViewHeight-7f845167.js";const G=[{title:"电站名称",dataIndex:"locationName",width:150,headAlign:"center",align:"left",resizable:!0,sorter:!0},{title:"发布单位",dataIndex:"sender",width:150,headAlign:"center",align:"left",resizable:!0,sorter:!0},{title:"预警级别",dataIndex:"level",width:150,headAlign:"center",align:"left",resizable:!0,sorter:!0},{title:"预警类型",dataIndex:"typeName",headAlign:"center",align:"left",width:150,resizable:!0,sorter:!0},{title:"预警详情",dataIndex:"text",headAlign:"center",align:"left",width:300,resizable:!0,sorter:!0},{title:"发布时间",dataIndex:"pubTime",width:150,customRender:({text:s})=>z.renderDate(s),resizable:!0,sorter:!0},{title:"预警开始时间",dataIndex:"startTime",width:150,customRender:({text:s})=>z.renderDate(s),resizable:!0,sorter:!0},{title:"预警结束时间",dataIndex:"endTime",width:150,customRender:({text:s})=>z.renderDate(s),resizable:!0,sorter:!0}],J={class:"fix-basic-table"},K={class:"tab-button-div"},Q={class:"tab-table-div"},X={key:0,style:{color:"red"}},Y={key:1,style:{color:"orange"}},ee={key:2,style:{color:"#e9d30e"}},te={key:3,style:{color:"blue"}},ae=W({__name:"index",setup(s){const h=q([]),e=H({warnLevel:null,stationId:null,pageNo:1,pageSize:10}),I=()=>b(this,null,function*(){let t=[],a=[];if(Array.isArray(e.stationName))if(e.stationName.forEach(o=>{o.option!=null&&(t.push(o.option.value),a.push(o.option.lable))}),t.length>0){let o=t.join("|"),d=a.join("|");e.stationId=d,e.stationName=o}else{let o=e.stationName.join("|"),d=e.stationId.join("|");e.stationId=d,e.stationName=o}let C=yield v(e);return e.stationId!=null&&(e.stationId=e.stationId.split("|"),e.stationName=e.stationName.split("|")),C}),v=t=>k.get({url:"/bi/safety/disasterWarning",params:t},{isOnlyResult:!0}),N=t=>k.get({url:"/bi/common/station/info",params:t},{});function x(t,a){t.length==0&&(e.stationId=void 0,e.stationName=void 0)}function c(){N({}).then(t=>{t.result&&t.result.length>0&&t.result.forEach(a=>{h.value.push({value:a.stationName,lable:a.id})})})}const n=$(),{currentRoute:p}=n,f=w(p).query;U(()=>b(this,null,function*(){c(),f.warnLevel&&(e.warnLevel=f.warnLevel),f.stationId&&(e.stationId=f.stationId,e.stationName=f.stationName)}));const[F,{reload:R,getPaginationRef:T}]=B({title:"自然灾害预警",api:()=>b(this,null,function*(){const t=T();return e.pageNo=t.current,e.pageSize=t.pageSize,yield I()}),columns:G,useSearchForm:!1,bordered:!0,pagination:{pageSize:20},showIndexColumn:!1,showTableSetting:!0,tableSetting:{fullScreen:!0},sortFn:t=>{t.order?(e.sortField=t.field,e.sortOrder=t.order.replace("end","")):(e.sortField=null,e.sortOrder=null)}});function A(){e.warnLevel=null,e.stationId=void 0,e.stationName=void 0,R()}function D(){R()}return(t,a)=>{const C=y("a-select"),o=y("a-form-item"),d=y("a-button"),O=y("a-form");return m(),M(w(P),{dense:"",contentFullHeight:"",fixedHeight:"",contentClass:"flex",style:{position:"relative"}},{default:l(()=>[L("div",J,[L("div",K,[r(O,{model:e,name:"searchInfo",layout:"inline",autocomplete:"off",class:"search-form"},{default:l(()=>[r(o,{name:"stationName",label:"电站",labelCol:{span:6},rules:[{required:!1,message:"请选择电站"}],style:{width:"26.5%"}},{default:l(()=>[r(C,{value:e.stationName,"onUpdate:value":a[0]||(a[0]=i=>e.stationName=i),"show-search":"","allow-clear":"",mode:"multiple",style:{width:"100%"},placeholder:"请选择电站",options:h.value,onChange:x,labelInValue:"","max-tag-count":"responsive"},null,8,["value","options"])]),_:1}),r(o,{name:"warnLevel",label:"预警级别",labelCol:{span:12},rules:[{required:!1,message:"请选择预警级别"}],style:{width:"26.5%"}},{default:l(()=>[r(E,{type:"warnLevel",onChange:a[1]||(a[1]=i=>"()=> searchInfo.warnLevel = value"),value:e.warnLevel,"onUpdate:value":a[2]||(a[2]=i=>e.warnLevel=i),width:"100%"},null,8,["value"])]),_:1}),r(o,{class:"search-btns"},{default:l(()=>[r(d,{style:{margin:"0 8px"},onClick:A},{default:l(()=>[S("重置")]),_:1}),r(d,{type:"primary",class:"tab-button",onClick:D},{default:l(()=>[S("查询")]),_:1})]),_:1})]),_:1},8,["model"])]),L("div",Q,[r(w(j),{onRegister:w(F),onResizeColumn:a[3]||(a[3]=(i,u)=>u.width=i)},{bodyCell:l(({column:i,text:u,record:ne})=>[i.dataIndex==="level"?(m(),_(Z,{key:0},[u=="红色"?(m(),_("span",X,"红色")):g("",!0),u=="橙色"?(m(),_("span",Y,"橙色")):g("",!0),u=="黄色"?(m(),_("span",ee,"黄色")):g("",!0),u=="蓝色"?(m(),_("span",te,"蓝色")):g("",!0)],64)):g("",!0)]),_:1},8,["onRegister"])])])]),_:1})}}});const Fe=V(ae,[["__scopeId","data-v-7dbcc6d5"]]);export{Fe as default};
//# sourceMappingURL=index-46c59cc7.js.map
