{"version":3,"file":"DetailModal.vue_vue_type_script_setup_true_lang-e64c9bdc.js","sources":["../../src/components/Description/src/Description.vue","../../src/components/Description/src/useDescription.ts","../../src/components/Description/index.ts","../../src/views/sys/error-log/DetailModal.vue"],"sourcesContent":["<script lang=\"tsx\">\n  import type { DescriptionProps, DescInstance, DescItem } from './typing';\n  import type { DescriptionsProps } from 'ant-design-vue/es/descriptions/index';\n  import type { CollapseContainerOptions } from '/@/components/Container/index';\n  import {\n    type CSSProperties,\n    type PropType,\n    defineComponent,\n    computed,\n    ref,\n    unref,\n    toRefs,\n  } from 'vue';\n  import { get } from 'lodash-es';\n  import { Descriptions } from 'ant-design-vue';\n  import { CollapseContainer } from '/@/components/Container/index';\n  import { useDesign } from '/@/hooks/web/useDesign';\n  import { isFunction } from '/@/utils/is';\n  import { getSlot } from '/@/utils/helper/tsxHelper';\n  import { useAttrs } from '@vben/hooks';\n\n  const props = {\n    useCollapse: { type: Boolean, default: true },\n    title: { type: String, default: '' },\n    size: {\n      type: String,\n      validator: (v) => ['small', 'default', 'middle', undefined].includes(v),\n      default: 'small',\n    },\n    bordered: { type: Boolean, default: true },\n    column: {\n      type: [Number, Object],\n      default: () => {\n        return { xxl: 4, xl: 3, lg: 3, md: 3, sm: 2, xs: 1 };\n      },\n    },\n    collapseOptions: {\n      type: Object as PropType<CollapseContainerOptions>,\n      default: null,\n    },\n    schema: {\n      type: Array as PropType<DescItem[]>,\n      default: () => [],\n    },\n    data: { type: Object },\n  };\n\n  export default defineComponent({\n    name: 'Description',\n    props,\n    emits: ['register'],\n    setup(props, { slots, emit }) {\n      const propsRef = ref<Partial<DescriptionProps> | null>(null);\n\n      const { prefixCls } = useDesign('description');\n      const attrs = useAttrs();\n\n      // Custom title component: get title\n      const getMergeProps = computed(() => {\n        return {\n          ...props,\n          ...(unref(propsRef) as any),\n        } as DescriptionProps;\n      });\n\n      const getProps = computed(() => {\n        const opt = {\n          ...unref(getMergeProps),\n          title: undefined,\n        };\n        return opt as DescriptionProps;\n      });\n\n      /**\n       * @description: Whether to setting title\n       */\n      const useWrapper = computed(() => !!unref(getMergeProps).title);\n\n      /**\n       * @description: Get configuration Collapse\n       */\n      const getCollapseOptions = computed((): CollapseContainerOptions => {\n        return {\n          // Cannot be expanded by default\n          canExpand: false,\n          ...unref(getProps).collapseOptions,\n        };\n      });\n\n      const getDescriptionsProps = computed(() => {\n        return { ...unref(attrs), ...unref(getProps) } as DescriptionsProps;\n      });\n\n      /**\n       * @description:设置desc\n       */\n      function setDescProps(descProps: Partial<DescriptionProps>): void {\n        // Keep the last setDrawerProps\n        propsRef.value = {\n          ...(unref(propsRef) as Record<string, any>),\n          ...descProps,\n        } as Record<string, any>;\n      }\n\n      // Prevent line breaks\n      function renderLabel({ label, labelMinWidth, labelStyle }: DescItem) {\n        if (!labelStyle && !labelMinWidth) {\n          return label;\n        }\n\n        const labelStyles: CSSProperties = {\n          ...labelStyle,\n          minWidth: `${labelMinWidth}px `,\n        };\n        return <div style={labelStyles}>{label}</div>;\n      }\n\n      function renderItem() {\n        const { schema, data } = unref(getProps);\n        return unref(schema)\n          .map((item) => {\n            const { render, field, span, show, contentMinWidth } = item;\n\n            if (show && isFunction(show) && !show(data)) {\n              return null;\n            }\n\n            const getContent = () => {\n              const _data = unref(getProps)?.data;\n              if (!_data) {\n                return null;\n              }\n              const getField = get(_data, field);\n              // eslint-disable-next-line\n              if (getField && !toRefs(_data).hasOwnProperty(field)) {\n                return isFunction(render) ? render('', _data) : '';\n              }\n              return isFunction(render) ? render(getField, _data) : getField ?? '';\n            };\n\n            const width = contentMinWidth;\n            return (\n              <Descriptions.Item label={renderLabel(item)} key={field} span={span}>\n                {() => {\n                  if (!contentMinWidth) {\n                    return getContent();\n                  }\n                  const style: CSSProperties = {\n                    minWidth: `${width}px`,\n                  };\n                  return <div style={style}>{getContent()}</div>;\n                }}\n              </Descriptions.Item>\n            );\n          })\n          .filter((item) => !!item);\n      }\n\n      const renderDesc = () => {\n        return (\n          <Descriptions class={`${prefixCls}`} {...(unref(getDescriptionsProps) as any)}>\n            {renderItem()}\n          </Descriptions>\n        );\n      };\n\n      const renderContainer = () => {\n        const content = props.useCollapse ? renderDesc() : <div>{renderDesc()}</div>;\n        // Reduce the dom level\n        if (!props.useCollapse) {\n          return content;\n        }\n\n        const { canExpand, helpMessage } = unref(getCollapseOptions);\n        const { title } = unref(getMergeProps);\n\n        return (\n          <CollapseContainer title={title} canExpan={canExpand} helpMessage={helpMessage}>\n            {{\n              default: () => content,\n              action: () => getSlot(slots, 'action'),\n            }}\n          </CollapseContainer>\n        );\n      };\n\n      const methods: DescInstance = {\n        setDescProps,\n      };\n\n      emit('register', methods);\n      return () => (unref(useWrapper) ? renderContainer() : renderDesc());\n    },\n  });\n</script>\n","import type { DescriptionProps, DescInstance, UseDescReturnType } from './typing';\nimport { ref, getCurrentInstance, unref } from 'vue';\nimport { isProdMode } from '/@/utils/env';\n\nexport function useDescription(props?: Partial<DescriptionProps>): UseDescReturnType {\n  if (!getCurrentInstance()) {\n    throw new Error('useDescription() can only be used inside setup() or functional components!');\n  }\n  const desc = ref<Nullable<DescInstance>>(null);\n  const loaded = ref(false);\n\n  function register(instance: DescInstance) {\n    if (unref(loaded) && isProdMode()) {\n      return;\n    }\n    desc.value = instance;\n    props && instance.setDescProps(props);\n    loaded.value = true;\n  }\n\n  const methods: DescInstance = {\n    setDescProps: (descProps: Partial<DescriptionProps>): void => {\n      unref(desc)?.setDescProps(descProps);\n    },\n  };\n\n  return [register, methods];\n}\n","import { withInstall } from '/@/utils';\nimport description from './src/Description.vue';\n\nexport * from './src/typing';\nexport { useDescription } from './src/useDescription';\nexport const Description = withInstall(description);\n","<template>\n  <BasicModal :width=\"800\" :title=\"t('sys.errorLog.tableActionDesc')\" v-bind=\"$attrs\">\n    <Description :data=\"info\" @register=\"register\" />\n  </BasicModal>\n</template>\n<script lang=\"ts\" setup>\n  import type { PropType } from 'vue';\n  import type { ErrorLogInfo } from '/#/store';\n  import { BasicModal } from '/@/components/Modal/index';\n  import { Description, useDescription } from '/@/components/Description/index';\n  import { useI18n } from '/@/hooks/web/useI18n';\n  import { getDescSchema } from './data';\n\n  defineProps({\n    info: {\n      type: Object as PropType<ErrorLogInfo>,\n      default: null,\n    },\n  });\n\n  const { t } = useI18n();\n\n  const [register] = useDescription({\n    column: 2,\n    schema: getDescSchema()!,\n  });\n</script>\n"],"names":["_isSlot","s","Object","prototype","toString","call","_isVNode","props","useCollapse","type","Boolean","default","title","String","size","validator","v","undefined","includes","bordered","column","Number","xxl","xl","lg","md","sm","xs","collapseOptions","schema","Array","data","defineComponent","name","emits","setup","slots","emit","propsRef","ref","prefixCls","useDesign","attrs","useAttrs","getMergeProps","computed","__spreadValues","unref","getProps","__spreadProps","useWrapper","getCollapseOptions","canExpand","getDescriptionsProps","setDescProps","descProps","value","renderLabel","label","labelMinWidth","labelStyle","labelStyles","minWidth","_createVNode","renderItem","map","item","render","field","span","show","contentMinWidth","isFunction","getContent","_data","getField","get","toRefs","hasOwnProperty","width","Descriptions","Item","style","filter","renderDesc","_slot","_mergeProps","renderContainer","content","helpMessage","CollapseContainer","action","getSlot","useDescription","getCurrentInstance","desc","loaded","register","instance","isProdMode","_a","Description","withInstall","description","t","useI18n","getDescSchema"],"mappings":"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"}