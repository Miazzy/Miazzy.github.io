{"version":3,"file":"download-03e71dd5.js","sources":["../../src/utils/file/download.ts"],"sourcesContent":["import { openWindow } from '..';\nimport { dataURLtoBlob, urlToBase64 } from './base64Conver';\n\n/**\n * Download online pictures\n * @param url\n * @param filename\n * @param mime\n * @param bom\n */\nexport function downloadByOnlineUrl(url: string, filename: string, mime?: string, bom?: BlobPart) {\n  urlToBase64(url).then((base64) => {\n    downloadByBase64(base64, filename, mime, bom);\n  });\n}\n\n/**\n * Download pictures based on base64\n * @param buf\n * @param filename\n * @param mime\n * @param bom\n */\nexport function downloadByBase64(buf: string, filename: string, mime?: string, bom?: BlobPart) {\n  const base64Buf = dataURLtoBlob(buf);\n  downloadByData(base64Buf, filename, mime, bom);\n}\n\n/**\n * Download according to the background interface file stream\n * @param {*} data\n * @param {*} filename\n * @param {*} mime\n * @param {*} bom\n */\nexport function downloadByData(data: BlobPart, filename: string, mime?: string, bom?: BlobPart) {\n  const blobData = typeof bom !== 'undefined' ? [bom, data] : [data];\n  const blob = new Blob(blobData, { type: mime || 'application/octet-stream' });\n\n  const blobURL = window.URL.createObjectURL(blob);\n  const tempLink = document.createElement('a');\n  tempLink.style.display = 'none';\n  tempLink.href = blobURL;\n  tempLink.setAttribute('download', filename);\n  if (typeof tempLink.download === 'undefined') {\n    tempLink.setAttribute('target', '_blank');\n  }\n  document.body.appendChild(tempLink);\n  tempLink.click();\n  document.body.removeChild(tempLink);\n  window.URL.revokeObjectURL(blobURL);\n}\n\n/**\n * Download file according to file address\n * @param {*} sUrl\n */\nexport function downloadByUrl({\n  url,\n  target = '_blank',\n  fileName,\n}: {\n  url: string;\n  target?: TargetContext;\n  fileName?: string;\n}): boolean {\n  const isChrome = window.navigator.userAgent.toLowerCase().indexOf('chrome') > -1;\n  const isSafari = window.navigator.userAgent.toLowerCase().indexOf('safari') > -1;\n\n  if (/(iP)/g.test(window.navigator.userAgent)) {\n    console.error('Your browser does not support download!');\n    return false;\n  }\n  if (isChrome || isSafari) {\n    const link = document.createElement('a');\n    link.href = url;\n    link.target = target;\n\n    if (link.download !== undefined) {\n      link.download = fileName || url.substring(url.lastIndexOf('/') + 1, url.length);\n    }\n\n    if (document.createEvent) {\n      const e = document.createEvent('MouseEvents');\n      e.initEvent('click', true, true);\n      link.dispatchEvent(e);\n      return true;\n    }\n  }\n  if (url.indexOf('?') === -1) {\n    url += '?download';\n  }\n\n  openWindow(url, { target });\n  return true;\n}\n\n// 导出Excel文件\nexport const exportExcelFile = (data, title) => {\n  if (data) {\n    const blob = new Blob([data], {\n      type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8',\n    });\n    const downloadElement = document.createElement('a');\n    const href = window.URL.createObjectURL(blob); //创建下载的链接\n    downloadElement.href = href;\n    downloadElement.download = title; //下载后文件名\n    document.body.appendChild(downloadElement);\n    downloadElement.click(); //点击下载\n    document.body.removeChild(downloadElement); //下载完成移除元素\n    window.URL.revokeObjectURL(href); //释放掉blob对象\n  }\n};\n"],"names":["downloadByUrl","url","target","fileName","isChrome","isSafari","link","e","openWindow","exportExcelFile","data","title","blob","downloadElement","href"],"mappings":"+BAyDO,SAASA,EAAc,CAC5B,IAAAC,EACA,OAAAC,EAAS,SACT,SAAAC,CACF,EAIY,CACJ,MAAAC,EAAW,OAAO,UAAU,UAAU,YAAc,EAAA,QAAQ,QAAQ,EAAI,GACxEC,EAAW,OAAO,UAAU,UAAU,YAAc,EAAA,QAAQ,QAAQ,EAAI,GAE9E,GAAI,QAAQ,KAAK,OAAO,UAAU,SAAS,EACzC,eAAQ,MAAM,yCAAyC,EAChD,GAET,GAAID,GAAYC,EAAU,CAClB,MAAAC,EAAO,SAAS,cAAc,GAAG,EAQvC,GAPAA,EAAK,KAAOL,EACZK,EAAK,OAASJ,EAEVI,EAAK,WAAa,SACfA,EAAA,SAAWH,GAAYF,EAAI,UAAUA,EAAI,YAAY,GAAG,EAAI,EAAGA,EAAI,MAAM,GAG5E,SAAS,YAAa,CAClB,MAAAM,EAAI,SAAS,YAAY,aAAa,EAC1C,OAAAA,EAAA,UAAU,QAAS,GAAM,EAAI,EAC/BD,EAAK,cAAcC,CAAC,EACb,EACT,CACF,CACA,OAAIN,EAAI,QAAQ,GAAG,IAAM,KAChBA,GAAA,aAGEO,EAAAP,EAAK,CAAE,OAAAC,CAAA,CAAQ,EACnB,EACT,CAGa,MAAAO,EAAkB,CAACC,EAAMC,IAAU,CAC9C,GAAID,EAAM,CACR,MAAME,EAAO,IAAI,KAAK,CAACF,CAAI,EAAG,CAC5B,KAAM,iFAAA,CACP,EACKG,EAAkB,SAAS,cAAc,GAAG,EAC5CC,EAAO,OAAO,IAAI,gBAAgBF,CAAI,EAC5CC,EAAgB,KAAOC,EACvBD,EAAgB,SAAWF,EAClB,SAAA,KAAK,YAAYE,CAAe,EACzCA,EAAgB,MAAM,EACb,SAAA,KAAK,YAAYA,CAAe,EAClC,OAAA,IAAI,gBAAgBC,CAAI,CACjC,CACF"}