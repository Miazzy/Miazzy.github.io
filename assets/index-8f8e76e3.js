var C=(S,g,p)=>new Promise((w,f)=>{var c=n=>{try{r(p.next(n))}catch(v){f(v)}},y=n=>{try{r(p.throw(n))}catch(v){f(v)}},r=n=>n.done?w(n.value):Promise.resolve(n.value).then(c,y);r((p=p.apply(S,g)).next())});import{D as W}from"./dict-c04c0dd8.js";import{c7 as G}from"./index.js";import{_ as Z}from"./bpmn-embedded-90db6ebb.js";import{g as j,a as H}from"./index-a3e62fdf.js";import{s as J}from"./formCreate-e6d0da36.js";import{d as K,aD as Q,ax as ee,k as i,r as te,o as ae,al as m,x as F,Z as u,_ as le,f as t,aa as a,v as I,a9 as d,$ as N,ad as D,u as T,E as _,ac as M,a7 as oe}from"./vue-71d1abb3.js";import{D as $}from"./Dialog-0a006d82.js";import{_ as ne}from"./index.vue_vue_type_script_setup_true_lang-e7a017e1.js";import"./antd-15ac76ed.js";import"./index.esm-c216ed00.js";import"./taskAssignRuleForm-a40563e3.js";import"./tree-fc0e156a.js";import"./index-6f04a2b9.js";import"./index-b9390eab.js";const ke=K({name:"BpmProcessDefinition",__name:"index",setup(S){const{query:g}=Q();ee();const p=i(!0),w=i(0),f=i([]),c=i(!1),y=i(""),r=te({pageNo:1,pageSize:10,key:g.key}),n=()=>C(this,null,function*(){p.value=!0;try{const o=yield j(r);f.value=o.list,w.value=o.total}finally{p.value=!1}}),v=o=>{y.value=g.modelId,c.value=!0},P=i(!1),x=i({rule:[],option:{}}),U=o=>C(this,null,function*(){o.formType==10?(J(x,o.formConf,o.formFields),P.value=!0):yield push({path:o.formCustomCreatePath})}),B=i(!1),b=i(null),E=i({prefix:"flowable"}),L=o=>C(this,null,function*(){B.value=!0,b.value=yield H(o.id)});return ae(()=>{n()}),(o,l)=>{const s=m("el-table-column"),k=m("el-button"),R=m("dict-tag"),h=m("el-tag"),q=m("el-table"),z=m("Pagination"),A=m("ContentWrap"),X=m("form-create"),Y=F("hasPermi"),O=F("loading");return u(),le("div",null,[t(A,null,{default:a(()=>[I((u(),d(q,{data:f.value},{default:a(()=>[t(s,{label:"定义编号",align:"center",prop:"id",width:"400"}),t(s,{label:"流程名称",align:"center",prop:"name",width:"200"},{default:a(e=>[t(k,{type:"primary",link:"",onClick:V=>L(e.row)},{default:a(()=>[N("span",null,D(e.row.name),1)]),_:2},1032,["onClick"])]),_:1}),t(s,{label:"定义分类",align:"center",prop:"category",width:"100"},{default:a(e=>[t(R,{type:T(W).BPM_MODEL_CATEGORY,value:e.row.category},null,8,["type","value"])]),_:1}),t(s,{label:"表单信息",align:"center",prop:"formType",width:"200"},{default:a(e=>[e.row.formType===10?(u(),d(k,{key:0,type:"primary",link:"",onClick:V=>U(e.row)},{default:a(()=>[N("span",null,D(e.row.formName),1)]),_:2},1032,["onClick"])):(u(),d(k,{key:1,type:"primary",link:"",onClick:V=>U(e.row)},{default:a(()=>[N("span",null,D(e.row.formCustomCreatePath),1)]),_:2},1032,["onClick"]))]),_:1}),t(s,{label:"流程版本",align:"center",prop:"processDefinition.version",width:"80"},{default:a(e=>[e.row?(u(),d(h,{key:0},{default:a(()=>[_("v"+D(e.row.version),1)]),_:2},1024)):(u(),d(h,{key:1,type:"warning"},{default:a(()=>[_("未部署")]),_:1}))]),_:1}),t(s,{label:"状态",align:"center",prop:"version",width:"80"},{default:a(e=>[e.row.suspensionState===1?(u(),d(h,{key:0,type:"success"},{default:a(()=>[_("激活")]),_:1})):M("",!0),e.row.suspensionState===2?(u(),d(h,{key:1,type:"warning"},{default:a(()=>[_("挂起")]),_:1})):M("",!0)]),_:1}),t(s,{label:"部署时间",align:"center",prop:"deploymentTime",width:"180",formatter:T(G)},null,8,["formatter"]),t(s,{label:"定义描述",align:"center",prop:"description",width:"300","show-overflow-tooltip":""}),t(s,{label:"操作",align:"center",width:"150",fixed:"right"},{default:a(e=>[I((u(),d(k,{link:"",type:"primary",onClick:V=>v(e.row)},{default:a(()=>[_(" 分配规则 ")]),_:2},1032,["onClick"])),[[Y,["bpm:task-assign-rule:query"]]])]),_:1})]),_:1},8,["data"])),[[O,p.value]]),t(z,{total:w.value,page:r.pageNo,"onUpdate:page":l[0]||(l[0]=e=>r.pageNo=e),limit:r.pageSize,"onUpdate:limit":l[1]||(l[1]=e=>r.pageSize=e),onPagination:n},null,8,["total","page","limit"])]),_:1}),t($,{title:"表单详情",visible:c.value,"onUpdate:visible":l[2]||(l[2]=e=>c.value=e),width:1e3,height:800,showBtm:!1},{default:a(()=>[t(ne,{modelId:y.value},null,8,["modelId"])]),_:1},8,["visible"]),t($,{title:"表单详情",visible:P.value,"onUpdate:visible":l[3]||(l[3]=e=>P.value=e),width:800,height:800,showBtm:!1},{default:a(()=>[t(X,{rule:x.value.rule,option:x.value.option},null,8,["rule","option"])]),_:1},8,["visible"]),t($,{title:"流程图",visible:B.value,"onUpdate:visible":l[5]||(l[5]=e=>B.value=e),width:800,height:800,overflowY:"scroll",overflowX:"scroll",showBtm:!1},{default:a(()=>[t(T(Z),oe({key:"designer",modelValue:b.value,"onUpdate:modelValue":l[4]||(l[4]=e=>b.value=e),value:b.value},E.value,{prefix:E.value.prefix}),null,16,["modelValue","value","prefix"])]),_:1},8,["visible"])])}}});export{ke as default};
//# sourceMappingURL=index-8f8e76e3.js.map
