{"version":3,"file":"index-16c81ca1.js","sources":["../../src/views/bpm/manage/group/index.vue"],"sourcesContent":["<template>\n  <ContentWrap>\n    <!-- 搜索工作栏 -->\n    <el-form\n      class=\"-mb-15px\"\n      :model=\"queryParams\"\n      ref=\"queryFormRef\"\n      :inline=\"true\"\n      label-width=\"68px\"\n    >\n      <el-form-item label=\"组名\" prop=\"name\">\n        <el-input\n          v-model=\"queryParams.name\"\n          placeholder=\"请输入组名\"\n          clearable\n          @keyup.enter=\"handleQuery\"\n          class=\"!w-240px\"\n        />\n      </el-form-item>\n      <el-form-item label=\"状态\" prop=\"status\">\n        <el-select v-model=\"queryParams.status\" placeholder=\"请选择状态\" clearable class=\"!w-240px\">\n          <el-option\n            v-for=\"dict in getIntDictOptions(DICT_TYPE.COMMON_STATUS)\"\n            :key=\"dict.value\"\n            :label=\"dict.label\"\n            :value=\"dict.value\"\n          />\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"创建时间\" prop=\"createTime\">\n        <el-date-picker\n          v-model=\"queryParams.createTime\"\n          value-format=\"YYYY-MM-DD HH:mm:ss\"\n          type=\"daterange\"\n          start-placeholder=\"开始日期\"\n          end-placeholder=\"结束日期\"\n          :default-time=\"[new Date('1 00:00:00'), new Date('1 23:59:59')]\"\n          class=\"!w-240px\"\n        />\n      </el-form-item>\n      <el-form-item>\n        <el-button @click=\"handleQuery\"><Icon icon=\"ep:search\" class=\"mr-5px\" /> 搜索</el-button>\n        <el-button @click=\"resetQuery\"><Icon icon=\"ep:refresh\" class=\"mr-5px\" /> 重置</el-button>\n        <el-button\n          type=\"primary\"\n          plain\n          @click=\"openForm('create')\"\n          v-hasPermi=\"['bpm:user-group:create']\"\n        >\n          <Icon icon=\"ep:plus\" class=\"mr-5px\" /> 新增\n        </el-button>\n      </el-form-item>\n    </el-form>\n  </ContentWrap>\n\n  <!-- 列表 -->\n  <ContentWrap>\n    <el-table v-loading=\"loading\" :data=\"list\">\n      <el-table-column label=\"编号\" align=\"center\" prop=\"id\" />\n      <el-table-column label=\"组名\" align=\"center\" prop=\"name\" />\n      <el-table-column label=\"描述\" align=\"center\" prop=\"description\" />\n      <el-table-column label=\"成员\" align=\"center\">\n        <template #default=\"scope\">\n          <span v-for=\"userId in scope.row.memberUserIds\" :key=\"userId\" class=\"pr-5px\">\n            {{ userList.find((user) => user.id === userId)?.nickname }}\n          </span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"状态\" align=\"center\" prop=\"status\">\n        <template #default=\"scope\">\n          <dict-tag :type=\"DICT_TYPE.COMMON_STATUS\" :value=\"scope.row.status\" />\n        </template>\n      </el-table-column>\n      <el-table-column\n        label=\"创建时间\"\n        align=\"center\"\n        prop=\"createTime\"\n        :formatter=\"dateFormatter\"\n      />\n      <el-table-column label=\"操作\" align=\"center\">\n        <template #default=\"scope\">\n          <el-button\n            link\n            type=\"primary\"\n            @click=\"openForm('update', scope.row.id)\"\n            v-hasPermi=\"['bpm:user-group:update']\"\n          >\n            编辑\n          </el-button>\n          <el-button\n            link\n            type=\"danger\"\n            @click=\"handleDelete(scope.row.id)\"\n            v-hasPermi=\"['bpm:user-group:delete']\"\n          >\n            删除\n          </el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <!-- 分页 -->\n    <Pagination\n      :total=\"total\"\n      v-model:page=\"queryParams.pageNo\"\n      v-model:limit=\"queryParams.pageSize\"\n      @pagination=\"getList\"\n    />\n  </ContentWrap>\n\n  <!-- 表单弹窗：添加/修改 -->\n  <UserGroupForm ref=\"formRef\" @success=\"getList\" />\n</template>\n\n<script lang=\"ts\" setup>\n  import { DICT_TYPE, getIntDictOptions } from '@/utils/dict';\n  import { dateFormatter } from '@/utils/dateUtil';\n  import * as UserGroupApi from '@/api/bpm/userGroup';\n  import { UserVO } from '@/api/bpm/system/user';\n  import * as UserApi from '@/api/bpm/system/user';\n  import UserGroupForm from './UserGroupForm.vue';\n  import { ref, reactive, onMounted } from 'vue';\n  import { useI18n } from 'vue-i18n';\n  import { useMessage } from '/@/hooks/web/useMessage';\n\n  defineOptions({ name: 'BpmUserGroup' });\n\n  const message = useMessage(); // 消息弹窗\n  const { t } = useI18n(); // 国际化\n\n  const loading = ref(true); // 列表的加载中\n  const total = ref(0); // 列表的总页数\n  const list = ref([]); // 列表的数据\n  const queryParams = reactive({\n    pageNo: 1,\n    pageSize: 10,\n    name: null,\n    status: null,\n    createTime: [],\n  });\n  const queryFormRef = ref(); // 搜索的表单\n  const userList = ref<UserVO[]>([]); // 用户列表\n\n  /** 查询列表 */\n  const getList = async () => {\n    loading.value = true;\n    try {\n      const data = await UserGroupApi.getUserGroupPage(queryParams);\n      list.value = data.list;\n      total.value = data.total;\n    } finally {\n      loading.value = false;\n    }\n  };\n\n  /** 搜索按钮操作 */\n  const handleQuery = () => {\n    queryParams.pageNo = 1;\n    getList();\n  };\n\n  /** 重置按钮操作 */\n  const resetQuery = () => {\n    queryFormRef.value.resetFields();\n    handleQuery();\n  };\n\n  /** 添加/修改操作 */\n  const formRef = ref();\n  const openForm = (type: string, id?: number) => {\n    formRef.value.open(type, id);\n  };\n\n  /** 删除按钮操作 */\n  const handleDelete = async (id: number) => {\n    try {\n      // 删除的二次确认\n      await message.delConfirm();\n      // 发起删除\n      await UserGroupApi.deleteUserGroup(id);\n      message.success(t('common.delSuccess'));\n      // 刷新列表\n      await getList();\n    } catch {\n      //\n    }\n  };\n\n  /** 初始化 **/\n  onMounted(async () => {\n    await getList();\n    // 加载用户列表\n    userList.value = await UserApi.getSimpleUserList();\n  });\n</script>\n"],"names":["message","useMessage","t","useI18n","loading","ref","total","list","queryParams","reactive","queryFormRef","userList","getList","__async","data","UserGroupApi.getUserGroupPage","handleQuery","resetQuery","formRef","openForm","type","id","handleDelete","UserGroupApi.deleteUserGroup","e","onMounted","UserApi.getSimpleUserList"],"mappings":"stBA8HE,MAAMA,EAAUC,KACV,CAAE,EAAAC,GAAMC,KAERC,EAAUC,EAAI,EAAI,EAClBC,EAAQD,EAAI,CAAC,EACbE,EAAOF,EAAI,CAAA,CAAE,EACbG,EAAcC,EAAS,CAC3B,OAAQ,EACR,SAAU,GACV,KAAM,KACN,OAAQ,KACR,WAAY,CAAC,CAAA,CACd,EACKC,EAAeL,IACfM,EAAWN,EAAc,CAAA,CAAE,EAG3BO,EAAU,IAAYC,EAAA,sBAC1BT,EAAQ,MAAQ,GACZ,GAAA,CACF,MAAMU,EAAO,MAAMC,GAA8BP,CAAW,EAC5DD,EAAK,MAAQO,EAAK,KAClBR,EAAM,MAAQQ,EAAK,KAAA,QACnB,CACAV,EAAQ,MAAQ,EAClB,CAAA,GAIIY,EAAc,IAAM,CACxBR,EAAY,OAAS,EACbI,GAAA,EAIJK,EAAa,IAAM,CACvBP,EAAa,MAAM,cACPM,GAAA,EAIRE,EAAUb,IACVc,EAAW,CAACC,EAAcC,IAAgB,CACtCH,EAAA,MAAM,KAAKE,EAAMC,CAAE,CAAA,EAIvBC,EAAsBD,GAAeR,EAAA,sBACrC,GAAA,CAEF,MAAMb,EAAQ,aAER,MAAAuB,GAA6BF,CAAE,EAC7BrB,EAAA,QAAQE,EAAE,mBAAmB,CAAC,EAEtC,MAAMU,EAAQ,CAAA,OACRY,EAAA,CAER,CAAA,GAIF,OAAAC,EAAU,IAAYZ,EAAA,sBACpB,MAAMD,EAAQ,EAELD,EAAA,MAAQ,MAAMe,IAA0B,EAClD"}