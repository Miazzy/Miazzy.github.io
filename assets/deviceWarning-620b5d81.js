var _=(s,v,n)=>new Promise((x,d)=>{var k=t=>{try{m(n.next(t))}catch(l){d(l)}},w=t=>{try{m(n.throw(t))}catch(l){d(l)}},m=t=>t.done?x(t.value):Promise.resolve(t.value).then(k,w);m((n=n.apply(s,v)).next())});import{B as A}from"./BasicTable-0434a334.js";import{T as O}from"./BasicForm.vue_vue_type_style_index_0_lang-1ba7be9e.js";import"./index-085d06c7.js";import{u as B}from"./useTable-109483b3.js";import"./antd-15ac76ed.js";import{au as z,av as V,_ as W}from"./index.js";import{e as P}from"./download-03e71dd5.js";import{D as H}from"./Dialog-0a006d82.js";import{z as M,u as G}from"./monitorApi-44e70004.js";import{d as L,k as g,o as U,al as X,Z as a,_ as o,$ as y,f as b,aa as h,F as T,ac as i,u as f,E as Z,ad as $,aG as j,aH as q}from"./vue-71d1abb3.js";import"./useForm-dea3ed18.js";import"./uniqBy-92d3bc7f.js";import"./index-316f6ffb.js";import"./useWindowSizeFn-13b1b8a2.js";import"./index-f4fc48e6.js";import"./useTabs-2b062e85.js";import"./index-5d49b7a7.js";import"./SearchBox-22bb02d6.js";import"./UploadBox-636ecf02.js";import"./DictSelectBox.vue_vue_type_script_setup_true_lang-e03e9fe8.js";import"./OrganDialog-dd1023ce.js";import"./sortable.esm-4ae27e0b.js";import"./dict-c04c0dd8.js";const J=s=>(j("data-v-36bc1ccb"),s=s(),q(),s),K={class:"device-warning"},Q=J(()=>y("div",{class:"operation-btns"},null,-1)),Y={class:"table-box"},ee={class:"device-table-box"},te={key:0,style:{color:"#dc0000"}},ae={key:1,style:{color:"#30ca5a"}},oe={key:0,style:{color:"#dc0000"}},ie={key:1,style:{color:"#30ca5a"}},ne={key:0},re={key:1},se={class:"operation-btn-box"},le=L({__name:"deviceWarning",props:{curStationId:{type:String,default:""},esn:{type:String,default:""},height:{type:[Number,String],default:600}},setup(s,{expose:v}){const n=s,{createConfirm:x}=z(),d=g(!1),k=e=>e.workOrderId?[{label:"运维建议",icon:"clarity:note-edit-line",onClick:S.bind(null,e)},{label:"工单详情",icon:"ant-design:calendar-outlined",onClick:E.bind(null,e)}]:[{label:"运维建议",icon:"clarity:note-edit-line",onClick:S.bind(null,e)}],w=[{title:"告警名称",dataIndex:"alarmName",width:150},{title:"级别",dataIndex:"levelText",width:80},{title:"类型",dataIndex:"typeText",width:80},{title:"发生时间",dataIndex:"firstAlarmTime",sorter:!0,width:150},{title:"告警时长(h)",dataIndex:"showAlarmDuration",sorter:!0,width:150},{title:"恢复时间",dataIndex:"recoveryTime",sorter:!0,width:150},{title:"确认状态",dataIndex:"isConfirm",width:100},{title:"确认人",dataIndex:"confirmPersonName",width:100},{title:"确认时间",dataIndex:"confirmTime",sorter:!0,width:150}],m=g([{warningName:"主变进线智能操控报警 ",level:"重要",category:"分类1",status:"激活",happenTime:"2023-08-25 14:54",recoverTime:"2023-08-25 15:54"}]),t=g({}),l=()=>_(this,null,function*(){const e=N();let p={deviceEsn:n.esn,pageNo:e.current,pageSize:e.pageSize,sortField:t.sortField,sortOrder:t.sortOrder},r=yield M(p);return m.value=r.list,r}),[D,{reload:ce,getPaginationRef:N,reloadData:R,redoHeight:de}]=B({api:l,columns:w,bordered:!0,actionColumn:{width:280,title:"操作",dataIndex:"action",slots:{customRender:"action"}},rowSelection:{type:"checkbox"},pagination:{pageSize:10},showTableSetting:!0,tableSetting:{fullScreen:!1,redo:!1,size:!1},scroll:{y:n.height},sortFn:e=>{e.order&&(e.field==="showAlarmDuration"?t.sortField="alarmDuration":t.sortField=e.field,t.sortOrder=e.order.replace("end",""))}}),I=g(""),S=e=>{I.value=e.operationRemark,d.value=!0},E=e=>{console.log("工单详情",e)};function F(){return _(this,null,function*(){x({title:"提示",iconType:"warning",content:"确定要导出所有记录？",onOk(){return _(this,null,function*(){let p={deviceEsn:n.esn};yield G(p).then(r=>{P(r==null?void 0:r.data,"设备告警.xls")})})}})})}return U(()=>_(this,null,function*(){l()})),v({getDataList:l,reloadData:R}),(e,p)=>{const r=X("a-button");return a(),o("div",K,[Q,y("div",Y,[y("div",ee,[b(f(A),{onRegister:f(D),clickToRowSelect:!1},{bodyCell:h(({column:c,text:u,record:C})=>[c.key==="deviceStatus"?(a(),o(T,{key:0},[u==0||u==null?(a(),o("a",te,"告警中")):i("",!0),u==1?(a(),o("a",ae,"已恢复")):i("",!0)],64)):i("",!0),c.key==="isConfirm"?(a(),o(T,{key:1},[u==0||u==null?(a(),o("a",oe,"未确认")):i("",!0),u==1?(a(),o("a",ie,"已确认")):i("",!0)],64)):i("",!0),c.key==="typeText"?(a(),o(T,{key:2},[C.type=="interrupt"?(a(),o("span",ne,"通讯告警")):i("",!0),C.type=="electricity"?(a(),o("span",re,"电量告警")):i("",!0)],64)):i("",!0)]),toolbar:h(()=>[y("div",se,[b(r,{class:"operation-btn yellow-btn",preIcon:f(V).EXPORT,onClick:F},{default:h(()=>[Z(" 导出 ")]),_:1},8,["preIcon"])])]),action:h(({record:c})=>[b(f(O),{actions:k(c)},null,8,["actions"])]),_:1},8,["onRegister"])])]),b(H,{visible:d.value,"onUpdate:visible":p[0]||(p[0]=c=>d.value=c),title:"运维建议",height:"400px",width:"600px",showBtm:!1},{default:h(()=>[y("span",null,$(I.value),1)]),_:1},8,["visible"])])}}});const Be=W(le,[["__scopeId","data-v-36bc1ccb"]]);export{Be as default};
//# sourceMappingURL=deviceWarning-620b5d81.js.map
