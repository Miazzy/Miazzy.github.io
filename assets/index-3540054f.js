var A=Object.defineProperty;var f=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var x=(a,e,t)=>e in a?A(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,b=(a,e)=>{for(var t in e||(e={}))C.call(e,t)&&x(a,t,e[t]);if(f)for(var t of f(e))T.call(e,t)&&x(a,t,e[t]);return a};var p=(a,e,t)=>new Promise((u,s)=>{var g=i=>{try{r(t.next(i))}catch(n){s(n)}},l=i=>{try{r(t.throw(i))}catch(n){s(n)}},r=i=>i.done?u(i.value):Promise.resolve(i.value).then(g,l);r((t=t.apply(a,e)).next())});import{B as O}from"./BasicTable-0434a334.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1ba7be9e.js";import"./index-085d06c7.js";import{u as k}from"./useTable-109483b3.js";import"./antd-15ac76ed.js";import{a0 as _,a5 as m,aj as N,b as P,au as D,av as R}from"./index.js";import{e as E}from"./download-03e71dd5.js";import{d as F,o as v,al as w,Z as M,a9 as V,aa as h,f as I,u as d,E as B,ad as j}from"./vue-71d1abb3.js";import"./useForm-dea3ed18.js";import"./uniqBy-92d3bc7f.js";import"./index-316f6ffb.js";import"./useWindowSizeFn-13b1b8a2.js";import"./index-f4fc48e6.js";import"./useTabs-2b062e85.js";import"./index-5d49b7a7.js";import"./SearchBox-22bb02d6.js";import"./UploadBox-636ecf02.js";import"./Dialog-0a006d82.js";import"./DictSelectBox.vue_vue_type_script_setup_true_lang-e03e9fe8.js";import"./OrganDialog-dd1023ce.js";import"./sortable.esm-4ae27e0b.js";import"./dict-c04c0dd8.js";const H=a=>m.get({url:"/bi/common/org/info",params:a},{isOnlyResult:!0}),W=a=>m.post({url:"/baseset/common/list-station",params:a}),L=a=>m.post({url:"/bi/safetytools/export-excel",params:a,responseType:"blob"},{isReturnNativeResponse:!0});function U(a){return m.post({url:"/bi/safetytools/list",params:a})}const S=[{title:"所属公司",dataIndex:"stationOrganName",width:160,resizable:!0,align:"left",headAlign:"center",customCell:(a,e,t)=>({rowSpan:a.rowSpan}),ifShow:_().isMultiOrganization},{title:"电站名称",dataIndex:"stationName",align:"left",headAlign:"center",width:160,resizable:!0},{title:"安全工器具数量",dataIndex:"total",align:"right",headAlign:"center",width:160,resizable:!0},{title:"检验合格数",dataIndex:"checkQualified",align:"right",headAlign:"center",width:160,resizable:!0},{title:"检验不合格数",dataIndex:"checkUnqualified",align:"right",headAlign:"center",width:160,resizable:!0},{title:"超期未检数",dataIndex:"overNotCheck",align:"right",headAlign:"center",width:160,resizable:!0},{title:"报废数",dataIndex:"scrapNum",align:"right",headAlign:"center",width:160,resizable:!0},{title:"报废中",dataIndex:"scrapNumIng",align:"right",headAlign:"center",width:160,resizable:!0},{title:"30天内待检数",dataIndex:"thirtyCheck",align:"right",headAlign:"center",width:160,resizable:!0},{title:"安全工器具合格率(%)",dataIndex:"checkRate",align:"right",headAlign:"center",width:160,resizable:!0}],q=[{label:"所属公司",field:"stationOrganId",component:"ApiSelect",componentProps:{options:[],api:H},colProps:{span:8},ifShow:_().isMultiOrganization},{label:"选择电站",field:"stationId",component:"ApiSelect",componentProps:{options:[],api:()=>p(void 0,null,function*(){const a=yield W({}),e=[];return a.result.forEach(t=>{e.push({value:t.powerStationId,label:t.powerStationName})}),e})},colProps:{span:8}}],he=F({__name:"index",setup(a){let{params:e}=N();const{t}=P(),{createConfirm:u,createMessage:s}=D(),[g,{getForm:l}]=k({title:"工器具统计",api:i=>p(this,null,function*(){var o,c;return((o=e.startDate)==null?void 0:o.length)==7&&(e.startDate=e.startDate+"-01"),((c=e.endDate)==null?void 0:c.length)==7&&(e.endDate=e.endDate+"-01"),(yield U(i)).result}),columns:S,rowKey:"id",bordered:!0,formConfig:{labelWidth:120,schemas:q},useSearchForm:!0,showTableSetting:!0,pagination:!1});function r(){u({title:t("common.message.confirmTitle"),iconType:"warning",content:t("common.message.exportMessage"),onOk(){return p(this,null,function*(){let n=l().getFieldsValue();n.filename="工器具统计报表.xls",n.excelList=S,yield L(n).then(o=>{E(o==null?void 0:o.data,n.filename)}),n.filename=null,n.excelList=null,s.success(t("common.exportSuccessText"))})}})}return v(()=>{l().setFieldsValue(b({},e))}),(i,n)=>{const o=w("a-button"),c=w("PageWrapper");return M(),V(c,{dense:"",contentFullHeight:"",fixedHeight:"",contentClass:"flex",style:{position:"relative"}},{default:h(()=>[I(d(O),{onRegister:d(g),onResizeColumn:n[0]||(n[0]=(y,z)=>z.width=y),class:"w-4/4 xl:w-12/12"},{toolbar:h(()=>[I(o,{class:"yellow-btn",preIcon:d(R).EXPORT,onClick:r},{default:h(()=>[B(j(d(t)("common.action.export")),1)]),_:1},8,["preIcon"])]),_:1},8,["onRegister"])]),_:1})}}});export{he as default};
//# sourceMappingURL=index-3540054f.js.map
