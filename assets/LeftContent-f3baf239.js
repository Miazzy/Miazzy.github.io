var f=(c,w,m)=>new Promise((l,v)=>{var a=s=>{try{h(m.next(s))}catch(p){v(p)}},D=s=>{try{h(m.throw(s))}catch(p){v(p)}},h=s=>s.done?l(s.value):Promise.resolve(s.value).then(a,D);h((m=m.apply(c,w)).next())});import{a as G}from"./index.esm-c216ed00.js";import{S as C}from"./SubtitleBar-001f5f49.js";import{I as O}from"./IndicatorGroup-e2cd29a8.js";import{E as P}from"./EchartPillarChart-9aa5a33e.js";import{W}from"./WaterLevelChart-2133d837.js";import{_ as j}from"./EchartPieChart.vue_vue_type_script_setup_true_lang-58fa16af.js";import{am as V,ax as _,_ as q}from"./index.js";import{h as y}from"./utils-5bbca5df.js";import{p as z,w as K,i as Y,t as H,s as J,a as Q,b as X}from"./index-116b659b.js";import{d as ee,r as x,k as u,w as ae,o as te,al as oe,Z as le,_ as ne,$ as i,f as r,aa as k,a6 as I,a5 as A}from"./vue-71d1abb3.js";import"./index-d8a2358f.js";import"./install-58e0bd81.js";import"./NoData-1ab5cc7b.js";import"./antd-15ac76ed.js";import"./echarts-5cbe119e.js";import"./api-32c7505d.js";import"./helper-474c7a04.js";const se={class:"top-section section-box"},ie={class:"section-bg"},re={style:{width:"100%",height:"1.85rem"}},ue={style:{"margin-left":"0.16rem",transform:"scale(0.85)","transform-origin":"0 0"}},ce={class:"middel-section section-box"},de={class:"section-bg"},pe={style:{width:"100%",height:"1.85rem"}},me={style:{transform:"scale(0.8)","transform-origin":"0 0"}},he={class:"bottom-section section-box"},ve={class:"section-bg"},fe={style:{width:"100%",height:"1.85rem"}},be={style:{width:"4rem","margin-top":"0.05rem","margin-left":"1.75rem",transform:"scale(1.175)"}},ge=ee({__name:"LeftContent",props:{searchInfoByTime:{type:Object,default:{}},tabStatus:{type:String,default:""}},setup(c,{expose:w}){const m=c,l=x({}),v=u(V()),a=x({selectType:"all",selectValue:"online",planSelectType:"all",operation:"workOrder",safeOperation:"responsibility",signRage:0}),D=u([{label:"历年",value:"all"},{label:"当年",value:"inThoseYear"},{label:"近12个月",value:"december"}]),h=u([{label:"理论电量",value:"theory"},{label:"实发电量",value:"actual"},{label:"上网电量",value:"online"},{label:"结算电量",value:"settlement"}]),s=u(["电量"]),p=u({barData:[],categories:[],units:["万kWh"],colors:[["#488FF6","#60D1F3"],["#E59837","#FAE895"],["#078C5D","#68E4B8"]],dataZoomDefaultValueRange:[0,5]}),T=()=>f(this,null,function*(){const t={dateType:a.selectType,index:a.selectValue},e=yield z(t);e&&(p.value.barData=e.barData||[],p.value.categories=e.categories);const n=h.value.find(o=>o.value===a.selectValue);n&&(s.value.splice(0,s.value.length),s.value.push(n.label))}),M=()=>{T()},E=u([{label:"工单",value:"workOrder"},{label:"巡检",value:"inspection"},{label:"两票",value:"twoVotes"}]),b=u({}),d=u({pieData:[],colors:[]}),R=t=>f(this,null,function*(){if(d.value.pieData=[],d.value.colors=[],t==="workOrder"){const e=yield K({startMonth:l.startMonth,endMonth:l.endMonth});if(e&&(b.value=[{label:"工单总数",value:e.total||0},{label:"未闭环工单数",value:e.dealTotal||0},{label:"工单闭环率",value:e.dealRate||0}],e.pieData)){const n=e.pieData.map(o=>({name:o.name,value:o.value}));d.value.pieData=[...n],d.value.colors=["#03AAFF90","#62E99F90","#00BBFF90","#99DD0090"]}}else if(t==="inspection"){const e=yield Y({startMonth:l.startMonth,endMonth:l.endMonth});if(e&&(b.value=[{label:"未巡检数",value:e.unInspectionCount||0},{label:"巡检异常项",value:e.waitCount||0},{label:"巡检完成率",value:e.inspectionRate||0}],e.pieData)){const n=e.pieData.map(o=>({name:o.name,value:o.value}));d.value.pieData=[...n],d.value.colors=["#03AAFFA0","#99DD00A0","#62E99FA0","#00BBFF90"]}}else if(t==="twoVotes"){const e=yield H({startMonth:l.startMonth,endMonth:l.endMonth});if(e&&(b.value=[{label:"电气一票数",value:e.firstCount||0},{label:"电气二票数",value:e.secondCount||0},{label:"操作票数",value:e.operateCount||0}],e.pieData)){const n=e.pieData.map(o=>({name:o.name,value:o.value}));d.value.pieData=[...n],d.value.colors=["#03AAFF90","#62E99F90","#00BBFF90","#99DD0090"]}}}),N=t=>{R(t)},U=u([{label:"安全责任书",value:"responsibility"},{label:"安全检查",value:"check"},{label:"安全工器具",value:"tools"}]),g=u({}),F=t=>f(this,null,function*(){if(t==="responsibility"){const e=yield J({startMonth:l.startMonth,endMonth:l.endMonth});e&&(g.value=[{label:"应签数",value:e.supposedSignNum||0},{label:"已签数",value:e.signNum||0},{label:"签订率(%)",value:e.signRage||0}],a.signRage=e.signRage)}else if(t==="check"){const e=yield Q({startMonth:l.startMonth,endMonth:l.endMonth});e&&(g.value=[{label:"检查次数",value:e.checkCount||0},{label:"发现隐患(项)",value:e.hiddenCount||0},{label:"隐患处理率",value:e.dealRate||0}],a.signRage=e.dealRate)}else if(t==="tools"){const e=yield X({startMonth:l.startMonth,endMonth:l.endMonth});e&&(g.value=[{value:e.withinNum||0,label:"待检数(个)"},{value:e.unInspectedNum||0,label:"超期未检数(个)"},{lvalue:e.qualifiedRate||0,label:"合格率(%)"}],a.signRage=e.qualifiedRate)}}),Z=t=>{F(t)},L=()=>{v.value=V()};ae(()=>m.searchInfoByTime,t=>{G(l,t),R(a.operation),F(a.safeOperation)});const $=t=>{_("/bi/elec/powerContrast","电量对比统计",{dateType:"month",startDate:a.selectType==="all"?t.name+"-01":t.name,endDate:a.selectType==="all"?t.name+"-12":t.name})},B=()=>{a.operation==="twoVotes"?y("/bi/maintenance/ticket",{}):a.operation==="workOrder"?y("/bi/maintenance/workorder",{}):a.operation==="inspection"&&y("/bi/inspection/index",{})},S=()=>{a.safeOperation==="responsibility"?_("/bi/safety/agreement"):a.safeOperation==="check"?y("/bi/safety/check",{dateCycle:"month"}):a.safeOperation==="tools"&&_("/bi/safetytools/index")};return w({handleUpdate:L}),te(()=>f(this,null,function*(){T()})),(t,e)=>{const n=oe("a-select");return le(),ne("div",{class:"left-content",key:v.value},[i("div",se,[i("div",ie,[r(C,{subtitle:"发电统计"},{default:k(()=>[r(n,{value:a.selectType,"onUpdate:value":e[0]||(e[0]=o=>a.selectType=o),options:D.value,onChange:M,style:{width:"1.2rem","margin-right":"0.1rem"}},null,8,["value","options"]),r(n,{value:a.selectValue,"onUpdate:value":e[1]||(e[1]=o=>a.selectValue=o),options:h.value,onChange:M,style:{width:"1.2rem"}},null,8,["value","options"])]),_:1}),i("div",re,[i("div",ue,[r(P,{data:p.value,width:"26.06vw",height:c.tabStatus==="on"?"28.07vh":"31.38vh",name:s.value,rotate:0,onClickItem:$,dataZoomDefaultValueRange:p.value.dataZoomDefaultValueRange,dataZoomDisabled:!1},null,8,["data","height","name","dataZoomDefaultValueRange"])])])])]),i("div",ce,[i("div",de,[r(C,{subtitle:"运维统计"},{default:k(()=>[r(n,{value:a.operation,"onUpdate:value":e[2]||(e[2]=o=>a.operation=o),options:E.value,onChange:N,style:{width:"1.2rem"}},null,8,["value","options"])]),_:1}),r(O,{style:I(c.tabStatus==="on"?"margin-top: -0.06rem; ":"margin-top: -0.14rem"),class:A(["indicator-group-layout",c.tabStatus==="on"?"":"fix-indicator-group-padding"]),data:b.value,onClickItem:B},null,8,["style","class","data"]),i("div",pe,[i("div",me,[r(j,{id:"pieChart",width:"29.59vw",height:c.tabStatus==="on"?"25.2vh":"28vh",data:d.value.pieData,showLabel:"",labelFormatter:"{b}：{d}%",roseType:!1,radius:["40%","60%"],tooltipFormatter:"{b}：{c}",onClickItem:B},null,8,["height","data"])])])])]),i("div",he,[i("div",ve,[r(C,{subtitle:"安全运行"},{default:k(()=>[r(n,{value:a.safeOperation,"onUpdate:value":e[3]||(e[3]=o=>a.safeOperation=o),options:U.value,onChange:Z,style:{width:"1.2rem"}},null,8,["value","options"])]),_:1}),r(O,{style:I(c.tabStatus==="on"?"margin-top: -0.06rem":"margin-top: -0.14rem"),class:A(["indicator-group-layout",c.tabStatus==="on"?"":"fix-indicator-group-padding"]),data:g.value,onClickItem:S},null,8,["style","class","data"]),i("div",fe,[i("div",be,[r(W,{data:a.signRage,width:"1.5rem",height:"2rem",circle:{top:"0.49rem",left:"0.24rem",width:"1.02rem",height:"1.02rem"},onClickItem:S},null,8,["data"])])])])])])}}});const Ne=q(ge,[["__scopeId","data-v-949f8a25"]]);export{Ne as default};
//# sourceMappingURL=LeftContent-f3baf239.js.map
