{"version":3,"file":"Power-6b4be845.js","sources":["../../src/views/da/cockpit/power/Power.vue"],"sourcesContent":["<template>\n  <div v-if=\"refreshFlag\" class=\"layout rem-layout\">\n    <div class=\"dashboard\" :class=\"{ 'header-off': tabStatus === 'off' }\">\n      <CockpitHeader v-if=\"tabStatus === 'on'\" class=\"header-layout\" :title=\"title\" @date-change=\"handleDateChange\" />\n      <CockpitSetting v-if=\"tabStatus === 'off'\" @date-change=\"handleDateChange\" />\n      <div class=\"content\">\n        <LeftContent ref=\"leftContentRef\" :searchInfoByTime=\"searchInfoByTime\" :tabStatus=\"tabStatus\" />\n        <MiddleContent ref=\"middleContentRef\" :topIndexData=\"topIndexData\" :searchInfoByTime=\"searchInfoByTime\" :tabStatus=\"tabStatus\" />\n        <RightContent ref=\"rightContentRef\" :topIndexData=\"topIndexData\" :searchInfoByTime=\"searchInfoByTime\" :tabStatus=\"tabStatus\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import '../../rem.ts';\n  import { ref, onMounted, nextTick, getCurrentInstance } from 'vue';\n  import CockpitHeader from '/@/components/Framework/Chart/CockpitHeader.vue';\n  import LeftContent from '/@/views/da/cockpit/power/LeftContent.vue';\n  import MiddleContent from '/@/views/da/cockpit/power/MiddleContent.vue';\n  import RightContent from '/@/views/da/cockpit/power/RightContent.vue';\n  import { getTopIndexData } from './data';\n  import CockpitSetting from '/@/components/Framework/Chart/CockpitSetting.vue';\n  import { handleInstanceUpdated } from '/@/utils/route';\n  import { useRouter } from 'vue-router';\n  // import { MsgManager } from '/@/message/MsgManager';\n\n  const title = ref('电量驾驶舱');\n  const searchInfoByTime = ref({}); // 时间参数\n  const topIndexData = ref({}); // 指标值\n  const refreshFlag = ref(true);\n  const tabStatus = ref('');\n  const instance = getCurrentInstance();\n  const leftContentRef = ref();\n  const middleContentRef = ref();\n  const rightContentRef = ref();\n  const router = useRouter();\n\n  function handleDateChange(e) {\n    const [startMonth, endMonth] = e;\n    searchInfoByTime.value = { startMonth, endMonth };\n    queryTopIndexData();\n  }\n\n  const queryTopIndexData = async () => {\n    let data = await getTopIndexData(searchInfoByTime.value);\n    if (data.result) {\n      topIndexData.value = data.result[0];\n    }\n  };\n\n  // 判断当前页面是否在 iframe 中显示\n  const checkInIframe = () => {\n    try {\n      return window.self !== window.top;\n    } catch (e) {\n      return true;\n    }\n  };\n\n  // 更新页面\n  const handlePageUpdate = () => {\n    try {\n      const path = router.currentRoute.value?.path;\n      if (path === '/frame/cockpit/power') {\n        handleInstanceUpdated(instance);\n      } else if (path === '/cockpitpower') {\n        leftContentRef.value?.handleUpdate();\n        rightContentRef.value?.handleUpdate();\n        middleContentRef.value?.handleUpdate();\n      }\n    } catch (error) {\n      console.error('update power page error:', error);\n    }\n  };\n\n  onMounted(() => {\n    tabStatus.value = checkInIframe() ? 'off' : 'on';\n    window.addEventListener('resize', handlePageUpdate);\n  });\n</script>\n\n<style lang=\"less\" scoped>\n  .layout {\n    position: relative;\n    width: 100%;\n    height: 100%;\n\n    .dashboard {\n      display: flex;\n      position: relative;\n      flex-direction: column;\n      width: 100%;\n      height: 100%;\n      background: url('../../../../assets/images/da/sky_bg.jpg') no-repeat center/100% 100%;\n\n      .content {\n        display: flex;\n        position: relative;\n        flex: 1;\n        flex-shrink: 0;\n        justify-content: space-between;\n        margin-top: 0.2rem;\n\n        :deep(.ant-select-selection-search-input) {\n          color: rgb(255 255 255 / 85%);\n        }\n\n        :deep(.ant-select-selection-item) {\n          color: rgb(255 255 255 / 85%);\n        }\n\n        :deep(\n            .ant-select-single .ant-select-selector .ant-select-selection-item,\n            .ant-select-single .ant-select-selector .ant-select-selection-placeholder\n          ) {\n          line-height: 0.24rem;\n        }\n\n        :deep(.ant-select) {\n          font-size: 0.14rem;\n        }\n      }\n    }\n  }\n</style>\n"],"names":["title","ref","searchInfoByTime","topIndexData","refreshFlag","tabStatus","instance","getCurrentInstance","leftContentRef","middleContentRef","rightContentRef","router","useRouter","handleDateChange","e","startMonth","endMonth","queryTopIndexData","__async","data","getTopIndexData","checkInIframe","handlePageUpdate","path","_a","handleInstanceUpdated","_b","_c","_d","error","onMounted"],"mappings":"6zCA2BQ,MAAAA,EAAQC,EAAI,OAAO,EACnBC,EAAmBD,EAAI,CAAA,CAAE,EACzBE,EAAeF,EAAI,CAAA,CAAE,EACrBG,EAAcH,EAAI,EAAI,EACtBI,EAAYJ,EAAI,EAAE,EAClBK,EAAWC,IACXC,EAAiBP,IACjBQ,EAAmBR,IACnBS,EAAkBT,IAClBU,EAASC,IAEf,SAASC,EAAiBC,EAAG,CACrB,KAAA,CAACC,EAAYC,CAAQ,EAAIF,EACdZ,EAAA,MAAQ,CAAE,WAAAa,EAAY,SAAAC,CAAS,EAC9BC,GACpB,CAEA,MAAMA,EAAoB,IAAYC,EAAA,sBACpC,IAAIC,EAAO,MAAMC,EAAgBlB,EAAiB,KAAK,EACnDiB,EAAK,SACMhB,EAAA,MAAQgB,EAAK,OAAO,CAAC,EACpC,GAIIE,EAAgB,IAAM,CACtB,GAAA,CACK,OAAA,OAAO,OAAS,OAAO,UACvBP,EAAG,CACH,MAAA,EACT,CAAA,EAIIQ,EAAmB,IAAM,aACzB,GAAA,CACI,MAAAC,GAAOC,EAAAb,EAAO,aAAa,QAApB,YAAAa,EAA2B,KACpCD,IAAS,uBACXE,EAAsBnB,CAAQ,EACrBiB,IAAS,mBAClBG,EAAAlB,EAAe,QAAf,MAAAkB,EAAsB,gBACtBC,EAAAjB,EAAgB,QAAhB,MAAAiB,EAAuB,gBACvBC,EAAAnB,EAAiB,QAAjB,MAAAmB,EAAwB,sBAEnBC,EAAO,CACN,QAAA,MAAM,2BAA4BA,CAAK,CACjD,CAAA,EAGF,OAAAC,EAAU,IAAM,CACJzB,EAAA,MAAQgB,IAAkB,MAAQ,KACrC,OAAA,iBAAiB,SAAUC,CAAgB,CAAA,CACnD"}