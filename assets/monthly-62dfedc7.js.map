{"version":3,"file":"monthly-62dfedc7.js","sources":["../../src/views/po/integrated/assessmentevaluation/monthly/monthly.ts"],"sourcesContent":["import { defHttp } from '/@/utils/http/axios';\n\nimport { BasicColumn, useRender, FormSchema } from '/@/components/Table';\nimport { useDictStoreWithOut } from '@/store/modules/dict';\nimport { RightCircleFilled } from '@ant-design/icons-vue';\n\nconst dictStore = useDictStoreWithOut();\nenum Api {\n  deleteTemplate = '/po/evaluation-index/delete',\n  getTemplateById = '/po/evaluation-template/get',\n  proportionList = '/po/score-proportion/list',\n  indexList = '/po/evaluation-index/list',\n  tmplateHisList = '/po/evaluation-template/hisList',\n\n  getTemplateByMonth = '/po/evaluation-template/getTemplateByMonth',\n  getStationList = '/baseset/powerstation/list',\n  getDynamicData = '/po/monthly-evaluation/getDynamicData',\n  saveMonthly = '/po/monthly-evaluation/save',\n  updateStatus = '/po/monthly-evaluation/updateStatus',\n  monthlyPage = '/po/monthly-evaluation/page',\n  getMonthlyById = '/po/monthly-evaluation/get',\n  detailList = '/po/monthly-evaluation/getScoreResultByEvaluationId',\n  getIndexByKind = '/po/evaluation-template-dtl/list',\n  getScoringList = '/po/monthly-evaluation-dtl/list',\n  getAllStations = '/po/monthly-evaluation/getEvaluationStations',\n  saveMonthlyDtl = '/po/monthly-evaluation/saveScoring',\n  getStationDtlList = '/po/monthly-evaluation/getStationDtlList',\n  getMonthlyByPeriod = '/po/monthly-evaluation/getMonthlyByPeriod',\n}\n\n// 月度评价列表查询条件\nexport const searchFormSchema: FormSchema[] = [\n  {\n    field: 'billCode',\n    component: 'Input',\n    label: '单据编号',\n    required: false,\n  },\n  {\n    field: 'evaluationPeriod',\n    component: 'MonthPicker',\n    label: '评价周期',\n    componentProps: {\n      width: '100%',\n      format: 'YYYY-MM',\n      valueFormat: 'YYYY-MM',\n    },\n    required: false,\n  },\n  {\n    label: '审批状态',\n    field: 'status',\n    component: 'DictSelectBox',\n    componentProps: {\n      type: 'bpm_process_instance_result',\n    },\n  },\n\n  {\n    label: '业务状态',\n    field: 'businessStatus',\n    component: 'DictSelectBox',\n    componentProps: {\n      type: 'business_status',\n    },\n  },\n];\nasync function getDic(type: string) {\n  const arr: any = [\n    {\n      dictType: '',\n      value: '',\n      label: '',\n      colorType: '',\n      cssClass: '',\n    },\n  ];\n  const map = await dictStore.fetchBackendData(type, {\n    type: type,\n  });\n  return arr.concat(map);\n}\n\n// 列表表头\nexport const columns: BasicColumn[] = [\n  {\n    title: '单据编号',\n    dataIndex: 'billCode',\n    align: 'center',\n    width: 200,\n    resizable: true,\n  },\n  {\n    title: '评价周期',\n    dataIndex: 'evaluationPeriod',\n    width: 200,\n    sorter: true,\n    resizable: true,\n  },\n  {\n    title: '主题',\n    dataIndex: 'subject',\n    align: 'left',\n    width: 400,\n    resizable: true,\n  },\n  {\n    title: '创建人',\n    dataIndex: 'personMemberName',\n    align: 'center',\n    resizable: true,\n    width: 200,\n  },\n  {\n    title: '创建时间',\n    dataIndex: 'fillinDate',\n    align: 'center',\n    sorter: true,\n    resizable: true,\n    width: 200,\n  },\n  {\n    title: '业务状态',\n    dataIndex: 'businessStatusText',\n    align: 'center',\n    resizable: true,\n  },\n  {\n    title: '审批状态',\n    dataIndex: 'status',\n    align: 'center',\n    resizable: true,\n    fixed: 'right',\n    customRender: ({ text, record }) => {\n      return useRender.renderFlowStatus(text, record.statusText);\n    },\n  },\n];\n\n// 指标评分表头\nexport function getScoringColumns() {\n  const dataColumns = [\n    {\n      title: '指标名称',\n      dataIndex: 'indexName',\n      align: 'center',\n      resizable: true,\n      width: 100,\n    },\n    {\n      title: '评价方式',\n      align: 'center',\n      dataIndex: 'evaluationMethodText',\n      resizable: true,\n      width: 100,\n    },\n    {\n      title: '分值',\n      align: 'center',\n      dataIndex: 'tdScore',\n      resizable: true,\n      sorter: true,\n      width: 60,\n    },\n    {\n      title: '考核目标',\n      dataIndex: 'assessTarget',\n      align: 'left',\n      resizable: true,\n      width: 200,\n    },\n    {\n      title: '评分规则',\n      dataIndex: 'scoreRuleDesc',\n      align: 'left',\n      resizable: true,\n      width: 200,\n    },\n    {\n      title: '电站',\n      dataIndex: 'stationName',\n      align: 'center',\n      fixed: 'right',\n      resizable: true,\n      sorter: true,\n      width: 120,\n    },\n    {\n      title: '系统分',\n      dataIndex: 'sysScore',\n      align: 'center',\n      fixed: 'right',\n      resizable: true,\n      sorter: true,\n      width: 80,\n    },\n    {\n      title: '主观分',\n      dataIndex: 'subScore',\n      align: 'center',\n      fixed: 'right',\n      resizable: true,\n      sorter: true,\n      width: 80,\n    },\n    {\n      title: '日常评价分',\n      dataIndex: 'dailyEvaluationScore',\n      align: 'center',\n      fixed: 'right',\n      resizable: true,\n      sorter: true,\n      width: 120,\n    },\n    {\n      title: '调整分',\n      dataIndex: 'adjustmentScore',\n      align: 'center',\n      fixed: 'right',\n      resizable: true,\n      sorter: true,\n      width: 80,\n    },\n    {\n      title: '最终得分',\n      dataIndex: 'finalScore',\n      align: 'center',\n      fixed: 'right',\n      resizable: true,\n      sorter: true,\n      width: 100,\n    },\n    {\n      title: '评价说明',\n      dataIndex: 'evaluationDesc',\n      align: 'center',\n      fixed: 'right',\n      resizable: true,\n      width: 120,\n    },\n    {\n      title: '系统分扣分原因',\n      dataIndex: 'sysDescrption',\n      align: 'center',\n      fixed: 'right',\n      resizable: true,\n      width: 120,\n    },\n  ];\n  return dataColumns;\n}\n\n// 电站得分详情表头\nexport function getStationDtlColumns() {\n  const dataColumns = [\n    {\n      title: '指标类别',\n      dataIndex: 'indexKindText',\n      align: 'center',\n      resizable: true,\n      width: 80,\n    },\n    {\n      title: '指标名称',\n      dataIndex: 'indexName',\n      align: 'center',\n      resizable: true,\n      width: 80,\n    },\n    {\n      title: '评价方式',\n      align: 'center',\n      dataIndex: 'evaluationMethodText',\n      resizable: true,\n      width: 100,\n    },\n    {\n      title: '考核目标',\n      dataIndex: 'assessTarget',\n      resizable: true,\n      align: 'left',\n      width: 200,\n    },\n    {\n      title: '评分规则',\n      dataIndex: 'scoreRuleDesc',\n      resizable: true,\n      align: 'left',\n      width: 200,\n    },\n    {\n      title: '分值',\n      align: 'center',\n      dataIndex: 'score',\n      resizable: true,\n      sorter: true,\n      width: 60,\n    },\n    {\n      title: '系统分',\n      dataIndex: 'sysScore',\n      align: 'center',\n      fixed: 'right',\n      resizable: true,\n      sorter: true,\n      width: 80,\n    },\n    {\n      title: '系统分扣分原因',\n      dataIndex: 'sysDescription',\n      align: 'center',\n      fixed: 'right',\n      resizable: true,\n      width: 120,\n    },\n    {\n      title: '主观分',\n      dataIndex: 'subScore',\n      align: 'center',\n      resizable: true,\n      sorter: true,\n      fixed: 'right',\n      width: 80,\n    },\n    {\n      title: '日常评价分',\n      dataIndex: 'dailyEvaluationScore',\n      align: 'center',\n      fixed: 'right',\n      resizable: true,\n      sorter: true,\n      width: 100,\n    },\n    {\n      title: '调整分',\n      dataIndex: 'adjustmentScore',\n      align: 'center',\n      fixed: 'right',\n      resizable: true,\n      sorter: true,\n      width: 80,\n    },\n    {\n      title: '最终得分',\n      dataIndex: 'finalScore',\n      align: 'center',\n      fixed: 'right',\n      resizable: true,\n      sorter: true,\n      width: 100,\n    },\n    {\n      title: '加权分',\n      dataIndex: 'weightScore',\n      align: 'center',\n      fixed: 'right',\n      resizable: true,\n      sorter: true,\n      width: 80,\n    },\n    {\n      title: '评价说明',\n      dataIndex: 'evaluationDesc',\n      align: 'center',\n      fixed: 'right',\n      resizable: true,\n    },\n  ];\n  return dataColumns;\n}\n\n// 列表数据\nexport const getDataList = (params) =>\n  defHttp.get(\n    {\n      url: Api.monthlyPage,\n      params,\n    },\n    { isOnlyResult: true },\n  );\n\n// 保存\nexport const saveMonthly = (params) =>\n  defHttp.post(\n    {\n      url: Api.saveMonthly,\n      params,\n    },\n    {},\n  );\n// 启用/禁用\nexport const updateStatus = (params) =>\n  defHttp.get(\n    {\n      url: Api.updateStatus,\n      params,\n    },\n    { isOnlyResult: true },\n  );\n\n// 删除\nexport const deleteTemplate = (id) =>\n  defHttp.delete(\n    {\n      url: Api.deleteTemplate + '?id=' + id,\n    },\n    {},\n  );\n\n// 导出\nexport function exportExcel(params) {\n  return defHttp.download({ url: '/po/monthly-evaluation/export-excel', params }, '月度评价.xls');\n}\n//————————————————————————————————————————————————————————————新增页面——————————————————————————————————————————————————————————————————\n// 加载月度评价\nexport const getMonthlyById = (id) =>\n  defHttp.get(\n    {\n      url: Api.getMonthlyById + '?id=' + id,\n    },\n    { isOnlyResult: true },\n  );\n\n// 根据选择的月份获取生效模板\nexport const getTemplateByMonth = (params) =>\n  defHttp.get(\n    {\n      url: Api.getTemplateByMonth,\n      params,\n    },\n    { isOnlyResult: true },\n  );\n\n// 获取所有电站\nexport const getStationList = (params) =>\n  defHttp.get(\n    {\n      url: Api.getStationList,\n      params,\n    },\n    { isOnlyResult: true },\n  );\n\n// 明细列表数据\nexport const getDetailList = (params) =>\n  defHttp.get(\n    {\n      url: Api.detailList,\n      params,\n    },\n    { isOnlyResult: true },\n  );\n\n// 获取动态数据，包括按钮数据和明细列头数据\nexport const getDynamicData = (params) =>\n  defHttp.get(\n    {\n      url: Api.getDynamicData,\n      params,\n    },\n    { isOnlyResult: true },\n  );\n//————————————————————————————————————————————————————————————打分页面——————————————————————————————————————————————————————————————————\n\n// 打分页面指标下拉框数据\nexport const getIndexByKind = (params) =>\n  defHttp.get(\n    {\n      url: Api.getIndexByKind,\n      params,\n    },\n    { isOnlyResult: true },\n  );\n\n// 打分页面指标下拉框数据\nexport const getAllStations = (params) =>\n  defHttp.get(\n    {\n      url: Api.getAllStations,\n      params,\n    },\n    { isOnlyResult: true },\n  );\n\n// 打分页面明细数据列表\nexport const getScoringList = (params) =>\n  defHttp.get(\n    {\n      url: Api.getScoringList,\n      params,\n    },\n    { isOnlyResult: true },\n  );\n\n// 保存\nexport const saveMonthlyDtl = (params) =>\n  defHttp.post(\n    {\n      url: Api.saveMonthlyDtl,\n      params,\n    },\n    {},\n  );\n//————————————————————————————————————————————————————————————电站得分详情页面——————————————————————————————————————————————————————————————————\nexport const getStationDtlList = (params) =>\n  defHttp.get(\n    {\n      url: Api.getStationDtlList,\n      params,\n    },\n    { isOnlyResult: true },\n  );\n\nexport const getMonthlyByPeriod = (params) =>\n  defHttp.get(\n    {\n      url: Api.getMonthlyByPeriod,\n      params,\n    },\n    { isOnlyResult: true },\n  );\n"],"names":["useDictStoreWithOut","searchFormSchema","columns","text","record","useRender","getScoringColumns","getStationDtlColumns","getDataList","params","defHttp","saveMonthly","updateStatus","exportExcel","getMonthlyById","id","getTemplateByMonth","getStationList","getDetailList","getDynamicData","getIndexByKind","getAllStations","getScoringList","saveMonthlyDtl","getStationDtlList"],"mappings":"uOAMkBA,EAAoB,EAyB/B,MAAMC,EAAiC,CAC5C,CACE,MAAO,WACP,UAAW,QACX,MAAO,OACP,SAAU,EACZ,EACA,CACE,MAAO,mBACP,UAAW,cACX,MAAO,OACP,eAAgB,CACd,MAAO,OACP,OAAQ,UACR,YAAa,SACf,EACA,SAAU,EACZ,EACA,CACE,MAAO,OACP,MAAO,SACP,UAAW,gBACX,eAAgB,CACd,KAAM,6BACR,CACF,EAEA,CACE,MAAO,OACP,MAAO,iBACP,UAAW,gBACX,eAAgB,CACd,KAAM,iBACR,CACF,CACF,EAkBaC,EAAyB,CACpC,CACE,MAAO,OACP,UAAW,WACX,MAAO,SACP,MAAO,IACP,UAAW,EACb,EACA,CACE,MAAO,OACP,UAAW,mBACX,MAAO,IACP,OAAQ,GACR,UAAW,EACb,EACA,CACE,MAAO,KACP,UAAW,UACX,MAAO,OACP,MAAO,IACP,UAAW,EACb,EACA,CACE,MAAO,MACP,UAAW,mBACX,MAAO,SACP,UAAW,GACX,MAAO,GACT,EACA,CACE,MAAO,OACP,UAAW,aACX,MAAO,SACP,OAAQ,GACR,UAAW,GACX,MAAO,GACT,EACA,CACE,MAAO,OACP,UAAW,qBACX,MAAO,SACP,UAAW,EACb,EACA,CACE,MAAO,OACP,UAAW,SACX,MAAO,SACP,UAAW,GACX,MAAO,QACP,aAAc,CAAC,CAAE,KAAAC,EAAM,OAAAC,KACdC,EAAU,iBAAiBF,EAAMC,EAAO,UAAU,CAE7D,CACF,EAGO,SAASE,GAAoB,CA6G3B,MA5Ga,CAClB,CACE,MAAO,OACP,UAAW,YACX,MAAO,SACP,UAAW,GACX,MAAO,GACT,EACA,CACE,MAAO,OACP,MAAO,SACP,UAAW,uBACX,UAAW,GACX,MAAO,GACT,EACA,CACE,MAAO,KACP,MAAO,SACP,UAAW,UACX,UAAW,GACX,OAAQ,GACR,MAAO,EACT,EACA,CACE,MAAO,OACP,UAAW,eACX,MAAO,OACP,UAAW,GACX,MAAO,GACT,EACA,CACE,MAAO,OACP,UAAW,gBACX,MAAO,OACP,UAAW,GACX,MAAO,GACT,EACA,CACE,MAAO,KACP,UAAW,cACX,MAAO,SACP,MAAO,QACP,UAAW,GACX,OAAQ,GACR,MAAO,GACT,EACA,CACE,MAAO,MACP,UAAW,WACX,MAAO,SACP,MAAO,QACP,UAAW,GACX,OAAQ,GACR,MAAO,EACT,EACA,CACE,MAAO,MACP,UAAW,WACX,MAAO,SACP,MAAO,QACP,UAAW,GACX,OAAQ,GACR,MAAO,EACT,EACA,CACE,MAAO,QACP,UAAW,uBACX,MAAO,SACP,MAAO,QACP,UAAW,GACX,OAAQ,GACR,MAAO,GACT,EACA,CACE,MAAO,MACP,UAAW,kBACX,MAAO,SACP,MAAO,QACP,UAAW,GACX,OAAQ,GACR,MAAO,EACT,EACA,CACE,MAAO,OACP,UAAW,aACX,MAAO,SACP,MAAO,QACP,UAAW,GACX,OAAQ,GACR,MAAO,GACT,EACA,CACE,MAAO,OACP,UAAW,iBACX,MAAO,SACP,MAAO,QACP,UAAW,GACX,MAAO,GACT,EACA,CACE,MAAO,UACP,UAAW,gBACX,MAAO,SACP,MAAO,QACP,UAAW,GACX,MAAO,GACT,CAAA,CAGJ,CAGO,SAASC,GAAuB,CAmH9B,MAlHa,CAClB,CACE,MAAO,OACP,UAAW,gBACX,MAAO,SACP,UAAW,GACX,MAAO,EACT,EACA,CACE,MAAO,OACP,UAAW,YACX,MAAO,SACP,UAAW,GACX,MAAO,EACT,EACA,CACE,MAAO,OACP,MAAO,SACP,UAAW,uBACX,UAAW,GACX,MAAO,GACT,EACA,CACE,MAAO,OACP,UAAW,eACX,UAAW,GACX,MAAO,OACP,MAAO,GACT,EACA,CACE,MAAO,OACP,UAAW,gBACX,UAAW,GACX,MAAO,OACP,MAAO,GACT,EACA,CACE,MAAO,KACP,MAAO,SACP,UAAW,QACX,UAAW,GACX,OAAQ,GACR,MAAO,EACT,EACA,CACE,MAAO,MACP,UAAW,WACX,MAAO,SACP,MAAO,QACP,UAAW,GACX,OAAQ,GACR,MAAO,EACT,EACA,CACE,MAAO,UACP,UAAW,iBACX,MAAO,SACP,MAAO,QACP,UAAW,GACX,MAAO,GACT,EACA,CACE,MAAO,MACP,UAAW,WACX,MAAO,SACP,UAAW,GACX,OAAQ,GACR,MAAO,QACP,MAAO,EACT,EACA,CACE,MAAO,QACP,UAAW,uBACX,MAAO,SACP,MAAO,QACP,UAAW,GACX,OAAQ,GACR,MAAO,GACT,EACA,CACE,MAAO,MACP,UAAW,kBACX,MAAO,SACP,MAAO,QACP,UAAW,GACX,OAAQ,GACR,MAAO,EACT,EACA,CACE,MAAO,OACP,UAAW,aACX,MAAO,SACP,MAAO,QACP,UAAW,GACX,OAAQ,GACR,MAAO,GACT,EACA,CACE,MAAO,MACP,UAAW,cACX,MAAO,SACP,MAAO,QACP,UAAW,GACX,OAAQ,GACR,MAAO,EACT,EACA,CACE,MAAO,OACP,UAAW,iBACX,MAAO,SACP,MAAO,QACP,UAAW,EACb,CAAA,CAGJ,CAGa,MAAAC,EAAeC,GAC1BC,EAAQ,IACN,CACE,IAAK,8BACL,OAAAD,CACF,EACA,CAAE,aAAc,EAAK,CACvB,EAGWE,EAAeF,GAC1BC,EAAQ,KACN,CACE,IAAK,8BACL,OAAAD,CACF,EACA,CAAC,CACH,EAEWG,EAAgBH,GAC3BC,EAAQ,IACN,CACE,IAAK,sCACL,OAAAD,CACF,EACA,CAAE,aAAc,EAAK,CACvB,EAYK,SAASI,EAAYJ,EAAQ,CAClC,OAAOC,EAAQ,SAAS,CAAE,IAAK,sCAAuC,OAAAD,CAAA,EAAU,UAAU,CAC5F,CAGa,MAAAK,EAAkBC,GAC7BL,EAAQ,IACN,CACE,IAAK,iCAA8BK,CACrC,EACA,CAAE,aAAc,EAAK,CACvB,EAGWC,EAAsBP,GACjCC,EAAQ,IACN,CACE,IAAK,6CACL,OAAAD,CACF,EACA,CAAE,aAAc,EAAK,CACvB,EAGWQ,EAAkBR,GAC7BC,EAAQ,IACN,CACE,IAAK,6BACL,OAAAD,CACF,EACA,CAAE,aAAc,EAAK,CACvB,EAGWS,EAAiBT,GAC5BC,EAAQ,IACN,CACE,IAAK,sDACL,OAAAD,CACF,EACA,CAAE,aAAc,EAAK,CACvB,EAGWU,EAAkBV,GAC7BC,EAAQ,IACN,CACE,IAAK,wCACL,OAAAD,CACF,EACA,CAAE,aAAc,EAAK,CACvB,EAIWW,EAAkBX,GAC7BC,EAAQ,IACN,CACE,IAAK,mCACL,OAAAD,CACF,EACA,CAAE,aAAc,EAAK,CACvB,EAGWY,EAAkBZ,GAC7BC,EAAQ,IACN,CACE,IAAK,+CACL,OAAAD,CACF,EACA,CAAE,aAAc,EAAK,CACvB,EAGWa,EAAkBb,GAC7BC,EAAQ,IACN,CACE,IAAK,kCACL,OAAAD,CACF,EACA,CAAE,aAAc,EAAK,CACvB,EAGWc,EAAkBd,GAC7BC,EAAQ,KACN,CACE,IAAK,qCACL,OAAAD,CACF,EACA,CAAC,CACH,EAEWe,EAAqBf,GAChCC,EAAQ,IACN,CACE,IAAK,2CACL,OAAAD,CACF,EACA,CAAE,aAAc,EAAK,CACvB"}