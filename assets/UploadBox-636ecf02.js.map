{"version":3,"file":"UploadBox-636ecf02.js","sources":["../../src/components/Framework/Modal/UploadDialog.vue","../../src/components/Framework/Combox/UploadBox.vue"],"sourcesContent":["<template>\n  <Dialog\n    :title=\"title\"\n    :tweight=\"props.tweight\"\n    :visible=\"modalVisible\"\n    @update:visible=\"updateVisible\"\n    :width=\"props.width\"\n    :height=\"props.height\"\n    @cancel=\"cancel\"\n    @confirm=\"confirm\"\n    @close=\"close\"\n  >\n    <div :id=\"uid\" class=\"dialog-content\">\n      <!-- 温馨提示区域 -->\n      <div class=\"top-content\">\n        <a-alert\n          message=\"温馨提示\"\n          :description=\"props.tmessage\"\n          type=\"info\"\n          style=\"color: #1890FF\"\n        />\n      </div>\n      <!-- 附件列表区域 -->\n      <div class=\"main-content\">\n        <div style=\"overflow-y: scroll;height: 100%;max-height: 100%;\">\n          <a-upload\n            ref=\"antUpload\"\n            :file-list=\"fileList\"\n            :multiple=\"true\"\n            :before-upload=\"beforeUpload\"\n            @remove=\"handleRemove\"\n          >\n            <a-button :id=\"buttonID\" class=\"upload-button\" style=\"display: none\" />\n          </a-upload>\n        </div>\n      </div>\n    </div>\n    <template #footer>\n      <div class=\"footer-container\">\n        <a-button @click=\"handleFileSelect\">\n          <Icon icon=\"ant-design:select-outlined\" />\n          选择文件\n        </a-button>\n        <a-button\n          type=\"primary\"\n          :disabled=\"uploadBtnFlag\"\n          :loading=\"uploading\"\n          style=\"margin-top: 16px\"\n          @click=\"handleUpload\"\n        >\n          <Icon icon=\"material-symbols-light:upload\" />\n          {{ uploading ? '上传中...' : '开始上传' }}\n        </a-button>\n        <a-button @click=\"handleClose\">\n          <Icon icon=\"carbon:close-outline\" />\n          关闭\n        </a-button>\n      </div>\n    </template>\n  </Dialog>\n</template>\n\n<script lang=\"ts\" setup>\n  import Dialog from '@/components/Framework/Modal/Dialog.vue';\n  import Icon from '@/components/Icon/Icon.vue';\n  import {\n    ref,\n    defineProps,\n    defineEmits,\n    onMounted,\n    watch,\n    unref,\n    computed,\n    getCurrentInstance,\n  } from 'vue';\n  import { Modal } from 'ant-design-vue';\n  import type { UploadProps } from 'ant-design-vue';\n  import * as FileApi from '@/api/infra/file';\n  import { SysMessage } from '/@/hooks/web/useMessage';\n  import { MsgManager } from '/@/message/MsgManager';\n  import { buildUUID } from '/@/utils/uuid';\n  import { dialogMaskOpen, dialogMaskClose } from '@/utils/mask';\n\n  const modalVisible = ref(false);\n  const fileList = ref<UploadProps['fileList']>([]);\n  const uploading = ref<boolean>(false);\n  const buttonID = 'upload-button-' + (Math.random() * 10000).toFixed(0);\n  const antUpload = ref();\n  const uid = ref(buildUUID());\n\n  const props = defineProps({\n    visible: Boolean, // 是否显示弹框\n    title: String, // 弹框标题\n    value: { type: Array<String>, default: [] },\n    tweight: { type: Number, default: 500 },\n    width: { type: Number, default: 700 }, // 弹框宽度\n    height: { type: Number, default: 500 }, // 弹框高度\n    tdata: { type: Array }, // 附件数据\n    maxCount: { type: Number, default: 10 },\n    maxSize: { type: Number, default: 104857600 }, // 100M\n    application: { type: String, default: '' },\n    module: { type: String, default: '' },\n    bizId: { type: String, default: '' },\n    fileKindId: { type: String, default: '' },\n    tmessage: { type: String, default: '' },\n    format: {\n      type: String,\n      default: 'png,jpg,jpeg,bmp,wps,pdf,txt,doc,docx,xls,xlsx,ppt,pptx,zip,rar,mp3,mp4',\n    },\n  });\n\n  const emit = defineEmits([\n    'update:visible',\n    'update:value',\n    'change',\n    'cancel',\n    'confirm',\n    'close',\n  ]); // 定义事件\n\n  const uploadBtnFlag = computed(() => {\n    let valid = false;\n    try {\n      fileList.value.forEach((file: UploadProps['fileList'][number]) => {\n        if (!file.id) {\n          valid = true;\n        }\n      });\n    } catch (error) {\n      //\n    }\n    return !valid;\n  });\n\n  const cancel = () => {\n    emit('cancel'); // 发送取消事件\n  };\n\n  const confirm = () => {\n    emit('confirm', []); // 发送确定事件\n  };\n\n  const close = () => {\n    emit('close', []); // 发送确定事件\n  };\n\n  const updateVisible = ($event) => {\n    modalVisible.value = $event;\n    emit('update:visible', $event); // 关闭弹框\n  };\n\n  // 获取附件列表\n  const getFiles = async (bizId, fileKindId = '') => {\n    if (typeof bizId == 'undefined' || bizId == null || bizId == '') {\n      return [];\n    }\n    const filelist = await FileApi.getFiles({ bizId, fileKindId });\n    if (typeof filelist === 'string') {\n      return JSON.parse(filelist);\n    }\n    return filelist;\n  };\n\n  const handleRemove: UploadProps['onRemove'] = async (file): Boolean => {\n    const callback = new Promise((resolve, reject) => {\n      Modal.confirm({\n        title: '确认操作',\n        content: '请确认是否删除此附件？',\n        onOk: async () => {\n          try {\n            let index = fileList.value.indexOf(file);\n            fileList.value.splice(index, 1);\n            if (Reflect.has(file, 'id')) {\n              await FileApi.deleteFile(file.id);\n              emit('change', fileList.value);\n              emit('update:value', fileList.value);\n            } else {\n              const selector = `.dialog-content > .main-content .ant-upload-list`;\n              const selectorElement = `.dialog-content > .main-content .ant-upload-list .ant-upload-list-text-container:nth-child(${++index})`;\n              const parentNode = document.querySelector(selector);\n              const node = document.querySelector(selectorElement);\n              parentNode.removeChild(node);\n            }\n          } catch (error) {\n            //\n          }\n          resolve(true);\n        },\n        onCancel() {\n          emit('update:value', fileList.value);\n          emit('change', fileList.value);\n          reject(false);\n        },\n      });\n    });\n    const result = await callback;\n    return result;\n  };\n\n  const beforeUpload: UploadProps['beforeUpload'] = (file) => {\n    // 检查文件数量是否超限\n    if (fileList.value.length + 1 > props.maxCount) {\n      SysMessage.getInstance().warning('超过文件上传数量限制，最大上传文件数：' + props.maxCount);\n      return false;\n    }\n    // 检查上传的文件大小是否超限\n    if (file.size > props.maxSize) {\n      SysMessage.getInstance().warning(\n        `文件大小超过最大限度${Math.floor(props.maxSize / 1048576)}MB`,\n      );\n      return false;\n    }\n    // 上传文件不能为空\n    if (file.size === 0) {\n      SysMessage.getInstance().warning('不能上传空文件或目录，请重新选择');\n      return false;\n    }\n    // 不允许上传同名文件\n    for (let i = 0; i < fileList.value.length; i++) {\n      const item = fileList.value[i];\n      if (item.name === file.name) {\n        SysMessage.getInstance().warning('不允许上传重复文件');\n        return false;\n      }\n    }\n    // 控制上传文件的类型 arr是上传类型的白名单\n    const type = file.name.slice(file.name.lastIndexOf('.') + 1).toLowerCase();\n    const arr = `,${props.format},`;\n    if (!arr.includes(`,${type},`)) {\n      SysMessage.getInstance().warning(`不支持${type}类型的文件上传`);\n      return false;\n    }\n    fileList.value = [...fileList.value, file];\n    return false;\n  };\n\n  const handleUpload = () => {\n    let valid = false;\n    const formData = new FormData();\n    formData.append('application', props.application); //附件上传必须携带参数：应用\n    formData.append('module', props.module); //附件上传必须携带参数：模块\n    formData.append('bizId', props.bizId); //附件上传必须携带参数：业务ID\n    formData.append('fileKindId', props.fileKindId); //文件配置类型编码(表格配置附件必须携带)\n    if (!props.bizId) {\n      SysMessage.getInstance().warning(`bizId不能为空`);\n      return false;\n    }\n    fileList?.value?.forEach((file: UploadProps['fileList'][number]) => {\n      if (!file.id) {\n        // 未上传前file.id为空\n        formData.append('files[]', file as any);\n        valid = true;\n      }\n    });\n\n    // 校验是否存在新选择的待上传附件\n    if (!valid) {\n      return SysMessage.getInstance().error('请选择文件后再进行上传操作！');\n    }\n\n    uploading.value = true;\n    FileApi.uploadFile(formData)\n      .then(async () => {\n        uploading.value = false;\n        fileList.value = await getFiles(props.bizId, props.fileKindId);\n        emit('update:value', fileList.value);\n        emit('change', fileList.value);\n        SysMessage.getInstance().success('操作成功');\n      })\n      .catch(() => {\n        uploading.value = false;\n        SysMessage.getInstance().error('操作失败');\n      });\n  };\n\n  const handleFileSelect = () => {\n    try {\n      const button = document.querySelector('#' + buttonID + '.upload-button');\n      button.click();\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  const handleClose = () => {\n    modalVisible.value = false;\n    emit('update:visible', false); // 关闭弹框\n    dialogMaskClose();\n  };\n\n  watch(\n    () => props.visible,\n    async (newValue, oldValue) => {\n      modalVisible.value = newValue;\n      if (newValue != oldValue && newValue == true) {\n        if (props.value != null && props.value.length > 0) {\n          fileList.value = props.value;\n        } else {\n          fileList.value = await getFiles(props.bizId, props.fileKindId);\n        }\n      }\n    },\n  );\n\n  watch(\n    () => props.tdata,\n    () => {},\n  );\n\n  watch(\n    () => props.bizId,\n    async () => {\n      if (props.bizId && props.fileKindId) {\n        fileList.value = await getFiles(props.bizId, props.fileKindId);\n      }\n    },\n  );\n\n  onMounted(() => {\n    modalVisible.value = props.visible;\n  });\n</script>\n\n<style lang=\"less\" scoped>\n  .dialog-content {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n\n    .top-content {\n      margin-bottom: 5px;\n      border: 0 solid #f0f0f0;\n      color: #0960bd;\n    }\n\n    .main-content {\n      flex: 1;\n      height: auto;\n      border: 1px solid #f0f0f0;\n    }\n  }\n\n  .theme1 {\n    .dialog-content {\n      .main-content {\n        flex: 1;\n        height: auto;\n        border: 1px solid rgb(217 217 217 / 16%);\n      }\n    }\n  }\n\n  .footer-container {\n    :deep(.ant-btn) {\n      margin-right: 10px;\n      &:last-child {\n        margin-right: 0;\n      }\n    }\n  }\n\n  :deep(\n      .ant-upload-list-text .ant-upload-list-item-name,\n      .ant-upload-list-picture .ant-upload-list-item-name\n    ) {\n    flex: auto;\n    margin: 0;\n    padding: 0 8px;\n    text-align: left;\n  }\n\n  :deep(.ant-alert-content) {\n    text-align: left;\n  }\n\n  :deep(.ant-upload-list) {\n    margin-top: -15px;\n  }\n\n  :deep(.ant-alert-with-description .ant-alert-message) {\n    color: #1890FF;\n  }\n</style>\n","<template>\n  <div class=\"upload-box\">\n    <Button\n      v-if=\"props.vmode == 'edit' || props.vmode == 'box'\"\n      @click=\"handleOpenUpDialog\"\n      :disabled=\"isDisabled\"\n      style=\"margin: 0 10px 0 0\"\n      :size=\"btnSize\"\n    >\n      <Icon icon=\"material-symbols-light:upload\" />\n      {{ props.tname }}\n    </Button>\n    <div\n      v-if=\"props.vmode != 'edit' || props.vmode == 'box' || props.vmode == 'view'\"\n      class=\"ant-upload-list ant-upload-list-text\"\n    >\n      <template v-for=\"file in filelist\" :key=\"`${file.id}`\">\n        <div class=\"ant-upload-list-item\">\n          <div class=\"ant-upload-list-item-info\">\n            <span class=\"ant-upload-span\">\n              <span role=\"img\" aria-label=\"paper-clip\" class=\"anticon anticon-paper-clip\">\n                <Icon icon=\"ph:file-light\" />\n              </span>\n              <a\n                target=\"_blank\"\n                class=\"ant-upload-list-item-name\"\n                :size=\"file?.size\"\n                :title=\"file?.name\"\n                :href=\"FileApi.attachmentPreview(file?.url,file?.name)\"\n              >\n                {{ file?.name }}\n              </a>\n            </span>\n          </div>\n        </div>\n      </template>\n    </div>\n    <UploadDialog\n      v-if=\"props.vmode == 'edit' || props.vmode == 'box'\"\n      v-model:visible=\"uploadVisible\"\n      v-model:value=\"filelist\"\n      :title=\"props.title\"\n      :width=\"props.width\"\n      :height=\"props.height\"\n      :maxCount=\"props.maxCount\"\n      :maxSize=\"props.maxSize\"\n      :application=\"props.application\"\n      :module=\"props.module\"\n      :format=\"tFormat\"\n      :bizId=\"bizFileId\"\n      :fileKindId=\"tFileKindId\"\n      :tmessage=\"tMessage\"\n      @change=\"handleUploadOver\"\n      @cancel=\"handleUploadCancel\"\n      @confirm=\"handleUploadConfirm\"\n    />\n  </div>\n</template>\n<script lang=\"ts\" setup>\n  import { Button } from 'ant-design-vue';\n  import Icon from '@/components/Icon/Icon.vue';\n  import UploadDialog from '@/components/Framework/Modal/UploadDialog.vue';\n  import { ref, onMounted, defineProps, defineEmits, watch, unref, reactive, computed } from 'vue';\n  import * as FileApi from '@/api/infra/file';\n  import { MsgManager } from '/@/message/MsgManager';\n  import { useThrottleFn } from '@vueuse/core';\n\n  const props = defineProps({\n    vmode: { type: String, default: 'edit' },\n    title: { type: String, default: '上传附件' },\n    tname: { type: String, default: '上传附件' },\n    disabled: { type: Boolean, default: false },\n    width: { type: [Number], default: 800 },\n    height: { type: [Number], default: 600 },\n    twidth: { type: [Boolean, Number], default: true },\n    type: { type: String, default: '' },\n    value: { type: [String, Array], default: null },\n    maxCount: { type: [Number], default: 10 },\n    maxSize: { type: [Number], default: 104857600 }, // 100M\n    application: { type: String, default: '' },\n    module: { type: String, default: '' },\n    bizId: { type: [String, Function, Object], default: '-1' },\n    fileKindId: { type: String, default: '' },\n    format: {\n      type: String,\n      default: 'png,jpg,jpeg,bmp,wps,pdf,txt,doc,docx,xls,xlsx,ppt,pptx,zip,rar,mp3,mp4',\n    },\n    multiple: { type: [String, Boolean], default: false },\n    callback: { type: Function, default: null },\n    tfields: { type: Object, default: { label: 'label', value: 'value' } as Object },\n    btnSize: {type: String, default: ''}\n  });\n\n  const uploadVisible = ref(false);\n  const filelist = ref([]);\n  const bizFileId = ref('');\n  const tDisabled = ref(false);\n  const lastTimeStamp = ref(0);\n  const tFormat = ref('');\n  const tMessage = ref('');\n  const tFileKindId = ref('');\n\n  // 注入全局的disable状态\n  const appDisabled = ref(false);\n\n  // 根据disable状态计算出组件的disable状态\n  const isDisabled = computed(() => {\n    return tDisabled.value || appDisabled.value;\n  });\n\n  // 定义emits\n  const emit = defineEmits(['update:value', 'change', 'cancel', 'confirm', 'loaded']);\n\n  const getFileList = async () => {\n    const now = new Date().getTime();\n    if (now - lastTimeStamp.value > 1000) {\n      filelist.value = await getFiles(bizFileId.value, props.fileKindId);\n      emit('update:value', filelist.value);\n      emit('change', filelist.value);\n      lastTimeStamp.value = new Date().getTime();\n    }\n  };\n\n  const getFileListFunc = useThrottleFn(getFileList, 150);\n\n  // 打开弹框函数\n  const handleOpenUpDialog = () => {\n    uploadVisible.value = true;\n  };\n\n  // 上传取消函数\n  const handleUploadCancel = () => {\n    uploadVisible.value = false;\n    emit('cancel', false);\n    if (props.callback != null) {\n      props.callback(filelist.value);\n    }\n  };\n\n  // 上传确认函数\n  const handleUploadConfirm = () => {\n    uploadVisible.value = false;\n    emit('confirm', false);\n    if (props.callback != null) {\n      props.callback(filelist.value);\n    }\n  };\n\n  // 获取bizId\n  const getBizId = () => {\n    try {\n      if (typeof props.bizId == 'string') {\n        return props.bizId || '-1';\n      } else if (typeof props.bizId == 'function') {\n        return props.bizId();\n      } else if (typeof props.bizId == 'object') {\n        return props.bizId[props.tfields.value];\n      }\n    } catch (error) {\n      return props.bizId;\n    }\n  };\n\n  // 处理上传完毕函数\n  const handleUploadOver = async () => {\n    const bizId = getBizId();\n    bizFileId.value = bizId;\n    getFileListFunc();\n    setTimeout(() => {\n      if (props.callback != null) {\n        props.callback(filelist.value);\n      }\n    }, 300);\n  };\n\n  // 获取附件列表\n  const getFiles = async (bizId, fileKindId = '') => {\n    const callback = new Promise((resolve) => {\n      const func = () => {\n        if (typeof bizId == 'undefined' || bizId == null || bizId == '' || bizId == '-1') {\n          resolve([]);\n        }\n        FileApi.getFiles({ bizId, fileKindId }).then((data) => {\n          resolve(data);\n        });\n      };\n      const exec = useThrottleFn(func, 1000);\n      exec();\n    });\n    const result = await callback;\n    return result as [];\n  };\n\n  watch(\n    () => props.bizId,\n    async () => {\n      const bizId = getBizId();\n      bizFileId.value = bizId;\n      if (!(bizId == '-1' || bizId == '')) {\n        getFileListFunc();\n      }\n    },\n  );\n\n  watch(\n    () => props.value,\n    () => {},\n  );\n\n  watch(\n    () => props.fileKindId,\n    (val) => {\n      tFileKindId.value = val;\n    },\n  );\n\n  watch(\n    () => props.disabled,\n    () => {\n      tDisabled.value = props.disabled;\n    },\n  );\n\n  watch(\n    () => props.format,\n    (val) => {\n      tFormat.value = val;\n      tMessage.value = `文件只能上传${val}类型文件！`;\n    },\n  );\n\n  // 启动加载\n  onMounted(async () => {\n    try {\n      const bizId = getBizId();\n      bizFileId.value = bizId;\n      if (!(bizId == '-1' || bizId == '')) {\n        getFileListFunc();\n      }\n      tDisabled.value = props.disabled;\n      tFormat.value = props.format;\n      tMessage.value = `文件只能上传${props.format}类型文件！`;\n      tFileKindId.value = props.fileKindId;\n      if (props.callback != null) {\n        props.callback(filelist.value);\n      }\n      // 监听是否启用全局禁用\n      // MsgManager.getInstance().listen('global-disabled', (message) => { appDisabled.value = message; });\n      setTimeout(() => {\n        emit('loaded', filelist.value);\n      }, 300);\n    } catch (error) {\n      console.error(error);\n    }\n  });\n</script>\n<style lang=\"less\" scoped>\n  .ant-upload-list-item {\n    position: relative;\n    height: 30px;\n    margin-top: 4px;\n    font-size: 14px;\n    cursor: pointer;\n\n    .ant-upload-list-item-name {\n      cursor: pointer;\n    }\n  }\n</style>\n"],"names":["modalVisible","ref","fileList","uploading","buttonID","antUpload","uid","buildUUID","uploadBtnFlag","computed","valid","file","error","cancel","emit","confirm","close","updateVisible","$event","getFiles","bizId","fileKindId","__async","filelist","FileApi.getFiles","handleRemove","resolve","reject","Modal","index","FileApi.deleteFile","selector","selectorElement","parentNode","node","beforeUpload","props","SysMessage","i","type","handleUpload","formData","_a","FileApi.uploadFile","handleFileSelect","handleClose","dialogMaskClose","watch","newValue","oldValue","onMounted","uploadVisible","bizFileId","tDisabled","lastTimeStamp","tFormat","tMessage","tFileKindId","appDisabled","isDisabled","getFileListFunc","useThrottleFn","handleOpenUpDialog","handleUploadCancel","handleUploadConfirm","getBizId","handleUploadOver","data","val"],"mappings":"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"}