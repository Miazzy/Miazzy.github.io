{"version":3,"file":"BottomInfoContent-f9159b51.js","sources":["../../src/components/Framework/Chart/Indicator.vue","../../src/views/da/cockpit/overview/BottomInfoContent.vue"],"sourcesContent":["<template>\n  <div class=\"indicator\">\n    <div class=\"title\">{{ title }}</div>\n    <div class=\"value\" @click=\"handleClickValue\">{{ value }}</div>\n    <div class=\"info\">\n      <span class=\"subtitle\">{{ subtitle }}</span>\n      <span class=\"p-value\" :class=\"handleTextClass(percent)\">{{ percent }}</span>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import { computed } from 'vue';\n\n  const props = defineProps({\n    title: { type: String, default: '' },\n    value: { type: Number, default: 0 },\n    subtitle: { type: String, default: '' },\n    percent: { type: [Number, String], default: '' },\n    color: { type: String, default: '' },\n  });\n\n  // 根据数据内容判断副数据class\n  const getNumberClassName = (val) => {\n    if (val > 0) {\n      return 'arrow-positive';\n    } else if (val == 0) {\n      return 'zero';\n    } else if (val < 0) {\n      return 'arrow-negative';\n    }\n  };\n  const handleTextClass = (text) => {\n    if (!props.color) {\n      if (typeof text == 'string') {\n        let numberArr = text.match(/^-?\\d+(\\.\\d+)?/);\n        if (numberArr?.[0]) {\n          return getNumberClassName(numberArr[0]);\n        } else {\n          return 'no-data';\n        }\n      } else if (typeof text == 'number') {\n        return getNumberClassName(text);\n      }\n    } else {\n      return {\n        'text-red': props.color == 'red',\n        'text-green': props.color == 'green',\n      };\n    }\n  };\n  const emits = defineEmits(['clickValue']);\n  const handleClickValue = () => {\n    emits('clickValue');\n  };\n</script>\n\n<style lang=\"less\" scoped>\n  .indicator {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 0.02rem 0.04rem;\n    background-color: transparent;\n    color: white;\n    text-align: center;\n  }\n\n  .title {\n    color: #fff;\n    font-size: 0.14rem;\n  }\n\n  .value {\n    margin: 0.02rem 0;\n    color: #1890ff;\n    font-size: 0.22rem;\n    font-weight: 500;\n    cursor: pointer;\n  }\n\n  .info {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 100%;\n  }\n\n  .subtitle {\n    margin-right: 0.1rem;\n    color: rgb(255 255 255 / 60%);\n    font-size: 0.12rem;\n    line-height: 1;\n  }\n\n  .p-value {\n    font-size: 0.14rem;\n    margin-right: 0.04rem;\n    &::before {\n      margin-right: 0.04rem;\n      transform: scale(0.7);\n      display: inline-block;\n    }\n  }\n  .arrow-positive,\n  .text-red {\n    color: #e05b5b;\n  }\n\n  .arrow-negative,\n  .text-gree {\n    color: #00ba24;\n  }\n\n  .arrow-positive::before {\n    content: '▲';\n    color: #e05b5b;\n  }\n\n  .arrow-negative::before {\n    content: '▼';\n    color: #00ba24;\n  }\n\n  .zero {\n    color: #e05b5b;\n  }\n\n  .no-data {\n    color: rgba(255, 255, 255, 0.8);\n  }\n</style>\n","<template>\n  <div class=\"bottom-info-content\">\n    <div class=\"element indicator-element\">\n      <Indicator\n        :title=\"`电站规模(座)`\"\n        :value=\"formState.stationCount\"\n        :subtitle=\"`同比新增(座)`\"\n        :percent=\"formState.yoy\"\n        @clickValue=\"toBiReport('stationCount')\"\n      />\n    </div>\n    <div class=\"element indicator-element\">\n      <Indicator\n        :title=\"`光伏装机(MW)`\"\n        :value=\"formState.curCapacity\"\n        :subtitle=\"`同比新增(MW)`\"\n        :percent=\"formState.yoyCapacity\"\n        @clickValue=\"toBiReport('stationCount')\"\n      />\n    </div>\n    <div class=\"element\">\n      <div class=\"security-box\">\n        <div class=\"value-text\">{{ formState.runningDays }}</div>\n        <div class=\"title-text\">安全运行(天)</div>\n      </div>\n    </div>\n    <div class=\"element indicator-element\">\n      <Indicator\n        :title=\"`待处理隐患(项)`\"\n        :value=\"formState.hiddenCount\"\n        :subtitle=\"`处理率`\"\n        :percent=\"`${formState.dealRate}%`\"\n        color=\"green\"\n        @clickValue=\"toBiReport('hiddenCount')\"\n      />\n    </div>\n    <div class=\"element indicator-element\">\n      <Indicator\n        :title=\"`故障告警(台)`\"\n        :value=\"formState.alarmCount\"\n        :subtitle=\"`相应时长(h)`\"\n        :percent=\"formState.avgDuration\"\n        color=\"green\"\n        @clickValue=\"toBiReport('faultWarning')\"\n      />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import { ref, reactive, UnwrapRef, onMounted, watch } from 'vue';\n  import { assign } from 'min-dash';\n  import Indicator from '/@/components/Framework/Chart/Indicator.vue';\n  import * as OverviewApi from '@/api/da/cockpit/overview';\n  import { addTabPage } from '@/utils/route';\n\n  //搜索参数\n  const leftSearchInfo: UnwrapRef<any> = reactive({});\n\n  const props = defineProps({\n    searchInfoByTime: { type: Object, default: {} },\n  });\n  watch(\n    () => props.searchInfoByTime,\n    (value) => {\n      assign(leftSearchInfo, value);\n      queryOtherInfo();\n    },\n  );\n  const formState = reactive({\n    curCapacity: 0,\n    yoyCapacity: 0,\n    hiddenCount: 0,\n    dealRate: 0,\n    runningDays: 0,\n    stationCount: 0,\n    yoy: 0,\n  });\n\n  const toBiReport = async (type: string) => {\n    if (type === 'stationCount') {\n      //电站规模 并网统计\n      addTabPage('/bi/grid/capacity/statistics');\n    } else if (type === 'hiddenCount') {\n      //待处理隐患\n      addTabPage('/bi/hidden/index');\n    } else if (type === 'faultWarning') {\n      //故障告警\n      addTabPage('/monitor/faultWarning');\n    }\n  };\n\n  const queryOtherInfo = async () => {\n    const otherInfo = await OverviewApi.otherInfo({\n      startMonth: leftSearchInfo.startMonth,\n      endMonth: leftSearchInfo.endMonth,\n    });\n    if (otherInfo) {\n      formState.curCapacity = otherInfo.curCapacity || 0;\n      formState.yoyCapacity = otherInfo.yoyCapacity || 0;\n      formState.hiddenCount = otherInfo.hiddenCount || 0;\n      formState.dealRate = otherInfo.dealRate || 0;\n      formState.runningDays = otherInfo.runningDays || 0;\n      formState.stationCount = otherInfo.stationCount || 0;\n      formState.yoy = otherInfo.yoy || 0;\n    }\n  };\n\n  onMounted(async () => {});\n</script>\n\n<style lang=\"less\" scoped>\n  .bottom-info-content {\n    display: flex;\n    position: absolute;\n    z-index: 99;\n    bottom: 0.16rem;\n    left: 25vw;\n    flex-wrap: wrap; /* 使数字自动换行 */\n    align-items: center;\n    justify-content: center;\n    width: 50vw;\n    height: 1.76rem;\n    background: url('../../../../assets/images/da/index_bottom_bg.png') no-repeat bottom/contain;\n\n    div.element {\n      flex: 18.5%;\n\n      &.indicator-element {\n        padding-top: 0.64rem;\n      }\n    }\n\n    .security-box {\n      width: 1.68rem;\n      height: 1.76rem;\n      margin: 0 auto;\n      background: url('../../../../assets/images/da/security.png') no-repeat center/contain;\n      line-height: 1;\n      text-align: center;\n\n      .value-text {\n        padding: 0.32rem 0 0.18rem;\n        color: #1890ff;\n        font-size: 0.28rem;\n        font-weight: 600;\n      }\n\n      .title-text {\n        color: #fff;\n        font-size: 0.14rem;\n      }\n    }\n  }\n</style>\n"],"names":["getNumberClassName","val","handleTextClass","text","props","numberArr","handleClickValue","emits","leftSearchInfo","reactive","watch","value","assign","queryOtherInfo","formState","toBiReport","type","__async","addTabPage","otherInfo","OverviewApi.otherInfo","onMounted"],"mappings":"uyBAuBQA,EAAsBC,GAAQ,CAClC,GAAIA,EAAM,EACD,MAAA,iBACT,GAAWA,GAAO,EACT,MAAA,OACT,GAAWA,EAAM,EACR,MAAA,gBACT,EAEIC,EAAmBC,GAAS,CAC5B,GAACC,EAAM,MAYF,MAAA,CACL,WAAYA,EAAM,OAAS,MAC3B,aAAcA,EAAM,OAAS,OAAA,EAb3B,GAAA,OAAOD,GAAQ,SAAU,CACvB,IAAAE,EAAYF,EAAK,MAAM,gBAAgB,EACvC,OAAAE,GAAA,MAAAA,EAAY,GACPL,EAAmBK,EAAU,CAAC,CAAC,EAE/B,SACT,SACS,OAAOF,GAAQ,SACxB,OAAOH,EAAmBG,CAAI,CAOlC,EAGIG,EAAmB,IAAM,CAC7BC,EAAM,YAAY,CAAA,+rBCIdC,EAAiCC,EAAS,CAAA,CAAE,EAKlDC,EACE,IAAMN,EAAM,iBACXO,GAAU,CACTC,EAAOJ,EAAgBG,CAAK,EACbE,GACjB,CAAA,EAEF,MAAMC,EAAYL,EAAS,CACzB,YAAa,EACb,YAAa,EACb,YAAa,EACb,SAAU,EACV,YAAa,EACb,aAAc,EACd,IAAK,CAAA,CACN,EAEKM,EAAoBC,GAAiBC,EAAA,sBACrCD,IAAS,eAEXE,EAAW,8BAA8B,EAChCF,IAAS,cAElBE,EAAW,kBAAkB,EACpBF,IAAS,gBAElBE,EAAW,uBAAuB,CACpC,GAGIL,EAAiB,IAAYI,EAAA,sBAC3B,MAAAE,EAAY,MAAMC,EAAsB,CAC5C,WAAYZ,EAAe,WAC3B,SAAUA,EAAe,QAAA,CAC1B,EACGW,IACQL,EAAA,YAAcK,EAAU,aAAe,EACvCL,EAAA,YAAcK,EAAU,aAAe,EACvCL,EAAA,YAAcK,EAAU,aAAe,EACvCL,EAAA,SAAWK,EAAU,UAAY,EACjCL,EAAA,YAAcK,EAAU,aAAe,EACvCL,EAAA,aAAeK,EAAU,cAAgB,EACzCL,EAAA,IAAMK,EAAU,KAAO,EACnC,GAGF,OAAAE,EAAU,IAAYJ,EAAA,sBAAA,EAAE"}