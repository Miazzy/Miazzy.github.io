{"version":3,"file":"stationPowerData-82958019.js","sources":["../../src/views/monitor/stationOverview/stationPowerData.vue"],"sourcesContent":["<template>\n  <div class=\"right-box\">\n    <div id=\"chart-box-content\" class=\"right-row-box chart-box-content\" ref=\"chartBoxContent\">\n      <div class=\"box-header\">\n        <div class=\"header-left\"></div>\n        <div class=\"header-right\">\n          <a-date-picker\n            v-model:value=\"showDate\"\n            value-format=\"YYYY-MM-DD\"\n            @change=\"changeDate()\"\n          />\n        </div>\n      </div>\n      <div class=\"box-content\">\n        <div class=\"chart-box\">\n          <div :id=\"props.index\" style=\"width: 100%; height: 320px\"></div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script lang=\"ts\" setup>\n  import { onMounted, ref, watch, shallowRef, defineExpose } from 'vue';\n  import { stationChart } from '../monitorApi.ts';\n  import * as echarts from 'echarts';\n  import dayjs, { Dayjs } from 'dayjs';\n  import { formatDate } from '/@/utils/dateUtil';\n  // 传入参数\n  const props = defineProps({\n    stationId: { type: String, default: '' },\n    index: { type: String, default: 'activePower' },\n  });\n  const showDate = ref<Dayjs>();\n  const lineOptions = {\n    color: [\n      '#1729F6',\n      '#FCAB28',\n      '#09D963',\n      '#FF1EE9',\n      '#B32630',\n      '#009588',\n      '#C9930F',\n      '#FF5906',\n      '#f3a33f',\n      '#fe8466',\n      '#8A69FF',\n      '#FF7669',\n    ],\n    tooltip: {\n      show: true,\n      trigger: 'axis',\n      formatter: '台',\n      axisPointer: {\n        type: 'line',\n        lineStyle: {\n          type: 'dashed',\n          color: 'rgba(1,180,241,.5)',\n        },\n        crossStyle: {\n          type: 'dashed',\n          color: 'rgba(1,180,241,.5)',\n        },\n      },\n      backgroundColor: ' #f5fbfb',\n      borderColor: '#c6ecea',\n      borderWidth: 1,\n    },\n    dataZoom: [{ type: 'inside' }],\n    legend: {\n      top: 20,\n      right: 200,\n      padding: [10, 0],\n      itemGap: 14,\n      itemWidth: 14,\n      itemHeight: 10,\n      textStyle: {\n        color: '#bce2e3',\n      },\n    },\n    grid: {\n      top: 40,\n      bottom: 30,\n      left: 30,\n      right: 0,\n    },\n    xAxis: {\n      type: 'category',\n      boundaryGap: true,\n      axisTick: {\n        alignWithLabel: true,\n        show: false,\n      },\n      axisLine: {\n        lineStyle: {\n          color: 'rgba(255, 255, 255, 0.16)',\n        },\n      },\n      axisLabel: {\n        color: '#888',\n      },\n    },\n    yAxis: {\n      type: 'value',\n      nameTextStyle: {\n        color: '#888',\n      },\n      axisLine: {\n        show: true,\n        lineStyle: {\n          color: 'rgba(255, 255, 255, 0.16)',\n        },\n      },\n      axisLabel: {\n        color: '#888',\n        formatter: '{value}',\n      },\n      axisTick: {\n        show: false,\n      },\n      splitLine: {\n        lineStyle: {\n          color: 'rgba(255, 255, 255, 0.16)',\n          type: 'dashed',\n        },\n      },\n    },\n  };\n  const barOption = {\n    dataZoom: [{ type: 'inside' }],\n    tooltip: {\n      trigger: 'axis',\n      axisPointer: {\n        type: 'line',\n        lineStyle: {\n          type: 'dashed',\n          color: 'rgba(1,180,241,.5)',\n        },\n        crossStyle: {\n          type: 'dashed',\n          color: 'rgba(1,180,241,.5)',\n        },\n      },\n      textStyle: {\n        color: '#666',\n      },\n      backgroundColor: '#f5fbfb',\n      borderColor: '#c6ecea',\n      borderWidth: 1,\n      formatter: (params) => {\n        return (\n          '<p style=\"text-align: left; line-height: 20px;font-size:12px;\">' +\n          params[0].axisValue +\n          '</p> ' +\n          '<p style=\"font-size:12px;\">日发电量  <span style=\"color: #3dd4cc;font-size:13px;\">' +\n          params[0].data +\n          '</span> kWh</p>'\n        );\n      },\n    },\n    grid: {\n      top: 40,\n      bottom: 30,\n      left: 30,\n      right: 0,\n    },\n    xAxis: [\n      {\n        type: 'category',\n        boundaryGap: true,\n        axisTick: {\n          alignWithLabel: true,\n          show: false,\n        },\n        axisLine: {\n          lineStyle: {\n            color: 'rgba(255, 255, 255, 0.16)',\n          },\n        },\n        axisLabel: {\n          color: '#888',\n        },\n      },\n    ],\n    yAxis: [\n      {\n        type: 'value',\n        name: 'kWh',\n        nameTextStyle: {\n          color: '#888',\n        },\n        axisLine: {\n          show: true,\n          lineStyle: {\n            color: 'rgba(255, 255, 255, 0.16)',\n          },\n        },\n        axisLabel: {\n          color: '#888',\n          formatter: '{value}',\n        },\n        axisTick: {\n          show: false,\n        },\n        splitLine: {\n          lineStyle: {\n            color: 'rgba(255, 255, 255, 0.16)',\n            type: 'dashed',\n          },\n        },\n      },\n    ],\n    series: [\n      {\n        name: '日发电量',\n        type: 'bar',\n        color: {\n          type: 'linear',\n          x: 0,\n          y: 0,\n          x2: 0,\n          y2: 1,\n          colorStops: [\n            {\n              offset: 0,\n              color: 'rgba(73,207,246,.8)', // 0% 处的颜色\n            },\n            {\n              offset: 1,\n              color: '#49b5f6', // 100% 处的颜色\n            },\n          ],\n        },\n        barWidth: 14,\n        barGap: '20%',\n        showSymbol: null,\n        smooth: '.6',\n        lineStyle: {\n          color: '#01d2f1',\n        },\n        areaStyle: {\n          color: {\n            type: 'linear',\n            x: 0,\n            y: 0,\n            x2: 0,\n            y2: 1,\n            colorStops: [\n              {\n                offset: 0,\n                color: 'rgba(255, 227, 151, .3)', // 0% 处的颜色\n              },\n              {\n                offset: 1,\n                color: 'rgba(255, 227, 151, .1)', // 100% 处的颜色\n              },\n            ],\n            globalCoord: true, // 缺省为 false\n          },\n        },\n        itemStyle: {\n          normal: {\n            barBorderRadius: [2, 2, 0, 0],\n            shadowColor: 'rgba(0,0,0,0.1)',\n            shadowBlur: 3,\n            shadowOffsetY: 3,\n          },\n        },\n        // data: ['12','14', '16', '18', '20', '22', '24', '30']\n      },\n    ],\n  };\n  const changeDate = async () => {\n    getStationActualChart();\n  };\n\n  const getStationActualChart = async () => {\n    let param = {\n      stationId: props.stationId,\n      sortField: props.index,\n      showDate: formatDate(showDate.value),\n    };\n\n    let res = await stationChart(param);\n    if (res != null && props.index == 'outputPowerDay') {\n      setBarOption(res);\n    } else if (res != null) {\n      setLineOption(res);\n    }\n  };\n\n  const stationEchart = shallowRef({});\n  function setLineOption(res) {\n    let option = JSON.parse(JSON.stringify(lineOptions)),\n      series = [],\n      legend = [],\n      data = res;\n    stationEchart.value = {};\n    if (!res.data) return;\n    option.xAxis.data = data.x;\n    option.yAxis.name = data.unit;\n    data.data.forEach((item) => {\n      let seriesTemp;\n      legend.push(item.name);\n      if (data.chartType === 'bar') {\n        seriesTemp = {\n          name: item.name,\n          type: data.chartType,\n          barWidth: 14,\n          data: item.y,\n        };\n      } else {\n        seriesTemp = {\n          name: item.name,\n          type: data.chartType,\n          smooth: 0.5,\n          showSymbol: false,\n          symbolSize: 8,\n          lineStyle: {\n            width: 2,\n            shadowColor: 'rgba(0, 0, 0, .6)',\n          },\n          connectNulls: true,\n          data: item.y,\n        };\n      }\n      series.push(seriesTemp);\n    });\n    option.legend.data = legend;\n    option.legend.show = false;\n    option.series = series;\n    option.tooltip.formatter = (value) => {\n      let html = [`<label class=\"chart-tooltip-label\">${value[0].axisValue}</label><br/>`];\n      for (let i = 0; i < value.length; i++) {\n        let unit = data.unit;\n        let showValue = null;\n        value[i].data != null || value[i].data != undefined\n          ? (showValue = Number(value[i].data))\n          : (showValue = '--');\n        html.push(\n          `<span class=\"chart-tooltip-item\">${value[i].seriesName} <span style=\"color:${value[i].color};font-weight:bold;\">${showValue}</span> ${unit}</span><br/>`,\n        );\n      }\n      return html.join('');\n    };\n\n    initChart(document.getElementById(props.index), option);\n  }\n\n  function setBarOption(data, type) {\n    let option = JSON.parse(JSON.stringify(barOption)),\n      series = [],\n      name = '日发电量';\n    option.xAxis[0].data = data.x; // x轴\n    option.yAxis[0].name = data.unit; // y轴单位\n    option.tooltip.formatter = (params) => {\n      return (\n        '<p style=\"text-align: left;color:#666;opacity: .8; line-height: 20px;font-size:12px;\">' +\n        params[0].axisValue +\n        '</p> ' +\n        '<p style=\"font-size:12px;color:#666;\">' +\n        name +\n        '  <span style=\"color: #3ccacc;font-size:13px;font-weight:bold;\">' +\n        params[0].data +\n        '</span> ' +\n        data.unit +\n        '</p>'\n      );\n    };\n    series.push({\n      name,\n      type: 'bar',\n      color: {\n        type: 'linear',\n        x: 0,\n        y: 0,\n        x2: 0,\n        y2: 1,\n        colorStops: [\n          {\n            offset: 0,\n            color: '#51A7FF', // 0% 处的颜色,上面\n          },\n          {\n            offset: 1,\n            color: '#7CC2F2', // 100% 处的颜色，下面\n          },\n        ],\n      },\n      barWidth: 24,\n      barGap: '40%',\n      showSymbol: null,\n      smooth: false,\n      lineStyle: {\n        color: 'rgba(252,171,40,1)',\n      },\n      itemStyle: {\n        normal: {\n          barBorderRadius: [2, 2, 0, 0],\n          shadowColor: 'rgba(0,0,0,0.1)',\n          shadowBlur: 3,\n          shadowOffsetY: 3,\n        },\n      },\n      data: data.y,\n    });\n    option.series = series;\n    initChart(document.getElementById(props.index), option);\n  }\n\n  function initChart(dom, data, callback) {\n    const main = document.getElementById(props.index);\n    stationEchart.value = echarts.init(main);\n    stationEchart.value.setOption(data, true);\n    //窗口改变时重绘echarts,使用函数节流提高性能\n    callback && callback(myEchart);\n    window.addEventListener('resize', () => {\n      stationEchart.value.resize();\n    });\n  }\n  // watch(\n  //   () => props.index,\n  //   (newValue) => {\n  //     getStationActualChart();\n  //   },\n  // );\n\n  // 启动执行代码\n  onMounted(() => {\n    let current = new Date(); //获取新的时间\n    //获取当前年份,并且转为字符串\n    showDate.value = dayjs(formatDate(current), 'YYYY-MM-DD');\n    getStationActualChart();\n  });\n  defineExpose({ getStationActualChart });\n</script>\n<style scoped>\n  .right-box {\n    width: 100%;\n    height: 362px;\n    border: solid 1px rgb(255 255 255 / 16%);\n\n    .right-row-box {\n      width: 100%;\n      height: calc(50% - 5px);\n      margin-bottom: 10px;\n      border-radius: 2px;\n\n      &:last-child {\n        margin-bottom: 0;\n      }\n\n      .box-header {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        height: 48px;\n        padding: 0 16px;\n        font-size: 14px;\n        line-height: 47px;\n      }\n    }\n  }\n</style>\n"],"names":["showDate","ref","lineOptions","barOption","params","changeDate","__async","getStationActualChart","param","props","formatDate","res","stationChart","setBarOption","setLineOption","stationEchart","shallowRef","option","series","legend","data","item","seriesTemp","value","html","i","unit","showValue","initChart","type","name","dom","callback","main","echarts.init","onMounted","current","dayjs","__expose"],"mappings":"87BAgCQA,EAAWC,IACXC,EAAc,CAClB,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,SACF,EACA,QAAS,CACP,KAAM,GACN,QAAS,OACT,UAAW,IACX,YAAa,CACX,KAAM,OACN,UAAW,CACT,KAAM,SACN,MAAO,oBACT,EACA,WAAY,CACV,KAAM,SACN,MAAO,oBACT,CACF,EACA,gBAAiB,WACjB,YAAa,UACb,YAAa,CACf,EACA,SAAU,CAAC,CAAE,KAAM,SAAU,EAC7B,OAAQ,CACN,IAAK,GACL,MAAO,IACP,QAAS,CAAC,GAAI,CAAC,EACf,QAAS,GACT,UAAW,GACX,WAAY,GACZ,UAAW,CACT,MAAO,SACT,CACF,EACA,KAAM,CACJ,IAAK,GACL,OAAQ,GACR,KAAM,GACN,MAAO,CACT,EACA,MAAO,CACL,KAAM,WACN,YAAa,GACb,SAAU,CACR,eAAgB,GAChB,KAAM,EACR,EACA,SAAU,CACR,UAAW,CACT,MAAO,2BACT,CACF,EACA,UAAW,CACT,MAAO,MACT,CACF,EACA,MAAO,CACL,KAAM,QACN,cAAe,CACb,MAAO,MACT,EACA,SAAU,CACR,KAAM,GACN,UAAW,CACT,MAAO,2BACT,CACF,EACA,UAAW,CACT,MAAO,OACP,UAAW,SACb,EACA,SAAU,CACR,KAAM,EACR,EACA,UAAW,CACT,UAAW,CACT,MAAO,4BACP,KAAM,QACR,CACF,CACF,CAAA,EAEIC,EAAY,CAChB,SAAU,CAAC,CAAE,KAAM,SAAU,EAC7B,QAAS,CACP,QAAS,OACT,YAAa,CACX,KAAM,OACN,UAAW,CACT,KAAM,SACN,MAAO,oBACT,EACA,WAAY,CACV,KAAM,SACN,MAAO,oBACT,CACF,EACA,UAAW,CACT,MAAO,MACT,EACA,gBAAiB,UACjB,YAAa,UACb,YAAa,EACb,UAAYC,GAER,kEACAA,EAAO,CAAC,EAAE,UACV,sFAEAA,EAAO,CAAC,EAAE,KACV,iBAGN,EACA,KAAM,CACJ,IAAK,GACL,OAAQ,GACR,KAAM,GACN,MAAO,CACT,EACA,MAAO,CACL,CAC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"}