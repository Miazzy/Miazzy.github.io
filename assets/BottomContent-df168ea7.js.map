{"version":3,"file":"BottomContent-df168ea7.js","sources":["../../src/views/da/cockpit/security/BottomContent.vue"],"sourcesContent":["<template>\n  <div class=\"bottom-content\" :key=\"instanceKey\">\n    <div class=\"left-section section-box\">\n      <div class=\"section-bg\">\n        <SubtitleBar :subtitle=\"`安全工器具`\">\n          <a-select\n            v-model:value=\"formState.dimension\"\n            :options=\"dimensionTypeData\"\n            @change=\"handleDimensionTypeChange\"\n            style=\"width: 1.2rem\"\n            v-show=\"dimensionTypeData.length > 1\"\n          />\n        </SubtitleBar>\n        <IndicatorGroup\n          :data=\"toolData\"\n          :style=\"tabStatus === 'on' ? 'margin-top: -0.15rem' : 'margin-top: -0.2rem'\"\n          class=\"indicator-group-layout\"\n          :class=\"tabStatus === 'on' ? '' : 'fix-indicator-group-padding'\"\n          @clickItem=\"clickSafetools\"\n        />\n        <div style=\"width: 100%; height: 2rem\">\n          <div style=\"margin-left: 0.16rem; transform: scale(0.85); transform-origin: 0 0\">\n            <EchartLineBarChart\n              :data=\"toolChartData\"\n              :colors=\"toolChartData.colors\"\n              :width=\"`35.96vw`\"\n              :height=\"tabStatus === 'on' ? `35.5vh` : `40vh`\"\n              :category=\"toolChartData.categories\"\n              ybgcolor=\"#01B7D730\"\n              :name=\"bchartSeriesName\"\n              @clickItem=\"clickToolsEchart\"\n              :dataZoomDefaultValueRange=\"toolChartData.dataZoomDefaultValueRange\"\n              :dataZoomDisabled=\"false\"\n              :dataZoomMaxValueSpan=\"toolChartData.categories.length\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"middle-section section-box\">\n      <div class=\"section-bg\">\n        <SubtitleBar :subtitle=\"`安全责任书`\">\n          <a-select\n            v-model:value=\"formState.safeResp\"\n            :options=\"dimensionTypeData\"\n            @change=\"handleSafeRespChange\"\n            style=\"width: 1.2rem\"\n            v-show=\"dimensionTypeData.length > 1\"\n          />\n        </SubtitleBar>\n        <IndicatorGroup\n          :data=\"respData\"\n          :style=\"tabStatus === 'on' ? 'margin-top: -0.15rem' : 'margin-top: -0.2rem'\"\n          class=\"indicator-group-layout\"\n          :class=\"tabStatus === 'on' ? '' : 'fix-indicator-group-padding'\"\n          @clickItem=\"clickAgreementAll\"\n        />\n        <div style=\"width: 100%; height: 2rem\">\n          <div style=\"margin-left: 0.16rem; transform: scale(0.85); transform-origin: 0 0\">\n            <EchartLineBarChart\n              :data=\"sbarchartData\"\n              :colors=\"sbarchartData.colors\"\n              :width=\"`35.96vw`\"\n              :height=\"tabStatus === 'on' ? `35.5vh` : `40vh`\"\n              :category=\"sbarchartData.categories\"\n              ybgcolor=\"#01B7D730\"\n              :name=\"sbarChartSeriesName\"\n              @clickItem=\"clickAgreement\"\n              :dataZoomDefaultValueRange=\"sbarchartData.dataZoomDefaultValueRange\"\n              :dataZoomDisabled=\"false\"\n              :dataZoomMaxValueSpan=\"sbarchartData.categories.length\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"right-section section-box\">\n      <div class=\"section-bg\">\n        <SubtitleBar :subtitle=\"`安全标准化`\">\n          <a-select\n            v-model:value=\"formState.emergency\"\n            :options=\"dimensionTypeData\"\n            @change=\"handleEmergencyChange\"\n            style=\"width: 1.2rem\"\n            v-show=\"dimensionTypeData.length > 1\"\n          />\n        </SubtitleBar>\n        <IndicatorGroup\n          :data=\"emergencyData\"\n          :style=\"tabStatus === 'on' ? 'margin-top: -0.15rem' : 'margin-top: -0.2rem'\"\n          class=\"indicator-group-layout2\"\n          :class=\"tabStatus === 'on' ? '' : 'fix-indicator-group-padding'\"\n        />\n        <div style=\"width: 100%; height: 2rem\">\n          <div style=\"margin-left: 0.16rem; transform: scale(0.85); transform-origin: 0 0\">\n            <EchartLineBarChart\n              :data=\"emergencyChartData\"\n              :colors=\"emergencyChartData.colors\"\n              :width=\"`35.96vw`\"\n              :height=\"tabStatus === 'on' ? `35.5vh` : `40vh`\"\n              :category=\"emergencyChartData.categories\"\n              ybgcolor=\"#01B7D730\"\n              :name=\"emergencyChartSeriesName\"\n              :dataZoomDefaultValueRange=\"emergencyChartData.dataZoomDefaultValueRange\"\n              :dataZoomDisabled=\"false\"\n              :dataZoomMaxValueSpan=\"emergencyChartData.categories.length\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import { ref, onMounted, defineProps, watch, reactive, UnwrapRef } from 'vue';\n  import SubtitleBar from '/@/components/Framework/Chart/SubtitleBar.vue';\n  import IndicatorGroup from '/@/components/Framework/Chart/IndicatorGroup.vue';\n  import EchartLineBarChart from '/@/components/Framework/Chart/EchartLineBarChart.vue';\n  import { handleRouteChange } from '../../utils';\n  import * as SecurityApi from '@/api/da/cockpit/security';\n  import { assign } from 'lodash-es';\n  import * as CommonApi from '@/api/da/common';\n  import { buildUUID } from '@/utils/uuid';\n\n  //搜索参数\n  const searchInfo: UnwrapRef<any> = reactive({});\n  const props = defineProps({\n    searchInfoByTime: { type: Object, default: {} },\n    tabStatus: { type: String, default: '' },\n  });\n  const instanceKey = ref(buildUUID());\n  const formState = reactive({\n    dimension: 'station',\n    safeResp: 'station',\n    emergency: 'station',\n  });\n\n  watch(\n    () => props.searchInfoByTime,\n    (value) => {\n      assign(searchInfo, value);\n      doEmergencyStat(formState.emergency);\n    },\n  );\n\n  const dimensionTypeData: any = ref([\n    // { label: '电站维度', value: 'station' },\n    // { label: '公司维度', value: 'company' },\n    // { label: '运维维度', value: 'operation' },\n  ]);\n\n  onMounted(async () => {\n    const sts = await CommonApi.getDictDataMap({ dictType: 'cockpit_three_dimension' });\n    sts.result.forEach((e) => {\n      dimensionTypeData.value.push({ value: e.value, label: e.label });\n    });\n\n    doSafeToolsStat(formState.dimension);\n    doSafeRespStat(formState.safeResp);\n  });\n  // ==================================安全工器具 begin ======================================\n  const toolData = ref([\n    {\n      value: 100,\n      label: '待检数(个)',\n    },\n    {\n      value: 15,\n      label: '超期未检数(个)',\n    },\n    {\n      value: 82.25,\n      label: '合格率(%)',\n    },\n  ]);\n  const bchartSeriesName = [['待检数', '超期未检数'], ['合格率']];\n  const toolChartData = ref({\n    barData: [[], []],\n    categories: [],\n    lineData: [[]],\n    colors: [\n      ['#488FF6', '#60D1F3'],\n      ['#078C5D', '#68E4B8'],\n      ['#E59837', '#FAE895'],\n      ['#e59837', '#fae895'],\n      ['#078C5D', '#68E4B8'],\n    ],\n    dataZoomDefaultValueRange: [0, 5],\n  });\n  const doSafeToolsStat = async (value) => {\n    const safeToolsStat = await SecurityApi.safeToolsStat({ dimension: value });\n    if (safeToolsStat) {\n      toolData.value[0].value = safeToolsStat.unInspectedNum;\n      toolData.value[1].value = safeToolsStat.withinNum;\n      toolData.value[2].value = safeToolsStat.qualifiedRate;\n\n      toolChartData.value.barData = safeToolsStat.barData || [];\n      toolChartData.value.categories = safeToolsStat.categories || [];\n      if (safeToolsStat.lineData?.length) {\n        toolChartData.value.lineData[0] = safeToolsStat.lineData;\n      } else {\n        toolChartData.value.lineData = [];\n      }\n    }\n  };\n  const handleDimensionTypeChange = (value) => {\n    doSafeToolsStat(value);\n  };\n\n  // ==================================安全责任书 begin ======================================\n  const respData = ref([\n    {\n      value: 35,\n      label: '应签订(人)',\n    },\n    {\n      value: 59.23,\n      label: '未签订(人)',\n    },\n    {\n      value: 59.23,\n      label: '签订率(%)',\n    },\n  ]);\n  const sbarchartData = ref({\n    barData: [[], []],\n    categories: [],\n    lineData: [[]],\n    colors: [\n      ['#488FF6', '#60D1F3'],\n      ['#078C5D', '#68E4B8'],\n      ['#E59837', '#FAE895'],\n      ['#e59837', '#fae895'],\n      ['#078C5D', '#68E4B8'],\n    ],\n    dataZoomDefaultValueRange: [0, 5],\n  });\n  const sbarChartSeriesName = [['应签订', '未签订'], ['签订率']];\n  const doSafeRespStat = async (value) => {\n    const safeRespStat = await SecurityApi.safeRespStat({ dimension: value });\n    if (safeRespStat) {\n      respData.value[0].value = safeRespStat.supposedSignNum;\n      respData.value[1].value = safeRespStat.unSignNum;\n      respData.value[2].value = safeRespStat.signRate;\n\n      sbarchartData.value.barData = safeRespStat.barData || [];\n      sbarchartData.value.categories = safeRespStat.categories || [];\n      if (safeRespStat.lineData?.length) {\n        sbarchartData.value.lineData[0] = safeRespStat.lineData;\n      } else {\n        sbarchartData.value.lineData = [];\n      }\n    }\n  };\n  const handleSafeRespChange = (value) => {\n    doSafeRespStat(value);\n  };\n  // ==================================安全责任书 end ======================================\n\n  // ==================================安全标准化 begin ====================================\n  const emergencyData = ref([\n    {\n      value: 20,\n      label: '应急预案演练(次)',\n    },\n  ]);\n  const emergencyChartData = ref({\n    barData: [[]],\n    categories: [],\n    colors: [\n      ['#488FF6', '#60D1F3'],\n      ['#078C5D', '#68E4B8'],\n      ['#E59837', '#FAE895'],\n      ['#e59837', '#fae895'],\n      ['#078C5D', '#68E4B8'],\n    ],\n    dataZoomDefaultValueRange: [0, 5],\n  });\n  const emergencyChartSeriesName = [['应急预案演练']];\n  const doEmergencyStat = async (value) => {\n    const emergencyStat = await SecurityApi.emergencyStat({\n      dimension: value,\n      startMonth: searchInfo.startMonth,\n      endMonth: searchInfo.endMonth,\n    });\n    if (emergencyStat) {\n      let tempData = [];\n      if (emergencyStat.statData.length > 0) {\n        emergencyStat.statData.forEach((element) => {\n          tempData.push({ value: element.drillCount, label: element.drillTypeLabel + '(次)' });\n        });\n      }\n      emergencyData.value = tempData;\n      emergencyChartData.value.categories = emergencyStat.categories || [];\n      if (emergencyStat.barData?.length) {\n        emergencyChartData.value.barData[0] = emergencyStat.barData;\n      } else {\n        emergencyChartData.value.barData = [];\n        emergencyChartData.value.lineData = [];\n      }\n    }\n  };\n  const handleEmergencyChange = (value) => {\n    doEmergencyStat(value);\n  };\n  // ==================================安全标准化 end ======================================\n\n  // ==================================数据穿透 ======================================\n  //安全工器具\n  const clickSafetools = () => {\n    handleRouteChange('/bi/safetytools/index', {});\n  };\n  //安全工器具图表\n  const clickToolsEchart = (params) => {\n    handleRouteChange('/bi/safetytools/index', {\n      stationOrganId: formState.dimension === 'company' ? params.data.id : '',\n      stationId: formState.dimension === 'station' ? params.data.id : '',\n      dateType: 'month',\n    });\n  };\n  //安全责任书\n  const clickAgreement = (params) => {\n    handleRouteChange('/bi/safety/agreement', {\n      orgId: formState.safeResp === 'company' ? params.data.id : '',\n      stationId: formState.safeResp === 'station' ? params.data.id : '',\n      dateCycle: 'month',\n    });\n  };\n  //安全责任书无电站/公司\n  const clickAgreementAll = () => {\n    handleRouteChange('/bi/safety/agreement', {\n      dateCycle: 'month',\n    });\n  };\n\n  // 更新组件函数\n  const handleUpdate = () => {\n    instanceKey.value = buildUUID();\n  };\n\n  defineExpose({\n    handleUpdate,\n  });\n</script>\n\n<style lang=\"less\" scoped>\n  .bottom-content {\n    display: flex;\n    flex: 44.34%;\n    justify-content: space-between;\n    height: 44.34%;\n    padding-top: 0.93vh;\n\n    .section-box {\n      flex: 33.3333%;\n      width: 33.3333%;\n      height: 100%;\n    }\n\n    .section-bg {\n      width: 100%;\n      height: 100%;\n      background: url('../../../../assets/images/da/section_bg_5.png') no-repeat center/100% 100%;\n    }\n\n    .left-section {\n      padding-right: 0.56vw;\n    }\n\n    .middle-section {\n      padding: 0 0.28vw;\n    }\n\n    .right-section {\n      padding-left: 0.56vw;\n    }\n\n    :deep(.ant-select:not(.ant-select-customize-input) .ant-select-selector) {\n      height: 0.26rem !important;\n      border: 0.01rem solid #07a6ff70;\n      border-radius: 0;\n      background-color: transparent;\n    }\n\n    :deep(.ant-select-single .ant-select-selector .ant-select-selection-placeholder) {\n      height: 0.26rem;\n      line-height: 0.26rem;\n    }\n\n    :deep(.ant-select-arrow) {\n      color: rgb(255 255 255 / 50%);\n    }\n\n    .indicator-group-layout {\n      padding: 0.08rem 1.2rem 0;\n\n      &.fix-indicator-group-padding {\n        padding-top: 1.8vh;\n      }\n    }\n\n    .indicator-group-layout2 {\n      padding: 0.08rem 1.88rem 0;\n\n      &.fix-indicator-group-padding {\n        padding-top: 1.8vh;\n      }\n    }\n  }\n</style>\n"],"names":["searchInfo","reactive","instanceKey","ref","buildUUID","formState","watch","props","value","assign","doEmergencyStat","dimensionTypeData","onMounted","__async","CommonApi.getDictDataMap","e","doSafeToolsStat","doSafeRespStat","toolData","bchartSeriesName","toolChartData","safeToolsStat","SecurityApi.safeToolsStat","handleDimensionTypeChange","respData","sbarchartData","sbarChartSeriesName","safeRespStat","SecurityApi.safeRespStat","handleSafeRespChange","emergencyData","emergencyChartData","emergencyChartSeriesName","emergencyStat","SecurityApi.emergencyStat","tempData","element","handleEmergencyChange","clickSafetools","handleRouteChange","clickToolsEchart","params","clickAgreement","clickAgreementAll","__expose"],"mappings":"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"}