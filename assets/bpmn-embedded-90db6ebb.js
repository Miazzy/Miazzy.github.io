var c_=Object.defineProperty,p_=Object.defineProperties;var f_=Object.getOwnPropertyDescriptors;var yd=Object.getOwnPropertySymbols;var d_=Object.prototype.hasOwnProperty,h_=Object.prototype.propertyIsEnumerable;var Ed=(e,t,n)=>t in e?c_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,at=(e,t)=>{for(var n in t||(t={}))d_.call(t,n)&&Ed(e,n,t[n]);if(yd)for(var n of yd(t))h_.call(t,n)&&Ed(e,n,t[n]);return e},Fi=(e,t)=>p_(e,f_(t));var en=(e,t,n)=>new Promise((i,a)=>{var r=u=>{try{s(n.next(u))}catch(c){a(c)}},o=u=>{try{s(n.throw(u))}catch(c){a(c)}},s=u=>u.done?i(u.value):Promise.resolve(u.value).then(r,o);s((n=n.apply(e,t)).next())});import{d as mt,k as Z,e as Yn,u as Ge,w as ct,al as te,Z as re,a9 as ye,aa as j,_ as Oe,a5 as Ho,$ as Ve,a6 as Sv,q as Dt,M as wv,ac as Ce,E as me,ad as Os,a7 as Tv,p as Ls,D as m_,o as Ya,t as Vn,x as v_,R as g_,F as an,f as R,v as uc,r as y_,J as $e,A as bd,ae as Tr,ab as E_,ai as b_,ap as __,c as Ar}from"./vue-71d1abb3.js";import{b$ as x_,c0 as S_,_ as Cv,c1 as kt,c2 as zo,c3 as _d,bQ as Pr,au as Av,ay as vr}from"./index.js";import{R as Fr,Q as Ss,Z as w_}from"./antd-15ac76ed.js";import{i as T_,b as C_,s as jr}from"./index.esm-c216ed00.js";import{b as xd,D as Sd}from"./dict-c04c0dd8.js";const A_=["xlink:href"],P_=["data-icon"],Bs=mt({name:"Icon",__name:"Icon",props:{icon:{type:String,default:""},color:{type:String,default:""},size:{type:Number,default:""},svgClass:{type:String,default:""}},setup(e){const t=e,{getPrefixCls:n}=x_(),i=n("icon"),a=Z(null),r=Yn(()=>t.icon.startsWith("svg-icon:")),o=Yn(()=>Ge(r)?`#icon-${t.icon.split("svg-icon:")[1]}`:t.icon),s=Yn(()=>{const{color:p,size:f}=t;return{fontSize:`${f}px`,color:p}}),u=Yn(()=>{const{svgClass:p}=t;return`iconify ${p}`}),c=p=>en(this,null,function*(){if(Ge(r))return;const f=Ge(a);if(!f||(yield Dt(),!p))return;const m=S_.renderSVG(p,{});if(m)f.textContent="",f.appendChild(m);else{const v=document.createElement("span");v.className="iconify",v.dataset.icon=p,f.textContent="",f.appendChild(v)}});return ct(()=>t.icon,p=>{c(p)}),(p,f)=>{const m=te("ElIcon");return re(),ye(m,{class:Ho(Ge(i)),color:e.color,size:e.size},{default:j(()=>[r.value?(re(),Oe("svg",{key:0,class:Ho(u.value),"aria-hidden":"true"},[Ve("use",{"xlink:href":o.value},null,8,A_)],2)):(re(),Oe("span",{key:1,ref_key:"elRef",ref:a,class:Ho(p.$attrs.class),style:Sv(s.value)},[Ve("span",{class:Ho(u.value),"data-icon":o.value},null,10,P_)],6))]),_:1},8,["class","color","size"])}}}),R_=mt({name:"XButton",__name:"XButton",props:{modelValue:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},preIcon:{type:String,default:""},postIcon:{type:String,default:""},title:{type:String,default:""},type:{type:String,default:""},link:{type:Boolean,default:!1},circle:{type:Boolean,default:!1},round:{type:Boolean,default:!1},plain:{type:Boolean,default:!1},onClick:{type:Function,default:null}},setup(e){const t=e,n=Yn(()=>{const i=["title","preIcon","postIcon","onClick"],a=wv(),r=at(at({},a),t);for(const o in r)i.indexOf(o)!==-1&&delete r[o];return r});return(i,a)=>{const r=te("el-button");return re(),ye(r,Tv(n.value,{onClick:e.onClick}),{default:j(()=>[e.preIcon?(re(),ye(Bs,{key:0,icon:e.preIcon,class:"mr-1px"},null,8,["icon"])):Ce("",!0),me(" "+Os(e.title?e.title:"")+" ",1),e.postIcon?(re(),ye(Bs,{key:1,icon:e.postIcon,class:"mr-1px"},null,8,["icon"])):Ce("",!0)]),_:1},16,["onClick"])}}});const Ke=Cv(R_,[["__scopeId","data-v-35cdf603"]]),I_=mt({name:"XTextButton",__name:"XTextButton",props:{modelValue:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},preIcon:{type:String,default:""},postIcon:{type:String,default:""},title:{type:String,default:""},type:{type:String,default:"primary"},circle:{type:Boolean,default:!1},round:{type:Boolean,default:!1},plain:{type:Boolean,default:!1},onClick:{type:Function,default:null}},setup(e){const t=e,n=Yn(()=>{const i=["title","preIcon","postIcon","onClick"],a=wv(),r=at(at({},a),t);for(const o in r)i.indexOf(o)!==-1&&delete r[o];return r});return(i,a)=>{const r=te("el-button");return re(),ye(r,Tv({link:""},n.value,{onClick:e.onClick}),{default:j(()=>[e.preIcon?(re(),ye(Bs,{key:0,icon:e.preIcon,class:"mr-1px"},null,8,["icon"])):Ce("",!0),me(" "+Os(e.title?e.title:"")+" ",1),e.postIcon?(re(),ye(Bs,{key:1,icon:e.postIcon,class:"mr-1px"},null,8,["icon"])):Ce("",!0)]),_:1},16,["onClick"])}}});const ma=Cv(I_,[["__scopeId","data-v-f9347ad8"]]);var cc={exports:{}};typeof Object.create=="function"?cc.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:cc.exports=function(t,n){if(n){t.super_=n;var i=function(){};i.prototype=n.prototype,t.prototype=new i,t.prototype.constructor=t}};var N_=cc.exports;const se=Fr(N_);function M_(e,t){return t={exports:{}},e(t,t.exports),t.exports}var k_=M_(function(e){var t=e.exports=function(n,i){if(i||(i=16),n===void 0&&(n=128),n<=0)return"0";for(var a=Math.log(Math.pow(2,n))/Math.log(i),r=2;a===1/0;r*=2)a=Math.log(Math.pow(2,n/r))/Math.log(i)*r;for(var o=a-Math.floor(a),s="",r=0;r<Math.floor(a);r++){var u=Math.floor(Math.random()*i).toString(i);s=u+s}if(o){var c=Math.pow(i,o),u=Math.floor(Math.random()*c).toString(i);s=u+s}var p=parseInt(s,i);return p!==1/0&&p>=Math.pow(2,n)?t(n,i):s};t.rack=function(n,i,a){var r=function(s){var u=0;do{if(u++>10)if(a)n+=a;else throw new Error("too many ID collisions, use more bits");var c=t(n,i)}while(Object.hasOwnProperty.call(o,c));return o[c]=s,c},o=r.hats={};return r.get=function(s){return r.hats[s]},r.set=function(s,u){return r.hats[s]=u,r},r.bits=n||128,r.base=i||16,r}});function Bn(e){if(!(this instanceof Bn))return new Bn(e);e=e||[128,36,1],this._seed=e.length?k_.rack(e[0],e[1],e[2]):e}Bn.prototype.next=function(e){return this._seed(e||!0)};Bn.prototype.nextPrefixed=function(e,t){var n;do n=e+this.next(!0);while(this.assigned(n));return this.claim(n,t),n};Bn.prototype.claim=function(e,t){this._seed.set(e,t||!0)};Bn.prototype.assigned=function(e){return this._seed.get(e)||!1};Bn.prototype.unclaim=function(e){delete this._seed.hats[e]};Bn.prototype.clear=function(){var e=this._seed.hats,t;for(t in e)this.unclaim(t)};function Ba(e){return Array.prototype.concat.apply([],e)}var Ka=Object.prototype.toString,D_=Object.prototype.hasOwnProperty;function Qn(e){return e===void 0}function sn(e){return e!==void 0}function $a(e){return e==null}function xe(e){return Ka.call(e)==="[object Array]"}function nt(e){return Ka.call(e)==="[object Object]"}function ve(e){return Ka.call(e)==="[object Number]"}function bt(e){var t=Ka.call(e);return t==="[object Function]"||t==="[object AsyncFunction]"||t==="[object GeneratorFunction]"||t==="[object AsyncGeneratorFunction]"||t==="[object Proxy]"}function jt(e){return Ka.call(e)==="[object String]"}function Pv(e){if(!xe(e))throw new Error("must supply array")}function kn(e,t){return D_.call(e,t)}function Me(e,t){t=Qc(t);var n;return B(e,function(i,a){if(t(i,a))return n=i,!1}),n}function Xc(e,t){t=Qc(t);var n=xe(e)?-1:void 0;return B(e,function(i,a){if(t(i,a))return n=a,!1}),n}function ge(e,t){var n=[];return B(e,function(i,a){t(i,a)&&n.push(i)}),n}function B(e,t){var n,i;if(!Qn(e)){var a=xe(e)?L_:O_;for(var r in e)if(kn(e,r)&&(n=e[r],i=t(n,a(r)),i===!1))return n}}function Rv(e,t){return Qn(e)?[]:(Pv(e),t=Qc(t),e.filter(function(n,i){return!t(n,i)}))}function Ht(e,t,n){return B(e,function(i,a){n=t(n,i,a)}),n}function Qi(e,t){return!!Ht(e,function(n,i,a){return n&&t(i,a)},!0)}function wi(e,t){return!!Me(e,t)}function pt(e,t){var n=[];return B(e,function(i,a){n.push(t(i,a))}),n}function Va(e){return e&&Object.keys(e)||[]}function Rr(e){return Va(e).length}function al(e){return pt(e,function(t){return t})}function er(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t=Jc(t),B(e,function(i){var a=t(i)||"_",r=n[a];r||(r=n[a]=[]),r.push(i)}),n}function Zc(e){e=Jc(e);for(var t={},n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];B(i,function(o){return er(o,e,t)});var r=pt(t,function(o,s){return o[0]});return r}var Iv=Zc;function un(e,t){t=Jc(t);var n=[];return B(e,function(i,a){for(var r=t(i,a),o={d:r,v:i},s=0;s<n.length;s++){var u=n[s].d;if(r<u){n.splice(s,0,o);return}}n.push(o)}),pt(n,function(i){return i.v})}function ln(e){return function(t){return Qi(e,function(n,i){return t[i]===n})}}function Jc(e){return bt(e)?e:function(t){return t[e]}}function Qc(e){return bt(e)?e:function(t){return t===e}}function O_(e){return e}function L_(e){return Number(e)}function ep(e,t){var n,i,a,r;function o(f){var m=Date.now(),v=f?0:r+t-m;if(v>0)return s(v);e.apply(a,i),u()}function s(f){n=setTimeout(o,f)}function u(){n&&clearTimeout(n),n=r=i=a=void 0}function c(){n&&o(!0),u()}function p(){r=Date.now();for(var f=arguments.length,m=new Array(f),v=0;v<f;v++)m[v]=arguments[v];i=m,a=this,n||s(t)}return p.flush=c,p.cancel=u,p}function B_(e,t){var n=!1;return function(){n||(e.apply(void 0,arguments),n=!0,setTimeout(function(){n=!1},t))}}function Pt(e,t){return e.bind(t)}function ws(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ws=function(t){return typeof t}:ws=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ws(e)}function pc(){return pc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},pc.apply(this,arguments)}function G(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return pc.apply(void 0,[e].concat(n))}function $_(e,t,n){var i=e;return B(t,function(a,r){if(typeof a!="number"&&typeof a!="string")throw new Error("illegal key type: "+ws(a)+". Key should be of type number or string.");if(a==="constructor")throw new Error("illegal key: constructor");if(a==="__proto__")throw new Error("illegal key: __proto__");var o=t[r+1],s=i[a];sn(o)&&$a(s)&&(s=i[a]=isNaN(+o)?{}:[]),Qn(o)?Qn(n)?delete i[a]:i[a]=n:i=s}),e}function V_(e,t,n){var i=e;return B(t,function(a){if($a(i))return i=void 0,!1;i=i[a]}),Qn(i)?n:i}function cn(e,t){var n={},i=Object(e);return B(t,function(a){a in i&&(n[a]=e[a])}),n}function ei(e,t){var n={},i=Object(e);return B(i,function(a,r){t.indexOf(r)===-1&&(n[r]=a)}),n}function Nv(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.length&&B(n,function(a){!a||!nt(a)||B(a,function(r,o){if(o!=="__proto__"){var s=e[o];nt(r)?(nt(s)||(s={}),e[o]=Nv(s,r)):e[o]=r}})}),e}const F_=Object.freeze(Object.defineProperty({__proto__:null,assign:G,bind:Pt,debounce:ep,ensureArray:Pv,every:Qi,filter:ge,find:Me,findIndex:Xc,flatten:Ba,forEach:B,get:V_,groupBy:er,has:kn,isArray:xe,isDefined:sn,isFunction:bt,isNil:$a,isNumber:ve,isObject:nt,isString:jt,isUndefined:Qn,keys:Va,map:pt,matchPattern:ln,merge:Nv,omit:ei,pick:cn,reduce:Ht,set:$_,size:Rr,some:wi,sortBy:un,throttle:B_,unionBy:Iv,uniqueBy:Zc,values:al,without:Rv},Symbol.toStringTag,{value:"Module"}));function Xt(e,t,n){return arguments.length==2?e.getAttribute(t):n===null?e.removeAttribute(t):(e.setAttribute(t,n),e)}var j_=[].indexOf,tp=function(e,t){if(j_)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1},H_=/\s+/,z_=Object.prototype.toString;function lt(e){return new yi(e)}function yi(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}yi.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array(),n=tp(t,e);return~n||t.push(e),this.el.className=t.join(" "),this};yi.prototype.remove=function(e){if(z_.call(e)=="[object RegExp]")return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=tp(t,e);return~n&&t.splice(n,1),this.el.className=t.join(" "),this};yi.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this};yi.prototype.toggle=function(e,t){return this.list?(typeof t!="undefined"?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(typeof t!="undefined"?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)};yi.prototype.array=function(){var e=this.el.getAttribute("class")||"",t=e.replace(/^\s+|\s+$/g,""),n=t.split(H_);return n[0]===""&&n.shift(),n};yi.prototype.has=yi.prototype.contains=function(e){return this.list?this.list.contains(e):!!~tp(this.array(),e)};function ol(e){for(var t;e.childNodes.length;)t=e.childNodes[0],e.removeChild(t);return e}var gr=typeof Element!="undefined"?Element.prototype:{},wd=gr.matches||gr.matchesSelector||gr.webkitMatchesSelector||gr.mozMatchesSelector||gr.msMatchesSelector||gr.oMatchesSelector,$s=G_;function G_(e,t){if(!e||e.nodeType!==1)return!1;if(wd)return wd.call(e,t);for(var n=e.parentNode.querySelectorAll(t),i=0;i<n.length;i++)if(n[i]==e)return!0;return!1}function tr(e,t,n){for(var i=n?e:e.parentNode;i&&i.nodeType!==document.DOCUMENT_NODE&&i.nodeType!==document.DOCUMENT_FRAGMENT_NODE;){if($s(i,t))return i;i=i.parentNode}return $s(i,t)?i:null}var Mv=window.addEventListener?"addEventListener":"attachEvent",U_=window.removeEventListener?"removeEventListener":"detachEvent",kv=Mv!=="addEventListener"?"on":"",W_=function(e,t,n,i){return e[Mv](kv+t,n,i||!1),n},q_=function(e,t,n,i){return e[U_](kv+t,n,i||!1),n},pe={bind:W_,unbind:q_},Dv=["focus","blur"];function Y_(e,t,n,i,a){return Dv.indexOf(n)!==-1&&(a=!0),pe.bind(e,n,function(r){var o=r.target||r.srcElement;r.delegateTarget=tr(o,t,!0),r.delegateTarget&&i.call(e,r)},a)}function K_(e,t,n,i){return Dv.indexOf(t)!==-1&&(i=!0),pe.unbind(e,t,n,i)}var qt={bind:Y_,unbind:K_},je=X_,Ov=!1,Go;typeof document!="undefined"&&(Go=document.createElement("div"),Go.innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',Ov=!Go.getElementsByTagName("link").length,Go=void 0);var ot={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:Ov?[1,"X<div>","</div>"]:[0,"",""]};ot.td=ot.th=[3,"<table><tbody><tr>","</tr></tbody></table>"];ot.option=ot.optgroup=[1,'<select multiple="multiple">',"</select>"];ot.thead=ot.tbody=ot.colgroup=ot.caption=ot.tfoot=[1,"<table>","</table>"];ot.polyline=ot.ellipse=ot.polygon=ot.circle=ot.text=ot.line=ot.path=ot.rect=ot.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];function X_(e,t){if(typeof e!="string")throw new TypeError("String expected");t||(t=document);var n=/<([\w:]+)/.exec(e);if(!n)return t.createTextNode(e);e=e.replace(/^\s+|\s+$/g,"");var i=n[1];if(i=="body"){var u=t.createElement("html");return u.innerHTML=e,u.removeChild(u.lastChild)}var a=ot[i]||ot._default,r=a[0],o=a[1],s=a[2],u=t.createElement("div");for(u.innerHTML=o+e+s;r--;)u=u.lastChild;if(u.firstChild==u.lastChild)return u.removeChild(u.firstChild);for(var c=t.createDocumentFragment();u.firstChild;)c.appendChild(u.removeChild(u.firstChild));return c}function Xe(e,t){return t=t||document,t.querySelector(e)}function fc(e,t){return t=t||document,t.querySelectorAll(e)}function $n(e){e.parentNode&&e.parentNode.removeChild(e)}function Z_(e,t){if(e.ownerDocument!==t.ownerDocument)try{return t.ownerDocument.importNode(e,!0)}catch(n){}return e}function Lv(e,t){return t.appendChild(Z_(e,t))}function fe(e,t){return Lv(t,e),e}var dc=2,Bv={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":dc,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":dc,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function J_(e,t){return Bv[t]?e.style[t]:e.getAttributeNS(null,t)}function $v(e,t,n){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),a=Bv[i];a?(a===dc&&typeof n=="number"&&(n=String(n)+"px"),e.style[i]=n):e.setAttributeNS(null,t,n)}function Q_(e,t){var n=Object.keys(t),i,a;for(i=0,a;a=n[i];i++)$v(e,a,t[a])}function ee(e,t,n){if(typeof t=="string")if(n!==void 0)$v(e,t,n);else return J_(e,t);else Q_(e,t);return e}function np(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var ex=/\s+/,tx=Object.prototype.toString;function hc(e){return typeof e!="undefined"}function Se(e){return new Ei(e)}function Ei(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}Ei.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array(),n=np(t,e);return~n||t.push(e),hc(this.el.className.baseVal)?this.el.className.baseVal=t.join(" "):this.el.className=t.join(" "),this};Ei.prototype.remove=function(e){if(tx.call(e)==="[object RegExp]")return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=np(t,e);return~n&&t.splice(n,1),this.el.className.baseVal=t.join(" "),this};Ei.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this};Ei.prototype.toggle=function(e,t){return this.list?(hc(t)?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(hc(t)?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)};Ei.prototype.array=function(){var e=this.el.getAttribute("class")||"",t=e.replace(/^\s+|\s+$/g,""),n=t.split(ex);return n[0]===""&&n.shift(),n};Ei.prototype.has=Ei.prototype.contains=function(e){return this.list?this.list.contains(e):!!~np(this.array(),e)};function tt(e){var t=e.parentNode;return t&&t.removeChild(e),e}function ip(e){for(var t;t=e.firstChild;)tt(t);return e}function Vv(e){return e.cloneNode(!0)}var rp={svg:"http://www.w3.org/2000/svg"},Td='<svg xmlns="'+rp.svg+'"';function Fv(e){var t=!1;e.substring(0,4)==="<svg"?e.indexOf(rp.svg)===-1&&(e=Td+e.substring(4)):(e=Td+">"+e+"</svg>",t=!0);var n=nx(e);if(!t)return n;for(var i=document.createDocumentFragment(),a=n.firstChild;a.firstChild;)i.appendChild(a.firstChild);return i}function nx(e){var t;return t=new DOMParser,t.async=!1,t.parseFromString(e,"text/xml")}function le(e,t){var n;return e.charAt(0)==="<"?(n=Fv(e).firstChild,n=document.importNode(n,!0)):n=document.createElementNS(rp.svg,e),t&&ee(n,t),n}var Pu=null;function mc(){return Pu===null&&(Pu=le("svg")),Pu}function Cd(e,t){var n,i,a=Object.keys(t);for(n=0;i=a[n];n++)e[i]=t[i];return e}function ix(e,t,n,i,a,r){var o=mc().createSVGMatrix();switch(arguments.length){case 0:return o;case 1:return Cd(o,e);case 6:return Cd(o,{a:e,b:t,c:n,d:i,e:a,f:r})}}function Ra(e){return e?mc().createSVGTransformFromMatrix(e):mc().createSVGTransform()}var Ad=/([&<>]{1})/g,rx=/([\n\r"]{1})/g,ax={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"'"};function Ru(e,t){function n(i,a){return ax[a]||a}return e.replace(t,n)}function jv(e,t){var n,i,a,r,o;switch(e.nodeType){case 3:t.push(Ru(e.textContent,Ad));break;case 1:if(t.push("<",e.tagName),e.hasAttributes())for(a=e.attributes,n=0,i=a.length;n<i;++n)r=a.item(n),t.push(" ",r.name,'="',Ru(r.value,rx),'"');if(e.hasChildNodes()){for(t.push(">"),o=e.childNodes,n=0,i=o.length;n<i;++n)jv(o.item(n),t);t.push("</",e.tagName,">")}else t.push("/>");break;case 8:t.push("<!--",Ru(e.nodeValue,Ad),"-->");break;case 4:t.push("<![CDATA[",e.nodeValue,"]]>");break;default:throw new Error("unable to handle node "+e.nodeType)}return t}function ox(e,t){var n=Fv(t);if(ip(e),!!t){lx(n)||(n=n.documentElement);for(var i=ux(n.childNodes),a=0;a<i.length;a++)Lv(i[a],e)}}function sx(e){for(var t=e.firstChild,n=[];t;)jv(t,n),t=t.nextSibling;return n.join("")}function lx(e){return e.nodeName==="#document-fragment"}function Pd(e,t){if(t!==void 0){try{ox(e,t)}catch(n){throw new Error("error parsing SVG: "+n.message)}return e}else return sx(e)}function ux(e){return Array.prototype.slice.call(e)}function cx(e,t){return t instanceof SVGMatrix?e.createSVGTransformFromMatrix(t):t}function px(e,t){var n,i;for(e.clear(),n=0;i=t[n];n++)e.appendItem(cx(e,i))}function Fa(e,t){var n=e.transform.baseVal;return t&&(Array.isArray(t)||(t=[t]),px(n,t)),n.consolidate()}var fx=/^class /;function dx(e){return fx.test(e.toString())}function vc(e){return Object.prototype.toString.call(e)==="[object Array]"}function Iu(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Uo(){var e=Array.prototype.slice.call(arguments);e.length===1&&vc(e[0])&&(e=e[0]);var t=e.pop();return t.$inject=e,t}var hx=/constructor\s*[^(]*\(\s*([^)]*)\)/m,mx=/^(?:async )?(?:function\s*)?[^(]*\(\s*([^)]*)\)/m,vx=/\/\*([^*]*)\*\//m;function gx(e){if(typeof e!="function")throw new Error('Cannot annotate "'+e+'". Expected a function!');var t=e.toString().match(dx(e)?hx:mx);return t?t[1]&&t[1].split(",").map(function(n){return t=n.match(vx),t?t[1].trim():n.trim()})||[]:[]}function yx(){var e=[];this.factory=function(t,n){return e.push([t,"factory",n]),this},this.value=function(t,n){return e.push([t,"value",n]),this},this.type=function(t,n){return e.push([t,"type",n]),this},this.forEach=function(t){e.forEach(t)}}function gc(e,t){t=t||{get:function(g,b){if(n.push(g),b===!1)return null;throw o('No provider for "'+g+'"!')}};var n=[],i=this._providers=Object.create(t._providers||null),a=this._instances=Object.create(null),r=a.injector=this,o=function(g){var b=n.join(" -> ");return n.length=0,new Error(b?g+" (Resolving: "+b+")":g)},s=function(g,b){if(!i[g]&&g.indexOf(".")!==-1){for(var _=g.split("."),k=s(_.shift());_.length;)k=k[_.shift()];return k}if(Iu(a,g))return a[g];if(Iu(i,g)){if(n.indexOf(g)!==-1)throw n.push(g),o("Cannot resolve circular dependency!");return n.push(g),a[g]=i[g][0](i[g][1]),n.pop(),a[g]}return t.get(g,b)},u=function(g,b){if(typeof b=="undefined"&&(b={}),typeof g!="function")if(vc(g))g=Uo(g.slice());else throw new Error('Cannot invoke "'+g+'". Expected a function!');var _=g.$inject||gx(g),k=_.map(function(N){return Iu(b,N)?b[N]:s(N)});return{fn:g,dependencies:k}},c=function(g){var b=u(g),_=b.fn,k=b.dependencies,N=Function.prototype.bind.apply(_,[null].concat(k));return new N},p=function(g,b,_){var k=u(g,_),N=k.fn,A=k.dependencies;return N.apply(b,A)},f=function(g){return Uo(function(b){return g.get(b)})},m=function(g,b){if(b&&b.length){var _=Object.create(null),k=Object.create(null),N=[],A=[],S=[],C,D,$,M;for(var V in i)C=i[V],b.indexOf(V)!==-1&&(C[2]==="private"?(D=N.indexOf(C[3]),D===-1?($=C[3].createChild([],b),M=f($),N.push(C[3]),A.push($),S.push(M),_[V]=[M,V,"private",$]):_[V]=[S[D],V,"private",A[D]]):_[V]=[C[2],C[1]],k[V]=!0),(C[2]==="factory"||C[2]==="type")&&C[1].$scope&&b.forEach(function(K){C[1].$scope.indexOf(K)!==-1&&(_[V]=[C[2],C[1]],k[K]=!0)});b.forEach(function(K){if(!k[K])throw new Error('No provider for "'+K+'". Cannot use provider from the parent!')}),g.unshift(_)}return new gc(g,r)},v={factory:p,type:c,value:function(g){return g}};e.forEach(function(g){function b(A,S){return A!=="value"&&vc(S)&&(S=Uo(S.slice())),S}if(g instanceof yx)g.forEach(function(A){var S=A[0],C=A[1],D=A[2];i[S]=[v[C],b(C,D),C]});else if(typeof g=="object")if(g.__exports__){var _=Object.keys(g).reduce(function(A,S){return S.substring(0,2)!=="__"&&(A[S]=g[S]),A},Object.create(null)),k=new gc((g.__modules__||[]).concat([_]),r),N=Uo(function(A){return k.get(A)});g.__exports__.forEach(function(A){i[A]=[N,A,"private",k]})}else Object.keys(g).forEach(function(A){if(g[A][2]==="private"){i[A]=g[A];return}var S=g[A][0],C=g[A][1];i[A]=[v[S],b(S,C),S]})}),this.get=s,this.invoke=p,this.instantiate=c,this.createChild=m}var Ex=1e3;function ti(e,t){var n=this;t=t||Ex,e.on(["render.shape","render.connection"],t,function(i,a){var r=i.type,o=a.element,s=a.gfx,u=a.attrs;if(n.canRender(o))return r==="render.shape"?n.drawShape(s,o,u):n.drawConnection(s,o,u)}),e.on(["render.getShapePath","render.getConnectionPath"],t,function(i,a){if(n.canRender(a))return i.type==="render.getShapePath"?n.getShapePath(a):n.getConnectionPath(a)})}ti.prototype.canRender=function(){};ti.prototype.drawShape=function(){};ti.prototype.drawConnection=function(){};ti.prototype.getShapePath=function(){};ti.prototype.getConnectionPath=function(){};function Hr(e){return e.join(",").replace(/,?([A-z]),?/g,"$1")}function Hv(e){for(var t="",n=0,i;i=e[n];n++)t+=i.x+","+i.y+" ";return t}function ap(e,t){var n=le("polyline");return ee(n,{points:Hv(e)}),t&&ee(n,t),n}function bx(e,t){return ee(e,{points:Hv(t)}),e}function zv(e){return ge(e,function(t){return!Me(e,function(n){return n!==t&&Gv(t,n)})})}function Gv(e,t){if(t){if(e===t)return t;if(e.parent)return Gv(e.parent,t)}}function Rd(e,t,n){var i=!n||e.indexOf(t)===-1;return i&&e.push(t),i}function nr(e,t,n){n=n||0,xe(e)||(e=[e]),B(e,function(i,a){var r=t(i,a,n);xe(r)&&r.length&&nr(r,t,n+1)})}function _x(e,t,n){var i=[],a=[];return nr(e,function(r,o,s){Rd(i,r,t);var u=r.children;if((n===-1||s<n)&&u&&Rd(a,u,t))return u}),i}function sl(e,t){return _x(e,!t,-1)}function xx(e,t,n){Qn(t)&&(t=!0),nt(t)&&(n=t,t=!0),n=n||{};var i=va(n.allShapes),a=va(n.allConnections),r=va(n.enclosedElements),o=va(n.enclosedConnections),s=va(n.topLevel,t&&er(e,function(p){return p.id}));function u(p){s[p.source.id]&&s[p.target.id]&&(s[p.id]=[p]),i[p.source.id]&&i[p.target.id]&&(o[p.id]=r[p.id]=p),a[p.id]=p}function c(p){if(r[p.id]=p,p.waypoints)o[p.id]=a[p.id]=p;else return i[p.id]=p,B(p.incoming,u),B(p.outgoing,u),p.children}return nr(e,c),{allShapes:i,allConnections:a,topLevel:s,enclosedConnections:o,enclosedElements:r}}function xt(e,t){t=!!t,xe(e)||(e=[e]);var n,i,a,r;return B(e,function(o){var s=o;o.waypoints&&!t&&(s=xt(o.waypoints,!0));var u=s.x,c=s.y,p=s.height||0,f=s.width||0;(u<n||n===void 0)&&(n=u),(c<i||i===void 0)&&(i=c),(u+f>a||a===void 0)&&(a=u+f),(c+p>r||r===void 0)&&(r=c+p)}),{x:n,y:i,height:r-i,width:a-n}}function Sx(e,t){var n={};return B(e,function(i){var a=i;a.waypoints&&(a=xt(a)),!ve(t.y)&&a.x>t.x&&(n[i.id]=i),!ve(t.x)&&a.y>t.y&&(n[i.id]=i),a.x>t.x&&a.y>t.y&&(ve(t.width)&&ve(t.height)&&a.width+a.x<t.width+t.x&&a.height+a.y<t.height+t.y||!ve(t.width)||!ve(t.height))&&(n[i.id]=i)}),n}function Uv(e){return"waypoints"in e?"connection":"x"in e?"shape":"root"}function Wv(e){return!!(e&&e.isFrame)}function va(e,t){return G({},e||{},t||{})}var wx=1;function Ti(e,t){ti.call(this,e,wx),this.CONNECTION_STYLE=t.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=t.style({fill:"white",stroke:"fuchsia",strokeWidth:2}),this.FRAME_STYLE=t.style(["no-fill"],{stroke:"fuchsia",strokeDasharray:4,strokeWidth:2})}se(Ti,ti);Ti.prototype.canRender=function(){return!0};Ti.prototype.drawShape=function(t,n,i){var a=le("rect");return ee(a,{x:0,y:0,width:n.width||0,height:n.height||0}),Wv(n)?ee(a,G({},this.FRAME_STYLE,i||{})):ee(a,G({},this.SHAPE_STYLE,i||{})),fe(t,a),a};Ti.prototype.drawConnection=function(t,n,i){var a=ap(n.waypoints,G({},this.CONNECTION_STYLE,i||{}));return fe(t,a),a};Ti.prototype.getShapePath=function(t){var n=t.x,i=t.y,a=t.width,r=t.height,o=[["M",n,i],["l",a,0],["l",0,r],["l",-a,0],["z"]];return Hr(o)};Ti.prototype.getConnectionPath=function(t){var n=t.waypoints,i,a,r=[];for(i=0;a=n[i];i++)a=a.original||a,r.push([i===0?"M":"L",a.x,a.y]);return Hr(r)};Ti.$inject=["eventBus","styles"];function Tx(){var e={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},t=this;this.cls=function(n,i,a){var r=this.style(i,a);return G(r,{class:n})},this.style=function(n,i){!xe(n)&&!i&&(i=n,n=[]);var a=Ht(n,function(r,o){return G(r,e[o]||{})},{});return i?G(a,i):a},this.computeStyle=function(n,i,a){return xe(i)||(a=i,i=[]),t.style(i||[],G({},a,n||{}))}}const Cx={__init__:["defaultRenderer"],defaultRenderer:["type",Ti],styles:["type",Tx]};function Je(e,t){if(!e||!t)return-1;var n=e.indexOf(t);return n!==-1&&e.splice(n,1),n}function Qe(e,t,n){if(!(!e||!t)){typeof n!="number"&&(n=-1);var i=e.indexOf(t);if(i!==-1){if(i===n)return;if(n!==-1)e.splice(i,1);else return}n!==-1?e.splice(n,0,t):e.push(t)}}function op(e,t){return!e||!t?-1:e.indexOf(t)}function Xa(e,t){return!e||!t?-1:Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function sp(e,t,n,i){if(typeof i=="undefined"&&(i=5),!e||!t||!n)return!1;var a=(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x),r=Xa(e,t);return Math.abs(a/r)<=i}var qv=2;function Kn(e,t){var n;return xe(e)?n=e:n=[e,t],Ax(n)?"h":Px(n)?"v":!1}function Ax(e,t){var n;xe(e)?n=e:n=[e,t];var i=n.slice().shift();return Qi(n,function(a){return Math.abs(i.y-a.y)<=qv})}function Px(e,t){var n;xe(e)?n=e:n=[e,t];var i=n.slice().shift();return Qi(n,function(a){return Math.abs(i.x-a.x)<=qv})}function Id(e,t,n){return n=n||0,e.x>t.x-n&&e.y>t.y-n&&e.x<t.x+t.width+n&&e.y<t.y+t.height+n}function yc(e,t){return{x:Math.round(e.x+(t.x-e.x)/2),y:Math.round(e.y+(t.y-e.y)/2)}}var Rx=/,?([a-z]),?/gi,Nd=parseFloat,Ze=Math,fi=Ze.PI,Nn=Ze.min,Mn=Ze.max,Md=Ze.pow,vi=Ze.abs,Ix=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/ig,Nx=/(-?\d*\.?\d*(?:e[-+]?\d+)?)[\s]*,?[\s]*/ig,Vs=Array.isArray||function(e){return e instanceof Array};function lp(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ia(e){if(typeof e=="function"||Object(e)!==e)return e;var t=new e.constructor;for(var n in e)lp(e,n)&&(t[n]=Ia(e[n]));return t}function Mx(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}function kx(e){function t(){var n=Array.prototype.slice.call(arguments,0),i=n.join("␀"),a=t.cache=t.cache||{},r=t.count=t.count||[];return lp(a,i)?(Mx(r,i),a[i]):(r.length>=1e3&&delete a[r.shift()],r.push(i),a[i]=e.apply(0,n),a[i])}return t}function Dx(e){if(!e)return null;var t=Ir(e);if(t.arr)return Ia(t.arr);var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},i=[];return Vs(e)&&Vs(e[0])&&(i=Ia(e)),i.length||String(e).replace(Ix,function(a,r,o){var s=[],u=r.toLowerCase();for(o.replace(Nx,function(c,p){p&&s.push(+p)}),u=="m"&&s.length>2&&(i.push([r].concat(s.splice(0,2))),u="l",r=r=="m"?"l":"L");s.length>=n[u]&&(i.push([r].concat(s.splice(0,n[u]))),!!n[u]););}),i.toString=Ir.toString,t.arr=Ia(i),i}function Ir(e){var t=Ir.ps=Ir.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout(function(){for(var n in t)lp(t,n)&&n!=e&&(t[n].sleep--,!t[n].sleep&&delete t[n])}),t[e]}function Ec(e,t,n,i){return arguments.length===1&&(t=e.y,n=e.width,i=e.height,e=e.x),{x:e,y:t,width:n,height:i,x2:e+n,y2:t+i}}function Yv(){return this.join(",").replace(Rx,"$1")}function Fs(e){var t=Ia(e);return t.toString=Yv,t}function kd(e,t,n,i,a,r,o,s,u){var c=1-u,p=Md(c,3),f=Md(c,2),m=u*u,v=m*u,g=p*e+f*3*u*n+c*3*u*u*a+v*o,b=p*t+f*3*u*i+c*3*u*u*r+v*s;return{x:js(g),y:js(b)}}function Dd(e){var t=Fx.apply(null,e);return Ec(t.x0,t.y0,t.x1-t.x0,t.y1-t.y0)}function di(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Ox(e,t){return e=Ec(e),t=Ec(t),di(t,e.x,e.y)||di(t,e.x2,e.y)||di(t,e.x,e.y2)||di(t,e.x2,e.y2)||di(e,t.x,t.y)||di(e,t.x2,t.y)||di(e,t.x,t.y2)||di(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)}function Od(e,t,n,i,a){var r=-3*t+9*n-9*i+3*a,o=e*r+6*t-12*n+6*i;return e*o-3*t+3*n}function Ld(e,t,n,i,a,r,o,s,u){u==null&&(u=1),u=u>1?1:u<0?0:u;for(var c=u/2,p=12,f=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],m=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],v=0,g=0;g<p;g++){var b=c*f[g]+c,_=Od(b,e,n,a,o),k=Od(b,t,i,r,s),N=_*_+k*k;v+=m[g]*Ze.sqrt(N)}return c*v}function Lx(e,t,n,i,a,r,o,s){if(!(Mn(e,n)<Nn(a,o)||Nn(e,n)>Mn(a,o)||Mn(t,i)<Nn(r,s)||Nn(t,i)>Mn(r,s))){var u=(e*i-t*n)*(a-o)-(e-n)*(a*s-r*o),c=(e*i-t*n)*(r-s)-(t-i)*(a*s-r*o),p=(e-n)*(r-s)-(t-i)*(a-o);if(p){var f=js(u/p),m=js(c/p),v=+f.toFixed(2),g=+m.toFixed(2);if(!(v<+Nn(e,n).toFixed(2)||v>+Mn(e,n).toFixed(2)||v<+Nn(a,o).toFixed(2)||v>+Mn(a,o).toFixed(2)||g<+Nn(t,i).toFixed(2)||g>+Mn(t,i).toFixed(2)||g<+Nn(r,s).toFixed(2)||g>+Mn(r,s).toFixed(2)))return{x:f,y:m}}}}function js(e){return Math.round(e*1e11)/1e11}function Bx(e,t,n){var i=Dd(e),a=Dd(t);if(!Ox(i,a))return n?0:[];for(var r=Ld.apply(0,e),o=Ld.apply(0,t),s=Bd(e)?1:~~(r/5)||1,u=Bd(t)?1:~~(o/5)||1,c=[],p=[],f={},m=n?0:[],v=0;v<s+1;v++){var g=kd.apply(0,e.concat(v/s));c.push({x:g.x,y:g.y,t:v/s})}for(v=0;v<u+1;v++)g=kd.apply(0,t.concat(v/u)),p.push({x:g.x,y:g.y,t:v/u});for(v=0;v<s;v++)for(var b=0;b<u;b++){var _=c[v],k=c[v+1],N=p[b],A=p[b+1],S=vi(k.x-_.x)<.01?"y":"x",C=vi(A.x-N.x)<.01?"y":"x",D=Lx(_.x,_.y,k.x,k.y,N.x,N.y,A.x,A.y),$;if(D){if($=D.x.toFixed(9)+"#"+D.y.toFixed(9),f[$])continue;f[$]=!0;var M=_.t+vi((D[S]-_[S])/(k[S]-_[S]))*(k.t-_.t),V=N.t+vi((D[C]-N[C])/(A[C]-N[C]))*(A.t-N.t);M>=0&&M<=1&&V>=0&&V<=1&&(n?m++:m.push({x:D.x,y:D.y,t1:M,t2:V}))}}return m}function $x(e,t,n){e=Vd(e),t=Vd(t);for(var i,a,r,o,s,u,c,p,f,m,v=n?0:[],g=0,b=e.length;g<b;g++){var _=e[g];if(_[0]=="M")i=s=_[1],a=u=_[2];else{_[0]=="C"?(f=[i,a].concat(_.slice(1)),i=f[6],a=f[7]):(f=[i,a,i,a,s,u,s,u],i=s,a=u);for(var k=0,N=t.length;k<N;k++){var A=t[k];if(A[0]=="M")r=c=A[1],o=p=A[2];else{A[0]=="C"?(m=[r,o].concat(A.slice(1)),r=m[6],o=m[7]):(m=[r,o,r,o,c,p,c,p],r=c,o=p);var S=Bx(f,m,n);if(n)v+=S;else{for(var C=0,D=S.length;C<D;C++)S[C].segment1=g,S[C].segment2=k,S[C].bez1=f,S[C].bez2=m;v=v.concat(S)}}}}}return v}function Vx(e){var t=Ir(e);if(t.abs)return Fs(t.abs);if((!Vs(e)||!Vs(e&&e[0]))&&(e=Dx(e)),!e||!e.length)return[["M",0,0]];var n=[],i=0,a=0,r=0,o=0,s=0,u;e[0][0]=="M"&&(i=+e[0][1],a=+e[0][2],r=i,o=a,s++,n[0]=["M",i,a]);for(var c,p,f=s,m=e.length;f<m;f++){if(n.push(c=[]),p=e[f],u=p[0],u!=u.toUpperCase())switch(c[0]=u.toUpperCase(),c[0]){case"A":c[1]=p[1],c[2]=p[2],c[3]=p[3],c[4]=p[4],c[5]=p[5],c[6]=+p[6]+i,c[7]=+p[7]+a;break;case"V":c[1]=+p[1]+a;break;case"H":c[1]=+p[1]+i;break;case"M":r=+p[1]+i,o=+p[2]+a;default:for(var v=1,g=p.length;v<g;v++)c[v]=+p[v]+(v%2?i:a)}else for(var b=0,_=p.length;b<_;b++)c[b]=p[b];switch(u=u.toUpperCase(),c[0]){case"Z":i=+r,a=+o;break;case"H":i=c[1];break;case"V":a=c[1];break;case"M":r=c[c.length-2],o=c[c.length-1];default:i=c[c.length-2],a=c[c.length-1]}}return n.toString=Yv,t.abs=Fs(n),n}function Bd(e){return e[0]===e[2]&&e[1]===e[3]&&e[4]===e[6]&&e[5]===e[7]}function Wo(e,t,n,i){return[e,t,n,i,n,i]}function $d(e,t,n,i,a,r){var o=.3333333333333333,s=2/3;return[o*e+s*n,o*t+s*i,o*a+s*n,o*r+s*i,a,r]}function Kv(e,t,n,i,a,r,o,s,u,c){var p=fi*120/180,f=fi/180*(+a||0),m=[],v,g=kx(function(he,Fe,_e){var we=he*Ze.cos(_e)-Fe*Ze.sin(_e),ft=he*Ze.sin(_e)+Fe*Ze.cos(_e);return{x:we,y:ft}});if(c)$=c[0],M=c[1],C=c[2],D=c[3];else{v=g(e,t,-f),e=v.x,t=v.y,v=g(s,u,-f),s=v.x,u=v.y;var b=(e-s)/2,_=(t-u)/2,k=b*b/(n*n)+_*_/(i*i);k>1&&(k=Ze.sqrt(k),n=k*n,i=k*i);var N=n*n,A=i*i,S=(r==o?-1:1)*Ze.sqrt(vi((N*A-N*_*_-A*b*b)/(N*_*_+A*b*b))),C=S*n*_/i+(e+s)/2,D=S*-i*b/n+(t+u)/2,$=Ze.asin(((t-D)/i).toFixed(9)),M=Ze.asin(((u-D)/i).toFixed(9));$=e<C?fi-$:$,M=s<C?fi-M:M,$<0&&($=fi*2+$),M<0&&(M=fi*2+M),o&&$>M&&($=$-fi*2),!o&&M>$&&(M=M-fi*2)}var V=M-$;if(vi(V)>p){var K=M,X=s,z=u;M=$+p*(o&&M>$?1:-1),s=C+n*Ze.cos(M),u=D+i*Ze.sin(M),m=Kv(s,u,n,i,a,0,o,X,z,[M,K,C,D])}V=M-$;var U=Ze.cos($),Q=Ze.sin($),l=Ze.cos(M),d=Ze.sin(M),E=Ze.tan(V/4),y=4/3*n*E,h=4/3*i*E,x=[e,t],I=[e+y*Q,t-h*U],F=[s+y*d,u-h*l],O=[s,u];if(I[0]=2*x[0]-I[0],I[1]=2*x[1]-I[1],c)return[I,F,O].concat(m);m=[I,F,O].concat(m).join().split(",");for(var H=[],W=0,Y=m.length;W<Y;W++)H[W]=W%2?g(m[W-1],m[W],f).y:g(m[W],m[W+1],f).x;return H}function Fx(e,t,n,i,a,r,o,s){for(var u=[],c=[[],[]],p,f,m,v,g,b,_,k,N=0;N<2;++N){if(N==0?(f=6*e-12*n+6*a,p=-3*e+9*n-9*a+3*o,m=3*n-3*e):(f=6*t-12*i+6*r,p=-3*t+9*i-9*r+3*s,m=3*i-3*t),vi(p)<1e-12){if(vi(f)<1e-12)continue;v=-m/f,0<v&&v<1&&u.push(v);continue}_=f*f-4*m*p,k=Ze.sqrt(_),!(_<0)&&(g=(-f+k)/(2*p),0<g&&g<1&&u.push(g),b=(-f-k)/(2*p),0<b&&b<1&&u.push(b))}for(var A=u.length,S=A,C;A--;)v=u[A],C=1-v,c[0][A]=C*C*C*e+3*C*C*v*n+3*C*v*v*a+v*v*v*o,c[1][A]=C*C*C*t+3*C*C*v*i+3*C*v*v*r+v*v*v*s;return c[0][S]=e,c[1][S]=t,c[0][S+1]=o,c[1][S+1]=s,c[0].length=c[1].length=S+2,{x0:Nn.apply(0,c[0]),y0:Nn.apply(0,c[1]),x1:Mn.apply(0,c[0]),y1:Mn.apply(0,c[1])}}function Vd(e){var t=Ir(e);if(t.curve)return Fs(t.curve);for(var n=Vx(e),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a=function(v,g,b){var _,k;if(!v)return["C",g.x,g.y,g.x,g.y,g.x,g.y];switch(!(v[0]in{T:1,Q:1})&&(g.qx=g.qy=null),v[0]){case"M":g.X=v[1],g.Y=v[2];break;case"A":v=["C"].concat(Kv.apply(0,[g.x,g.y].concat(v.slice(1))));break;case"S":b=="C"||b=="S"?(_=g.x*2-g.bx,k=g.y*2-g.by):(_=g.x,k=g.y),v=["C",_,k].concat(v.slice(1));break;case"T":b=="Q"||b=="T"?(g.qx=g.x*2-g.qx,g.qy=g.y*2-g.qy):(g.qx=g.x,g.qy=g.y),v=["C"].concat($d(g.x,g.y,g.qx,g.qy,v[1],v[2]));break;case"Q":g.qx=v[1],g.qy=v[2],v=["C"].concat($d(g.x,g.y,v[1],v[2],v[3],v[4]));break;case"L":v=["C"].concat(Wo(g.x,g.y,v[1],v[2]));break;case"H":v=["C"].concat(Wo(g.x,g.y,v[1],g.y));break;case"V":v=["C"].concat(Wo(g.x,g.y,g.x,v[1]));break;case"Z":v=["C"].concat(Wo(g.x,g.y,g.X,g.Y));break}return v},r=function(v,g){if(v[g].length>7){v[g].shift();for(var b=v[g];b.length;)o[g]="A",v.splice(g++,0,["C"].concat(b.splice(0,6)));v.splice(g,1),p=n.length}},o=[],s="",u="",c=0,p=n.length;c<p;c++){n[c]&&(s=n[c][0]),s!="C"&&(o[c]=s,c&&(u=o[c-1])),n[c]=a(n[c],i,u),o[c]!="A"&&s=="C"&&(o[c]="C"),r(n,c);var f=n[c],m=f.length;i.x=f[m-2],i.y=f[m-1],i.bx=Nd(f[m-4])||i.x,i.by=Nd(f[m-3])||i.y}return t.curve=Fs(n),n}var jx=$x;const Xv=Fr(jx);function Zv(e){return{x:Math.round(e.x),y:Math.round(e.y),width:Math.round(e.width),height:Math.round(e.height)}}function gi(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function ce(e){return{top:e.y,right:e.x+(e.width||0),bottom:e.y+(e.height||0),left:e.x}}function up(e){return{x:e.left,y:e.top,width:e.right-e.left,height:e.bottom-e.top}}function Ee(e){return gi({x:e.x+(e.width||0)/2,y:e.y+(e.height||0)/2})}function St(e,t,n){n=n||0,nt(n)||(n={x:n,y:n});var i=ce(e),a=ce(t),r=i.bottom+n.y<=a.top,o=i.left-n.x>=a.right,s=i.top-n.y>=a.bottom,u=i.right+n.x<=a.left,c=r?"top":s?"bottom":null,p=u?"left":o?"right":null;return p&&c?c+"-"+p:p||c||"intersect"}function bc(e,t,n){var i=Hx(e,t);return i.length===1||i.length===2&&Xa(i[0],i[1])<1?gi(i[0]):i.length>1?(i=un(i,function(a){var r=Math.floor(a.t2*100)||1;return r=100-r,r=(r<10?"0":"")+r,a.segment2+"#"+r}),gi(i[n?0:i.length-1])):null}function Hx(e,t){return Xv(e,t)}function zx(e){e=e.slice();for(var t=0,n,i,a;e[t];)n=e[t],i=e[t-1],a=e[t+1],Xa(n,a)===0||sp(i,a,n)?e.splice(t,1):t++;return e}function Ts(e,t){return Math.round(e*t)/t}function Fd(e){return ve(e)?e+"px":e}function Gx(e){for(;e.parent;)e=e.parent;return e}function Ux(e){e=G({},{width:"100%",height:"100%"},e);var t=e.container||document.body,n=document.createElement("div");return n.setAttribute("class","djs-container"),G(n.style,{position:"relative",overflow:"hidden",width:Fd(e.width),height:Fd(e.height)}),t.appendChild(n),n}function Jv(e,t,n){var i=le("g");Se(i).add(t);var a=n!==void 0?n:e.childNodes.length-1;return e.insertBefore(i,e.childNodes[a]||null),i}var Hs="base",_c="djs-element-hidden",Qv=0,Wx=1,qx={shape:["x","y","width","height"],connection:["waypoints"]};function be(e,t,n,i){this._eventBus=t,this._elementRegistry=i,this._graphicsFactory=n,this._init(e||{})}be.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"];be.prototype._init=function(e){var t=this._eventBus,n=this._container=Ux(e),i=this._svg=le("svg");ee(i,{width:"100%",height:"100%"}),fe(n,i);var a=this._viewport=Jv(i,"viewport");this._layers={},this._planes={},e.deferUpdate!==!1&&(this._viewboxChanged=ep(Pt(this._viewboxChanged,this),300)),t.on("diagram.init",function(){t.fire("canvas.init",{svg:i,viewport:a})},this),t.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed","plane.set"],function(){delete this._cachedViewbox},this),t.on("diagram.destroy",500,this._destroy,this),t.on("diagram.clear",500,this._clear,this)};be.prototype._destroy=function(e){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});var t=this._container.parentNode;t&&t.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._planes,delete this._activePlane,delete this._viewport};be.prototype._clear=function(){var e=this,t=this._elementRegistry.getAll();t.forEach(function(n){var i=Uv(n);i==="root"?e.setRootElementForPlane(null,e.findPlane(n),!0):e._removeElement(n,i)}),this._activePlane=null,this._planes={},delete this._cachedViewbox};be.prototype.getDefaultLayer=function(){return this.getLayer(Hs,Qv)};be.prototype.getLayer=function(e,t){if(!e)throw new Error("must specify a name");var n=this._layers[e];if(n||(n=this._layers[e]=this._createLayer(e,t)),typeof t!="undefined"&&n.index!==t)throw new Error("layer <"+e+"> already created at index <"+t+">");return n.group};be.prototype._createLayer=function(e,t){typeof t=="undefined"&&(t=Wx);var n=Ht(this._layers,function(i,a){return t>=a.index&&i++,i},0);return{group:Jv(this._viewport,"layer-"+e,n),index:t}};be.prototype.getPlane=function(e){if(!e)throw new Error("must specify a name");return this._planes[e]};be.prototype.createPlane=function(e,t){if(!e)throw new Error("must specify a name");if(this._planes[e])throw new Error("plane "+e+" already exists");t||(t={id:"__implicitroot"+e,children:[],isImplicit:!0});var n=this.getLayer(e,Qv);Se(n).add(_c);var i=this._planes[e]={layer:n,name:e,rootElement:null};return this.setRootElementForPlane(t,i),i};be.prototype.setActivePlane=function(e){if(!e)throw new Error("must specify a plane");return typeof e=="string"&&(e=this.getPlane(e)),this._activePlane&&Se(this._activePlane.layer).add(_c),this._activePlane=e,Se(e.layer).remove(_c),e.rootElement&&this._elementRegistry.updateGraphics(e.rootElement,this._svg,!0),this._eventBus.fire("plane.set",{plane:e}),e};be.prototype.getActiveLayer=function(){return this.getActivePlane().layer};be.prototype.getActivePlane=function(){var e=this._activePlane;return e||(e=this.createPlane(Hs),this.setActivePlane(Hs)),e};be.prototype.findPlane=function(e){typeof e=="string"&&(e=this._elementRegistry.get(e));var t=Gx(e);return Me(this._planes,function(n){return n.rootElement===t})};be.prototype.getContainer=function(){return this._container};be.prototype._updateMarker=function(e,t,n){var i;e.id||(e=this._elementRegistry.get(e)),i=this._elementRegistry._elements[e.id],i&&(B([i.gfx,i.secondaryGfx],function(a){a&&(n?Se(a).add(t):Se(a).remove(t))}),this._eventBus.fire("element.marker.update",{element:e,gfx:i.gfx,marker:t,add:!!n}))};be.prototype.addMarker=function(e,t){this._updateMarker(e,t,!0)};be.prototype.removeMarker=function(e,t){this._updateMarker(e,t,!1)};be.prototype.hasMarker=function(e,t){e.id||(e=this._elementRegistry.get(e));var n=this.getGraphics(e);return Se(n).has(t)};be.prototype.toggleMarker=function(e,t){this.hasMarker(e,t)?this.removeMarker(e,t):this.addMarker(e,t)};be.prototype.getRootElement=function(){var e=this.getActivePlane();return e.rootElement};be.prototype.setRootElement=function(e,t){var n=this._activePlane;if(n)return this.setRootElementForPlane(e,n,t);var i=this.createPlane(Hs,e);return this.setActivePlane(i),i.rootElement};be.prototype.setRootElementForPlane=function(e,t,n){typeof t=="string"&&(t=this.getPlane(t)),e&&this._ensureValid("root",e);var i=t.rootElement,a=this._elementRegistry,r=this._eventBus;if(i){if(!n)throw new Error("rootElement already set, need to specify override");r.fire("root.remove",{element:i}),r.fire("root.removed",{element:i}),a.remove(i)}if(e){var o=t.layer;r.fire("root.add",{element:e}),a.add(e,o),r.fire("root.added",{element:e,gfx:o}),t===this._activePlane&&this._elementRegistry.updateGraphics(e,this._svg,!0)}return t.rootElement=e,e};be.prototype._ensureValid=function(e,t){if(!t.id)throw new Error("element must have an id");if(this._elementRegistry.get(t.id))throw new Error("element with id "+t.id+" already exists");var n=qx[e],i=Qi(n,function(a){return typeof t[a]!="undefined"});if(!i)throw new Error("must supply { "+n.join(", ")+" } with "+e)};be.prototype._setParent=function(e,t,n){Qe(t.children,e,n),e.parent=t};be.prototype._addElement=function(e,t,n,i){n=n||this.getRootElement();var a=this._eventBus,r=this._graphicsFactory;this._ensureValid(e,t),a.fire(e+".add",{element:t,parent:n}),this._setParent(t,n,i);var o=r.create(e,t,i);return this._elementRegistry.add(t,o),r.update(e,t,o),a.fire(e+".added",{element:t,gfx:o}),t};be.prototype.addShape=function(e,t,n){return this._addElement("shape",e,t,n)};be.prototype.addConnection=function(e,t,n){return this._addElement("connection",e,t,n)};be.prototype._removeElement=function(e,t){var n=this._elementRegistry,i=this._graphicsFactory,a=this._eventBus;if(e=n.get(e.id||e),!!e)return a.fire(t+".remove",{element:e}),i.remove(e),Je(e.parent&&e.parent.children,e),e.parent=null,a.fire(t+".removed",{element:e}),n.remove(e),e};be.prototype.removeShape=function(e){return this._removeElement(e,"shape")};be.prototype.removeConnection=function(e){return this._removeElement(e,"connection")};be.prototype.getGraphics=function(e,t){return this._elementRegistry.getGraphics(e,t)};be.prototype._changeViewbox=function(e){this._eventBus.fire("canvas.viewbox.changing"),e.apply(this),this._cachedViewbox=null,this._viewboxChanged()};be.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})};be.prototype.viewbox=function(e){if(e===void 0&&this._cachedViewbox)return this._cachedViewbox;var t=this._viewport,n,i=this.getSize(),a,r,o,s,u;if(e)this._changeViewbox(function(){o=Math.min(i.width/e.width,i.height/e.height);var c=this._svg.createSVGMatrix().scale(o).translate(-e.x,-e.y);Fa(t,c)});else return n=this._activePlane&&this._activePlane.layer.getBBox()||{},r=Fa(t),a=r?r.matrix:ix(),o=Ts(a.a,1e3),s=Ts(-a.e||0,1e3),u=Ts(-a.f||0,1e3),e=this._cachedViewbox={x:s?s/o:0,y:u?u/o:0,width:i.width/o,height:i.height/o,scale:o,inner:{width:n.width||0,height:n.height||0,x:n.x||0,y:n.y||0},outer:i},e;return e};be.prototype.scroll=function(e){var t=this._viewport,n=t.getCTM();return e&&this._changeViewbox(function(){e=G({dx:0,dy:0},e||{}),n=this._svg.createSVGMatrix().translate(e.dx,e.dy).multiply(n),eg(t,n)}),{x:n.e,y:n.f}};be.prototype.scrollToElement=function(e,t){var n=100;typeof e=="string"&&(e=this._elementRegistry.get(e));var i=this.findPlane(e);i!==this._activePlane&&this.setActivePlane(i),t||(t={}),typeof t=="number"&&(n=t),t={top:t.top||n,right:t.right||n,bottom:t.bottom||n,left:t.left||n};var a=xt(e),r=ce(a),o=this.viewbox(),s=this.zoom(),u,c;o.y+=t.top/s,o.x+=t.left/s,o.width-=(t.right+t.left)/s,o.height-=(t.bottom+t.top)/s;var p=ce(o),f=a.width<o.width&&a.height<o.height;if(!f)u=a.x-o.x,c=a.y-o.y;else{var m=Math.max(0,r.right-p.right),v=Math.min(0,r.left-p.left),g=Math.max(0,r.bottom-p.bottom),b=Math.min(0,r.top-p.top);u=m||v,c=g||b}this.scroll({dx:-u*s,dy:-c*s})};be.prototype.zoom=function(e,t){if(!e)return this.viewbox(e).scale;if(e==="fit-viewport")return this._fitViewport(t);var n,i;return this._changeViewbox(function(){typeof t!="object"&&(n=this.viewbox().outer,t={x:n.width/2,y:n.height/2}),i=this._setZoom(e,t)}),Ts(i.a,1e3)};function eg(e,t){var n="matrix("+t.a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")";e.setAttribute("transform",n)}be.prototype._fitViewport=function(e){var t=this.viewbox(),n=t.outer,i=t.inner,a,r;return i.x>=0&&i.y>=0&&i.x+i.width<=n.width&&i.y+i.height<=n.height&&!e?r={x:0,y:0,width:Math.max(i.width+i.x,n.width),height:Math.max(i.height+i.y,n.height)}:(a=Math.min(1,n.width/i.width,n.height/i.height),r={x:i.x+(e?i.width/2-n.width/a/2:0),y:i.y+(e?i.height/2-n.height/a/2:0),width:n.width/a,height:n.height/a}),this.viewbox(r),this.viewbox(!1).scale};be.prototype._setZoom=function(e,t){var n=this._svg,i=this._viewport,a=n.createSVGMatrix(),r=n.createSVGPoint(),o,s,u,c,p;u=i.getCTM();var f=u.a;return t?(o=G(r,t),s=o.matrixTransform(u.inverse()),c=a.translate(s.x,s.y).scale(1/f*e).translate(-s.x,-s.y),p=u.multiply(c)):p=a.scale(e),eg(this._viewport,p),p};be.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}};be.prototype.getAbsoluteBBox=function(e){var t=this.viewbox(),n;if(e.waypoints){var i=this.getGraphics(e);n=i.getBBox()}else n=e;var a=n.x*t.scale-t.x*t.scale,r=n.y*t.scale-t.y*t.scale,o=n.width*t.scale,s=n.height*t.scale;return{x:a,y:r,width:o,height:s}};be.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var Nr="data-element-id";function Zt(e){this._elements={},this._eventBus=e}Zt.$inject=["eventBus"];Zt.prototype.add=function(e,t,n){var i=e.id;this._validateId(i),ee(t,Nr,i),n&&ee(n,Nr,i),this._elements[i]={element:e,gfx:t,secondaryGfx:n}};Zt.prototype.remove=function(e){var t=this._elements,n=e.id||e,i=n&&t[n];i&&(ee(i.gfx,Nr,""),i.secondaryGfx&&ee(i.secondaryGfx,Nr,""),delete t[n])};Zt.prototype.updateId=function(e,t){this._validateId(t),typeof e=="string"&&(e=this.get(e)),this._eventBus.fire("element.updateId",{element:e,newId:t});var n=this.getGraphics(e),i=this.getGraphics(e,!0);this.remove(e),e.id=t,this.add(e,n,i)};Zt.prototype.updateGraphics=function(e,t,n){var i=e.id||e,a=this._elements[i];return n?a.secondaryGfx=t:a.gfx=t,ee(t,Nr,i),t};Zt.prototype.get=function(e){var t;typeof e=="string"?t=e:t=e&&ee(e,Nr);var n=this._elements[t];return n&&n.element};Zt.prototype.filter=function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(n)}),t};Zt.prototype.find=function(e){for(var t=this._elements,n=Object.keys(t),i=0;i<n.length;i++){var a=n[i],r=t[a],o=r.element,s=r.gfx;if(e(o,s))return o}};Zt.prototype.getAll=function(){return this.filter(function(e){return e})};Zt.prototype.forEach=function(e){var t=this._elements;Object.keys(t).forEach(function(n){var i=t[n],a=i.element,r=i.gfx;return e(a,r)})};Zt.prototype.getGraphics=function(e,t){var n=e.id||e,i=this._elements[n];return i&&(t?i.secondaryGfx:i.gfx)};Zt.prototype._validateId=function(e){if(!e)throw new Error("element must have an id");if(this._elements[e])throw new Error("element with id "+e+" already added")};var cp={exports:{}},ll={};function Yx(e,t,n,i){var a=n.inverse;return Object.defineProperty(e,"remove",{value:function(r){var o=this.indexOf(r);return o!==-1&&(this.splice(o,1),t.unset(r,a,i)),r}}),Object.defineProperty(e,"contains",{value:function(r){return this.indexOf(r)!==-1}}),Object.defineProperty(e,"add",{value:function(r,o){var s=this.indexOf(r);if(typeof o=="undefined"){if(s!==-1)return;o=this.length}s!==-1&&this.splice(s,1),this.splice(o,0,r),s===-1&&t.set(r,a,i)}}),Object.defineProperty(e,"__refs_collection",{value:!0}),e}function Kx(e){return e.__refs_collection===!0}ll.extend=Yx;ll.isExtended=Kx;var tg=ll;function Xx(e,t){return Object.prototype.hasOwnProperty.call(e,t.name||t)}function ng(e,t,n){var i=tg.extend(n[t.name]||[],e,t,n);Object.defineProperty(n,t.name,{enumerable:t.enumerable,value:i}),i.length&&i.forEach(function(a){e.set(a,t.inverse,n)})}function Zx(e,t,n){var i=t.inverse,a=n[t.name];Object.defineProperty(n,t.name,{configurable:t.configurable,enumerable:t.enumerable,get:function(){return a},set:function(r){if(r!==a){var o=a;a=null,o&&e.unset(o,i,n),a=r,e.set(a,i,n)}}})}function bi(e,t){if(!(this instanceof bi))return new bi(e,t);e.inverse=t,t.inverse=e,this.props={},this.props[e.name]=e,this.props[t.name]=t}bi.prototype.bind=function(e,t){if(typeof t=="string"){if(!this.props[t])throw new Error("no property <"+t+"> in ref");t=this.props[t]}t.collection?ng(this,t,e):Zx(this,t,e)};bi.prototype.ensureRefsCollection=function(e,t){var n=e[t.name];return tg.isExtended(n)||ng(this,t,e),n};bi.prototype.ensureBound=function(e,t){Xx(e,t)||this.bind(e,t)};bi.prototype.unset=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).remove(n):e[t.name]=void 0)};bi.prototype.set=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).add(n):e[t.name]=n)};var Jx=bi;cp.exports=Jx;cp.exports.Collection=ll;var Qx=cp.exports;const zr=Fr(Qx);var ig=new zr({name:"children",enumerable:!0,collection:!0},{name:"parent"}),rg=new zr({name:"labels",enumerable:!0,collection:!0},{name:"labelTarget"}),jd=new zr({name:"attachers",collection:!0},{name:"host"}),ag=new zr({name:"outgoing",collection:!0},{name:"source"}),og=new zr({name:"incoming",collection:!0},{name:"target"});function Za(){Object.defineProperty(this,"businessObject",{writable:!0}),Object.defineProperty(this,"label",{get:function(){return this.labels[0]},set:function(e){var t=this.label,n=this.labels;!e&&t?n.remove(t):n.add(e,0)}}),ig.bind(this,"parent"),rg.bind(this,"labels"),ag.bind(this,"outgoing"),og.bind(this,"incoming")}function Gr(){Za.call(this),ig.bind(this,"children"),jd.bind(this,"host"),jd.bind(this,"attachers")}se(Gr,Za);function sg(){Gr.call(this)}se(sg,Gr);function ul(){Gr.call(this),rg.bind(this,"labelTarget")}se(ul,Gr);function lg(){Za.call(this),ag.bind(this,"source"),og.bind(this,"target")}se(lg,Za);var eS={connection:lg,shape:Gr,label:ul,root:sg};function tS(e,t){var n=eS[e];if(!n)throw new Error("unknown type: <"+e+">");return G(new n,t)}function ni(){this._uid=12}ni.prototype.createRoot=function(e){return this.create("root",e)};ni.prototype.createLabel=function(e){return this.create("label",e)};ni.prototype.createShape=function(e){return this.create("shape",e)};ni.prototype.createConnection=function(e){return this.create("connection",e)};ni.prototype.create=function(e,t){return t=G({},t||{}),t.id||(t.id=e+"_"+this._uid++),tS(e,t)};var zs="__fn",ug=1e3,nS=Array.prototype.slice;function zt(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}zt.prototype.on=function(e,t,n,i){if(e=xe(e)?e:[e],bt(t)&&(i=n,n=t,t=ug),!ve(t))throw new Error("priority must be a number");var a=n;i&&(a=Pt(n,i),a[zs]=n[zs]||n);var r=this;e.forEach(function(o){r._addListener(o,{priority:t,callback:a,next:null})})};zt.prototype.once=function(e,t,n,i){var a=this;if(bt(t)&&(i=n,n=t,t=ug),!ve(t))throw new Error("priority must be a number");function r(){r.__isTomb=!0;var o=n.apply(i,arguments);return a.off(e,r),o}r[zs]=n,this.on(e,t,r)};zt.prototype.off=function(e,t){e=xe(e)?e:[e];var n=this;e.forEach(function(i){n._removeListener(i,t)})};zt.prototype.createEvent=function(e){var t=new Ja;return t.init(e),t};zt.prototype.fire=function(e,t){var n,i,a,r;if(r=nS.call(arguments),typeof e=="object"&&(t=e,e=t.type),!e)throw new Error("no event type specified");if(i=this._listeners[e],!!i){t instanceof Ja?n=t:n=this.createEvent(t),r[0]=n;var o=n.type;e!==o&&(n.type=e);try{a=this._invokeListeners(n,r,i)}finally{e!==o&&(n.type=o)}return a===void 0&&n.defaultPrevented&&(a=!1),a}};zt.prototype.handleError=function(e){return this.fire("error",{error:e})===!1};zt.prototype._destroy=function(){this._listeners={}};zt.prototype._invokeListeners=function(e,t,n){for(var i;n&&!e.cancelBubble;)i=this._invokeListener(e,t,n),n=n.next;return i};zt.prototype._invokeListener=function(e,t,n){var i;if(n.callback.__isTomb)return i;try{i=iS(n.callback,t),i!==void 0&&(e.returnValue=i,e.stopPropagation()),i===!1&&e.preventDefault()}catch(a){if(!this.handleError(a))throw console.error("unhandled error in event listener",a),a}return i};zt.prototype._addListener=function(e,t){var n=this._getListeners(e),i;if(!n){this._setListeners(e,t);return}for(;n;){if(n.priority<t.priority){t.next=n,i?i.next=t:this._setListeners(e,t);return}i=n,n=n.next}i.next=t};zt.prototype._getListeners=function(e){return this._listeners[e]};zt.prototype._setListeners=function(e,t){this._listeners[e]=t};zt.prototype._removeListener=function(e,t){var n=this._getListeners(e),i,a,r;if(!t){this._setListeners(e,null);return}for(;n;)i=n.next,r=n.callback,(r===t||r[zs]===t)&&(a?a.next=i:this._setListeners(e,i)),a=n,n=i};function Ja(){}Ja.prototype.stopPropagation=function(){this.cancelBubble=!0};Ja.prototype.preventDefault=function(){this.defaultPrevented=!0};Ja.prototype.init=function(e){G(this,e||{})};function iS(e,t){return e.apply(null,t)}function Gs(e){return e.childNodes[0]}function rS(e){return e.parentNode.childNodes[1]}function xc(e,t,n,i,a){var r=Ra();r.setTranslate(t,n);var o=Ra();o.setRotate(i||0,0,0);var s=Ra();s.setScale(a||1,a||1),Fa(e,[r,o,s])}function Ft(e,t,n){var i=Ra();i.setTranslate(t,n),Fa(e,i)}function cg(e,t){var n=Ra();n.setRotate(t,0,0),Fa(e,n)}function Jt(e,t){this._eventBus=e,this._elementRegistry=t}Jt.$inject=["eventBus","elementRegistry"];Jt.prototype._getChildrenContainer=function(e){var t=this._elementRegistry.getGraphics(e),n;return e.parent?(n=rS(t),n||(n=le("g"),Se(n).add("djs-children"),fe(t.parentNode,n))):n=t,n};Jt.prototype._clear=function(e){var t=Gs(e);return ol(t),t};Jt.prototype._createContainer=function(e,t,n,i){var a=le("g");Se(a).add("djs-group"),typeof n!="undefined"?pg(a,t,t.childNodes[n]):fe(t,a);var r=le("g");Se(r).add("djs-element"),Se(r).add("djs-"+e),i&&Se(r).add("djs-frame"),fe(a,r);var o=le("g");return Se(o).add("djs-visual"),fe(r,o),r};Jt.prototype.create=function(e,t,n){var i=this._getChildrenContainer(t.parent);return this._createContainer(e,i,n,Wv(t))};Jt.prototype.updateContainments=function(e){var t=this,n=this._elementRegistry,i;i=Ht(e,function(a,r){return r.parent&&(a[r.parent.id]=r.parent),a},{}),B(i,function(a){var r=a.children;if(r){var o=t._getChildrenContainer(a);B(r.slice().reverse(),function(s){var u=n.getGraphics(s);pg(u.parentNode,o)})}})};Jt.prototype.drawShape=function(e,t){var n=this._eventBus;return n.fire("render.shape",{gfx:e,element:t})};Jt.prototype.getShapePath=function(e){var t=this._eventBus;return t.fire("render.getShapePath",e)};Jt.prototype.drawConnection=function(e,t){var n=this._eventBus;return n.fire("render.connection",{gfx:e,element:t})};Jt.prototype.getConnectionPath=function(e){var t=this._eventBus;return t.fire("render.getConnectionPath",e)};Jt.prototype.update=function(e,t,n){if(t.parent){var i=this._clear(n);if(e==="shape")this.drawShape(i,t),Ft(n,t.x,t.y);else if(e==="connection")this.drawConnection(i,t);else throw new Error("unknown type: "+e);t.hidden?ee(n,"display","none"):ee(n,"display","block")}};Jt.prototype.remove=function(e){var t=this._elementRegistry.getGraphics(e);tt(t.parentNode)};function pg(e,t,n){var i=n||t.firstChild;e!==i&&t.insertBefore(e,i)}const aS={__depends__:[Cx],__init__:["canvas"],canvas:["type",be],elementRegistry:["type",Zt],elementFactory:["type",ni],eventBus:["type",zt],graphicsFactory:["type",Jt]};function oS(e){var t=[],n=[];function i(s){return t.indexOf(s)>=0}function a(s){t.push(s)}function r(s){i(s)||((s.__depends__||[]).forEach(r),!i(s)&&(a(s),(s.__init__||[]).forEach(function(u){n.push(u)})))}e.forEach(r);var o=new gc(t);return n.forEach(function(s){try{o[typeof s=="string"?"get":"invoke"](s)}catch(u){throw console.error("Failed to instantiate component"),console.error(u.stack),u}}),o}function sS(e){e=e||{};var t={config:["value",e]},n=[t,aS].concat(e.modules||[]);return oS(n)}function Ur(e,t){this.injector=t=t||sS(e),this.get=t.get,this.invoke=t.invoke,this.get("eventBus").fire("diagram.init")}Ur.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")};Ur.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")};function pp(){}pp.prototype.get=function(e){return this.$model.properties.get(this,e)};pp.prototype.set=function(e,t){this.$model.properties.set(this,e,t)};function fg(e,t){this.model=e,this.properties=t}fg.prototype.createType=function(e){var t=this.model,n=this.properties,i=Object.create(pp.prototype);B(e.properties,function(o){!o.isMany&&o.default!==void 0&&(i[o.name]=o.default)}),n.defineModel(i,t),n.defineDescriptor(i,e);var a=e.ns.name;function r(o){n.define(this,"$type",{value:a,enumerable:!0}),n.define(this,"$attrs",{value:{}}),n.define(this,"$parent",{writable:!0}),B(o,Pt(function(s,u){this.set(u,s)},this))}return r.prototype=i,r.hasType=i.$instanceOf=this.model.hasType,n.defineModel(r,t),n.defineDescriptor(r,e),r};var lS={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0},dg={String:function(e){return e},Boolean:function(e){return e==="true"},Integer:function(e){return parseInt(e,10)},Real:function(e){return parseFloat(e)}};function fp(e,t){var n=dg[e];return n?n(t):t}function Sc(e){return!!lS[e]}function hg(e){return!!dg[e]}function Ot(e,t){var n=e.split(/:/),i,a;if(n.length===1)i=e,a=t;else if(n.length===2)i=n[1],a=n[0];else throw new Error("expected <prefix:localName> or <localName>, got "+e);return e=(a?a+":":"")+i,{name:e,prefix:a,localName:i}}function pn(e){this.ns=e,this.name=e.name,this.allTypes=[],this.allTypesByName={},this.properties=[],this.propertiesByName={}}pn.prototype.build=function(){return cn(this,["ns","name","allTypes","allTypesByName","properties","propertiesByName","bodyProperty","idProperty"])};pn.prototype.addProperty=function(e,t,n){typeof t=="boolean"&&(n=t,t=void 0),this.addNamedProperty(e,n!==!1);var i=this.properties;t!==void 0?i.splice(t,0,e):i.push(e)};pn.prototype.replaceProperty=function(e,t,n){var i=e.ns,a=this.properties,r=this.propertiesByName,o=e.name!==t.name;if(e.isId){if(!t.isId)throw new Error("property <"+t.ns.name+"> must be id property to refine <"+e.ns.name+">");this.setIdProperty(t,!1)}if(e.isBody){if(!t.isBody)throw new Error("property <"+t.ns.name+"> must be body property to refine <"+e.ns.name+">");this.setBodyProperty(t,!1)}var s=a.indexOf(e);if(s===-1)throw new Error("property <"+i.name+"> not found in property list");a.splice(s,1),this.addProperty(t,n?void 0:s,o),r[i.name]=r[i.localName]=t};pn.prototype.redefineProperty=function(e,t,n){var i=e.ns.prefix,a=t.split("#"),r=Ot(a[0],i),o=Ot(a[1],r.prefix).name,s=this.propertiesByName[o];if(s)this.replaceProperty(s,e,n);else throw new Error("refined property <"+o+"> not found");delete e.redefines};pn.prototype.addNamedProperty=function(e,t){var n=e.ns,i=this.propertiesByName;t&&(this.assertNotDefined(e,n.name),this.assertNotDefined(e,n.localName)),i[n.name]=i[n.localName]=e};pn.prototype.removeNamedProperty=function(e){var t=e.ns,n=this.propertiesByName;delete n[t.name],delete n[t.localName]};pn.prototype.setBodyProperty=function(e,t){if(t&&this.bodyProperty)throw new Error("body property defined multiple times (<"+this.bodyProperty.ns.name+">, <"+e.ns.name+">)");this.bodyProperty=e};pn.prototype.setIdProperty=function(e,t){if(t&&this.idProperty)throw new Error("id property defined multiple times (<"+this.idProperty.ns.name+">, <"+e.ns.name+">)");this.idProperty=e};pn.prototype.assertNotDefined=function(e,t){var n=e.name,i=this.propertiesByName[n];if(i)throw new Error("property <"+n+"> already defined; override of <"+i.definedBy.ns.name+"#"+i.ns.name+"> by <"+e.definedBy.ns.name+"#"+e.ns.name+"> not allowed without redefines")};pn.prototype.hasProperty=function(e){return this.propertiesByName[e]};pn.prototype.addTrait=function(e,t){var n=this.allTypesByName,i=this.allTypes,a=e.name;a in n||(B(e.properties,Pt(function(r){r=G({},r,{name:r.ns.localName,inherited:t}),Object.defineProperty(r,"definedBy",{value:e});var o=r.replaces,s=r.redefines;o||s?this.redefineProperty(r,o||s,o):(r.isBody&&this.setBodyProperty(r),r.isId&&this.setIdProperty(r),this.addProperty(r))},this)),i.push(e),n[a]=e)};function Ci(e,t){this.packageMap={},this.typeMap={},this.packages=[],this.properties=t,B(e,Pt(this.registerPackage,this))}Ci.prototype.getPackage=function(e){return this.packageMap[e]};Ci.prototype.getPackages=function(){return this.packages};Ci.prototype.registerPackage=function(e){e=G({},e);var t=this.packageMap;Hd(t,e,"prefix"),Hd(t,e,"uri"),B(e.types,Pt(function(n){this.registerType(n,e)},this)),t[e.uri]=t[e.prefix]=e,this.packages.push(e)};Ci.prototype.registerType=function(e,t){e=G({},e,{superClass:(e.superClass||[]).slice(),extends:(e.extends||[]).slice(),properties:(e.properties||[]).slice(),meta:G(e.meta||{})});var n=Ot(e.name,t.prefix),i=n.name,a={};B(e.properties,Pt(function(r){var o=Ot(r.name,n.prefix),s=o.name;Sc(r.type)||(r.type=Ot(r.type,o.prefix).name),G(r,{ns:o,name:s}),a[s]=r},this)),G(e,{ns:n,name:i,propertiesByName:a}),B(e.extends,Pt(function(r){var o=this.typeMap[r];o.traits=o.traits||[],o.traits.push(i)},this)),this.definePackage(e,t),this.typeMap[i]=e};Ci.prototype.mapTypes=function(e,t,n){var i=Sc(e.name)?{name:e.name}:this.typeMap[e.name],a=this;function r(s){return o(s,!0)}function o(s,u){var c=Ot(s,Sc(s)?"":e.prefix);a.mapTypes(c,t,u)}if(!i)throw new Error("unknown type <"+e.name+">");B(i.superClass,n?r:o),t(i,!n),B(i.traits,r)};Ci.prototype.getEffectiveDescriptor=function(e){var t=Ot(e),n=new pn(t);this.mapTypes(t,function(a,r){n.addTrait(a,r)});var i=n.build();return this.definePackage(i,i.allTypes[i.allTypes.length-1].$pkg),i};Ci.prototype.definePackage=function(e,t){this.properties.define(e,"$pkg",{value:t})};function Hd(e,t,n){var i=t[n];if(i in e)throw new Error("package with "+n+" <"+i+"> already defined")}function Wr(e){this.model=e}Wr.prototype.set=function(e,t,n){if(!jt(t)||!t.length)throw new TypeError("property name must be a non-empty string");var i=this.model.getPropertyDescriptor(e,t),a=i&&i.name;uS(n)?i?delete e[a]:delete e.$attrs[t]:i?a in e?e[a]=n:mg(e,i,n):e.$attrs[t]=n};Wr.prototype.get=function(e,t){var n=this.model.getPropertyDescriptor(e,t);if(!n)return e.$attrs[t];var i=n.name;return!e[i]&&n.isMany&&mg(e,n,[]),e[i]};Wr.prototype.define=function(e,t,n){if(!n.writable){var i=n.value;n=G({},n,{get:function(){return i}}),delete n.value}Object.defineProperty(e,t,n)};Wr.prototype.defineDescriptor=function(e,t){this.define(e,"$descriptor",{value:t})};Wr.prototype.defineModel=function(e,t){this.define(e,"$model",{value:t})};function uS(e){return typeof e=="undefined"}function mg(e,t,n){Object.defineProperty(e,t.name,{enumerable:!t.isReference,writable:!0,value:n,configurable:!0})}function fn(e){this.properties=new Wr(this),this.factory=new fg(this,this.properties),this.registry=new Ci(e,this.properties),this.typeCache={}}fn.prototype.create=function(e,t){var n=this.getType(e);if(!n)throw new Error("unknown type <"+e+">");return new n(t)};fn.prototype.getType=function(e){var t=this.typeCache,n=jt(e)?e:e.ns.name,i=t[n];return i||(e=this.registry.getEffectiveDescriptor(n),i=t[n]=this.factory.createType(e)),i};fn.prototype.createAny=function(e,t,n){var i=Ot(e),a={$type:e,$instanceOf:function(o){return o===this.$type}},r={name:e,isGeneric:!0,ns:{prefix:i.prefix,localName:i.localName,uri:t}};return this.properties.defineDescriptor(a,r),this.properties.defineModel(a,this),this.properties.define(a,"$parent",{enumerable:!1,writable:!0}),this.properties.define(a,"$instanceOf",{enumerable:!1,writable:!0}),B(n,function(o,s){nt(o)&&o.value!==void 0?a[o.name]=o.value:a[s]=o}),a};fn.prototype.getPackage=function(e){return this.registry.getPackage(e)};fn.prototype.getPackages=function(){return this.registry.getPackages()};fn.prototype.getElementDescriptor=function(e){return e.$descriptor};fn.prototype.hasType=function(e,t){t===void 0&&(t=e,e=this);var n=e.$model.getElementDescriptor(e);return t in n.allTypesByName};fn.prototype.getPropertyDescriptor=function(e,t){return this.getElementDescriptor(e).propertiesByName[t]};fn.prototype.getTypeDescriptor=function(e){return this.registry.typeMap[e]};var zd=String.fromCharCode,cS=Object.prototype.hasOwnProperty,pS=/&#(\d+);|&#x([0-9a-f]+);|&(\w+);/ig,Na={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'};Object.keys(Na).forEach(function(e){Na[e.toUpperCase()]=Na[e]});function fS(e,t,n,i){return i?cS.call(Na,i)?Na[i]:"&"+i+";":zd(t||parseInt(n,16))}function ji(e){return e.length>3&&e.indexOf("&")!==-1?e.replace(pS,fS):e}var dS="http://www.w3.org/2001/XMLSchema-instance",hS="xsi",Gd="xsi:type",Ud="non-whitespace outside of root node";function yr(e){return new Error(e)}function Wd(e){return"missing namespace for prefix <"+e+">"}function qo(e){return{get:e,enumerable:!0}}function mS(e){var t={},n;for(n in e)t[n]=e[n];return t}function wc(e){return e+"$uri"}function vS(e){var t={},n,i;for(n in e)i=e[n],t[i]=i,t[wc(i)]=n;return t}function qd(){return{line:0,column:0}}function gS(e){throw e}function vg(e){if(!this)return new vg(e);var t=e&&e.proxy,n,i,a,r,o=gS,s,u,c,p,f=qd,m=!1,v=!1,g=null,b=!1,_;function k(S){S instanceof Error||(S=yr(S)),g=S,o(S,f)}function N(S){s&&(S instanceof Error||(S=yr(S)),s(S,f))}this.on=function(S,C){if(typeof C!="function")throw yr("required args <name, cb>");switch(S){case"openTag":i=C;break;case"text":n=C;break;case"closeTag":a=C;break;case"error":o=C;break;case"warn":s=C;break;case"cdata":r=C;break;case"attention":p=C;break;case"question":c=C;break;case"comment":u=C;break;default:throw yr("unsupported event: "+S)}return this},this.ns=function(S){if(typeof S=="undefined"&&(S={}),typeof S!="object")throw yr("required args <nsMap={}>");var C={},D;for(D in S)C[D]=S[D];return C[dS]=hS,v=!0,_=C,this},this.parse=function(S){if(typeof S!="string")throw yr("required args <xml=string>");return g=null,A(S),f=qd,b=!1,g},this.stop=function(){b=!0};function A(S){var C=v?[]:null,D=v?vS(_):null,$,M=[],V=0,K=!1,X=!1,z=0,U=0,Q,l,d,E,y,h,x,I,F,O="",H=0,W;function Y(){if(W!==null)return W;var Fe,_e,we,ft=v&&D.xmlns,dt=v&&m?[]:null,De=H,ze=O,It=ze.length,Nt,Ct,Ye,Ut,Re,ut={},ko={},Wt,ue,ke;e:for(;De<It;De++)if(Wt=!1,ue=ze.charCodeAt(De),!(ue===32||ue<14&&ue>8)){for((ue<65||ue>122||ue>90&&ue<97)&&ue!==95&&ue!==58&&(N("illegal first char attribute name"),Wt=!0),ke=De+1;ke<It;ke++)if(ue=ze.charCodeAt(ke),!(ue>96&&ue<123||ue>64&&ue<91||ue>47&&ue<59||ue===46||ue===45||ue===95)){if(ue===32||ue<14&&ue>8){N("missing attribute value"),De=ke;continue e}if(ue===61)break;N("illegal attribute name char"),Wt=!0}if(Re=ze.substring(De,ke),Re==="xmlns:xmlns"&&(N("illegal declaration of xmlns"),Wt=!0),ue=ze.charCodeAt(ke+1),ue===34)ke=ze.indexOf('"',De=ke+2),ke===-1&&(ke=ze.indexOf("'",De),ke!==-1&&(N("attribute value quote missmatch"),Wt=!0));else if(ue===39)ke=ze.indexOf("'",De=ke+2),ke===-1&&(ke=ze.indexOf('"',De),ke!==-1&&(N("attribute value quote missmatch"),Wt=!0));else for(N("missing attribute value quotes"),Wt=!0,ke=ke+1;ke<It&&(ue=ze.charCodeAt(ke+1),!(ue===32||ue<14&&ue>8));ke++);for(ke===-1&&(N("missing closing quotes"),ke=It,Wt=!0),Wt||(Ye=ze.substring(De,ke)),De=ke;ke+1<It&&(ue=ze.charCodeAt(ke+1),!(ue===32||ue<14&&ue>8));ke++)De===ke&&(N("illegal character after attribute end"),Wt=!0);if(De=ke+1,Wt)continue e;if(Re in ko){N("attribute <"+Re+"> already defined");continue}if(ko[Re]=!0,!v){ut[Re]=Ye;continue}if(m){if(Ct=Re==="xmlns"?"xmlns":Re.charCodeAt(0)===120&&Re.substr(0,6)==="xmlns:"?Re.substr(6):null,Ct!==null){if(Fe=ji(Ye),_e=wc(Ct),Ut=_[Fe],!Ut){if(Ct==="xmlns"||_e in D&&D[_e]!==Fe)do Ut="ns"+V++;while(typeof D[Ut]!="undefined");else Ut=Ct;_[Fe]=Ut}D[Ct]!==Ut&&(Nt||(D=mS(D),Nt=!0),D[Ct]=Ut,Ct==="xmlns"&&(D[wc(Ut)]=Fe,ft=Ut),D[_e]=Fe),ut[Re]=Ye;continue}dt.push(Re,Ye);continue}if(ue=Re.indexOf(":"),ue===-1){ut[Re]=Ye;continue}if(!(we=D[Re.substring(0,ue)])){N(Wd(Re.substring(0,ue)));continue}Re=ft===we?Re.substr(ue+1):we+Re.substr(ue),Re===Gd&&(ue=Ye.indexOf(":"),ue!==-1?(we=Ye.substring(0,ue),we=D[we]||we,Ye=we+Ye.substring(ue)):Ye=ft+":"+Ye),ut[Re]=Ye}if(m)for(De=0,It=dt.length;De<It;De++){if(Re=dt[De++],Ye=dt[De],ue=Re.indexOf(":"),ue!==-1){if(!(we=D[Re.substring(0,ue)])){N(Wd(Re.substring(0,ue)));continue}Re=ft===we?Re.substr(ue+1):we+Re.substr(ue),Re===Gd&&(ue=Ye.indexOf(":"),ue!==-1?(we=Ye.substring(0,ue),we=D[we]||we,Ye=we+Ye.substring(ue)):Ye=ft+":"+Ye)}ut[Re]=Ye}return W=ut}function he(){for(var Fe=/(\r\n|\r|\n)/g,_e=0,we=0,ft=0,dt=U,De,ze;z>=ft&&(De=Fe.exec(S),!(!De||(dt=De[0].length+De.index,dt>z)));)_e+=1,ft=dt;return z==-1?(we=dt,ze=S.substring(U)):U===0?ze=S.substring(U,z):(we=z-ft,ze=U==-1?S.substring(z):S.substring(z,U+1)),{data:ze,line:_e,column:we}}for(f=he,t&&(F=Object.create({},{name:qo(function(){return x}),originalName:qo(function(){return I}),attrs:qo(Y),ns:qo(function(){return D})}));U!==-1;){if(S.charCodeAt(U)===60?z=U:z=S.indexOf("<",U),z===-1){if(M.length)return k("unexpected end of file");if(U===0)return k("missing start tag");U<S.length&&S.substring(U).trim()&&N(Ud);return}if(U!==z){if(M.length){if(n&&(n(S.substring(U,z),ji,f),b))return}else if(S.substring(U,z).trim()&&(N(Ud),b))return}if(E=S.charCodeAt(z+1),E===33){if(d=S.charCodeAt(z+2),d===91&&S.substr(z+3,6)==="CDATA["){if(U=S.indexOf("]]>",z),U===-1)return k("unclosed cdata");if(r&&(r(S.substring(z+9,U),f),b))return;U+=3;continue}if(d===45&&S.charCodeAt(z+3)===45){if(U=S.indexOf("-->",z),U===-1)return k("unclosed comment");if(u&&(u(S.substring(z+4,U),ji,f),b))return;U+=3;continue}}if(E===63){if(U=S.indexOf("?>",z),U===-1)return k("unclosed question");if(c&&(c(S.substring(z,U+2),f),b))return;U+=2;continue}for(Q=z+1;;Q++){if(y=S.charCodeAt(Q),isNaN(y))return U=-1,k("unclosed tag");if(y===34)d=S.indexOf('"',Q+1),Q=d!==-1?d:Q;else if(y===39)d=S.indexOf("'",Q+1),Q=d!==-1?d:Q;else if(y===62){U=Q;break}}if(E===33){if(p&&(p(S.substring(z,U+1),ji,f),b))return;U+=1;continue}if(W={},E===47){if(K=!1,X=!0,!M.length)return k("missing open tag");if(Q=x=M.pop(),d=z+2+Q.length,S.substring(z+2,d)!==Q)return k("closing tag mismatch");for(;d<U;d++)if(E=S.charCodeAt(d),!(E===32||E>8&&E<14))return k("close tag")}else{if(S.charCodeAt(U-1)===47?(Q=x=S.substring(z+1,U-1),K=!0,X=!0):(Q=x=S.substring(z+1,U),K=!0,X=!1),!(E>96&&E<123||E>64&&E<91||E===95||E===58))return k("illegal first char nodeName");for(d=1,l=Q.length;d<l;d++)if(E=Q.charCodeAt(d),!(E>96&&E<123||E>64&&E<91||E>47&&E<59||E===45||E===95||E==46)){if(E===32||E<14&&E>8){x=Q.substring(0,d),W=null;break}return k("invalid nodeName")}X||M.push(x)}if(v){if($=D,K&&(X||C.push($),W===null&&(m=Q.indexOf("xmlns",d)!==-1)&&(H=d,O=Q,Y(),m=!1)),I=x,E=x.indexOf(":"),E!==-1){if(h=D[x.substring(0,E)],!h)return k("missing namespace on <"+I+">");x=x.substr(E+1)}else h=D.xmlns;h&&(x=h+":"+x)}if(K&&(H=d,O=Q,i&&(t?i(F,ji,X,f):i(x,Y,ji,X,f),b)))return;if(X){if(a&&(a(t?F:x,ji,K,f),b))return;v&&(K?D=$:D=C.pop())}U+=1}}}function gg(e){return e.xml&&e.xml.tagAlias==="lowerCase"}var yS={xsi:"http://www.w3.org/2001/XMLSchema-instance",xml:"http://www.w3.org/XML/1998/namespace"},cl="xsi:type";function yg(e){return e.xml&&e.xml.serialize}function Eg(e){return yg(e)===cl}function ES(e){return yg(e)==="property"}function bS(e){return e.charAt(0).toUpperCase()+e.slice(1)}function bg(e,t){return gg(t)?e.prefix+":"+bS(e.localName):e.name}function _S(e,t){var n=e.name,i=e.localName,a=t.xml&&t.xml.typePrefix;return a&&i.indexOf(a)===0?e.prefix+":"+i.slice(a.length):n}function xS(e,t){var n=Ot(e),i=t.getPackage(n.prefix);return _S(n,i)}function _i(e){return new Error(e)}function Xn(e){return e.$descriptor}function SS(e){G(this,e),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(t){this.references.push(t)},this.addElement=function(t){if(!t)throw _i("expected element");var n=this.elementsById,i=Xn(t),a=i.idProperty,r;if(a&&(r=t.get(a.name),r)){if(!/^([a-z][\w-.]*:)?[a-z_][\w-.]*$/i.test(r))throw new Error("illegal ID <"+r+">");if(n[r])throw _i("duplicate ID <"+r+">");n[r]=t}},this.addWarning=function(t){this.warnings.push(t)}}function Qa(){}Qa.prototype.handleEnd=function(){};Qa.prototype.handleText=function(){};Qa.prototype.handleNode=function(){};function dp(){}dp.prototype=Object.create(Qa.prototype);dp.prototype.handleNode=function(){return this};function qr(){}qr.prototype=Object.create(Qa.prototype);qr.prototype.handleText=function(e){this.body=(this.body||"")+e};function eo(e,t){this.property=e,this.context=t}eo.prototype=Object.create(qr.prototype);eo.prototype.handleNode=function(e){if(this.element)throw _i("expected no sub nodes");return this.element=this.createReference(e),this};eo.prototype.handleEnd=function(){this.element.id=this.body};eo.prototype.createReference=function(e){return{property:this.property.ns.name,id:""}};function hp(e,t){this.element=t,this.propertyDesc=e}hp.prototype=Object.create(qr.prototype);hp.prototype.handleEnd=function(){var e=this.body||"",t=this.element,n=this.propertyDesc;e=fp(n.type,e),n.isMany?t.get(n.name).push(e):t.set(n.name,e)};function pl(){}pl.prototype=Object.create(qr.prototype);pl.prototype.handleNode=function(e){var t=this,n=this.element;return n?t=this.handleChild(e):(n=this.element=this.createElement(e),this.context.addElement(n)),t};function Rt(e,t,n){this.model=e,this.type=e.getType(t),this.context=n}Rt.prototype=Object.create(pl.prototype);Rt.prototype.addReference=function(e){this.context.addReference(e)};Rt.prototype.handleText=function(e){var t=this.element,n=Xn(t),i=n.bodyProperty;if(!i)throw _i("unexpected body text <"+e+">");qr.prototype.handleText.call(this,e)};Rt.prototype.handleEnd=function(){var e=this.body,t=this.element,n=Xn(t),i=n.bodyProperty;i&&e!==void 0&&(e=fp(i.type,e),t.set(i.name,e))};Rt.prototype.createElement=function(e){var t=e.attributes,n=this.type,i=Xn(n),a=this.context,r=new n({}),o=this.model,s;return B(t,function(u,c){var p=i.propertiesByName[c],f;p&&p.isReference?p.isMany?(f=u.split(" "),B(f,function(m){a.addReference({element:r,property:p.ns.name,id:m})})):a.addReference({element:r,property:p.ns.name,id:u}):(p?u=fp(p.type,u):c!=="xmlns"&&(s=Ot(c,i.ns.prefix),o.getPackage(s.prefix)&&a.addWarning({message:"unknown attribute <"+c+">",element:r,property:c,value:u})),r.set(c,u))}),r};Rt.prototype.getPropertyForNode=function(e){var t=e.name,n=Ot(t),i=this.type,a=this.model,r=Xn(i),o=n.name,s=r.propertiesByName[o],u,c;if(s&&!s.isAttr)return Eg(s)&&(u=e.attributes[cl],u)?(u=xS(u,a),c=a.getType(u),G({},s,{effectiveType:Xn(c).name})):s;var p=a.getPackage(n.prefix);if(p){if(u=bg(n,p),c=a.getType(u),s=Me(r.properties,function(f){return!f.isVirtual&&!f.isReference&&!f.isAttribute&&c.hasType(f.type)}),s)return G({},s,{effectiveType:Xn(c).name})}else if(s=Me(r.properties,function(f){return!f.isReference&&!f.isAttribute&&f.type==="Element"}),s)return s;throw _i("unrecognized element <"+n.name+">")};Rt.prototype.toString=function(){return"ElementDescriptor["+Xn(this.type).name+"]"};Rt.prototype.valueHandler=function(e,t){return new hp(e,t)};Rt.prototype.referenceHandler=function(e){return new eo(e,this.context)};Rt.prototype.handler=function(e){return e==="Element"?new Mr(this.model,e,this.context):new Rt(this.model,e,this.context)};Rt.prototype.handleChild=function(e){var t,n,i,a;if(t=this.getPropertyForNode(e),i=this.element,n=t.effectiveType||t.type,hg(n))return this.valueHandler(t,i);t.isReference?a=this.referenceHandler(t).handleNode(e):a=this.handler(n).handleNode(e);var r=a.element;return r!==void 0&&(t.isMany?i.get(t.name).push(r):i.set(t.name,r),t.isReference?(G(r,{element:i}),this.context.addReference(r)):r.$parent=i),a};function mp(e,t,n){Rt.call(this,e,t,n)}mp.prototype=Object.create(Rt.prototype);mp.prototype.createElement=function(e){var t=e.name,n=Ot(t),i=this.model,a=this.type,r=i.getPackage(n.prefix),o=r&&bg(n,r)||t;if(!a.hasType(o))throw _i("unexpected element <"+e.originalName+">");return Rt.prototype.createElement.call(this,e)};function Mr(e,t,n){this.model=e,this.context=n}Mr.prototype=Object.create(pl.prototype);Mr.prototype.createElement=function(e){var t=e.name,n=Ot(t),i=n.prefix,a=e.ns[i+"$uri"],r=e.attributes;return this.model.createAny(t,a,r)};Mr.prototype.handleChild=function(e){var t=new Mr(this.model,"Element",this.context).handleNode(e),n=this.element,i=t.element,a;return i!==void 0&&(a=n.$children=n.$children||[],a.push(i),i.$parent=n),t};Mr.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body)};function vp(e){e instanceof fn&&(e={model:e}),G(this,{lax:!1},e)}vp.prototype.fromXML=function(e,t,n){var i=t.rootHandler;t instanceof Rt?(i=t,t={}):typeof t=="string"?(i=this.handler(t),t={}):typeof i=="string"&&(i=this.handler(i));var a=this.model,r=this.lax,o=new SS(G({},t,{rootHandler:i})),s=new vg({proxy:!0}),u=wS();i.context=o,u.push(i);function c(C,D,$){var M=D(),V=M.line,K=M.column,X=M.data;X.charAt(0)==="<"&&X.indexOf(" ")!==-1&&(X=X.slice(0,X.indexOf(" "))+">");var z="unparsable content "+(X?X+" ":"")+`detected
	line: `+V+`
	column: `+K+`
	nested error: `+C.message;if($)return o.addWarning({message:z,error:C}),!0;throw _i(z)}function p(C,D){return c(C,D,!0)}function f(){var C=o.elementsById,D=o.references,$,M;for($=0;M=D[$];$++){var V=M.element,K=C[M.id],X=Xn(V).propertiesByName[M.property];if(K||o.addWarning({message:"unresolved reference <"+M.id+">",element:M.element,property:M.property,value:M.id}),X.isMany){var z=V.get(X.name),U=z.indexOf(M);U===-1&&(U=z.length),K?z[U]=K:z.splice(U,1)}else V.set(X.name,K)}}function m(){u.pop().handleEnd()}var v=/^<\?xml /i,g=/ encoding="([^"]+)"/i,b=/^utf-8$/i;function _(C){if(v.test(C)){var D=g.exec(C),$=D&&D[1];!$||b.test($)||o.addWarning({message:"unsupported document encoding <"+$+">, falling back to UTF-8"})}}function k(C,D){var $=u.peek();try{u.push($.handleNode(C))}catch(M){c(M,D,r)&&u.push(new dp)}}function N(C,D){try{u.peek().handleText(C)}catch($){p($,D)}}function A(C,D){C.trim()&&N(C,D)}var S=a.getPackages().reduce(function(C,D){return C[D.uri]=D.prefix,C},{"http://www.w3.org/XML/1998/namespace":"xml"});return s.ns(S).on("openTag",function(C,D,$,M){var V=C.attrs||{},K=Object.keys(V).reduce(function(z,U){var Q=D(V[U]);return z[U]=Q,z},{}),X={name:C.name,originalName:C.originalName,attributes:K,ns:C.ns};k(X,M)}).on("question",_).on("closeTag",m).on("cdata",N).on("text",function(C,D,$){A(D(C),$)}).on("error",c).on("warn",p),new Promise(function(C,D){var $;try{s.parse(e),f()}catch(z){$=z}var M=i.element;!$&&!M&&($=_i("failed to parse document as <"+i.type.$descriptor.name+">"));var V=o.warnings,K=o.references,X=o.elementsById;return $?($.warnings=V,D($)):C({rootElement:M,elementsById:X,references:K,warnings:V})})};vp.prototype.handler=function(e){return new mp(this.model,e)};function wS(){var e=[];return Object.defineProperty(e,"peek",{value:function(){return this[this.length-1]}}),e}var TS=`<?xml version="1.0" encoding="UTF-8"?>
`,CS=/<|>|'|"|&|\n\r|\n/g,_g=/<|>|&/g;function AS(e){var t={},n={},i={},a=[],r=[];this.byUri=function(o){return n[o]||e&&e.byUri(o)},this.add=function(o,s){n[o.uri]=o,s?a.push(o):r.push(o),this.mapPrefix(o.prefix,o.uri)},this.uriByPrefix=function(o){return t[o||"xmlns"]},this.mapPrefix=function(o,s){t[o||"xmlns"]=s},this.getNSKey=function(o){return o.prefix!==void 0?o.uri+"|"+o.prefix:o.uri},this.logUsed=function(o){var s=o.uri,u=this.getNSKey(o);i[u]=this.byUri(s),e&&e.logUsed(o)},this.getUsed=function(o){function s(p){var f=u.getNSKey(p);return i[f]}var u=this,c=[].concat(a,r);return c.filter(s)}}function PS(e){return e.charAt(0).toLowerCase()+e.slice(1)}function RS(e,t){return gg(t)?PS(e):e}function xg(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function Sg(e){return jt(e)?e:(e.prefix?e.prefix+":":"")+e.localName}function IS(e){return e.getUsed().filter(function(t){return t.prefix!=="xml"}).map(function(t){var n="xmlns"+(t.prefix?":"+t.prefix:"");return{name:n,value:t.uri}})}function NS(e,t){return t.isGeneric?G({localName:t.ns.localName},e):G({localName:RS(t.ns.localName,t.$pkg)},e)}function MS(e,t){return G({localName:t.ns.localName},e)}function kS(e){var t=e.$descriptor;return ge(t.properties,function(n){var i=n.name;if(n.isVirtual||!kn(e,i))return!1;var a=e[i];return a===n.default||a===null?!1:n.isMany?a.length:!0})}var DS={"\n":"#10","\n\r":"#10",'"':"#34","'":"#39","<":"#60",">":"#62","&":"#38"},OS={"<":"lt",">":"gt","&":"amp"};function wg(e,t,n){return e=jt(e)?e:""+e,e.replace(t,function(i){return"&"+n[i]+";"})}function LS(e){return wg(e,CS,DS)}function BS(e){return wg(e,_g,OS)}function $S(e){return ge(e,function(t){return t.isAttr})}function VS(e){return ge(e,function(t){return!t.isAttr})}function gp(e){this.tagName=e}gp.prototype.build=function(e){return this.element=e,this};gp.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"+this.element.id+"</"+this.tagName+">").appendNewLine()};function Zi(){}Zi.prototype.serializeValue=Zi.prototype.serializeTo=function(e){e.append(this.escape?BS(this.value):this.value)};Zi.prototype.build=function(e,t){return this.value=t,e.type==="String"&&t.search(_g)!==-1&&(this.escape=!0),this};function yp(e){this.tagName=e}xg(yp,Zi);yp.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"),this.serializeValue(e),e.append("</"+this.tagName+">").appendNewLine()};function Ue(e,t){this.body=[],this.attrs=[],this.parent=e,this.propertyDescriptor=t}Ue.prototype.build=function(e){this.element=e;var t=e.$descriptor,n=this.propertyDescriptor,i,a,r=t.isGeneric;return r?i=this.parseGeneric(e):i=this.parseNsAttributes(e),n?this.ns=this.nsPropertyTagName(n):this.ns=this.nsTagName(t),this.tagName=this.addTagName(this.ns),r||(a=kS(e),this.parseAttributes($S(a)),this.parseContainments(VS(a))),this.parseGenericAttributes(e,i),this};Ue.prototype.nsTagName=function(e){var t=this.logNamespaceUsed(e.ns);return NS(t,e)};Ue.prototype.nsPropertyTagName=function(e){var t=this.logNamespaceUsed(e.ns);return MS(t,e)};Ue.prototype.isLocalNs=function(e){return e.uri===this.ns.uri};Ue.prototype.nsAttributeName=function(e){var t;if(jt(e)?t=Ot(e):t=e.ns,e.inherited)return{localName:t.localName};var n=this.logNamespaceUsed(t);return this.getNamespaces().logUsed(n),this.isLocalNs(n)?{localName:t.localName}:G({localName:t.localName},n)};Ue.prototype.parseGeneric=function(e){var t=this,n=this.body,i=[];return B(e,function(a,r){var o;r==="$body"?n.push(new Zi().build({type:"String"},a)):r==="$children"?B(a,function(s){n.push(new Ue(t).build(s))}):r.indexOf("$")!==0&&(o=t.parseNsAttribute(e,r,a),o&&i.push({name:r,value:a}))}),i};Ue.prototype.parseNsAttribute=function(e,t,n){var i=e.$model,a=Ot(t),r;if(a.prefix==="xmlns"&&(r={prefix:a.localName,uri:n}),!a.prefix&&a.localName==="xmlns"&&(r={uri:n}),!r)return{name:t,value:n};if(i&&i.getPackage(n))this.logNamespace(r,!0,!0);else{var o=this.logNamespaceUsed(r,!0);this.getNamespaces().logUsed(o)}};Ue.prototype.parseNsAttributes=function(e,t){var n=this,i=e.$attrs,a=[];return B(i,function(r,o){var s=n.parseNsAttribute(e,o,r);s&&a.push(s)}),a};Ue.prototype.parseGenericAttributes=function(e,t){var n=this;B(t,function(i){if(i.name!==cl)try{n.addAttribute(n.nsAttributeName(i.name),i.value)}catch(a){console.warn("missing namespace information for ",i.name,"=",i.value,"on",e,a)}})};Ue.prototype.parseContainments=function(e){var t=this,n=this.body,i=this.element;B(e,function(a){var r=i.get(a.name),o=a.isReference,s=a.isMany;if(s||(r=[r]),a.isBody)n.push(new Zi().build(a,r[0]));else if(hg(a.type))B(r,function(p){n.push(new yp(t.addTagName(t.nsPropertyTagName(a))).build(a,p))});else if(o)B(r,function(p){n.push(new gp(t.addTagName(t.nsPropertyTagName(a))).build(p))});else{var u=Eg(a),c=ES(a);B(r,function(p){var f;u?f=new fl(t,a):c?f=new Ue(t,a):f=new Ue(t),n.push(f.build(p))})}})};Ue.prototype.getNamespaces=function(e){var t=this.namespaces,n=this.parent,i;return t||(i=n&&n.getNamespaces(),e||!i?this.namespaces=t=new AS(i):t=i),t};Ue.prototype.logNamespace=function(e,t,n){var i=this.getNamespaces(n),a=e.uri,r=e.prefix,o=i.byUri(a);return(!o||n)&&i.add(e,t),i.mapPrefix(r,a),e};Ue.prototype.logNamespaceUsed=function(e,t){var n=this.element,i=n.$model,a=this.getNamespaces(t),r=e.prefix,o=e.uri,s,u,c;if(!r&&!o)return{localName:e.localName};if(c=yS[r]||i&&(i.getPackage(r)||{}).uri,o=o||c||a.uriByPrefix(r),!o)throw new Error("no namespace uri given for prefix <"+r+">");if(e=a.byUri(o),!e){for(s=r,u=1;a.uriByPrefix(s);)s=r+"_"+u++;e=this.logNamespace({prefix:s,uri:o},c===o)}return r&&a.mapPrefix(r,o),e};Ue.prototype.parseAttributes=function(e){var t=this,n=this.element;B(e,function(i){var a=n.get(i.name);if(i.isReference)if(!i.isMany)a=a.id;else{var r=[];B(a,function(o){r.push(o.id)}),a=r.join(" ")}t.addAttribute(t.nsAttributeName(i),a)})};Ue.prototype.addTagName=function(e){var t=this.logNamespaceUsed(e);return this.getNamespaces().logUsed(t),Sg(e)};Ue.prototype.addAttribute=function(e,t){var n=this.attrs;jt(t)&&(t=LS(t));var i=Xc(n,function(r){return r.name.localName===e.localName&&r.name.uri===e.uri&&r.name.prefix===e.prefix}),a={name:e,value:t};i!==-1?n.splice(i,1,a):n.push(a)};Ue.prototype.serializeAttributes=function(e){var t=this.attrs,n=this.namespaces;n&&(t=IS(n).concat(t)),B(t,function(i){e.append(" ").append(Sg(i.name)).append('="').append(i.value).append('"')})};Ue.prototype.serializeTo=function(e){var t=this.body[0],n=t&&t.constructor!==Zi;e.appendIndent().append("<"+this.tagName),this.serializeAttributes(e),e.append(t?">":" />"),t&&(n&&e.appendNewLine().indent(),B(this.body,function(i){i.serializeTo(e)}),n&&e.unindent().appendIndent(),e.append("</"+this.tagName+">")),e.appendNewLine()};function fl(e,t){Ue.call(this,e,t)}xg(fl,Ue);fl.prototype.parseNsAttributes=function(e){var t=Ue.prototype.parseNsAttributes.call(this,e),n=e.$descriptor;if(n.name===this.propertyDescriptor.type)return t;var i=this.typeNs=this.nsTagName(n);this.getNamespaces().logUsed(this.typeNs);var a=e.$model.getPackage(i.uri),r=a.xml&&a.xml.typePrefix||"";return this.addAttribute(this.nsAttributeName(cl),(i.prefix?i.prefix+":":"")+r+n.ns.localName),t};fl.prototype.isLocalNs=function(e){return e.uri===(this.typeNs||this.ns).uri};function FS(){this.value="",this.write=function(e){this.value+=e}}function jS(e,t){var n=[""];this.append=function(i){return e.write(i),this},this.appendNewLine=function(){return t&&e.write(`
`),this},this.appendIndent=function(){return t&&e.write(n.join("  ")),this},this.indent=function(){return n.push(""),this},this.unindent=function(){return n.pop(),this}}function HS(e){e=G({format:!1,preamble:!0},e||{});function t(n,i){var a=i||new FS,r=new jS(a,e.format);if(e.preamble&&r.append(TS),new Ue().build(n).serializeTo(r),!i)return a.value}return{toXML:t}}function dl(e,t){fn.call(this,e,t)}dl.prototype=Object.create(fn.prototype);dl.prototype.fromXML=function(e,t,n){jt(t)||(n=t,t="bpmn:Definitions");var i=new vp(G({model:this,lax:!0},n)),a=i.handler(t);return i.fromXML(e,a)};dl.prototype.toXML=function(e,t){var n=new HS(t);return new Promise(function(i,a){try{var r=n.toXML(e);return i({xml:r})}catch(o){return a(o)}})};var zS="BPMN20",GS="http://www.omg.org/spec/BPMN/20100524/MODEL",US="bpmn",WS=[],qS=[{name:"Interface",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"operations",type:"Operation",isMany:!0},{name:"implementationRef",isAttr:!0,type:"String"}]},{name:"Operation",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"inMessageRef",type:"Message",isReference:!0},{name:"outMessageRef",type:"Message",isReference:!0},{name:"errorRef",type:"Error",isMany:!0,isReference:!0},{name:"implementationRef",isAttr:!0,type:"String"}]},{name:"EndPoint",superClass:["RootElement"]},{name:"Auditing",superClass:["BaseElement"]},{name:"GlobalTask",superClass:["CallableElement"],properties:[{name:"resources",type:"ResourceRole",isMany:!0}]},{name:"Monitoring",superClass:["BaseElement"]},{name:"Performer",superClass:["ResourceRole"]},{name:"Process",superClass:["FlowElementsContainer","CallableElement"],properties:[{name:"processType",type:"ProcessType",isAttr:!0},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"properties",type:"Property",isMany:!0},{name:"laneSets",isMany:!0,replaces:"FlowElementsContainer#laneSets",type:"LaneSet"},{name:"flowElements",isMany:!0,replaces:"FlowElementsContainer#flowElements",type:"FlowElement"},{name:"artifacts",type:"Artifact",isMany:!0},{name:"resources",type:"ResourceRole",isMany:!0},{name:"correlationSubscriptions",type:"CorrelationSubscription",isMany:!0},{name:"supports",type:"Process",isMany:!0,isReference:!0},{name:"definitionalCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"isExecutable",isAttr:!0,type:"Boolean"}]},{name:"LaneSet",superClass:["BaseElement"],properties:[{name:"lanes",type:"Lane",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Lane",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"partitionElementRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"partitionElement",type:"BaseElement"},{name:"flowNodeRef",type:"FlowNode",isMany:!0,isReference:!0},{name:"childLaneSet",type:"LaneSet",xml:{serialize:"xsi:type"}}]},{name:"GlobalManualTask",superClass:["GlobalTask"]},{name:"ManualTask",superClass:["Task"]},{name:"UserTask",superClass:["Task"],properties:[{name:"renderings",type:"Rendering",isMany:!0},{name:"implementation",isAttr:!0,type:"String"}]},{name:"Rendering",superClass:["BaseElement"]},{name:"HumanPerformer",superClass:["Performer"]},{name:"PotentialOwner",superClass:["HumanPerformer"]},{name:"GlobalUserTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"renderings",type:"Rendering",isMany:!0}]},{name:"Gateway",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"gatewayDirection",type:"GatewayDirection",default:"Unspecified",isAttr:!0}]},{name:"EventBasedGateway",superClass:["Gateway"],properties:[{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"eventGatewayType",type:"EventBasedGatewayType",isAttr:!0,default:"Exclusive"}]},{name:"ComplexGateway",superClass:["Gateway"],properties:[{name:"activationCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ExclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"InclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ParallelGateway",superClass:["Gateway"]},{name:"RootElement",isAbstract:!0,superClass:["BaseElement"]},{name:"Relationship",superClass:["BaseElement"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"direction",type:"RelationshipDirection",isAttr:!0},{name:"source",isMany:!0,isReference:!0,type:"Element"},{name:"target",isMany:!0,isReference:!0,type:"Element"}]},{name:"BaseElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,type:"String",isId:!0},{name:"documentation",type:"Documentation",isMany:!0},{name:"extensionDefinitions",type:"ExtensionDefinition",isMany:!0,isReference:!0},{name:"extensionElements",type:"ExtensionElements"}]},{name:"Extension",properties:[{name:"mustUnderstand",default:!1,isAttr:!0,type:"Boolean"},{name:"definition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"extensionAttributeDefinitions",type:"ExtensionAttributeDefinition",isMany:!0}]},{name:"ExtensionAttributeDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",isAttr:!0,type:"String"},{name:"isReference",default:!1,isAttr:!0,type:"Boolean"},{name:"extensionDefinition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionElements",properties:[{name:"valueRef",isAttr:!0,isReference:!0,type:"Element"},{name:"values",type:"Element",isMany:!0},{name:"extensionAttributeDefinition",type:"ExtensionAttributeDefinition",isAttr:!0,isReference:!0}]},{name:"Documentation",superClass:["BaseElement"],properties:[{name:"text",type:"String",isBody:!0},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Event",isAbstract:!0,superClass:["FlowNode","InteractionNode"],properties:[{name:"properties",type:"Property",isMany:!0}]},{name:"IntermediateCatchEvent",superClass:["CatchEvent"]},{name:"IntermediateThrowEvent",superClass:["ThrowEvent"]},{name:"EndEvent",superClass:["ThrowEvent"]},{name:"StartEvent",superClass:["CatchEvent"],properties:[{name:"isInterrupting",default:!0,isAttr:!0,type:"Boolean"}]},{name:"ThrowEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"inputSet",type:"InputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"CatchEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"parallelMultiple",isAttr:!0,type:"Boolean",default:!1},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"outputSet",type:"OutputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"BoundaryEvent",superClass:["CatchEvent"],properties:[{name:"cancelActivity",default:!0,isAttr:!0,type:"Boolean"},{name:"attachedToRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"EventDefinition",isAbstract:!0,superClass:["RootElement"]},{name:"CancelEventDefinition",superClass:["EventDefinition"]},{name:"ErrorEventDefinition",superClass:["EventDefinition"],properties:[{name:"errorRef",type:"Error",isAttr:!0,isReference:!0}]},{name:"TerminateEventDefinition",superClass:["EventDefinition"]},{name:"EscalationEventDefinition",superClass:["EventDefinition"],properties:[{name:"escalationRef",type:"Escalation",isAttr:!0,isReference:!0}]},{name:"Escalation",properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"escalationCode",isAttr:!0,type:"String"}],superClass:["RootElement"]},{name:"CompensateEventDefinition",superClass:["EventDefinition"],properties:[{name:"waitForCompletion",isAttr:!0,type:"Boolean",default:!0},{name:"activityRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"TimerEventDefinition",superClass:["EventDefinition"],properties:[{name:"timeDate",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeCycle",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeDuration",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"LinkEventDefinition",superClass:["EventDefinition"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"target",type:"LinkEventDefinition",isAttr:!0,isReference:!0},{name:"source",type:"LinkEventDefinition",isMany:!0,isReference:!0}]},{name:"MessageEventDefinition",superClass:["EventDefinition"],properties:[{name:"messageRef",type:"Message",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"ConditionalEventDefinition",superClass:["EventDefinition"],properties:[{name:"condition",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"SignalEventDefinition",superClass:["EventDefinition"],properties:[{name:"signalRef",type:"Signal",isAttr:!0,isReference:!0}]},{name:"Signal",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ImplicitThrowEvent",superClass:["ThrowEvent"]},{name:"DataState",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"ItemAwareElement",superClass:["BaseElement"],properties:[{name:"itemSubjectRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"dataState",type:"DataState"}]},{name:"DataAssociation",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"ItemAwareElement",isMany:!0,isReference:!0},{name:"targetRef",type:"ItemAwareElement",isReference:!0},{name:"transformation",type:"FormalExpression",xml:{serialize:"property"}},{name:"assignment",type:"Assignment",isMany:!0}]},{name:"DataInput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"inputSetRef",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"inputSetWithOptional",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"inputSetWithWhileExecuting",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"DataOutput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"outputSetRef",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"outputSetWithOptional",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"outputSetWithWhileExecuting",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"InputSet",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"dataInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"optionalInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"whileExecutingInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"outputSetRefs",type:"OutputSet",isMany:!0,isReference:!0}]},{name:"OutputSet",superClass:["BaseElement"],properties:[{name:"dataOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"inputSetRefs",type:"InputSet",isMany:!0,isReference:!0},{name:"optionalOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"whileExecutingOutputRefs",type:"DataOutput",isMany:!0,isReference:!0}]},{name:"Property",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"DataInputAssociation",superClass:["DataAssociation"]},{name:"DataOutputAssociation",superClass:["DataAssociation"]},{name:"InputOutputSpecification",superClass:["BaseElement"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"inputSets",type:"InputSet",isMany:!0},{name:"outputSets",type:"OutputSet",isMany:!0}]},{name:"DataObject",superClass:["FlowElement","ItemAwareElement"],properties:[{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"}]},{name:"InputOutputBinding",properties:[{name:"inputDataRef",type:"InputSet",isAttr:!0,isReference:!0},{name:"outputDataRef",type:"OutputSet",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"Assignment",superClass:["BaseElement"],properties:[{name:"from",type:"Expression",xml:{serialize:"xsi:type"}},{name:"to",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"DataStore",superClass:["RootElement","ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"capacity",isAttr:!0,type:"Integer"},{name:"isUnlimited",default:!0,isAttr:!0,type:"Boolean"}]},{name:"DataStoreReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataStoreRef",type:"DataStore",isAttr:!0,isReference:!0}]},{name:"DataObjectReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataObjectRef",type:"DataObject",isAttr:!0,isReference:!0}]},{name:"ConversationLink",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ConversationAssociation",superClass:["BaseElement"],properties:[{name:"innerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0},{name:"outerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0}]},{name:"CallConversation",superClass:["ConversationNode"],properties:[{name:"calledCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"Conversation",superClass:["ConversationNode"]},{name:"SubConversation",superClass:["ConversationNode"],properties:[{name:"conversationNodes",type:"ConversationNode",isMany:!0}]},{name:"ConversationNode",isAbstract:!0,superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"messageFlowRefs",type:"MessageFlow",isMany:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0}]},{name:"GlobalConversation",superClass:["Collaboration"]},{name:"PartnerEntity",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"PartnerRole",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"CorrelationProperty",superClass:["RootElement"],properties:[{name:"correlationPropertyRetrievalExpression",type:"CorrelationPropertyRetrievalExpression",isMany:!0},{name:"name",isAttr:!0,type:"String"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Error",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"errorCode",isAttr:!0,type:"String"}]},{name:"CorrelationKey",superClass:["BaseElement"],properties:[{name:"correlationPropertyRef",type:"CorrelationProperty",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Expression",superClass:["BaseElement"],isAbstract:!1,properties:[{name:"body",isBody:!0,type:"String"}]},{name:"FormalExpression",superClass:["Expression"],properties:[{name:"language",isAttr:!0,type:"String"},{name:"evaluatesToTypeRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Message",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"itemRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"ItemDefinition",superClass:["RootElement"],properties:[{name:"itemKind",type:"ItemKind",isAttr:!0},{name:"structureRef",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"import",type:"Import",isAttr:!0,isReference:!0}]},{name:"FlowElement",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"categoryValueRef",type:"CategoryValue",isMany:!0,isReference:!0}]},{name:"SequenceFlow",superClass:["FlowElement"],properties:[{name:"isImmediate",isAttr:!0,type:"Boolean"},{name:"conditionExpression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"sourceRef",type:"FlowNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"FlowNode",isAttr:!0,isReference:!0}]},{name:"FlowElementsContainer",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"laneSets",type:"LaneSet",isMany:!0},{name:"flowElements",type:"FlowElement",isMany:!0}]},{name:"CallableElement",isAbstract:!0,superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"supportedInterfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"ioBinding",type:"InputOutputBinding",isMany:!0,xml:{serialize:"property"}}]},{name:"FlowNode",isAbstract:!0,superClass:["FlowElement"],properties:[{name:"incoming",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"outgoing",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"lanes",type:"Lane",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"CorrelationPropertyRetrievalExpression",superClass:["BaseElement"],properties:[{name:"messagePath",type:"FormalExpression"},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"CorrelationPropertyBinding",superClass:["BaseElement"],properties:[{name:"dataPath",type:"FormalExpression"},{name:"correlationPropertyRef",type:"CorrelationProperty",isAttr:!0,isReference:!0}]},{name:"Resource",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"resourceParameters",type:"ResourceParameter",isMany:!0}]},{name:"ResourceParameter",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isRequired",isAttr:!0,type:"Boolean"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"CorrelationSubscription",superClass:["BaseElement"],properties:[{name:"correlationKeyRef",type:"CorrelationKey",isAttr:!0,isReference:!0},{name:"correlationPropertyBinding",type:"CorrelationPropertyBinding",isMany:!0}]},{name:"MessageFlow",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"MessageFlowAssociation",superClass:["BaseElement"],properties:[{name:"innerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0},{name:"outerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0}]},{name:"InteractionNode",isAbstract:!0,properties:[{name:"incomingConversationLinks",type:"ConversationLink",isMany:!0,isVirtual:!0,isReference:!0},{name:"outgoingConversationLinks",type:"ConversationLink",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"Participant",superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"interfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"participantMultiplicity",type:"ParticipantMultiplicity"},{name:"endPointRefs",type:"EndPoint",isMany:!0,isReference:!0},{name:"processRef",type:"Process",isAttr:!0,isReference:!0}]},{name:"ParticipantAssociation",superClass:["BaseElement"],properties:[{name:"innerParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"outerParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"ParticipantMultiplicity",properties:[{name:"minimum",default:0,isAttr:!0,type:"Integer"},{name:"maximum",default:1,isAttr:!0,type:"Integer"}],superClass:["BaseElement"]},{name:"Collaboration",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"participants",type:"Participant",isMany:!0},{name:"messageFlows",type:"MessageFlow",isMany:!0},{name:"artifacts",type:"Artifact",isMany:!0},{name:"conversations",type:"ConversationNode",isMany:!0},{name:"conversationAssociations",type:"ConversationAssociation"},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0},{name:"messageFlowAssociations",type:"MessageFlowAssociation",isMany:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"choreographyRef",type:"Choreography",isMany:!0,isReference:!0},{name:"conversationLinks",type:"ConversationLink",isMany:!0}]},{name:"ChoreographyActivity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"loopType",type:"ChoreographyLoopType",default:"None",isAttr:!0}]},{name:"CallChoreography",superClass:["ChoreographyActivity"],properties:[{name:"calledChoreographyRef",type:"Choreography",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"SubChoreography",superClass:["ChoreographyActivity","FlowElementsContainer"],properties:[{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"ChoreographyTask",superClass:["ChoreographyActivity"],properties:[{name:"messageFlowRef",type:"MessageFlow",isMany:!0,isReference:!0}]},{name:"Choreography",superClass:["Collaboration","FlowElementsContainer"]},{name:"GlobalChoreographyTask",superClass:["Choreography"],properties:[{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"TextAnnotation",superClass:["Artifact"],properties:[{name:"text",type:"String"},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Group",superClass:["Artifact"],properties:[{name:"categoryValueRef",type:"CategoryValue",isAttr:!0,isReference:!0}]},{name:"Association",superClass:["Artifact"],properties:[{name:"associationDirection",type:"AssociationDirection",isAttr:!0},{name:"sourceRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"targetRef",type:"BaseElement",isAttr:!0,isReference:!0}]},{name:"Category",superClass:["RootElement"],properties:[{name:"categoryValue",type:"CategoryValue",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Artifact",isAbstract:!0,superClass:["BaseElement"]},{name:"CategoryValue",superClass:["BaseElement"],properties:[{name:"categorizedFlowElements",type:"FlowElement",isMany:!0,isVirtual:!0,isReference:!0},{name:"value",isAttr:!0,type:"String"}]},{name:"Activity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"isForCompensation",default:!1,isAttr:!0,type:"Boolean"},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"boundaryEventRefs",type:"BoundaryEvent",isMany:!0,isReference:!0},{name:"properties",type:"Property",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"startQuantity",default:1,isAttr:!0,type:"Integer"},{name:"resources",type:"ResourceRole",isMany:!0},{name:"completionQuantity",default:1,isAttr:!0,type:"Integer"},{name:"loopCharacteristics",type:"LoopCharacteristics"}]},{name:"ServiceTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"SubProcess",superClass:["Activity","FlowElementsContainer","InteractionNode"],properties:[{name:"triggeredByEvent",default:!1,isAttr:!0,type:"Boolean"},{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"LoopCharacteristics",isAbstract:!0,superClass:["BaseElement"]},{name:"MultiInstanceLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"isSequential",default:!1,isAttr:!0,type:"Boolean"},{name:"behavior",type:"MultiInstanceBehavior",default:"All",isAttr:!0},{name:"loopCardinality",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopDataInputRef",type:"ItemAwareElement",isReference:!0},{name:"loopDataOutputRef",type:"ItemAwareElement",isReference:!0},{name:"inputDataItem",type:"DataInput",xml:{serialize:"property"}},{name:"outputDataItem",type:"DataOutput",xml:{serialize:"property"}},{name:"complexBehaviorDefinition",type:"ComplexBehaviorDefinition",isMany:!0},{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"oneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0},{name:"noneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0}]},{name:"StandardLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"testBefore",default:!1,isAttr:!0,type:"Boolean"},{name:"loopCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopMaximum",type:"Integer",isAttr:!0}]},{name:"CallActivity",superClass:["Activity","InteractionNode"],properties:[{name:"calledElement",type:"String",isAttr:!0}]},{name:"Task",superClass:["Activity","InteractionNode"]},{name:"SendTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ReceiveTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ScriptTask",superClass:["Task"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"script",type:"String"}]},{name:"BusinessRuleTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"AdHocSubProcess",superClass:["SubProcess"],properties:[{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"ordering",type:"AdHocOrdering",isAttr:!0},{name:"cancelRemainingInstances",default:!0,isAttr:!0,type:"Boolean"}]},{name:"Transaction",superClass:["SubProcess"],properties:[{name:"protocol",isAttr:!0,type:"String"},{name:"method",isAttr:!0,type:"String"}]},{name:"GlobalScriptTask",superClass:["GlobalTask"],properties:[{name:"scriptLanguage",isAttr:!0,type:"String"},{name:"script",isAttr:!0,type:"String"}]},{name:"GlobalBusinessRuleTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"ComplexBehaviorDefinition",superClass:["BaseElement"],properties:[{name:"condition",type:"FormalExpression"},{name:"event",type:"ImplicitThrowEvent"}]},{name:"ResourceRole",superClass:["BaseElement"],properties:[{name:"resourceRef",type:"Resource",isReference:!0},{name:"resourceParameterBindings",type:"ResourceParameterBinding",isMany:!0},{name:"resourceAssignmentExpression",type:"ResourceAssignmentExpression"},{name:"name",isAttr:!0,type:"String"}]},{name:"ResourceParameterBinding",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"parameterRef",type:"ResourceParameter",isAttr:!0,isReference:!0}],superClass:["BaseElement"]},{name:"ResourceAssignmentExpression",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}}],superClass:["BaseElement"]},{name:"Import",properties:[{name:"importType",isAttr:!0,type:"String"},{name:"location",isAttr:!0,type:"String"},{name:"namespace",isAttr:!0,type:"String"}]},{name:"Definitions",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"targetNamespace",isAttr:!0,type:"String"},{name:"expressionLanguage",default:"http://www.w3.org/1999/XPath",isAttr:!0,type:"String"},{name:"typeLanguage",default:"http://www.w3.org/2001/XMLSchema",isAttr:!0,type:"String"},{name:"imports",type:"Import",isMany:!0},{name:"extensions",type:"Extension",isMany:!0},{name:"rootElements",type:"RootElement",isMany:!0},{name:"diagrams",isMany:!0,type:"bpmndi:BPMNDiagram"},{name:"exporter",isAttr:!0,type:"String"},{name:"relationships",type:"Relationship",isMany:!0},{name:"exporterVersion",isAttr:!0,type:"String"}]}],YS=[{name:"ProcessType",literalValues:[{name:"None"},{name:"Public"},{name:"Private"}]},{name:"GatewayDirection",literalValues:[{name:"Unspecified"},{name:"Converging"},{name:"Diverging"},{name:"Mixed"}]},{name:"EventBasedGatewayType",literalValues:[{name:"Parallel"},{name:"Exclusive"}]},{name:"RelationshipDirection",literalValues:[{name:"None"},{name:"Forward"},{name:"Backward"},{name:"Both"}]},{name:"ItemKind",literalValues:[{name:"Physical"},{name:"Information"}]},{name:"ChoreographyLoopType",literalValues:[{name:"None"},{name:"Standard"},{name:"MultiInstanceSequential"},{name:"MultiInstanceParallel"}]},{name:"AssociationDirection",literalValues:[{name:"None"},{name:"One"},{name:"Both"}]},{name:"MultiInstanceBehavior",literalValues:[{name:"None"},{name:"One"},{name:"All"},{name:"Complex"}]},{name:"AdHocOrdering",literalValues:[{name:"Parallel"},{name:"Sequential"}]}],KS={tagAlias:"lowerCase",typePrefix:"t"},XS={name:zS,uri:GS,prefix:US,associations:WS,types:qS,enumerations:YS,xml:KS},ZS="BPMNDI",JS="http://www.omg.org/spec/BPMN/20100524/DI",QS="bpmndi",ew=[{name:"BPMNDiagram",properties:[{name:"plane",type:"BPMNPlane",redefines:"di:Diagram#rootElement"},{name:"labelStyle",type:"BPMNLabelStyle",isMany:!0}],superClass:["di:Diagram"]},{name:"BPMNPlane",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"}],superClass:["di:Plane"]},{name:"BPMNShape",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"isHorizontal",isAttr:!0,type:"Boolean"},{name:"isExpanded",isAttr:!0,type:"Boolean"},{name:"isMarkerVisible",isAttr:!0,type:"Boolean"},{name:"label",type:"BPMNLabel"},{name:"isMessageVisible",isAttr:!0,type:"Boolean"},{name:"participantBandKind",type:"ParticipantBandKind",isAttr:!0},{name:"choreographyActivityShape",type:"BPMNShape",isAttr:!0,isReference:!0}],superClass:["di:LabeledShape"]},{name:"BPMNEdge",properties:[{name:"label",type:"BPMNLabel"},{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"sourceElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#source"},{name:"targetElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#target"},{name:"messageVisibleKind",type:"MessageVisibleKind",isAttr:!0,default:"initiating"}],superClass:["di:LabeledEdge"]},{name:"BPMNLabel",properties:[{name:"labelStyle",type:"BPMNLabelStyle",isAttr:!0,isReference:!0,redefines:"di:DiagramElement#style"}],superClass:["di:Label"]},{name:"BPMNLabelStyle",properties:[{name:"font",type:"dc:Font"}],superClass:["di:Style"]}],tw=[{name:"ParticipantBandKind",literalValues:[{name:"top_initiating"},{name:"middle_initiating"},{name:"bottom_initiating"},{name:"top_non_initiating"},{name:"middle_non_initiating"},{name:"bottom_non_initiating"}]},{name:"MessageVisibleKind",literalValues:[{name:"initiating"},{name:"non_initiating"}]}],nw=[],iw={name:ZS,uri:JS,prefix:QS,types:ew,enumerations:tw,associations:nw},rw="DC",aw="http://www.omg.org/spec/DD/20100524/DC",ow="dc",sw=[{name:"Boolean"},{name:"Integer"},{name:"Real"},{name:"String"},{name:"Font",properties:[{name:"name",type:"String",isAttr:!0},{name:"size",type:"Real",isAttr:!0},{name:"isBold",type:"Boolean",isAttr:!0},{name:"isItalic",type:"Boolean",isAttr:!0},{name:"isUnderline",type:"Boolean",isAttr:!0},{name:"isStrikeThrough",type:"Boolean",isAttr:!0}]},{name:"Point",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0}]},{name:"Bounds",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0},{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]}],lw=[],uw={name:rw,uri:aw,prefix:ow,types:sw,associations:lw},cw="DI",pw="http://www.omg.org/spec/DD/20100524/DI",fw="di",dw=[{name:"DiagramElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"extension",type:"Extension"},{name:"owningDiagram",type:"Diagram",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"owningElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"modelElement",isReadOnly:!0,isVirtual:!0,isReference:!0,type:"Element"},{name:"style",type:"Style",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"ownedElement",type:"DiagramElement",isReadOnly:!0,isMany:!0,isVirtual:!0}]},{name:"Node",isAbstract:!0,superClass:["DiagramElement"]},{name:"Edge",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"source",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"target",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"waypoint",isUnique:!1,isMany:!0,type:"dc:Point",xml:{serialize:"xsi:type"}}]},{name:"Diagram",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"rootElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0},{name:"name",isAttr:!0,type:"String"},{name:"documentation",isAttr:!0,type:"String"},{name:"resolution",isAttr:!0,type:"Real"},{name:"ownedStyle",type:"Style",isReadOnly:!0,isMany:!0,isVirtual:!0}]},{name:"Shape",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Plane",isAbstract:!0,superClass:["Node"],properties:[{name:"planeElement",type:"DiagramElement",subsettedProperty:"DiagramElement-ownedElement",isMany:!0}]},{name:"LabeledEdge",isAbstract:!0,superClass:["Edge"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isMany:!0,isVirtual:!0}]},{name:"LabeledShape",isAbstract:!0,superClass:["Shape"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isMany:!0,isVirtual:!0}]},{name:"Label",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Style",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"}]},{name:"Extension",properties:[{name:"values",isMany:!0,type:"Element"}]}],hw=[],mw={tagAlias:"lowerCase"},vw={name:cw,uri:pw,prefix:fw,types:dw,associations:hw,xml:mw},gw="bpmn.io colors for BPMN",yw="http://bpmn.io/schema/bpmn/biocolor/1.0",Ew="bioc",bw=[{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]}],_w=[],xw=[],Sw={name:gw,uri:yw,prefix:Ew,types:bw,enumerations:_w,associations:xw},ww="BPMN in Color",Tw="http://www.omg.org/spec/BPMN/non-normative/color/1.0",Cw="color",Aw=[{name:"ColoredLabel",extends:["bpmndi:BPMNLabel"],properties:[{name:"color",isAttr:!0,type:"String"}]},{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"background-color",isAttr:!0,type:"String"},{name:"border-color",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"border-color",isAttr:!0,type:"String"}]}],Pw=[],Rw=[],Iw={name:ww,uri:Tw,prefix:Cw,types:Aw,enumerations:Pw,associations:Rw},Nw={bpmn:XS,bpmndi:iw,dc:uw,di:vw,bioc:Sw,color:Iw};function Mw(e,t){var n=G({},Nw,e);return new dl(n,t)}function Et(e){return e?"<"+e.$type+(e.id?' id="'+e.id:"")+'" />':"<null>"}var kw=new zr({name:"bpmnElement",enumerable:!0},{name:"di",configurable:!0});function Vt(e,t){return e.$instanceOf(t)}function Dw(e){return Me(e.rootElements,function(t){return Vt(t,"bpmn:Process")||Vt(t,"bpmn:Collaboration")})}function Ow(e,t){var n={},i=[];function a(O,H){return function(W){O(W,H)}}function r(O){n[O.id]=O}function o(O){return n[O.id]}function s(O,H){var W=O.gfx;if(W)throw new Error(t("already rendered {element}",{element:Et(O)}));return e.element(O,H)}function u(O,H){return e.root(O,H)}function c(O,H){try{var W=O.di&&s(O,H);return r(O),W}catch(Y){p(Y.message,{element:O,error:Y}),console.error(t("failed to import {element}",{element:Et(O)})),console.error(Y)}}function p(O,H){e.error(O,H)}function f(O){var H=O.bpmnElement;H?H.di?p(t("multiple DI elements defined for {element}",{element:Et(H)}),{element:H}):(kw.bind(H,"di"),H.di=O):p(t("no bpmnElement referenced in {element}",{element:Et(O)}),{element:O})}function m(O){v(O.plane)}function v(O){f(O),B(O.planeElement,g)}function g(O){f(O)}function b(O,H){var W=O.diagrams;if(H&&W.indexOf(H)===-1)throw new Error(t("diagram not part of bpmn:Definitions"));if(!H&&W&&W.length&&(H=W[0]),!H)throw new Error(t("no diagram to display"));m(H);var Y=H.plane;if(!Y)throw new Error(t("no plane for {element}",{element:Et(H)}));var he=Y.bpmnElement;if(!he)if(he=Dw(O),he)p(t("correcting missing bpmnElement on {plane} to {rootElement}",{plane:Et(Y),rootElement:Et(he)})),Y.bpmnElement=he,f(Y);else throw new Error(t("no process or collaboration to display"));var Fe=u(he,Y);if(Vt(he,"bpmn:Process"))k(he,Fe);else if(Vt(he,"bpmn:Collaboration"))I(he),N(O.rootElements,Fe);else throw new Error(t("unsupported bpmnElement for {plane}: {rootElement}",{plane:Et(Y),rootElement:Et(he)}));_()}function _(){for(var O;i.length;)O=i.shift(),O()}function k(O,H){y(O,H),K(O.ioSpecification,H),V(O.artifacts,H),r(O)}function N(O,H){var W=ge(O,function(Y){return!o(Y)&&Vt(Y,"bpmn:Process")&&Y.laneSets});W.forEach(a(k,H))}function A(O,H){c(O,H)}function S(O,H){B(O,a(A,H))}function C(O,H){c(O,H)}function D(O,H){c(O,H)}function $(O,H){c(O,H)}function M(O,H){c(O,H)}function V(O,H){B(O,function(W){Vt(W,"bpmn:Association")?i.push(function(){M(W,H)}):M(W,H)})}function K(O,H){O&&(B(O.dataInputs,a(D,H)),B(O.dataOutputs,a($,H)))}function X(O,H){y(O,H),V(O.artifacts,H)}function z(O,H){var W=c(O,H);Vt(O,"bpmn:SubProcess")&&X(O,W||H),Vt(O,"bpmn:Activity")&&K(O.ioSpecification,H),i.push(function(){B(O.dataInputAssociations,a(C,H)),B(O.dataOutputAssociations,a(C,H))})}function U(O,H){c(O,H)}function Q(O,H){c(O,H)}function l(O,H){i.push(function(){var W=c(O,H);O.childLaneSet&&d(O.childLaneSet,W||H),F(O)})}function d(O,H){B(O.lanes,a(l,H))}function E(O,H){B(O,a(d,H))}function y(O,H){h(O.flowElements,H),O.laneSets&&E(O.laneSets,H)}function h(O,H){B(O,function(W){Vt(W,"bpmn:SequenceFlow")?i.push(function(){U(W,H)}):Vt(W,"bpmn:BoundaryEvent")?i.unshift(function(){z(W,H)}):Vt(W,"bpmn:FlowNode")?z(W,H):Vt(W,"bpmn:DataObject")||(Vt(W,"bpmn:DataStoreReference")||Vt(W,"bpmn:DataObjectReference")?Q(W,H):p(t("unrecognized flowElement {element} in context {context}",{element:Et(W),context:H?Et(H.businessObject):"null"}),{element:W,context:H}))})}function x(O,H){var W=c(O,H),Y=O.processRef;Y&&k(Y,W||H)}function I(O){B(O.participants,a(x)),V(O.artifacts),i.push(function(){S(O.messageFlows)})}function F(O){B(O.flowNodeRef,function(H){var W=H.get("lanes");W&&W.push(O)})}return{handleDeferred:_,handleDefinitions:b,handleSubProcess:X,registerDi:f}}function Lw(e,t,n){var i,a,r,o,s=[];function u(c,p){var f={root:function(v){return i.add(v)},element:function(v,g){return i.add(v,g)},error:function(v,g){s.push({message:v,context:g})}},m=new Ow(f,r);m.handleDefinitions(c,p)}return new Promise(function(c,p){try{return i=e.get("bpmnImporter"),a=e.get("eventBus"),r=e.get("translate"),a.fire("import.render.start",{definitions:t}),u(t,n),a.fire("import.render.complete",{error:o,warnings:s}),c({warnings:s})}catch(f){return f.warnings=s,p(f)}})}function Yr(e){return function(){if(!window.Promise)throw new Error("Promises is not supported in this environment. Please polyfill Promise.");var t=arguments.length;if(t>=1&&bt(arguments[t-1])){var n=arguments[t-1];console.warn(new Error("Passing callbacks to "+e.name+" is deprecated and will be removed in a future major release. Please switch to promises: https://bpmn.io/l/moving-to-promises.html"));var i=Array.prototype.slice.call(arguments,0,-1);e.apply(this,i).then(function(a){var r=Object.keys(a)[0];return n(null,a[r])},function(a){return n(a,a.warnings)})}else return e.apply(this,arguments)}}var Bw='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.02 5.57" width="53" height="21" style="vertical-align:middle"><path fill="currentColor" d="M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z"/><path fill="currentColor" d="M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z"/></svg>',Tg=Bw;function hl(e){return e.join(";")}var Cg=hl(["color: #404040"]),$w=hl(["z-index: 1001","position: fixed","top: 0","left: 0","right: 0","bottom: 0"]),Vw=hl(["width: 100%","height: 100%","background: rgba(40,40,40,0.2)"]),Fw=hl(["position: absolute","left: 50%","top: 40%","transform: translate(-50%)","width: 260px","padding: 10px","background: white","box-shadow: 0 1px 4px rgba(0,0,0,0.3)","font-family: Helvetica, Arial, sans-serif","font-size: 14px","display: flex","line-height: 1.3"]),jw='<div class="bjs-powered-by-lightbox" style="'+$w+'"><div class="backdrop" style="'+Vw+'"></div><div class="notice" style="'+Fw+'"><a href="https://bpmn.io" target="_blank" rel="noopener" style="margin: 15px 20px 15px 10px; align-self: center;'+Cg+'">'+Tg+'</a><span>Web-based tooling for BPMN, DMN and CMMN diagrams powered by <a href="https://bpmn.io" target="_blank" rel="noopener">bpmn.io</a>.</span></div></div>',ga;function Hw(){ga||(ga=je(jw),qt.bind(ga,".backdrop","click",function(e){document.body.removeChild(ga)})),document.body.appendChild(ga)}function We(e){e=G({},Gw,e),this._moddle=this._createModdle(e),this._container=this._createContainer(e),Ww(this._container),this._init(this._container,this._moddle,e)}se(We,Ur);We.prototype.importXML=Yr(function(t,n){var i=this;function a(r){var o=i.get("eventBus").createEvent(r);return Object.defineProperty(o,"context",{enumerable:!0,get:function(){return console.warn(new Error("import.parse.complete <context> is deprecated and will be removed in future library versions")),{warnings:r.warnings,references:r.references,elementsById:r.elementsById}}}),o}return new Promise(function(r,o){t=i._emit("import.parse.start",{xml:t})||t,i._moddle.fromXML(t,"bpmn:Definitions").then(function(s){var u=s.rootElement,c=s.references,p=s.warnings,f=s.elementsById;u=i._emit("import.parse.complete",a({error:null,definitions:u,elementsById:f,references:c,warnings:p}))||u,i.importDefinitions(u,n).then(function(m){var v=[].concat(p,m.warnings||[]);return i._emit("import.done",{error:null,warnings:v}),r({warnings:v})}).catch(function(m){var v=[].concat(p,m.warnings||[]);return i._emit("import.done",{error:m,warnings:v}),o(Cs(m,v))})}).catch(function(s){return i._emit("import.parse.complete",{error:s}),s=zw(s),i._emit("import.done",{error:s,warnings:s.warnings}),o(s)})})});We.prototype.importDefinitions=Yr(function(t,n){var i=this;return new Promise(function(a,r){i._setDefinitions(t),i.open(n).then(function(o){var s=o.warnings;return a({warnings:s})}).catch(function(o){return r(o)})})});We.prototype.open=Yr(function(t){var n=this._definitions,i=t,a=this;return new Promise(function(r,o){if(!n){var s=new Error("no XML imported");return o(Cs(s,[]))}if(typeof t=="string"&&(i=Uw(n,t),!i)){var u=new Error("BPMNDiagram <"+t+"> not found");return o(Cs(u,[]))}try{a.clear()}catch(c){return o(Cs(c,[]))}Lw(a,n,i).then(function(c){var p=c.warnings;return r({warnings:p})}).catch(function(c){return o(c)})})});We.prototype.saveXML=Yr(function(t){t=t||{};var n=this,i=this._definitions;return new Promise(function(a){if(!i)return a({error:new Error("no definitions loaded")});i=n._emit("saveXML.start",{definitions:i})||i,n._moddle.toXML(i,t).then(function(r){var o=r.xml;return o=n._emit("saveXML.serialized",{xml:o})||o,a({xml:o})})}).catch(function(a){return{error:a}}).then(function(a){n._emit("saveXML.done",a);var r=a.error;return r?Promise.reject(r):a})});We.prototype.saveSVG=Yr(function(t){var n=this;return new Promise(function(i,a){n._emit("saveSVG.start");var r,o;try{var s=n.get("canvas"),u=s.getDefaultLayer(),c=Xe("defs",s._svg),p=Pd(u),f=c?"<defs>"+Pd(c)+"</defs>":"",m=u.getBBox();r=`<?xml version="1.0" encoding="utf-8"?>
<!-- created with bpmn-js / http://bpmn.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="`+m.width+'" height="'+m.height+'" viewBox="'+m.x+" "+m.y+" "+m.width+" "+m.height+'" version="1.1">'+f+p+"</svg>"}catch(v){o=v}return n._emit("saveSVG.done",{error:o,svg:r}),o?a(o):i({svg:r})})});We.prototype._setDefinitions=function(e){this._definitions=e};We.prototype.getModules=function(){return this._modules};We.prototype.clear=function(){this.getDefinitions()&&(this.get("elementRegistry").forEach(function(e){var t=e.businessObject;t&&t.di&&delete t.di}),Ur.prototype.clear.call(this))};We.prototype.destroy=function(){Ur.prototype.destroy.call(this),$n(this._container)};We.prototype.on=function(e,t,n,i){return this.get("eventBus").on(e,t,n,i)};We.prototype.off=function(e,t){this.get("eventBus").off(e,t)};We.prototype.attachTo=function(e){if(!e)throw new Error("parentNode required");this.detach(),e.get&&e.constructor.prototype.jquery&&(e=e.get(0)),typeof e=="string"&&(e=Xe(e)),e.appendChild(this._container),this._emit("attach",{}),this.get("canvas").resized()};We.prototype.getDefinitions=function(){return this._definitions};We.prototype.detach=function(){var e=this._container,t=e.parentNode;t&&(this._emit("detach",{}),t.removeChild(e))};We.prototype._init=function(e,t,n){var i=n.modules||this.getModules(),a=n.additionalModules||[],r=[{bpmnjs:["value",this],moddle:["value",t]}],o=[].concat(r,i,a),s=G(ei(n,["additionalModules"]),{canvas:G({},n.canvas,{container:e}),modules:o});Ur.call(this,s),n&&n.container&&this.attachTo(n.container)};We.prototype._emit=function(e,t){return this.get("eventBus").fire(e,t)};We.prototype._createContainer=function(e){var t=je('<div class="bjs-container"></div>');return G(t.style,{width:Yd(e.width),height:Yd(e.height),position:e.position}),t};We.prototype._createModdle=function(e){var t=G({},this._moddleExtensions,e.moddleExtensions);return new Mw(t)};We.prototype._modules=[];function Cs(e,t){return e.warnings=t,e}function zw(e){var t=/unparsable content <([^>]+)> detected([\s\S]*)$/,n=t.exec(e.message);return n&&(e.message="unparsable content <"+n[1]+"> detected; this may indicate an invalid BPMN 2.0 diagram file"+n[2]),e}var Gw={width:"100%",height:"100%",position:"relative"};function Yd(e){return e+(ve(e)?"px":"")}function Uw(e,t){return t&&Me(e.diagrams,function(n){return n.id===t})||null}function Ww(e){var t=Tg,n='<a href="http://bpmn.io" target="_blank" class="bjs-powered-by" title="Powered by bpmn.io" style="position: absolute; bottom: 15px; right: 15px; z-index: 100; '+Cg+'">'+t+"</a>",i=je(n);e.appendChild(i),pe.bind(i,"click",function(a){Hw(),a.preventDefault()})}function to(e){We.call(this,e),this.on("import.parse.complete",function(t){t.error||this._collectIds(t.definitions,t.elementsById)},this),this.on("diagram.destroy",function(){this.get("moddle").ids.clear()},this)}se(to,We);to.prototype._createModdle=function(e){var t=We.prototype._createModdle.call(this,e);return t.ids=new Bn([32,36,1]),t};to.prototype._collectIds=function(e,t){var n=e.$model,i=n.ids,a;i.clear();for(a in t)i.claim(a,t[a])};function w(e,t){var n=oe(e);return n&&typeof n.$instanceOf=="function"&&n.$instanceOf(t)}function oe(e){return e&&e.businessObject||e}function Le(e){return w(e,"bpmn:CallActivity")?!1:w(e,"bpmn:SubProcess")?oe(e).di&&!!oe(e).di.isExpanded:w(e,"bpmn:Participant")?!!oe(e).processRef:!0}function qw(e){return e&&oe(e).isInterrupting!==!1}function Yt(e){return e&&!!oe(e).triggeredByEvent}function ml(e,t){var n=oe(e),i=!1;return n.eventDefinitions&&B(n.eventDefinitions,function(a){w(a,t)&&(i=!0)}),i}function Yw(e){return ml(e,"bpmn:ErrorEventDefinition")}function Kw(e){return ml(e,"bpmn:EscalationEventDefinition")}function Xw(e){return ml(e,"bpmn:CompensateEventDefinition")}function Ag(e){if(w(e,"bpmn:FlowElement")||w(e,"bpmn:Participant")||w(e,"bpmn:Lane")||w(e,"bpmn:SequenceFlow")||w(e,"bpmn:MessageFlow")||w(e,"bpmn:DataInput")||w(e,"bpmn:DataOutput"))return"name";if(w(e,"bpmn:TextAnnotation"))return"text";if(w(e,"bpmn:Group"))return"categoryValueRef"}function Zw(e){var t=e.categoryValueRef;return t&&t.value||""}function Sn(e){var t=e.businessObject,n=Ag(t);if(n)return n==="categoryValueRef"?Zw(t):t[n]||""}function Jw(e,t,n){var i=e.businessObject,a=Ag(i);return a&&(a==="categoryValueRef"?i.categoryValueRef.value=t:i[a]=t),e}function In(e,t,n){function i(a,r){return Qi(r,function(o,s){return a[s]==o})}return wi(e.eventDefinitions,function(a){return a.$type===t&&i(e,n)})}function Qw(e){return e.$type==="bpmn:IntermediateThrowEvent"||e.$type==="bpmn:EndEvent"}function e0(e){var t=e.dataObjectRef;return e.isCollection||t&&t.isCollection}function kr(e){return e.businessObject.di}function At(e){return e.businessObject}function Te(e,t){var n=kr(e);return n.get("color:background-color")||n.get("bioc:fill")||t||"white"}function ne(e,t){var n=kr(e);return n.get("color:border-color")||n.get("bioc:stroke")||t||"black"}function ya(e,t,n){var i=kr(e),a=i.get("label");return a&&a.get("color:color")||t||ne(e,n)}function t0(e){var t=e.x+e.width/2,n=e.y+e.height/2,i=e.width/2,a=[["M",t,n],["m",0,-i],["a",i,i,0,1,1,0,2*i],["a",i,i,0,1,1,0,-2*i],["z"]];return Hr(a)}function n0(e,t){var n=e.x,i=e.y,a=e.width,r=e.height,o=[["M",n+t,i],["l",a-t*2,0],["a",t,t,0,0,1,t,t],["l",0,r-t*2],["a",t,t,0,0,1,-t,t],["l",t*2-a,0],["a",t,t,0,0,1,-t,-t],["l",0,t*2-r],["a",t,t,0,0,1,t,-t],["z"]];return Hr(o)}function i0(e){var t=e.width,n=e.height,i=e.x,a=e.y,r=t/2,o=n/2,s=[["M",i+r,a],["l",r,o],["l",-r,o],["l",-r,-o],["z"]];return Hr(s)}function r0(e){var t=e.x,n=e.y,i=e.width,a=e.height,r=[["M",t,n],["l",i,0],["l",0,a],["l",-i,0],["z"]];return Hr(r)}var a0=new Bn,As=10,Nu=3,Er=.95,o0=.35,s0=10;function ir(e,t,n,i,a,r,o){ti.call(this,t,o);var s=e&&e.defaultFillColor,u=e&&e.defaultStrokeColor,c=e&&e.defaultLabelColor,p=a0.next(),f={},m=n.computeStyle;function v(y,h){var x=G({fill:"black",strokeWidth:1,strokeLinecap:"round",strokeDasharray:"none"},h.attrs),I=h.ref||{x:0,y:0},F=h.scale||1;x.strokeDasharray==="none"&&(x.strokeDasharray=[1e4,1]);var O=le("marker");ee(h.element,x),fe(O,h.element),ee(O,{id:y,viewBox:"0 0 20 20",refX:I.x,refY:I.y,markerWidth:20*F,markerHeight:20*F,orient:"auto"});var H=Xe("defs",a._svg);H||(H=le("defs"),fe(a._svg,H)),fe(H,O),f[y]=O}function g(y){return y.replace(/[^0-9a-zA-z]+/g,"_")}function b(y,h,x){var I=y+"-"+g(h)+"-"+g(x)+"-"+p;return f[I]||_(I,y,h,x),"url(#"+I+")"}function _(y,h,x,I){if(h==="sequenceflow-end"){var F=le("path");ee(F,{d:"M 1 5 L 11 10 L 1 15 Z"}),v(y,{element:F,ref:{x:11,y:10},scale:.5,attrs:{fill:I,stroke:I}})}if(h==="messageflow-start"){var O=le("circle");ee(O,{cx:6,cy:6,r:3.5}),v(y,{element:O,attrs:{fill:x,stroke:I},ref:{x:6,y:6}})}if(h==="messageflow-end"){var H=le("path");ee(H,{d:"m 1 5 l 0 -3 l 7 3 l -7 3 z"}),v(y,{element:H,attrs:{fill:x,stroke:I,strokeLinecap:"butt"},ref:{x:8.5,y:5}})}if(h==="association-start"){var W=le("path");ee(W,{d:"M 11 5 L 1 10 L 11 15"}),v(y,{element:W,attrs:{fill:"none",stroke:I,strokeWidth:1.5},ref:{x:1,y:10},scale:.5})}if(h==="association-end"){var Y=le("path");ee(Y,{d:"M 1 5 L 11 10 L 1 15"}),v(y,{element:Y,attrs:{fill:"none",stroke:I,strokeWidth:1.5},ref:{x:12,y:10},scale:.5})}if(h==="conditional-flow-marker"){var he=le("path");ee(he,{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z"}),v(y,{element:he,attrs:{fill:x,stroke:I},ref:{x:-1,y:10},scale:.5})}if(h==="conditional-default-flow-marker"){var Fe=le("path");ee(Fe,{d:"M 6 4 L 10 16"}),v(y,{element:Fe,attrs:{stroke:I},ref:{x:0,y:10},scale:.5})}}function k(y,h,x,I,F){nt(I)&&(F=I,I=0),I=I||0,F=m(F,{stroke:"black",strokeWidth:2,fill:"white"}),F.fill==="none"&&delete F.fillOpacity;var O=h/2,H=x/2,W=le("circle");return ee(W,{cx:O,cy:H,r:Math.round((h+x)/4-I)}),ee(W,F),fe(y,W),W}function N(y,h,x,I,F,O){nt(F)&&(O=F,F=0),F=F||0,O=m(O,{stroke:"black",strokeWidth:2,fill:"white"});var H=le("rect");return ee(H,{x:F,y:F,width:h-F*2,height:x-F*2,rx:I,ry:I}),ee(H,O),fe(y,H),H}function A(y,h,x,I){var F=h/2,O=x/2,H=[{x:F,y:0},{x:h,y:O},{x:F,y:x},{x:0,y:O}],W=H.map(function(he){return he.x+","+he.y}).join(" ");I=m(I,{stroke:"black",strokeWidth:2,fill:"white"});var Y=le("polygon");return ee(Y,{points:W}),ee(Y,I),fe(y,Y),Y}function S(y,h,x){x=m(x,["no-fill"],{stroke:"black",strokeWidth:2,fill:"none"});var I=ap(h,x);return fe(y,I),I}function C(y,h,x){x=m(x,["no-fill"],{strokeWidth:2,stroke:"black"});var I=le("path");return ee(I,{d:h}),ee(I,x),fe(y,I),I}function D(y,h,x,I){return C(h,x,G({"data-marker":y},I))}function $(y){return function(h,x){return l[y](h,x)}}function M(y){return l[y]}function V(y,h){var x=At(y),I=Qw(x);return x.eventDefinitions&&x.eventDefinitions.length>1?x.parallelMultiple?M("bpmn:ParallelMultipleEventDefinition")(h,y,I):M("bpmn:MultipleEventDefinition")(h,y,I):In(x,"bpmn:MessageEventDefinition")?M("bpmn:MessageEventDefinition")(h,y,I):In(x,"bpmn:TimerEventDefinition")?M("bpmn:TimerEventDefinition")(h,y,I):In(x,"bpmn:ConditionalEventDefinition")?M("bpmn:ConditionalEventDefinition")(h,y):In(x,"bpmn:SignalEventDefinition")?M("bpmn:SignalEventDefinition")(h,y,I):In(x,"bpmn:EscalationEventDefinition")?M("bpmn:EscalationEventDefinition")(h,y,I):In(x,"bpmn:LinkEventDefinition")?M("bpmn:LinkEventDefinition")(h,y,I):In(x,"bpmn:ErrorEventDefinition")?M("bpmn:ErrorEventDefinition")(h,y,I):In(x,"bpmn:CancelEventDefinition")?M("bpmn:CancelEventDefinition")(h,y,I):In(x,"bpmn:CompensateEventDefinition")?M("bpmn:CompensateEventDefinition")(h,y,I):In(x,"bpmn:TerminateEventDefinition")?M("bpmn:TerminateEventDefinition")(h,y,I):null}function K(y,h,x){x=G({size:{width:100}},x);var I=r.createText(h||"",x);return Se(I).add("djs-label"),fe(y,I),I}function X(y,h,x){var I=At(h);return K(y,I.name,{box:h,align:x,padding:5,style:{fill:ya(h,c,u)}})}function z(y,h){var x={width:90,height:30,x:h.width/2+h.x,y:h.height/2+h.y};return K(y,Sn(h),{box:x,fitBox:!0,style:G({},r.getExternalStyle(),{fill:ya(h,c,u)})})}function U(y,h,x){var I=K(y,h,{box:{height:30,width:x.height},align:"center-middle",style:{fill:ya(x,c,u)}}),F=-1*x.height;xc(I,0,-F,270)}function Q(y){for(var h=y.waypoints,x="m  "+h[0].x+","+h[0].y,I=1;I<h.length;I++)x+="L"+h[I].x+","+h[I].y+" ";return x}var l=this.handlers={"bpmn:Event":function(y,h,x){return"fillOpacity"in x||(x.fillOpacity=Er),k(y,h.width,h.height,x)},"bpmn:StartEvent":function(y,h){var x={fill:Te(h,s),stroke:ne(h,u)},I=At(h);I.isInterrupting||(x={strokeDasharray:"6",strokeLinecap:"round",fill:Te(h,s),stroke:ne(h,u)});var F=M("bpmn:Event")(y,h,x);return V(h,y),F},"bpmn:MessageEventDefinition":function(y,h,x){var I=i.getScaledPath("EVENT_MESSAGE",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:h.width,containerHeight:h.height,position:{mx:.235,my:.315}}),F=x?ne(h,u):Te(h,s),O=x?Te(h,s):ne(h,u),H=C(y,I,{strokeWidth:1,fill:F,stroke:O});return H},"bpmn:TimerEventDefinition":function(y,h){var x=k(y,h.width,h.height,.2*h.height,{strokeWidth:2,fill:Te(h,s),stroke:ne(h,u)}),I=i.getScaledPath("EVENT_TIMER_WH",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:h.width,containerHeight:h.height,position:{mx:.5,my:.5}});C(y,I,{strokeWidth:2,strokeLinecap:"square",stroke:ne(h,u)});for(var F=0;F<12;F++){var O=i.getScaledPath("EVENT_TIMER_LINE",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:h.width,containerHeight:h.height,position:{mx:.5,my:.5}}),H=h.width/2,W=h.height/2;C(y,O,{strokeWidth:1,strokeLinecap:"square",transform:"rotate("+F*30+","+W+","+H+")",stroke:ne(h,u)})}return x},"bpmn:EscalationEventDefinition":function(y,h,x){var I=i.getScaledPath("EVENT_ESCALATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:h.width,containerHeight:h.height,position:{mx:.5,my:.2}}),F=x?ne(h,u):"none";return C(y,I,{strokeWidth:1,fill:F,stroke:ne(h,u)})},"bpmn:ConditionalEventDefinition":function(y,h){var x=i.getScaledPath("EVENT_CONDITIONAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:h.width,containerHeight:h.height,position:{mx:.5,my:.222}});return C(y,x,{strokeWidth:1,stroke:ne(h,u)})},"bpmn:LinkEventDefinition":function(y,h,x){var I=i.getScaledPath("EVENT_LINK",{xScaleFactor:1,yScaleFactor:1,containerWidth:h.width,containerHeight:h.height,position:{mx:.57,my:.263}}),F=x?ne(h,u):"none";return C(y,I,{strokeWidth:1,fill:F,stroke:ne(h,u)})},"bpmn:ErrorEventDefinition":function(y,h,x){var I=i.getScaledPath("EVENT_ERROR",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:h.width,containerHeight:h.height,position:{mx:.2,my:.722}}),F=x?ne(h,u):"none";return C(y,I,{strokeWidth:1,fill:F,stroke:ne(h,u)})},"bpmn:CancelEventDefinition":function(y,h,x){var I=i.getScaledPath("EVENT_CANCEL_45",{xScaleFactor:1,yScaleFactor:1,containerWidth:h.width,containerHeight:h.height,position:{mx:.638,my:-.055}}),F=x?ne(h,u):"none",O=C(y,I,{strokeWidth:1,fill:F,stroke:ne(h,u)});return cg(O,45),O},"bpmn:CompensateEventDefinition":function(y,h,x){var I=i.getScaledPath("EVENT_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:h.width,containerHeight:h.height,position:{mx:.22,my:.5}}),F=x?ne(h,u):"none";return C(y,I,{strokeWidth:1,fill:F,stroke:ne(h,u)})},"bpmn:SignalEventDefinition":function(y,h,x){var I=i.getScaledPath("EVENT_SIGNAL",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:h.width,containerHeight:h.height,position:{mx:.5,my:.2}}),F=x?ne(h,u):"none";return C(y,I,{strokeWidth:1,fill:F,stroke:ne(h,u)})},"bpmn:MultipleEventDefinition":function(y,h,x){var I=i.getScaledPath("EVENT_MULTIPLE",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:h.width,containerHeight:h.height,position:{mx:.222,my:.36}}),F=x?ne(h,u):"none";return C(y,I,{strokeWidth:1,fill:F})},"bpmn:ParallelMultipleEventDefinition":function(y,h){var x=i.getScaledPath("EVENT_PARALLEL_MULTIPLE",{xScaleFactor:1.2,yScaleFactor:1.2,containerWidth:h.width,containerHeight:h.height,position:{mx:.458,my:.194}});return C(y,x,{strokeWidth:1,fill:ne(h,u),stroke:ne(h,u)})},"bpmn:EndEvent":function(y,h){var x=M("bpmn:Event")(y,h,{strokeWidth:4,fill:Te(h,s),stroke:ne(h,u)});return V(h,y),x},"bpmn:TerminateEventDefinition":function(y,h){var x=k(y,h.width,h.height,8,{strokeWidth:4,fill:ne(h,u),stroke:ne(h,u)});return x},"bpmn:IntermediateEvent":function(y,h){var x=M("bpmn:Event")(y,h,{strokeWidth:1,fill:Te(h,s),stroke:ne(h,u)});return k(y,h.width,h.height,Nu,{strokeWidth:1,fill:Te(h,"none"),stroke:ne(h,u)}),V(h,y),x},"bpmn:IntermediateCatchEvent":$("bpmn:IntermediateEvent"),"bpmn:IntermediateThrowEvent":$("bpmn:IntermediateEvent"),"bpmn:Activity":function(y,h,x){return x=x||{},"fillOpacity"in x||(x.fillOpacity=Er),N(y,h.width,h.height,As,x)},"bpmn:Task":function(y,h){var x={fill:Te(h,s),stroke:ne(h,u)},I=M("bpmn:Activity")(y,h,x);return X(y,h,"center-middle"),d(y,h),I},"bpmn:ServiceTask":function(y,h){var x=M("bpmn:Task")(y,h),I=i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:12,y:18}});C(y,I,{strokeWidth:1,fill:Te(h,s),stroke:ne(h,u)});var F=i.getScaledPath("TASK_TYPE_SERVICE_FILL",{abspos:{x:17.2,y:18}});C(y,F,{strokeWidth:0,fill:Te(h,s)});var O=i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:17,y:22}});return C(y,O,{strokeWidth:1,fill:Te(h,s),stroke:ne(h,u)}),x},"bpmn:UserTask":function(y,h){var x=M("bpmn:Task")(y,h),I=15,F=12,O=i.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:I,y:F}});C(y,O,{strokeWidth:.5,fill:Te(h,s),stroke:ne(h,u)});var H=i.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:I,y:F}});C(y,H,{strokeWidth:.5,fill:Te(h,s),stroke:ne(h,u)});var W=i.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:I,y:F}});return C(y,W,{strokeWidth:.5,fill:ne(h,u),stroke:ne(h,u)}),x},"bpmn:ManualTask":function(y,h){var x=M("bpmn:Task")(y,h),I=i.getScaledPath("TASK_TYPE_MANUAL",{abspos:{x:17,y:15}});return C(y,I,{strokeWidth:.5,fill:Te(h,s),stroke:ne(h,u)}),x},"bpmn:SendTask":function(y,h){var x=M("bpmn:Task")(y,h),I=i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:1,yScaleFactor:1,containerWidth:21,containerHeight:14,position:{mx:.285,my:.357}});return C(y,I,{strokeWidth:1,fill:ne(h,u),stroke:Te(h,s)}),x},"bpmn:ReceiveTask":function(y,h){var x=At(h),I=M("bpmn:Task")(y,h),F;return x.instantiate?(k(y,28,28,20*.22,{strokeWidth:1}),F=i.getScaledPath("TASK_TYPE_INSTANTIATING_SEND",{abspos:{x:7.77,y:9.52}})):F=i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:21,containerHeight:14,position:{mx:.3,my:.4}}),C(y,F,{strokeWidth:1,fill:Te(h,s),stroke:ne(h,u)}),I},"bpmn:ScriptTask":function(y,h){var x=M("bpmn:Task")(y,h),I=i.getScaledPath("TASK_TYPE_SCRIPT",{abspos:{x:15,y:20}});return C(y,I,{strokeWidth:1,stroke:ne(h,u)}),x},"bpmn:BusinessRuleTask":function(y,h){var x=M("bpmn:Task")(y,h),I=i.getScaledPath("TASK_TYPE_BUSINESS_RULE_HEADER",{abspos:{x:8,y:8}}),F=C(y,I);ee(F,{strokeWidth:1,fill:Te(h,"#aaaaaa"),stroke:ne(h,u)});var O=i.getScaledPath("TASK_TYPE_BUSINESS_RULE_MAIN",{abspos:{x:8,y:8}}),H=C(y,O);return ee(H,{strokeWidth:1,stroke:ne(h,u)}),x},"bpmn:SubProcess":function(y,h,x){x=G({fill:Te(h,s),stroke:ne(h,u)},x);var I=M("bpmn:Activity")(y,h,x),F=Le(h);return Yt(h)&&ee(I,{strokeDasharray:"1,2"}),X(y,h,F?"center-top":"center-middle"),F?d(y,h):d(y,h,["SubProcessMarker"]),I},"bpmn:AdHocSubProcess":function(y,h){return M("bpmn:SubProcess")(y,h)},"bpmn:Transaction":function(y,h){var x=M("bpmn:SubProcess")(y,h),I=n.style(["no-fill","no-events"],{stroke:ne(h,u)});return N(y,h.width,h.height,As-2,Nu,I),x},"bpmn:CallActivity":function(y,h){return M("bpmn:SubProcess")(y,h,{strokeWidth:5})},"bpmn:Participant":function(y,h){var x={fillOpacity:Er,fill:Te(h,s),stroke:ne(h,u)},I=M("bpmn:Lane")(y,h,x),F=Le(h);if(F){S(y,[{x:30,y:0},{x:30,y:h.height}],{stroke:ne(h,u)});var O=At(h).name;U(y,O,h)}else{var H=At(h).name;K(y,H,{box:h,align:"center-middle",style:{fill:ya(h,c,u)}})}var W=!!At(h).participantMultiplicity;return W&&M("ParticipantMultiplicityMarker")(y,h),I},"bpmn:Lane":function(y,h,x){var I=N(y,h.width,h.height,0,G({fill:Te(h,s),fillOpacity:o0,stroke:ne(h,u)},x)),F=At(h);if(F.$type==="bpmn:Lane"){var O=F.name;U(y,O,h)}return I},"bpmn:InclusiveGateway":function(y,h){var x=M("bpmn:Gateway")(y,h);return k(y,h.width,h.height,h.height*.24,{strokeWidth:2.5,fill:Te(h,s),stroke:ne(h,u)}),x},"bpmn:ExclusiveGateway":function(y,h){var x=M("bpmn:Gateway")(y,h),I=i.getScaledPath("GATEWAY_EXCLUSIVE",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:h.width,containerHeight:h.height,position:{mx:.32,my:.3}});return kr(h).isMarkerVisible&&C(y,I,{strokeWidth:1,fill:ne(h,u),stroke:ne(h,u)}),x},"bpmn:ComplexGateway":function(y,h){var x=M("bpmn:Gateway")(y,h),I=i.getScaledPath("GATEWAY_COMPLEX",{xScaleFactor:.5,yScaleFactor:.5,containerWidth:h.width,containerHeight:h.height,position:{mx:.46,my:.26}});return C(y,I,{strokeWidth:1,fill:ne(h,u),stroke:ne(h,u)}),x},"bpmn:ParallelGateway":function(y,h){var x=M("bpmn:Gateway")(y,h),I=i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.6,yScaleFactor:.6,containerWidth:h.width,containerHeight:h.height,position:{mx:.46,my:.2}});return C(y,I,{strokeWidth:1,fill:ne(h,u),stroke:ne(h,u)}),x},"bpmn:EventBasedGateway":function(y,h){var x=At(h),I=M("bpmn:Gateway")(y,h);k(y,h.width,h.height,h.height*.2,{strokeWidth:1,fill:"none",stroke:ne(h,u)});var F=x.eventGatewayType,O=!!x.instantiate;function H(){var Fe=i.getScaledPath("GATEWAY_EVENT_BASED",{xScaleFactor:.18,yScaleFactor:.18,containerWidth:h.width,containerHeight:h.height,position:{mx:.36,my:.44}}),_e={strokeWidth:2,fill:Te(h,"none"),stroke:ne(h,u)};C(y,Fe,_e)}if(F==="Parallel"){var W=i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:h.width,containerHeight:h.height,position:{mx:.474,my:.296}}),Y=C(y,W);ee(Y,{strokeWidth:1,fill:"none"})}else if(F==="Exclusive"){if(!O){var he=k(y,h.width,h.height,h.height*.26);ee(he,{strokeWidth:1,fill:"none",stroke:ne(h,u)})}H()}return I},"bpmn:Gateway":function(y,h){var x={fill:Te(h,s),fillOpacity:Er,stroke:ne(h,u)};return A(y,h.width,h.height,x)},"bpmn:SequenceFlow":function(y,h){var x=Q(h),I=Te(h,s),F=ne(h,u),O={strokeLinejoin:"round",markerEnd:b("sequenceflow-end",I,F),stroke:ne(h,u)},H=C(y,x,O),W=At(h),Y;return h.source&&(Y=h.source.businessObject,W.conditionExpression&&Y.$instanceOf("bpmn:Activity")&&ee(H,{markerStart:b("conditional-flow-marker",I,F)}),Y.default&&(Y.$instanceOf("bpmn:Gateway")||Y.$instanceOf("bpmn:Activity"))&&Y.default===W&&ee(H,{markerStart:b("conditional-default-flow-marker",I,F)})),H},"bpmn:Association":function(y,h,x){var I=At(h),F=Te(h,s),O=ne(h,u);return x=G({strokeDasharray:"0.5, 5",strokeLinecap:"round",strokeLinejoin:"round",stroke:ne(h,u)},x||{}),(I.associationDirection==="One"||I.associationDirection==="Both")&&(x.markerEnd=b("association-end",F,O)),I.associationDirection==="Both"&&(x.markerStart=b("association-start",F,O)),S(y,h.waypoints,x)},"bpmn:DataInputAssociation":function(y,h){var x=Te(h,s),I=ne(h,u);return M("bpmn:Association")(y,h,{markerEnd:b("association-end",x,I)})},"bpmn:DataOutputAssociation":function(y,h){var x=Te(h,s),I=ne(h,u);return M("bpmn:Association")(y,h,{markerEnd:b("association-end",x,I)})},"bpmn:MessageFlow":function(y,h){var x=At(h),I=kr(h),F=Te(h,s),O=ne(h,u),H=Q(h),W={markerEnd:b("messageflow-end",F,O),markerStart:b("messageflow-start",F,O),strokeDasharray:"10, 12",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5px",stroke:ne(h,u)},Y=C(y,H,W);if(x.messageRef){var he=Y.getPointAtLength(Y.getTotalLength()/2),Fe=i.getScaledPath("MESSAGE_FLOW_MARKER",{abspos:{x:he.x,y:he.y}}),_e={strokeWidth:1};I.messageVisibleKind==="initiating"?(_e.fill="white",_e.stroke="black"):(_e.fill="#888",_e.stroke="white");var we=C(y,Fe,_e),ft=x.messageRef.name,dt=K(y,ft,{align:"center-top",fitBox:!0,style:{fill:ne(h,c)}}),De=we.getBBox(),ze=dt.getBBox(),It=he.x-ze.width/2,Nt=he.y+De.height/2+s0;xc(dt,It,Nt,0)}return Y},"bpmn:DataObject":function(y,h){var x=i.getScaledPath("DATA_OBJECT_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:h.width,containerHeight:h.height,position:{mx:.474,my:.296}}),I=C(y,x,{fill:Te(h,s),fillOpacity:Er,stroke:ne(h,u)}),F=At(h);return e0(F)&&E(y,h),I},"bpmn:DataObjectReference":$("bpmn:DataObject"),"bpmn:DataInput":function(y,h){var x=i.getRawPath("DATA_ARROW"),I=M("bpmn:DataObject")(y,h);return C(y,x,{strokeWidth:1}),I},"bpmn:DataOutput":function(y,h){var x=i.getRawPath("DATA_ARROW"),I=M("bpmn:DataObject")(y,h);return C(y,x,{strokeWidth:1,fill:"black"}),I},"bpmn:DataStoreReference":function(y,h){var x=i.getScaledPath("DATA_STORE",{xScaleFactor:1,yScaleFactor:1,containerWidth:h.width,containerHeight:h.height,position:{mx:0,my:.133}}),I=C(y,x,{strokeWidth:2,fill:Te(h,s),fillOpacity:Er,stroke:ne(h,u)});return I},"bpmn:BoundaryEvent":function(y,h){var x=At(h),I=x.cancelActivity,F={strokeWidth:1,fill:Te(h,s),stroke:ne(h,u)};I||(F.strokeDasharray="6",F.strokeLinecap="round");var O=G({},F,{fillOpacity:1}),H=G({},F,{fill:"none"}),W=M("bpmn:Event")(y,h,O);return k(y,h.width,h.height,Nu,H),V(h,y),W},"bpmn:Group":function(y,h){var x=N(y,h.width,h.height,As,{stroke:ne(h,u),strokeWidth:1,strokeDasharray:"8,3,1,3",fill:"none",pointerEvents:"none"});return x},label:function(y,h){return z(y,h)},"bpmn:TextAnnotation":function(y,h){var x={fill:"none",stroke:"none"},I=N(y,h.width,h.height,0,0,x),F=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:h.width,containerHeight:h.height,position:{mx:0,my:0}});C(y,F,{stroke:ne(h,u)});var O=At(h).text||"";return K(y,O,{box:h,align:"left-top",padding:5,style:{fill:ya(h,c,u)}}),I},ParticipantMultiplicityMarker:function(y,h){var x=i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:h.width,containerHeight:h.height,position:{mx:h.width/2/h.width,my:(h.height-15)/h.height}});D("participant-multiplicity",y,x,{strokeWidth:2,fill:Te(h,s),stroke:ne(h,u)})},SubProcessMarker:function(y,h){var x=N(y,14,14,0,{strokeWidth:1,fill:Te(h,s),stroke:ne(h,u)});Ft(x,h.width/2-7.5,h.height-20);var I=i.getScaledPath("MARKER_SUB_PROCESS",{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:h.width,containerHeight:h.height,position:{mx:(h.width/2-7.5)/h.width,my:(h.height-20)/h.height}});D("sub-process",y,I,{fill:Te(h,s),stroke:ne(h,u)})},ParallelMarker:function(y,h,x){var I=i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:h.width,containerHeight:h.height,position:{mx:(h.width/2+x.parallel)/h.width,my:(h.height-20)/h.height}});D("parallel",y,I,{fill:Te(h,s),stroke:ne(h,u)})},SequentialMarker:function(y,h,x){var I=i.getScaledPath("MARKER_SEQUENTIAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:h.width,containerHeight:h.height,position:{mx:(h.width/2+x.seq)/h.width,my:(h.height-19)/h.height}});D("sequential",y,I,{fill:Te(h,s),stroke:ne(h,u)})},CompensationMarker:function(y,h,x){var I=i.getScaledPath("MARKER_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:h.width,containerHeight:h.height,position:{mx:(h.width/2+x.compensation)/h.width,my:(h.height-13)/h.height}});D("compensation",y,I,{strokeWidth:1,fill:Te(h,s),stroke:ne(h,u)})},LoopMarker:function(y,h,x){var I=i.getScaledPath("MARKER_LOOP",{xScaleFactor:1,yScaleFactor:1,containerWidth:h.width,containerHeight:h.height,position:{mx:(h.width/2+x.loop)/h.width,my:(h.height-7)/h.height}});D("loop",y,I,{strokeWidth:1,fill:Te(h,s),stroke:ne(h,u),strokeLinecap:"round",strokeMiterlimit:.5})},AdhocMarker:function(y,h,x){var I=i.getScaledPath("MARKER_ADHOC",{xScaleFactor:1,yScaleFactor:1,containerWidth:h.width,containerHeight:h.height,position:{mx:(h.width/2+x.adhoc)/h.width,my:(h.height-15)/h.height}});D("adhoc",y,I,{strokeWidth:1,fill:ne(h,u),stroke:ne(h,u)})}};function d(y,h,x){var I=At(h),F=x&&x.indexOf("SubProcessMarker")!==-1,O;F?O={seq:-21,parallel:-22,compensation:-42,loop:-18,adhoc:10}:O={seq:-3,parallel:-6,compensation:-27,loop:0,adhoc:10},B(x,function(Y){M(Y)(y,h,O)}),I.isForCompensation&&M("CompensationMarker")(y,h,O),I.$type==="bpmn:AdHocSubProcess"&&M("AdhocMarker")(y,h,O);var H=I.loopCharacteristics,W=H&&H.isSequential;H&&(W===void 0&&M("LoopMarker")(y,h,O),W===!1&&M("ParallelMarker")(y,h,O),W===!0&&M("SequentialMarker")(y,h,O))}function E(y,h){var x=(h.height-18)/h.height,I=i.getScaledPath("DATA_OBJECT_COLLECTION_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:h.width,containerHeight:h.height,position:{mx:.33,my:x}});C(y,I,{strokeWidth:2})}this._drawPath=C}se(ir,ti);ir.$inject=["config.bpmnRenderer","eventBus","styles","pathMap","canvas","textRenderer"];ir.prototype.canRender=function(e){return w(e,"bpmn:BaseElement")};ir.prototype.drawShape=function(e,t){var n=t.type,i=this.handlers[n];return i(e,t)};ir.prototype.drawConnection=function(e,t){var n=t.type,i=this.handlers[n];return i(e,t)};ir.prototype.getShapePath=function(e){return w(e,"bpmn:Event")?t0(e):w(e,"bpmn:Activity")?n0(e,As):w(e,"bpmn:Gateway")?i0(e):r0(e)};var l0=0,u0={width:150,height:50};function c0(e){var t=e.split("-");return{horizontal:t[0]||"center",vertical:t[1]||"top"}}function p0(e){return nt(e)?G({top:0,left:0,right:0,bottom:0},e):{top:e,left:e,right:e,bottom:e}}function f0(e,t){t.textContent=e;var n;try{var i,a=e==="";return t.textContent=a?"dummy":e,n=t.getBBox(),i={width:n.width+n.x*2,height:n.height},a&&(i.width=0),i}catch(r){return{width:0,height:0}}}function d0(e,t,n){for(var i=e.shift(),a=i,r;;){if(r=f0(a,n),r.width=a?r.width:0,a===" "||a===""||r.width<Math.round(t)||a.length<2)return h0(e,a,i,r);a=v0(a,r.width,t)}}function h0(e,t,n,i){if(t.length<n.length){var a=n.slice(t.length).trim();e.unshift(a)}return{width:i.width,height:i.height,text:t}}var Kd="­";function m0(e,t){var n=e.split(/(\s|-|\u00AD)/g),i,a=[],r=0;if(n.length>1)for(;i=n.shift();)if(i.length+r<t)a.push(i),r+=i.length;else{(i==="-"||i===Kd)&&a.pop();break}var o=a[a.length-1];return o&&o===Kd&&(a[a.length-1]="-"),a.join("")}function v0(e,t,n){var i=Math.max(e.length*(n/t),1),a=m0(e,i);return a||(a=e.slice(0,Math.max(Math.round(i-1),1))),a}function g0(){var e=document.getElementById("helper-svg");return e||(e=le("svg"),ee(e,{id:"helper-svg",width:0,height:0,style:"visibility: hidden; position: fixed"}),document.body.appendChild(e)),e}function vl(e){this._config=G({},{size:u0,padding:l0,style:{},align:"center-top"},e||{})}vl.prototype.createText=function(e,t){return this.layoutText(e,t).element};vl.prototype.getDimensions=function(e,t){return this.layoutText(e,t).dimensions};vl.prototype.layoutText=function(e,t){var n=G({},this._config.size,t.box),i=G({},this._config.style,t.style),a=c0(t.align||this._config.align),r=p0(t.padding!==void 0?t.padding:this._config.padding),o=t.fitBox||!1,s=y0(i),u=e.split(/\u00AD?\r?\n/),c=[],p=n.width-r.left-r.right,f=le("text");ee(f,{x:0,y:0}),ee(f,i);var m=g0();for(fe(m,f);u.length;)c.push(d0(u,p,f));a.vertical==="middle"&&(r.top=r.bottom=0);var v=Ht(c,function(N,A,S){return N+(s||A.height)},0)+r.top+r.bottom,g=Ht(c,function(N,A,S){return A.width>N?A.width:N},0),b=r.top;a.vertical==="middle"&&(b+=(n.height-v)/2),b-=(s||c[0].height)/4;var _=le("text");ee(_,i),B(c,function(N){var A;switch(b+=s||N.height,a.horizontal){case"left":A=r.left;break;case"right":A=(o?g:p)-r.right-N.width;break;default:A=Math.max(((o?g:p)-N.width)/2+r.left,0)}var S=le("tspan");ee(S,{x:A,y:b}),S.textContent=N.text,fe(_,S)}),tt(f);var k={width:g,height:v};return{dimensions:k,element:_}};function y0(e){if("fontSize"in e&&"lineHeight"in e)return e.lineHeight*parseInt(e.fontSize,10)}var E0=12,b0=1.2,_0=30;function Pg(e){var t=G({fontFamily:"Arial, sans-serif",fontSize:E0,fontWeight:"normal",lineHeight:b0},e&&e.defaultStyle||{}),n=parseInt(t.fontSize,10)-1,i=G({},t,{fontSize:n},e&&e.externalStyle||{}),a=new vl({style:t});this.getExternalLabelBounds=function(r,o){var s=a.getDimensions(o,{box:{width:90,height:30,x:r.width/2+r.x,y:r.height/2+r.y},style:i});return{x:Math.round(r.x+r.width/2-s.width/2),y:Math.round(r.y),width:Math.ceil(s.width),height:Math.ceil(s.height)}},this.getTextAnnotationBounds=function(r,o){var s=a.getDimensions(o,{box:r,style:t,align:"left-top",padding:5});return{x:r.x,y:r.y,width:r.width,height:Math.max(_0,Math.round(s.height))}},this.createText=function(r,o){return a.createText(r,o||{})},this.getDefaultStyle=function(){return t},this.getExternalStyle=function(){return i}}Pg.$inject=["config.textRenderer"];function x0(){this.pathMap={EVENT_MESSAGE:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:36,width:36,heightElements:[6,14],widthElements:[10.5,21]},EVENT_SIGNAL:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z",height:36,width:36,heightElements:[18],widthElements:[10,20]},EVENT_ESCALATION:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x0},-{e.y1} l -{e.x0},{e.y1} Z",height:36,width:36,heightElements:[20,7],widthElements:[8]},EVENT_CONDITIONAL:{d:"M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z M {e.x2},{e.y3} l {e.x0},0 M {e.x2},{e.y4} l {e.x0},0 M {e.x2},{e.y5} l {e.x0},0 M {e.x2},{e.y6} l {e.x0},0 M {e.x2},{e.y7} l {e.x0},0 M {e.x2},{e.y8} l {e.x0},0 ",height:36,width:36,heightElements:[8.5,14.5,18,11.5,14.5,17.5,20.5,23.5,26.5],widthElements:[10.5,14.5,12.5]},EVENT_LINK:{d:"m {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z",height:36,width:36,heightElements:[4.4375,6.75,7.8125],widthElements:[9.84375,13.5]},EVENT_ERROR:{d:"m {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z",height:36,width:36,heightElements:[.023,8.737,8.151,16.564,10.591,8.714],widthElements:[.085,6.672,6.97,4.273,5.337,6.636]},EVENT_CANCEL_45:{d:"m {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:36,width:36,heightElements:[4.75,8.5],widthElements:[4.75,8.5]},EVENT_COMPENSATION:{d:"m {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x1},-{e.y2} {e.x2},-{e.y3} 0,{e.y1} -{e.x2},-{e.y3} z",height:36,width:36,heightElements:[6.5,13,.4,6.1],widthElements:[9,9.3,8.7]},EVENT_TIMER_WH:{d:"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ",height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:"M {mx},{my} m {e.x0},{e.y0} l -{e.x1},{e.y1} ",height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_MULTIPLE:{d:"m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z",height:36,width:36,heightElements:[6.28099,12.56199],widthElements:[3.1405,9.42149,12.56198]},EVENT_PARALLEL_MULTIPLE:{d:"m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} -{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z",height:36,width:36,heightElements:[2.56228,7.68683],widthElements:[2.56228,7.68683]},GATEWAY_EXCLUSIVE:{d:"m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} {e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} {e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z",height:17.5,width:17.5,heightElements:[8.5,6.5312,-6.5312,-8.5],widthElements:[6.5,-6.5,3,-3,5,-5]},GATEWAY_PARALLEL:{d:"m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:30,width:30,heightElements:[5,12.5],widthElements:[5,12.5]},GATEWAY_EVENT_BASED:{d:"m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z",height:11,width:11,heightElements:[-6,6,12,-12],widthElements:[9,-3,-12]},GATEWAY_COMPLEX:{d:"m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} {e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} {e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} -{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z",height:17.125,width:17.125,heightElements:[4.875,3.4375,2.125,3],widthElements:[3.4375,2.125,4.875,3]},DATA_OBJECT_PATH:{d:"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0",height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},DATA_OBJECT_COLLECTION_PATH:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},DATA_ARROW:{d:"m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z",height:61,width:51,heightElements:[],widthElements:[]},DATA_STORE:{d:"m  {mx},{my} l  0,{e.y2} c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 l  0,-{e.y2} c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1} {e.x2},0m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0",height:61,width:61,heightElements:[7,10,45],widthElements:[2,58,60]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",height:30,width:10,heightElements:[30],widthElements:[10]},MARKER_SUB_PROCESS:{d:"m{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_PARALLEL:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},MARKER_SEQUENTIAL:{d:"m{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_COMPENSATION:{d:"m {mx},{my} 7,-5 0,10 z m 7.1,-0.3 6.9,-4.7 0,10 -6.9,-4.7 z",height:10,width:21,heightElements:[],widthElements:[]},MARKER_LOOP:{d:"m {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 -6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902",height:13.9,width:13.7,heightElements:[],widthElements:[]},MARKER_ADHOC:{d:"m {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 -3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 -2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z",height:4,width:15,heightElements:[],widthElements:[]},TASK_TYPE_SEND:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:14,width:21,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_SCRIPT:{d:"m {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z m -7,-12 l 5,0 m -4.5,3 l 4.5,0 m -3,3 l 5,0m -4,3 l 5,0",height:15,width:12.6,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_USER_1:{d:"m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 -4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 zm -8,6 l 0,5.5 m 11,0 l 0,-5"},TASK_TYPE_USER_2:{d:"m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 -2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 "},TASK_TYPE_USER_3:{d:"m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 -4.20799998,3.36699999 -4.20699998,4.34799999 z"},TASK_TYPE_MANUAL:{d:"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 -0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 -1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 -10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 -0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 -1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 -0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 -5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z"},TASK_TYPE_INSTANTIATING_SEND:{d:"m {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6"},TASK_TYPE_SERVICE:{d:"m {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 -1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 -0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 -1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 -0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z m 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_SERVICE_FILL:{d:"m {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_BUSINESS_RULE_HEADER:{d:"m {mx},{my} 0,4 20,0 0,-4 z"},TASK_TYPE_BUSINESS_RULE_MAIN:{d:"m {mx},{my} 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"},MESSAGE_FLOW_MARKER:{d:"m {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6"}},this.getRawPath=function(t){return this.pathMap[t].d},this.getScaledPath=function(t,n){var i=this.pathMap[t],a,r;n.abspos?(a=n.abspos.x,r=n.abspos.y):(a=n.containerWidth*n.position.mx,r=n.containerHeight*n.position.my);var o={};if(n.position){for(var s=n.containerHeight/i.height*n.yScaleFactor,u=n.containerWidth/i.width*n.xScaleFactor,c=0;c<i.heightElements.length;c++)o["y"+c]=i.heightElements[c]*s;for(var p=0;p<i.widthElements.length;p++)o["x"+p]=i.widthElements[p]*u}var f=C0(i.d,{mx:a,my:r,e:o});return f}}var S0=/\{([^{}]+)\}/g,w0=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;function T0(e,t,n){var i=n;return t.replace(w0,function(a,r,o,s,u){r=r||s,i&&(r in i&&(i=i[r]),typeof i=="function"&&u&&(i=i()))}),i=(i==null||i==n?e:i)+"",i}function C0(e,t){return String(e).replace(S0,function(n,i){return T0(n,i,t)})}const A0={__init__:["bpmnRenderer"],bpmnRenderer:["type",ir],textRenderer:["type",Pg],pathMap:["type",x0]};function P0(e,t){return t=t||{},e.replace(/{([^}]+)}/g,function(n,i){return t[i]||"{"+i+"}"})}const gl={translate:["value",P0]};var ja={width:90,height:20},Xd=15;function Dr(e){return w(e,"bpmn:Event")||w(e,"bpmn:Gateway")||w(e,"bpmn:DataStoreReference")||w(e,"bpmn:DataObjectReference")||w(e,"bpmn:DataInput")||w(e,"bpmn:DataOutput")||w(e,"bpmn:SequenceFlow")||w(e,"bpmn:MessageFlow")||w(e,"bpmn:Group")}function yl(e){return _t(e.label)}function R0(e){var t=e.length/2-1,n=e[Math.floor(t)],i=e[Math.ceil(t+.01)],a=I0(e),r=Math.atan((i.y-n.y)/(i.x-n.x)),o=a.x,s=a.y;return Math.abs(r)<Math.PI/2?s-=Xd:o+=Xd,{x:o,y:s}}function I0(e){var t=e.length/2-1,n=e[Math.floor(t)],i=e[Math.ceil(t+.01)];return{x:n.x+(i.x-n.x)/2,y:n.y+(i.y-n.y)/2}}function El(e){return e.waypoints?R0(e.waypoints):w(e,"bpmn:Group")?{x:e.x+e.width/2,y:e.y+ja.height/2}:{x:e.x+e.width/2,y:e.y+e.height+ja.height/2}}function N0(e,t){var n,i,a,r=e.di,o=r.label;return o&&o.bounds?(a=o.bounds,i={width:Math.max(ja.width,a.width),height:a.height},n={x:a.x+a.width/2,y:a.y+a.height/2}):(n=El(t),i=ja),G({x:n.x-i.width/2,y:n.y-i.height/2},i)}function _t(e){return e&&!!e.labelTarget}function Ps(e,t){return G({id:e.id,type:e.$type,businessObject:e},t)}function M0(e,t,n){var i=e.di.waypoint;return!i||i.length<2?[Ee(t),Ee(n)]:i.map(function(a){return{x:a.x,y:a.y}})}function Rg(e,t,n,i){return new Error(e("element {element} referenced by {referenced}#{property} not yet drawn",{element:Et(n),referenced:Et(t),property:i}))}function ii(e,t,n,i,a,r){this._eventBus=e,this._canvas=t,this._elementFactory=n,this._elementRegistry=i,this._translate=a,this._textRenderer=r}ii.$inject=["eventBus","canvas","elementFactory","elementRegistry","translate","textRenderer"];ii.prototype.add=function(e,t){var n=e.di,i,a=this._translate,r,o;if(w(n,"bpmndi:BPMNPlane"))i=this._elementFactory.createRoot(Ps(e)),this._canvas.setRootElement(i);else if(w(n,"bpmndi:BPMNShape")){var s=!Le(e),u=D0(e);r=t&&(t.hidden||t.collapsed);var c=e.di.bounds;i=this._elementFactory.createShape(Ps(e,{collapsed:s,hidden:r,x:Math.round(c.x),y:Math.round(c.y),width:Math.round(c.width),height:Math.round(c.height),isFrame:u})),w(e,"bpmn:BoundaryEvent")&&this._attachBoundary(e,i),w(e,"bpmn:Lane")&&(o=0),w(e,"bpmn:DataStoreReference")&&(k0(t,Ee(c))||(t=this._canvas.getRootElement())),this._canvas.addShape(i,t,o)}else if(w(n,"bpmndi:BPMNEdge")){var p=this._getSource(e),f=this._getTarget(e);r=t&&(t.hidden||t.collapsed),i=this._elementFactory.createConnection(Ps(e,{hidden:r,source:p,target:f,waypoints:M0(e,p,f)})),w(e,"bpmn:DataAssociation")&&(t=null),w(e,"bpmn:SequenceFlow")&&(o=0),this._canvas.addConnection(i,t,o)}else throw new Error(a("unknown di {di} for element {semantic}",{di:Et(n),semantic:Et(e)}));return Dr(e)&&Sn(i)&&this.addLabel(e,i),this._eventBus.fire("bpmnElement.added",{element:i}),i};ii.prototype._attachBoundary=function(e,t){var n=this._translate,i=e.attachedToRef;if(!i)throw new Error(n("missing {semantic}#attachedToRef",{semantic:Et(e)}));var a=this._elementRegistry.get(i.id),r=a&&a.attachers;if(!a)throw Rg(n,e,i,"attachedToRef");t.host=a,r||(a.attachers=r=[]),r.indexOf(t)===-1&&r.push(t)};ii.prototype.addLabel=function(e,t){var n,i,a;return n=N0(e,t),i=Sn(t),i&&(n=this._textRenderer.getExternalLabelBounds(n,i)),a=this._elementFactory.createLabel(Ps(e,{id:e.id+"_label",labelTarget:t,type:"label",hidden:t.hidden||!Sn(t),x:Math.round(n.x),y:Math.round(n.y),width:Math.round(n.width),height:Math.round(n.height)})),this._canvas.addShape(a,t.parent)};ii.prototype._getEnd=function(e,t){var n,i,a=e.$type,r=this._translate;if(i=e[t+"Ref"],t==="source"&&a==="bpmn:DataInputAssociation"&&(i=i&&i[0]),(t==="source"&&a==="bpmn:DataOutputAssociation"||t==="target"&&a==="bpmn:DataInputAssociation")&&(i=e.$parent),n=i&&this._getElement(i),n)return n;throw i?Rg(r,e,i,t+"Ref"):new Error(r("{semantic}#{side} Ref not specified",{semantic:Et(e),side:t}))};ii.prototype._getSource=function(e){return this._getEnd(e,"source")};ii.prototype._getTarget=function(e){return this._getEnd(e,"target")};ii.prototype._getElement=function(e){return this._elementRegistry.get(e.id)};function k0(e,t){var n=t.x,i=t.y;return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function D0(e){return w(e,"bpmn:Group")}const O0={__depends__:[gl],bpmnImporter:["type",ii]},L0={__depends__:[A0,O0]};function Zd(e){!e||typeof e.stopPropagation!="function"||e.stopPropagation()}function Kr(e){return e.originalEvent||e.srcEvent}function Mu(e,t){Zd(e),Zd(Kr(e))}function xi(e){return e.pointers&&e.pointers.length&&(e=e.pointers[0]),e.touches&&e.touches.length&&(e=e.touches[0]),e?{x:e.clientX,y:e.clientY}:null}function B0(){return/mac/i.test(navigator.platform)}function Ig(e,t){return(Kr(e)||e).button===t}function Ai(e){return Ig(e,0)}function $0(e){return Ig(e,1)}function Or(e){var t=Kr(e)||e;return Ai(e)?B0()?t.metaKey:t.ctrlKey:!1}function Ng(e){var t=Kr(e)||e;return Ai(e)&&t.shiftKey}function V0(e){return!0}function Yo(e){return Ai(e)||$0(e)}var Jd=500;function Mg(e,t,n){var i=this;function a($,M,V){if(!s($,M)){var K,X,z;V?X=t.getGraphics(V):(K=M.delegateTarget||M.target,K&&(X=K,V=t.get(X))),!(!X||!V)&&(z=e.fire($,{element:V,gfx:X,originalEvent:M}),z===!1&&(M.stopPropagation(),M.preventDefault()))}}var r={};function o($){return r[$]}function s($,M){var V=c[$]||Ai;return!V(M)}var u={click:"element.click",contextmenu:"element.contextmenu",dblclick:"element.dblclick",mousedown:"element.mousedown",mousemove:"element.mousemove",mouseover:"element.hover",mouseout:"element.out",mouseup:"element.mouseup"},c={"element.contextmenu":V0,"element.mousedown":Yo,"element.mouseup":Yo,"element.click":Yo,"element.dblclick":Yo};function p($,M,V){var K=u[$];if(!K)throw new Error("unmapped DOM event name <"+$+">");return a(K,M,V)}var f="svg, .djs-element";function m($,M,V,K){var X=r[V]=function(z){a(V,z)};K&&(c[V]=K),X.$delegate=qt.bind($,f,M,X)}function v($,M,V){var K=o(V);K&&qt.unbind($,M,K.$delegate)}function g($){B(u,function(M,V){m($,V,M)})}function b($){B(u,function(M,V){v($,V,M)})}e.on("canvas.destroy",function($){b($.svg)}),e.on("canvas.init",function($){g($.svg)}),e.on(["shape.added","connection.added"],function($){var M=$.element,V=$.gfx;e.fire("interactionEvents.createHit",{element:M,gfx:V})}),e.on(["shape.changed","connection.changed"],Jd,function($){var M=$.element,V=$.gfx;e.fire("interactionEvents.updateHit",{element:M,gfx:V})}),e.on("interactionEvents.createHit",Jd,function($){var M=$.element,V=$.gfx;i.createDefaultHit(M,V)}),e.on("interactionEvents.updateHit",function($){var M=$.element,V=$.gfx;i.updateDefaultHit(M,V)});var _=S("djs-hit djs-hit-stroke"),k=S("djs-hit djs-hit-click-stroke"),N=S("djs-hit djs-hit-all"),A={all:N,"click-stroke":k,stroke:_};function S($,M){return M=G({stroke:"white",strokeWidth:15},M||{}),n.cls($,["no-fill","no-border"],M)}function C($,M){var V=A[M];if(!V)throw new Error("invalid hit type <"+M+">");return ee($,V),$}function D($,M){fe($,M)}this.removeHits=function($){var M=fc(".djs-hit",$);B(M,tt)},this.createDefaultHit=function($,M){var V=$.waypoints,K=$.isFrame,X;return V?this.createWaypointsHit(M,V):(X=K?"stroke":"all",this.createBoxHit(M,X,{width:$.width,height:$.height}))},this.createWaypointsHit=function($,M){var V=ap(M);return C(V,"stroke"),D($,V),V},this.createBoxHit=function($,M,V){V=G({x:0,y:0},V);var K=le("rect");return C(K,M),ee(K,V),D($,K),K},this.updateDefaultHit=function($,M){var V=Xe(".djs-hit",M);if(V)return $.waypoints?bx(V,$.waypoints):ee(V,{width:$.width,height:$.height}),V},this.fire=a,this.triggerMouseEvent=p,this.mouseHandler=o,this.registerEvent=m,this.unregisterEvent=v}Mg.$inject=["eventBus","elementRegistry","styles"];const no={__init__:["interactionEvents"],interactionEvents:["type",Mg]};var F0=500;function bl(e,t,n){this.offset=6;var i=t.cls("djs-outline",["no-fill"]),a=this;function r(o,s){var u=le("rect");return ee(u,G({x:10,y:10,width:100,height:100},i)),fe(o,u),u}e.on(["shape.added","shape.changed"],F0,function(o){var s=o.element,u=o.gfx,c=Xe(".djs-outline",u);c||(c=r(u)),a.updateShapeOutline(c,s)}),e.on(["connection.added","connection.changed"],function(o){var s=o.element,u=o.gfx,c=Xe(".djs-outline",u);c||(c=r(u)),a.updateConnectionOutline(c,s)})}bl.prototype.updateShapeOutline=function(e,t){ee(e,{x:-this.offset,y:-this.offset,width:t.width+this.offset*2,height:t.height+this.offset*2})};bl.prototype.updateConnectionOutline=function(e,t){var n=xt(t);ee(e,{x:n.x-this.offset,y:n.y-this.offset,width:n.width+this.offset*2,height:n.height+this.offset*2})};bl.$inject=["eventBus","styles","elementRegistry"];const kg={__init__:["outline"],outline:["type",bl]};function Xr(e,t){this._eventBus=e,this._canvas=t,this._selectedElements=[];var n=this;e.on(["shape.remove","connection.remove"],function(i){var a=i.element;n.deselect(a)}),e.on(["diagram.clear","plane.set"],function(i){n.select(null)})}Xr.$inject=["eventBus","canvas"];Xr.prototype.deselect=function(e){var t=this._selectedElements,n=t.indexOf(e);if(n!==-1){var i=t.slice();t.splice(n,1),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:t})}};Xr.prototype.get=function(){return this._selectedElements};Xr.prototype.isSelected=function(e){return this._selectedElements.indexOf(e)!==-1};Xr.prototype.select=function(e,t){var n=this._selectedElements,i=n.slice();xe(e)||(e=e?[e]:[]);var a=this._canvas;e=e.filter(function(r){var o=a.findPlane(r);return o===a.getActivePlane()}),t?B(e,function(r){n.indexOf(r)===-1&&n.push(r)}):this._selectedElements=n=e.slice(),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:n})};var Qd="hover",eh="selected";function Dg(e,t,n,i){this._multiSelectionBox=null;function a(o,s){t.addMarker(o,s)}function r(o,s){t.removeMarker(o,s)}e.on("element.hover",function(o){a(o.element,Qd)}),e.on("element.out",function(o){r(o.element,Qd)}),e.on("selection.changed",function(o){function s(f){r(f,eh)}function u(f){a(f,eh)}var c=o.oldSelection,p=o.newSelection;B(c,function(f){p.indexOf(f)===-1&&s(f)}),B(p,function(f){c.indexOf(f)===-1&&u(f)})})}Dg.$inject=["eventBus","canvas","selection","styles"];function Og(e,t,n,i){e.on("create.end",500,function(a){var r=a.context,o=r.canExecute,s=r.elements,u=r.hints||{},c=u.autoSelect;if(o){if(c===!1)return;xe(c)?t.select(c):t.select(s.filter(j0))}}),e.on("connect.end",500,function(a){var r=a.context,o=r.canExecute,s=r.hover;o&&s&&t.select(s)}),e.on("shape.move.end",500,function(a){var r=a.previousSelection||[],o=i.get(a.context.shape.id),s=Me(r,function(u){return o.id===u.id});s||t.select(o)}),e.on("element.click",function(a){if(Ai(a)){var r=a.element;r===n.getRootElement()&&(r=null);var o=t.isSelected(r),s=t.get().length>1,u=Or(a)||Ng(a);if(o&&s)return u?t.deselect(r):t.select(r);o?t.deselect(r):t.select(r,u)}})}Og.$inject=["eventBus","selection","canvas","elementRegistry"];function j0(e){return!e.hidden}const Fn={__init__:["selectionVisuals","selectionBehavior"],__depends__:[no,kg],selection:["type",Xr],selectionVisuals:["type",Dg],selectionBehavior:["type",Og]};function Ep(e){this._counter=0,this._prefix=(e?e+"-":"")+Math.floor(Math.random()*1e9)+"-"}Ep.prototype.next=function(){return this._prefix+ ++this._counter};var H0=new Ep("ov"),z0=500;function vt(e,t,n,i){this._eventBus=t,this._canvas=n,this._elementRegistry=i,this._ids=H0,this._overlayDefaults=G({show:null,scale:!0},e&&e.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=G0(n.getContainer()),this._init()}vt.$inject=["config.overlays","eventBus","canvas","elementRegistry"];vt.prototype.get=function(e){if(jt(e)&&(e={id:e}),jt(e.element)&&(e.element=this._elementRegistry.get(e.element)),e.element){var t=this._getOverlayContainer(e.element,!0);return t?e.type?ge(t.overlays,ln({type:e.type})):t.overlays.slice():[]}else return e.type?ge(this._overlays,ln({type:e.type})):e.id?this._overlays[e.id]:null};vt.prototype.add=function(e,t,n){if(nt(t)&&(n=t,t=null),e.id||(e=this._elementRegistry.get(e)),!n.position)throw new Error("must specifiy overlay position");if(!n.html)throw new Error("must specifiy overlay html");if(!e)throw new Error("invalid element specified");var i=this._ids.next();return n=G({},this._overlayDefaults,n,{id:i,type:t,element:e,html:n.html}),this._addOverlay(n),i};vt.prototype.remove=function(e){var t=this.get(e)||[];xe(t)||(t=[t]);var n=this;B(t,function(i){var a=n._getOverlayContainer(i.element,!0);if(i&&($n(i.html),$n(i.htmlContainer),delete i.htmlContainer,delete i.element,delete n._overlays[i.id]),a){var r=a.overlays.indexOf(i);r!==-1&&a.overlays.splice(r,1)}})};vt.prototype.show=function(){io(this._overlayRoot)};vt.prototype.hide=function(){io(this._overlayRoot,!1)};vt.prototype.clear=function(){this._overlays={},this._overlayContainers=[],ol(this._overlayRoot)};vt.prototype._updateOverlayContainer=function(e){var t=e.element,n=e.html,i=t.x,a=t.y;if(t.waypoints){var r=xt(t);i=r.x,a=r.y}Lg(n,i,a),Xt(e.html,"data-container-id",t.id)};vt.prototype._updateOverlay=function(e){var t=e.position,n=e.htmlContainer,i=e.element,a=t.left,r=t.top;if(t.right!==void 0){var o;i.waypoints?o=xt(i).width:o=i.width,a=t.right*-1+o}if(t.bottom!==void 0){var s;i.waypoints?s=xt(i).height:s=i.height,r=t.bottom*-1+s}Lg(n,a||0,r||0)};vt.prototype._createOverlayContainer=function(e){var t=je('<div class="djs-overlays" style="position: absolute" />');this._overlayRoot.appendChild(t);var n={html:t,element:e,overlays:[]};return this._updateOverlayContainer(n),this._overlayContainers.push(n),n};vt.prototype._updateRoot=function(e){var t=e.scale||1,n="matrix("+[t,0,0,t,-1*e.x*t,-1*e.y*t].join(",")+")";Bg(this._overlayRoot,n)};vt.prototype._getOverlayContainer=function(e,t){var n=Me(this._overlayContainers,function(i){return i.element===e});return!n&&!t?this._createOverlayContainer(e):n};vt.prototype._addOverlay=function(e){var t=e.id,n=e.element,i=e.html,a,r;i.get&&i.constructor.prototype.jquery&&(i=i.get(0)),jt(i)&&(i=je(i)),r=this._getOverlayContainer(n),a=je('<div class="djs-overlay" data-overlay-id="'+t+'" style="position: absolute">'),a.appendChild(i),e.type&&lt(a).add("djs-overlay-"+e.type);var o=this._canvas.findPlane(n),s=this._canvas.getActivePlane();e.plane=o,o!==s&&io(a,!1),e.htmlContainer=a,r.overlays.push(e),r.html.appendChild(a),this._overlays[t]=e,this._updateOverlay(e),this._updateOverlayVisibilty(e,this._canvas.viewbox())};vt.prototype._updateOverlayVisibilty=function(e,t){var n=e.show,i=e.plane,a=n&&n.minZoom,r=n&&n.maxZoom,o=e.htmlContainer,s=this._canvas.getActivePlane(),u=!0;(i!==s||n&&(sn(a)&&a>t.scale||sn(r)&&r<t.scale))&&(u=!1),io(o,u),this._updateOverlayScale(e,t)};vt.prototype._updateOverlayScale=function(e,t){var n=e.scale,i,a,r=e.htmlContainer,o,s="";n!==!0&&(n===!1?(i=1,a=1):(i=n.min,a=n.max),sn(i)&&t.scale<i&&(o=(1/t.scale||1)*i),sn(a)&&t.scale>a&&(o=(1/t.scale||1)*a)),sn(o)&&(s="scale("+o+","+o+")"),Bg(r,s)};vt.prototype._updateOverlaysVisibilty=function(e){var t=this;B(this._overlays,function(n){t._updateOverlayVisibilty(n,e)})};vt.prototype._init=function(){var e=this._eventBus,t=this;function n(i){t._updateRoot(i),t._updateOverlaysVisibilty(i),t.show()}e.on("canvas.viewbox.changing",function(i){t.hide()}),e.on("canvas.viewbox.changed",function(i){n(i.viewbox)}),e.on(["shape.remove","connection.remove"],function(i){var a=i.element,r=t.get({element:a});B(r,function(u){t.remove(u.id)});var o=t._getOverlayContainer(a);if(o){$n(o.html);var s=t._overlayContainers.indexOf(o);s!==-1&&t._overlayContainers.splice(s,1)}}),e.on("element.changed",z0,function(i){var a=i.element,r=t._getOverlayContainer(a,!0);r&&(B(r.overlays,function(o){t._updateOverlay(o)}),t._updateOverlayContainer(r))}),e.on("element.marker.update",function(i){var a=t._getOverlayContainer(i.element,!0);a&&lt(a.html)[i.add?"add":"remove"](i.marker)}),e.on("plane.set",function(i){B(t._overlays,function(a){io(a.htmlContainer,a.plane===i.plane)})}),e.on("diagram.clear",this.clear,this)};function G0(e){var t=je('<div class="djs-overlay-container" style="position: absolute; width: 0; height: 0;" />');return e.insertBefore(t,e.firstChild),t}function Lg(e,t,n){G(e.style,{left:t+"px",top:n+"px"})}function io(e,t){e.style.display=t===!1?"none":""}function Bg(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){e.style[n+"transform"]=t})}const bp={__init__:["overlays"],overlays:["type",vt]};function ri(e){We.call(this,e)}se(ri,We);ri.prototype._modules=[L0,gl,Fn,bp];ri.prototype._moddleExtensions={};var U0=67,W0=86,q0=89,Y0=90,K0=["c","C",U0],X0=["v","V",W0],Z0=["y","Y",q0],$g=["z","Z",Y0];function J0(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey}function Kt(e){return e.altKey?!1:e.ctrlKey||e.metaKey}function _n(e,t){return e=xe(e)?e:[e],e.indexOf(t.key)!==-1||e.indexOf(t.keyCode)!==-1}function _p(e){return e.shiftKey}function Q0(e){return Kt(e)&&_n(K0,e)}function eT(e){return Kt(e)&&_n(X0,e)}function tT(e){return Kt(e)&&!_p(e)&&_n($g,e)}function nT(e){return Kt(e)&&(_n(Z0,e)||_n($g,e)&&_p(e))}var _l="keyboard.keydown",iT="keyboard.keyup",th="input-handle-modified-keys",rT=1e3;function gt(e,t){var n=this;this._config=e||{},this._eventBus=t,this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),t.on("diagram.destroy",function(){n._fire("destroy"),n.unbind()}),t.on("diagram.init",function(){n._fire("init")}),t.on("attach",function(){e&&e.bindTo&&n.bind(e.bindTo)}),t.on("detach",function(){n.unbind()})}gt.$inject=["config.keyboard","eventBus"];gt.prototype._keydownHandler=function(e){this._keyHandler(e,_l)};gt.prototype._keyupHandler=function(e){this._keyHandler(e,iT)};gt.prototype._keyHandler=function(e,t){var n;if(!this._isEventIgnored(e)){var i={keyEvent:e};n=this._eventBus.fire(t||_l,i),n&&e.preventDefault()}};gt.prototype._isEventIgnored=function(e){return aT(e.target)&&this._isModifiedKeyIgnored(e)};gt.prototype._isModifiedKeyIgnored=function(e){if(!Kt(e))return!0;var t=this._getAllowedModifiers(e.target);return!t.includes(e.key)};gt.prototype._getAllowedModifiers=function(e){var t=tr(e,"["+th+"]",!0);return!t||this._node&&!this._node.contains(t)?[]:t.getAttribute(th).split(",")};gt.prototype.bind=function(e){this.unbind(),this._node=e,pe.bind(e,"keydown",this._keydownHandler,!0),pe.bind(e,"keyup",this._keyupHandler,!0),this._fire("bind")};gt.prototype.getBinding=function(){return this._node};gt.prototype.unbind=function(){var e=this._node;e&&(this._fire("unbind"),pe.unbind(e,"keydown",this._keydownHandler,!0),pe.unbind(e,"keyup",this._keyupHandler,!0)),this._node=null};gt.prototype._fire=function(e){this._eventBus.fire("keyboard."+e,{node:this._node})};gt.prototype.addListener=function(e,t,n){bt(e)&&(n=t,t=e,e=rT),this._eventBus.on(n||_l,e,t)};gt.prototype.removeListener=function(e,t){this._eventBus.off(t||_l,e)};gt.prototype.hasModifier=J0;gt.prototype.isCmd=Kt;gt.prototype.isShift=_p;gt.prototype.isKey=_n;function aT(e){return e&&($s(e,"input, textarea")||e.contentEditable==="true")}var oT=500;function Zr(e,t){var n=this;e.on("editorActions.init",oT,function(i){var a=i.editorActions;n.registerBindings(t,a)})}Zr.$inject=["eventBus","keyboard"];Zr.prototype.registerBindings=function(e,t){function n(i,a){t.isRegistered(i)&&e.addListener(a)}n("undo",function(i){var a=i.keyEvent;if(tT(a))return t.trigger("undo"),!0}),n("redo",function(i){var a=i.keyEvent;if(nT(a))return t.trigger("redo"),!0}),n("copy",function(i){var a=i.keyEvent;if(Q0(a))return t.trigger("copy"),!0}),n("paste",function(i){var a=i.keyEvent;if(eT(a))return t.trigger("paste"),!0}),n("stepZoom",function(i){var a=i.keyEvent;if(_n(["+","Add","="],a)&&Kt(a))return t.trigger("stepZoom",{value:1}),!0}),n("stepZoom",function(i){var a=i.keyEvent;if(_n(["-","Subtract"],a)&&Kt(a))return t.trigger("stepZoom",{value:-1}),!0}),n("zoom",function(i){var a=i.keyEvent;if(_n("0",a)&&Kt(a))return t.trigger("zoom",{value:1}),!0}),n("removeSelection",function(i){var a=i.keyEvent;if(_n(["Backspace","Delete","Del"],a))return t.trigger("removeSelection"),!0})};const xp={__init__:["keyboard","keyboardBindings"],keyboard:["type",gt],keyboardBindings:["type",Zr]};var sT={moveSpeed:50,moveSpeedAccelerated:200};function Vg(e,t,n){var i=this;this._config=G({},sT,e||{}),t.addListener(a);function a(r){var o=r.keyEvent,s=i._config;if(t.isCmd(o)&&t.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],o)){var u=t.isShift(o)?s.moveSpeedAccelerated:s.moveSpeed,c;switch(o.key){case"ArrowLeft":case"Left":c="left";break;case"ArrowUp":case"Up":c="up";break;case"ArrowRight":case"Right":c="right";break;case"ArrowDown":case"Down":c="down";break}return i.moveCanvas({speed:u,direction:c}),!0}}this.moveCanvas=function(r){var o=0,s=0,u=r.speed,c=u/Math.min(Math.sqrt(n.viewbox().scale),1);switch(r.direction){case"left":o=c;break;case"up":s=c;break;case"right":o=-c;break;case"down":s=-c;break}n.scroll({dx:o,dy:s})}}Vg.$inject=["config.keyboardMove","keyboard","canvas"];const Fg={__depends__:[xp],__init__:["keyboardMove"],keyboardMove:["type",Vg]};var lT=/^djs-cursor-.*$/;function xl(e){var t=lt(document.body);t.removeMatching(lT),e&&t.add("djs-cursor-"+e)}function jg(){xl(null)}var uT=5e3;function Hg(e,t){t=t||"element.click";function n(){return!1}return e.once(t,uT,n),function(){e.off(t,n)}}function Ma(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function On(e,t){return{x:e.x-t.x,y:e.y-t.y}}var cT=15;function zg(e,t){var n;e.on("element.mousedown",500,function(o){return r(o.originalEvent)});function i(o){var s=n.start,u=n.button,c=xi(o),p=On(c,s);if(!n.dragging&&pT(p)>cT&&(n.dragging=!0,u===0&&Hg(e),xl("grab")),n.dragging){var f=n.last||n.start;p=On(c,f),t.scroll({dx:p.x,dy:p.y}),n.last=c}o.preventDefault()}function a(o){pe.unbind(document,"mousemove",i),pe.unbind(document,"mouseup",a),n=null,jg()}function r(o){if(!tr(o.target,".djs-draggable")){var s=o.button;if(!(s>=2||o.ctrlKey||o.shiftKey||o.altKey))return n={button:s,start:xi(o)},pe.bind(document,"mousemove",i),pe.bind(document,"mouseup",a),!0}}this.isActive=function(){return!!n}}zg.$inject=["eventBus","canvas"];function pT(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}const Gg={__init__:["moveCanvas"],moveCanvas:["type",zg]};function Tc(e){return Math.log(e)/Math.log(10)}function Ug(e,t){var n=Tc(e.min),i=Tc(e.max),a=Math.abs(n)+Math.abs(i);return a/t}function fT(e,t){return Math.max(e.min,Math.min(e.max,t))}var dT=Math.sign||function(e){return e>=0?1:-1},Sp={min:.2,max:4},Wg=10,hT=.1,mT=.75;function jn(e,t,n){e=e||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=Pt(this._handleWheel,this),this._totalDelta=0,this._scale=e.scale||mT;var i=this;t.on("canvas.init",function(a){i._init(e.enabled!==!1)})}jn.$inject=["config.zoomScroll","eventBus","canvas"];jn.prototype.scroll=function(t){this._canvas.scroll(t)};jn.prototype.reset=function(){this._canvas.zoom("fit-viewport")};jn.prototype.zoom=function(t,n){var i=Ug(Sp,Wg*2);this._totalDelta+=t,Math.abs(this._totalDelta)>hT&&(this._zoom(t,n,i),this._totalDelta=0)};jn.prototype._handleWheel=function(t){if(!tr(t.target,".djs-scrollable",!0)){var n=this._container;t.preventDefault();var i=t.ctrlKey,a=t.shiftKey,r=-1*this._scale,o;if(i?r*=t.deltaMode===0?.02:.32:r*=t.deltaMode===0?1:16,i){var s=n.getBoundingClientRect(),u={x:t.clientX-s.left,y:t.clientY-s.top};o=Math.sqrt(Math.pow(t.deltaY,2)+Math.pow(t.deltaX,2))*dT(t.deltaY)*r,this.zoom(o,u)}else a?o={dx:r*t.deltaY,dy:0}:o={dx:r*t.deltaX,dy:r*t.deltaY},this.scroll(o)}};jn.prototype.stepZoom=function(t,n){var i=Ug(Sp,Wg);this._zoom(t,n,i)};jn.prototype._zoom=function(e,t,n){var i=this._canvas,a=e>0?1:-1,r=Tc(i.zoom()),o=Math.round(r/n)*n;o+=n*a;var s=Math.pow(10,o);i.zoom(fT(Sp,s),t)};jn.prototype.toggle=function(t){var n=this._container,i=this._handleWheel,a=this._enabled;return typeof t=="undefined"&&(t=!a),a!==t&&pe[t?"bind":"unbind"](n,"wheel",i,!1),this._enabled=t,t};jn.prototype._init=function(e){this.toggle(e)};const qg={__init__:["zoomScroll"],zoomScroll:["type",jn]};function Ha(e){ri.call(this,e)}se(Ha,ri);Ha.prototype._navigationModules=[Fg,Gg,qg];Ha.prototype._modules=[].concat(ri.prototype._modules,Ha.prototype._navigationModules);var Yg={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(e){(function(t,n,i,a){var r=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),s="function",u=Math.round,c=Math.abs,p=Date.now;function f(T,P,L){return setTimeout(A(T,L),P)}function m(T,P,L){return Array.isArray(T)?(v(T,L[P],L),!0):!1}function v(T,P,L){var q;if(T)if(T.forEach)T.forEach(P,L);else if(T.length!==a)for(q=0;q<T.length;)P.call(L,T[q],q,T),q++;else for(q in T)T.hasOwnProperty(q)&&P.call(L,T[q],q,T)}function g(T,P,L){var q="DEPRECATED METHOD: "+P+`
`+L+` AT 
`;return function(){var J=new Error("get-stack-trace"),ae=J&&J.stack?J.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Ae=t.console&&(t.console.warn||t.console.log);return Ae&&Ae.call(t.console,q,ae),T.apply(this,arguments)}}var b;typeof Object.assign!="function"?b=function(P){if(P===a||P===null)throw new TypeError("Cannot convert undefined or null to object");for(var L=Object(P),q=1;q<arguments.length;q++){var J=arguments[q];if(J!==a&&J!==null)for(var ae in J)J.hasOwnProperty(ae)&&(L[ae]=J[ae])}return L}:b=Object.assign;var _=g(function(P,L,q){for(var J=Object.keys(L),ae=0;ae<J.length;)(!q||q&&P[J[ae]]===a)&&(P[J[ae]]=L[J[ae]]),ae++;return P},"extend","Use `assign`."),k=g(function(P,L){return _(P,L,!0)},"merge","Use `assign`.");function N(T,P,L){var q=P.prototype,J;J=T.prototype=Object.create(q),J.constructor=T,J._super=q,L&&b(J,L)}function A(T,P){return function(){return T.apply(P,arguments)}}function S(T,P){return typeof T==s?T.apply(P&&P[0]||a,P):T}function C(T,P){return T===a?P:T}function D(T,P,L){v(K(P),function(q){T.addEventListener(q,L,!1)})}function $(T,P,L){v(K(P),function(q){T.removeEventListener(q,L,!1)})}function M(T,P){for(;T;){if(T==P)return!0;T=T.parentNode}return!1}function V(T,P){return T.indexOf(P)>-1}function K(T){return T.trim().split(/\s+/g)}function X(T,P,L){if(T.indexOf&&!L)return T.indexOf(P);for(var q=0;q<T.length;){if(L&&T[q][L]==P||!L&&T[q]===P)return q;q++}return-1}function z(T){return Array.prototype.slice.call(T,0)}function U(T,P,L){for(var q=[],J=[],ae=0;ae<T.length;){var Ae=P?T[ae][P]:T[ae];X(J,Ae)<0&&q.push(T[ae]),J[ae]=Ae,ae++}return L&&(P?q=q.sort(function(yt,Mt){return yt[P]>Mt[P]}):q=q.sort()),q}function Q(T,P){for(var L,q,J=P[0].toUpperCase()+P.slice(1),ae=0;ae<r.length;){if(L=r[ae],q=L?L+J:P,q in T)return q;ae++}return a}var l=1;function d(){return l++}function E(T){var P=T.ownerDocument||T;return P.defaultView||P.parentWindow||t}var y=/mobile|tablet|ip(ad|hone|od)|android/i,h="ontouchstart"in t,x=Q(t,"PointerEvent")!==a,I=h&&y.test(navigator.userAgent),F="touch",O="pen",H="mouse",W="kinect",Y=25,he=1,Fe=2,_e=4,we=8,ft=1,dt=2,De=4,ze=8,It=16,Nt=dt|De,Ct=ze|It,Ye=Nt|Ct,Ut=["x","y"],Re=["clientX","clientY"];function ut(T,P){var L=this;this.manager=T,this.callback=P,this.element=T.element,this.target=T.options.inputTarget,this.domHandler=function(q){S(T.options.enable,[T])&&L.handler(q)},this.init()}ut.prototype={handler:function(){},init:function(){this.evEl&&D(this.element,this.evEl,this.domHandler),this.evTarget&&D(this.target,this.evTarget,this.domHandler),this.evWin&&D(E(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&$(this.element,this.evEl,this.domHandler),this.evTarget&&$(this.target,this.evTarget,this.domHandler),this.evWin&&$(E(this.element),this.evWin,this.domHandler)}};function ko(T){var P,L=T.options.inputClass;return L?P=L:x?P=Eu:I?P=Lo:h?P=bu:P=Oo,new P(T,Wt)}function Wt(T,P,L){var q=L.pointers.length,J=L.changedPointers.length,ae=P&he&&q-J===0,Ae=P&(_e|we)&&q-J===0;L.isFirst=!!ae,L.isFinal=!!Ae,ae&&(T.session={}),L.eventType=P,ue(T,L),T.emit("hammer.input",L),T.recognize(L),T.session.prevInput=L}function ue(T,P){var L=T.session,q=P.pointers,J=q.length;L.firstInput||(L.firstInput=td(P)),J>1&&!L.firstMultiple?L.firstMultiple=td(P):J===1&&(L.firstMultiple=!1);var ae=L.firstInput,Ae=L.firstMultiple,ht=Ae?Ae.center:ae.center,yt=P.center=nd(q);P.timeStamp=p(),P.deltaTime=P.timeStamp-ae.timeStamp,P.angle=yu(ht,yt),P.distance=Do(ht,yt),ke(L,P),P.offsetDirection=rd(P.deltaX,P.deltaY);var Mt=id(P.deltaTime,P.deltaX,P.deltaY);P.overallVelocityX=Mt.x,P.overallVelocityY=Mt.y,P.overallVelocity=c(Mt.x)>c(Mt.y)?Mt.x:Mt.y,P.scale=Ae?zb(Ae.pointers,q):1,P.rotation=Ae?Hb(Ae.pointers,q):0,P.maxPointers=L.prevInput?P.pointers.length>L.prevInput.maxPointers?P.pointers.length:L.prevInput.maxPointers:P.pointers.length,jb(L,P);var Rn=T.element;M(P.srcEvent.target,Rn)&&(Rn=P.srcEvent.target),P.target=Rn}function ke(T,P){var L=P.center,q=T.offsetDelta||{},J=T.prevDelta||{},ae=T.prevInput||{};(P.eventType===he||ae.eventType===_e)&&(J=T.prevDelta={x:ae.deltaX||0,y:ae.deltaY||0},q=T.offsetDelta={x:L.x,y:L.y}),P.deltaX=J.x+(L.x-q.x),P.deltaY=J.y+(L.y-q.y)}function jb(T,P){var L=T.lastInterval||P,q=P.timeStamp-L.timeStamp,J,ae,Ae,ht;if(P.eventType!=we&&(q>Y||L.velocity===a)){var yt=P.deltaX-L.deltaX,Mt=P.deltaY-L.deltaY,Rn=id(q,yt,Mt);ae=Rn.x,Ae=Rn.y,J=c(Rn.x)>c(Rn.y)?Rn.x:Rn.y,ht=rd(yt,Mt),T.lastInterval=P}else J=L.velocity,ae=L.velocityX,Ae=L.velocityY,ht=L.direction;P.velocity=J,P.velocityX=ae,P.velocityY=Ae,P.direction=ht}function td(T){for(var P=[],L=0;L<T.pointers.length;)P[L]={clientX:u(T.pointers[L].clientX),clientY:u(T.pointers[L].clientY)},L++;return{timeStamp:p(),pointers:P,center:nd(P),deltaX:T.deltaX,deltaY:T.deltaY}}function nd(T){var P=T.length;if(P===1)return{x:u(T[0].clientX),y:u(T[0].clientY)};for(var L=0,q=0,J=0;J<P;)L+=T[J].clientX,q+=T[J].clientY,J++;return{x:u(L/P),y:u(q/P)}}function id(T,P,L){return{x:P/T||0,y:L/T||0}}function rd(T,P){return T===P?ft:c(T)>=c(P)?T<0?dt:De:P<0?ze:It}function Do(T,P,L){L||(L=Ut);var q=P[L[0]]-T[L[0]],J=P[L[1]]-T[L[1]];return Math.sqrt(q*q+J*J)}function yu(T,P,L){L||(L=Ut);var q=P[L[0]]-T[L[0]],J=P[L[1]]-T[L[1]];return Math.atan2(J,q)*180/Math.PI}function Hb(T,P){return yu(P[1],P[0],Re)+yu(T[1],T[0],Re)}function zb(T,P){return Do(P[0],P[1],Re)/Do(T[0],T[1],Re)}var Gb={mousedown:he,mousemove:Fe,mouseup:_e},Ub="mousedown",Wb="mousemove mouseup";function Oo(){this.evEl=Ub,this.evWin=Wb,this.pressed=!1,ut.apply(this,arguments)}N(Oo,ut,{handler:function(P){var L=Gb[P.type];L&he&&P.button===0&&(this.pressed=!0),L&Fe&&P.which!==1&&(L=_e),this.pressed&&(L&_e&&(this.pressed=!1),this.callback(this.manager,L,{pointers:[P],changedPointers:[P],pointerType:H,srcEvent:P}))}});var qb={pointerdown:he,pointermove:Fe,pointerup:_e,pointercancel:we,pointerout:we},Yb={2:F,3:O,4:H,5:W},ad="pointerdown",od="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(ad="MSPointerDown",od="MSPointerMove MSPointerUp MSPointerCancel");function Eu(){this.evEl=ad,this.evWin=od,ut.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}N(Eu,ut,{handler:function(P){var L=this.store,q=!1,J=P.type.toLowerCase().replace("ms",""),ae=qb[J],Ae=Yb[P.pointerType]||P.pointerType,ht=Ae==F,yt=X(L,P.pointerId,"pointerId");ae&he&&(P.button===0||ht)?yt<0&&(L.push(P),yt=L.length-1):ae&(_e|we)&&(q=!0),!(yt<0)&&(L[yt]=P,this.callback(this.manager,ae,{pointers:L,changedPointers:[P],pointerType:Ae,srcEvent:P}),q&&L.splice(yt,1))}});var Kb={touchstart:he,touchmove:Fe,touchend:_e,touchcancel:we},Xb="touchstart",Zb="touchstart touchmove touchend touchcancel";function sd(){this.evTarget=Xb,this.evWin=Zb,this.started=!1,ut.apply(this,arguments)}N(sd,ut,{handler:function(P){var L=Kb[P.type];if(L===he&&(this.started=!0),!!this.started){var q=Jb.call(this,P,L);L&(_e|we)&&q[0].length-q[1].length===0&&(this.started=!1),this.callback(this.manager,L,{pointers:q[0],changedPointers:q[1],pointerType:F,srcEvent:P})}}});function Jb(T,P){var L=z(T.touches),q=z(T.changedTouches);return P&(_e|we)&&(L=U(L.concat(q),"identifier",!0)),[L,q]}var Qb={touchstart:he,touchmove:Fe,touchend:_e,touchcancel:we},e_="touchstart touchmove touchend touchcancel";function Lo(){this.evTarget=e_,this.targetIds={},ut.apply(this,arguments)}N(Lo,ut,{handler:function(P){var L=Qb[P.type],q=t_.call(this,P,L);q&&this.callback(this.manager,L,{pointers:q[0],changedPointers:q[1],pointerType:F,srcEvent:P})}});function t_(T,P){var L=z(T.touches),q=this.targetIds;if(P&(he|Fe)&&L.length===1)return q[L[0].identifier]=!0,[L,L];var J,ae,Ae=z(T.changedTouches),ht=[],yt=this.target;if(ae=L.filter(function(Mt){return M(Mt.target,yt)}),P===he)for(J=0;J<ae.length;)q[ae[J].identifier]=!0,J++;for(J=0;J<Ae.length;)q[Ae[J].identifier]&&ht.push(Ae[J]),P&(_e|we)&&delete q[Ae[J].identifier],J++;if(ht.length)return[U(ae.concat(ht),"identifier",!0),ht]}var n_=2500,ld=25;function bu(){ut.apply(this,arguments);var T=A(this.handler,this);this.touch=new Lo(this.manager,T),this.mouse=new Oo(this.manager,T),this.primaryTouch=null,this.lastTouches=[]}N(bu,ut,{handler:function(P,L,q){var J=q.pointerType==F,ae=q.pointerType==H;if(!(ae&&q.sourceCapabilities&&q.sourceCapabilities.firesTouchEvents)){if(J)i_.call(this,L,q);else if(ae&&r_.call(this,q))return;this.callback(P,L,q)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function i_(T,P){T&he?(this.primaryTouch=P.changedPointers[0].identifier,ud.call(this,P)):T&(_e|we)&&ud.call(this,P)}function ud(T){var P=T.changedPointers[0];if(P.identifier===this.primaryTouch){var L={x:P.clientX,y:P.clientY};this.lastTouches.push(L);var q=this.lastTouches,J=function(){var ae=q.indexOf(L);ae>-1&&q.splice(ae,1)};setTimeout(J,n_)}}function r_(T){for(var P=T.srcEvent.clientX,L=T.srcEvent.clientY,q=0;q<this.lastTouches.length;q++){var J=this.lastTouches[q],ae=Math.abs(P-J.x),Ae=Math.abs(L-J.y);if(ae<=ld&&Ae<=ld)return!0}return!1}var cd=Q(o.style,"touchAction"),pd=cd!==a,fd="compute",dd="auto",_u="manipulation",Vi="none",fa="pan-x",da="pan-y",Bo=o_();function xu(T,P){this.manager=T,this.set(P)}xu.prototype={set:function(T){T==fd&&(T=this.compute()),pd&&this.manager.element.style&&Bo[T]&&(this.manager.element.style[cd]=T),this.actions=T.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var T=[];return v(this.manager.recognizers,function(P){S(P.options.enable,[P])&&(T=T.concat(P.getTouchAction()))}),a_(T.join(" "))},preventDefaults:function(T){var P=T.srcEvent,L=T.offsetDirection;if(this.manager.session.prevented){P.preventDefault();return}var q=this.actions,J=V(q,Vi)&&!Bo[Vi],ae=V(q,da)&&!Bo[da],Ae=V(q,fa)&&!Bo[fa];if(J){var ht=T.pointers.length===1,yt=T.distance<2,Mt=T.deltaTime<250;if(ht&&yt&&Mt)return}if(!(Ae&&ae)&&(J||ae&&L&Nt||Ae&&L&Ct))return this.preventSrc(P)},preventSrc:function(T){this.manager.session.prevented=!0,T.preventDefault()}};function a_(T){if(V(T,Vi))return Vi;var P=V(T,fa),L=V(T,da);return P&&L?Vi:P||L?P?fa:da:V(T,_u)?_u:dd}function o_(){if(!pd)return!1;var T={},P=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(L){T[L]=P?t.CSS.supports("touch-action",L):!0}),T}var $o=1,Qt=2,mr=4,pi=8,Gn=pi,ha=16,Pn=32;function Un(T){this.options=b({},this.defaults,T||{}),this.id=d(),this.manager=null,this.options.enable=C(this.options.enable,!0),this.state=$o,this.simultaneous={},this.requireFail=[]}Un.prototype={defaults:{},set:function(T){return b(this.options,T),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(T){if(m(T,"recognizeWith",this))return this;var P=this.simultaneous;return T=Vo(T,this),P[T.id]||(P[T.id]=T,T.recognizeWith(this)),this},dropRecognizeWith:function(T){return m(T,"dropRecognizeWith",this)?this:(T=Vo(T,this),delete this.simultaneous[T.id],this)},requireFailure:function(T){if(m(T,"requireFailure",this))return this;var P=this.requireFail;return T=Vo(T,this),X(P,T)===-1&&(P.push(T),T.requireFailure(this)),this},dropRequireFailure:function(T){if(m(T,"dropRequireFailure",this))return this;T=Vo(T,this);var P=X(this.requireFail,T);return P>-1&&this.requireFail.splice(P,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(T){return!!this.simultaneous[T.id]},emit:function(T){var P=this,L=this.state;function q(J){P.manager.emit(J,T)}L<pi&&q(P.options.event+hd(L)),q(P.options.event),T.additionalEvent&&q(T.additionalEvent),L>=pi&&q(P.options.event+hd(L))},tryEmit:function(T){if(this.canEmit())return this.emit(T);this.state=Pn},canEmit:function(){for(var T=0;T<this.requireFail.length;){if(!(this.requireFail[T].state&(Pn|$o)))return!1;T++}return!0},recognize:function(T){var P=b({},T);if(!S(this.options.enable,[this,P])){this.reset(),this.state=Pn;return}this.state&(Gn|ha|Pn)&&(this.state=$o),this.state=this.process(P),this.state&(Qt|mr|pi|ha)&&this.tryEmit(P)},process:function(T){},getTouchAction:function(){},reset:function(){}};function hd(T){return T&ha?"cancel":T&pi?"end":T&mr?"move":T&Qt?"start":""}function md(T){return T==It?"down":T==ze?"up":T==dt?"left":T==De?"right":""}function Vo(T,P){var L=P.manager;return L?L.get(T):T}function yn(){Un.apply(this,arguments)}N(yn,Un,{defaults:{pointers:1},attrTest:function(T){var P=this.options.pointers;return P===0||T.pointers.length===P},process:function(T){var P=this.state,L=T.eventType,q=P&(Qt|mr),J=this.attrTest(T);return q&&(L&we||!J)?P|ha:q||J?L&_e?P|pi:P&Qt?P|mr:Qt:Pn}});function Fo(){yn.apply(this,arguments),this.pX=null,this.pY=null}N(Fo,yn,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ye},getTouchAction:function(){var T=this.options.direction,P=[];return T&Nt&&P.push(da),T&Ct&&P.push(fa),P},directionTest:function(T){var P=this.options,L=!0,q=T.distance,J=T.direction,ae=T.deltaX,Ae=T.deltaY;return J&P.direction||(P.direction&Nt?(J=ae===0?ft:ae<0?dt:De,L=ae!=this.pX,q=Math.abs(T.deltaX)):(J=Ae===0?ft:Ae<0?ze:It,L=Ae!=this.pY,q=Math.abs(T.deltaY))),T.direction=J,L&&q>P.threshold&&J&P.direction},attrTest:function(T){return yn.prototype.attrTest.call(this,T)&&(this.state&Qt||!(this.state&Qt)&&this.directionTest(T))},emit:function(T){this.pX=T.deltaX,this.pY=T.deltaY;var P=md(T.direction);P&&(T.additionalEvent=this.options.event+P),this._super.emit.call(this,T)}});function Su(){yn.apply(this,arguments)}N(Su,yn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Vi]},attrTest:function(T){return this._super.attrTest.call(this,T)&&(Math.abs(T.scale-1)>this.options.threshold||this.state&Qt)},emit:function(T){if(T.scale!==1){var P=T.scale<1?"in":"out";T.additionalEvent=this.options.event+P}this._super.emit.call(this,T)}});function wu(){Un.apply(this,arguments),this._timer=null,this._input=null}N(wu,Un,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[dd]},process:function(T){var P=this.options,L=T.pointers.length===P.pointers,q=T.distance<P.threshold,J=T.deltaTime>P.time;if(this._input=T,!q||!L||T.eventType&(_e|we)&&!J)this.reset();else if(T.eventType&he)this.reset(),this._timer=f(function(){this.state=Gn,this.tryEmit()},P.time,this);else if(T.eventType&_e)return Gn;return Pn},reset:function(){clearTimeout(this._timer)},emit:function(T){this.state===Gn&&(T&&T.eventType&_e?this.manager.emit(this.options.event+"up",T):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}});function Tu(){yn.apply(this,arguments)}N(Tu,yn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Vi]},attrTest:function(T){return this._super.attrTest.call(this,T)&&(Math.abs(T.rotation)>this.options.threshold||this.state&Qt)}});function Cu(){yn.apply(this,arguments)}N(Cu,yn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Nt|Ct,pointers:1},getTouchAction:function(){return Fo.prototype.getTouchAction.call(this)},attrTest:function(T){var P=this.options.direction,L;return P&(Nt|Ct)?L=T.overallVelocity:P&Nt?L=T.overallVelocityX:P&Ct&&(L=T.overallVelocityY),this._super.attrTest.call(this,T)&&P&T.offsetDirection&&T.distance>this.options.threshold&&T.maxPointers==this.options.pointers&&c(L)>this.options.velocity&&T.eventType&_e},emit:function(T){var P=md(T.offsetDirection);P&&this.manager.emit(this.options.event+P,T),this.manager.emit(this.options.event,T)}});function jo(){Un.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}N(jo,Un,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[_u]},process:function(T){var P=this.options,L=T.pointers.length===P.pointers,q=T.distance<P.threshold,J=T.deltaTime<P.time;if(this.reset(),T.eventType&he&&this.count===0)return this.failTimeout();if(q&&J&&L){if(T.eventType!=_e)return this.failTimeout();var ae=this.pTime?T.timeStamp-this.pTime<P.interval:!0,Ae=!this.pCenter||Do(this.pCenter,T.center)<P.posThreshold;this.pTime=T.timeStamp,this.pCenter=T.center,!Ae||!ae?this.count=1:this.count+=1,this._input=T;var ht=this.count%P.taps;if(ht===0)return this.hasRequireFailures()?(this._timer=f(function(){this.state=Gn,this.tryEmit()},P.interval,this),Qt):Gn}return Pn},failTimeout:function(){return this._timer=f(function(){this.state=Pn},this.options.interval,this),Pn},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Gn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Wn(T,P){return P=P||{},P.recognizers=C(P.recognizers,Wn.defaults.preset),new Au(T,P)}Wn.VERSION="2.0.7",Wn.defaults={domEvents:!1,touchAction:fd,enable:!0,inputTarget:null,inputClass:null,preset:[[Tu,{enable:!1}],[Su,{enable:!1},["rotate"]],[Cu,{direction:Nt}],[Fo,{direction:Nt},["swipe"]],[jo],[jo,{event:"doubletap",taps:2},["tap"]],[wu]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var s_=1,vd=2;function Au(T,P){this.options=b({},Wn.defaults,P||{}),this.options.inputTarget=this.options.inputTarget||T,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=T,this.input=ko(this),this.touchAction=new xu(this,this.options.touchAction),gd(this,!0),v(this.options.recognizers,function(L){var q=this.add(new L[0](L[1]));L[2]&&q.recognizeWith(L[2]),L[3]&&q.requireFailure(L[3])},this)}Au.prototype={set:function(T){return b(this.options,T),T.touchAction&&this.touchAction.update(),T.inputTarget&&(this.input.destroy(),this.input.target=T.inputTarget,this.input.init()),this},stop:function(T){this.session.stopped=T?vd:s_},recognize:function(T){var P=this.session;if(!P.stopped){this.touchAction.preventDefaults(T);var L,q=this.recognizers,J=P.curRecognizer;(!J||J&&J.state&Gn)&&(J=P.curRecognizer=null);for(var ae=0;ae<q.length;)L=q[ae],P.stopped!==vd&&(!J||L==J||L.canRecognizeWith(J))?L.recognize(T):L.reset(),!J&&L.state&(Qt|mr|pi)&&(J=P.curRecognizer=L),ae++}},get:function(T){if(T instanceof Un)return T;for(var P=this.recognizers,L=0;L<P.length;L++)if(P[L].options.event==T)return P[L];return null},add:function(T){if(m(T,"add",this))return this;var P=this.get(T.options.event);return P&&this.remove(P),this.recognizers.push(T),T.manager=this,this.touchAction.update(),T},remove:function(T){if(m(T,"remove",this))return this;if(T=this.get(T),T){var P=this.recognizers,L=X(P,T);L!==-1&&(P.splice(L,1),this.touchAction.update())}return this},on:function(T,P){if(T!==a&&P!==a){var L=this.handlers;return v(K(T),function(q){L[q]=L[q]||[],L[q].push(P)}),this}},off:function(T,P){if(T!==a){var L=this.handlers;return v(K(T),function(q){P?L[q]&&L[q].splice(X(L[q],P),1):delete L[q]}),this}},emit:function(T,P){this.options.domEvents&&l_(T,P);var L=this.handlers[T]&&this.handlers[T].slice();if(!(!L||!L.length)){P.type=T,P.preventDefault=function(){P.srcEvent.preventDefault()};for(var q=0;q<L.length;)L[q](P),q++}},destroy:function(){this.element&&gd(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function gd(T,P){var L=T.element;if(L.style){var q;v(T.options.cssProps,function(J,ae){q=Q(L.style,ae),P?(T.oldCssProps[q]=L.style[q],L.style[q]=J):L.style[q]=T.oldCssProps[q]||""}),P||(T.oldCssProps={})}}function l_(T,P){var L=n.createEvent("Event");L.initEvent(T,!0,!0),L.gesture=P,P.target.dispatchEvent(L)}b(Wn,{INPUT_START:he,INPUT_MOVE:Fe,INPUT_END:_e,INPUT_CANCEL:we,STATE_POSSIBLE:$o,STATE_BEGAN:Qt,STATE_CHANGED:mr,STATE_ENDED:pi,STATE_RECOGNIZED:Gn,STATE_CANCELLED:ha,STATE_FAILED:Pn,DIRECTION_NONE:ft,DIRECTION_LEFT:dt,DIRECTION_RIGHT:De,DIRECTION_UP:ze,DIRECTION_DOWN:It,DIRECTION_HORIZONTAL:Nt,DIRECTION_VERTICAL:Ct,DIRECTION_ALL:Ye,Manager:Au,Input:ut,TouchAction:xu,TouchInput:Lo,MouseInput:Oo,PointerEventInput:Eu,TouchMouseInput:bu,SingleTouchInput:sd,Recognizer:Un,AttrRecognizer:yn,Tap:jo,Pan:Fo,Swipe:Cu,Pinch:Su,Rotate:Tu,Press:wu,on:D,off:$,each:v,merge:k,extend:_,assign:b,inherit:N,bindFn:A,prefixed:Q});var u_=typeof t!="undefined"?t:typeof self!="undefined"?self:{};u_.Hammer=Wn,typeof a=="function"&&a.amd?a(function(){return Wn}):e.exports?e.exports=Wn:t[i]=Wn})(window,document,"Hammer")})(Yg);var vT=Yg.exports;const Hi=Fr(vT);var gT=.2,yT=4,nh=["mousedown","mouseup","mouseover","mouseout","click","dblclick"];function Ko(e,t){return t.get(e,!1)}function Cc(e){e.preventDefault(),typeof e.stopPropagation=="function"?e.stopPropagation():e.srcEvent&&typeof e.srcEvent.stopPropagation=="function"&&e.srcEvent.stopPropagation(),typeof e.stopImmediatePropagation=="function"&&e.stopImmediatePropagation()}function ku(e){function t(c){B(nh,function(p){pe.bind(e,p,Cc,!0)})}function n(c){setTimeout(function(){B(nh,function(p){pe.unbind(e,p,Cc,!0)})},500)}pe.bind(e,"touchstart",t,!0),pe.bind(e,"touchend",n,!0),pe.bind(e,"touchcancel",n,!0);var i=new Hi.Manager(e,{inputClass:Hi.TouchInput,recognizers:[],domEvents:!0}),a=new Hi.Tap,r=new Hi.Pan({threshold:10}),o=new Hi.Press,s=new Hi.Pinch,u=new Hi.Tap({event:"doubletap",taps:2});return s.requireFailure(r),s.requireFailure(o),i.add([r,o,s,u,a]),i.reset=function(c){var p=this.recognizers,f=this.session;f.stopped||(i.stop(c),setTimeout(function(){var m,v;for(m=0;v=p[m];m++)v.reset(),v.state=8;f.curRecognizer=null},0))},i.on("hammer.input",function(c){c.srcEvent.defaultPrevented&&i.reset(!0)}),i}function Kg(e,t,n,i,a){var r=Ko("dragging",e),o=Ko("move",e),s=Ko("contextPad",e),u=Ko("palette",e),c;function p(v,g){return function(b){var _=f(b.target),k=_&&i.get(_);return g&&(b.srcEvent.button=g),a.fire(v,b,k)}}function f(v){var g=tr(v,"svg, .djs-element",!0);return g}function m(v){c=ku(v);function g(k){var N=0,A=0;function S(D){var $=D.deltaX-N,M=D.deltaY-A;t.scroll({dx:$,dy:M}),N=D.deltaX,A=D.deltaY}function C(D){c.off("panmove",S),c.off("panend",C),c.off("pancancel",C)}c.on("panmove",S),c.on("panend",C),c.on("pancancel",C)}function b(k){var N=f(k.target),A=N&&i.get(N);if(o&&t.getRootElement()!==A)return o.start(k,A,!0);g()}function _(k){var N=t.zoom(),A=k.center;function S(D){var $=1-(1-D.scale)/1.5,M=Math.max(gT,Math.min(yT,$*N));t.zoom(M,A),Cc(D)}function C(D){c.off("pinchmove",S),c.off("pinchend",C),c.off("pinchcancel",C),c.reset(!0)}c.on("pinchmove",S),c.on("pinchend",C),c.on("pinchcancel",C)}c.on("tap",p("element.click")),c.on("doubletap",p("element.dblclick",1)),c.on("panstart",b),c.on("press",b),c.on("pinchstart",_)}r&&n.on("drag.move",function(v){var g=v.originalEvent;if(!(!g||g instanceof MouseEvent)){var b=xi(g),_=document.elementFromPoint(b.x,b.y),k=f(_),N=k&&i.get(k);N!==v.hover&&(v.hover&&r.out(v),N&&(r.hover({element:N,gfx:k}),v.hover=N,v.hoverGfx=k))}}),s&&n.on("contextPad.create",function(v){var g=v.pad.html,b=ku(g);b.on("panstart",function(_){s.trigger("dragstart",_,!0)}),b.on("press",function(_){s.trigger("dragstart",_,!0)}),b.on("tap",function(_){s.trigger("click",_)})}),u&&n.on("palette.create",function(v){var g=v.container,b=ku(g);b.on("panstart",function(_){u.trigger("dragstart",_,!0)}),b.on("press",function(_){u.trigger("dragstart",_,!0)}),b.on("tap",function(_){u.trigger("click",_)})}),n.on("canvas.init",function(v){m(v.svg)})}Kg.$inject=["injector","canvas","eventBus","elementRegistry","interactionEvents","touchFix"];function wp(e,t){var n=this;t.on("canvas.init",function(i){n.addBBoxMarker(i.svg)})}wp.$inject=["canvas","eventBus"];wp.prototype.addBBoxMarker=function(e){var t={fill:"none",class:"outer-bound-marker"},n=le("rect");ee(n,{x:-1e4,y:1e4,width:10,height:10}),ee(n,t),fe(e,n);var i=le("rect");ee(i,{x:1e4,y:1e4,width:10,height:10}),ee(i,t),fe(e,i)};const ET={__depends__:[no],__init__:["touchInteractionEvents"],touchInteractionEvents:["type",Kg],touchFix:["type",wp]},bT={__depends__:[ET]};function Du(e){return e&&e[e.length-1]}function ih(e){return e.y}function rh(e){return e.x}var _T={left:rh,center:rh,right:function(e){return e.x+e.width},top:ih,middle:ih,bottom:function(e){return e.y+e.height}};function Jr(e){this._modeling=e}Jr.$inject=["modeling"];Jr.prototype._getOrientationDetails=function(e){var t=["top","bottom","middle"],n="x",i="width";return t.indexOf(e)!==-1&&(n="y",i="height"),{axis:n,dimension:i}};Jr.prototype._isType=function(e,t){return t.indexOf(e)!==-1};Jr.prototype._alignmentPosition=function(e,t){var n=this._getOrientationDetails(e),i=n.axis,a=n.dimension,r={},o={},s=!1,u,c,p;function f(m,v){return Math.round((m[i]+v[i]+v[a])/2)}if(this._isType(e,["left","top"]))r[e]=t[0][i];else if(this._isType(e,["right","bottom"]))p=Du(t),r[e]=p[i]+p[a];else if(this._isType(e,["center","middle"])){if(B(t,function(m){var v=m[i]+Math.round(m[a]/2);o[v]?o[v].elements.push(m):o[v]={elements:[m],center:v}}),u=un(o,function(m){return m.elements.length>1&&(s=!0),m.elements.length}),s)return r[e]=Du(u).center,r;c=t[0],t=un(t,function(m){return m[i]+m[a]}),p=Du(t),r[e]=f(c,p)}return r};Jr.prototype.trigger=function(e,t){var n=this._modeling,i=ge(e,function(s){return!(s.waypoints||s.host||s.labelTarget)});if(!(i.length<2)){var a=_T[t],r=un(i,a),o=this._alignmentPosition(t,r);n.alignElements(r,o)}};const xT={__init__:["alignElements"],alignElements:["type",Jr]};var ST=10,Xg=50,wT=250;function Tp(e,t,n,i){for(var a;a=TT(e,n,t);)n=i(t,n,a);return n}function Cp(e){return function(t,n,i){var a={x:n.x,y:n.y};return["x","y"].forEach(function(r){var o=e[r];if(o){var s=r==="x"?"width":"height",u=o.margin,c=o.minDistance;u<0?a[r]=Math.min(i[r]+u-t[s]/2,n[r]-c+u):a[r]=Math.max(i[r]+i[s]+u+t[s]/2,n[r]+c+u)}}),a}}function TT(e,t,n){var i={x:t.x-n.width/2,y:t.y-n.height/2,width:n.width,height:n.height},a=AT(e);return Me(a,function(r){if(r===n)return!1;var o=St(r,i,ST);return o==="intersect"})}function CT(e,t){t||(t={});function n(g){return g.source===e?1:-1}var i=t.defaultDistance||Xg,a=t.direction||"e",r=t.filter,o=t.getWeight||n,s=t.maxDistance||wT,u=t.reference||"start";r||(r=IT);function c(g,b){return a==="n"?u==="start"?ce(g).top-ce(b).bottom:u==="center"?ce(g).top-Ee(b).y:ce(g).top-ce(b).top:a==="w"?u==="start"?ce(g).left-ce(b).right:u==="center"?ce(g).left-Ee(b).x:ce(g).left-ce(b).left:a==="s"?u==="start"?ce(b).top-ce(g).bottom:u==="center"?Ee(b).y-ce(g).bottom:ce(b).bottom-ce(g).bottom:u==="start"?ce(b).left-ce(g).right:u==="center"?Ee(b).x-ce(g).right:ce(b).right-ce(g).right}var p=e.incoming.filter(r).map(function(g){var b=o(g),_=b<0?c(g.source,e):c(e,g.source);return{id:g.source.id,distance:_,weight:b}}),f=e.outgoing.filter(r).map(function(g){var b=o(g),_=b>0?c(e,g.target):c(g.target,e);return{id:g.target.id,distance:_,weight:b}}),m=p.concat(f).reduce(function(g,b){return g[b.id+"__weight_"+b.weight]=b,g},{}),v=Ht(m,function(g,b){var _=b.distance,k=b.weight;return _<0||_>s||(g[String(_)]||(g[String(_)]=0),g[String(_)]+=1*k,(!g.distance||g[g.distance]<g[String(_)])&&(g.distance=_)),g},{});return v.distance||i}function AT(e){var t=Ou(e);return e.host&&(t=t.concat(Ou(e.host))),e.attachers&&(t=t.concat(e.attachers.reduce(function(n,i){return n.concat(Ou(i))},[]))),t}function Ou(e){return RT(e).concat(PT(e))}function PT(e){return e.incoming.map(function(t){return t.source})}function RT(e){return e.outgoing.map(function(t){return t.target})}function IT(){return!0}var NT=100;function Zg(e,t,n){e.on("autoPlace",NT,function(i){var a=i.shape,r=i.source;return MT(r,a)}),e.on("autoPlace.end",function(i){n.scrollToElement(i.shape)}),this.append=function(i,a,r){e.fire("autoPlace.start",{source:i,shape:a});var o=e.fire("autoPlace",{source:i,shape:a}),s=t.appendShape(i,a,o,i.parent,r);return e.fire("autoPlace.end",{source:i,shape:s}),s}}Zg.$inject=["eventBus","modeling","canvas"];function MT(e,t,n){n||(n={});var i=n.defaultDistance||Xg,a=Ee(e),r=ce(e);return{x:r.right+i+t.width/2,y:a.y}}function Jg(e,t){e.on("autoPlace.end",500,function(n){t.select(n.shape)})}Jg.$inject=["eventBus","selection"];const kT={__init__:["autoPlaceSelectionBehavior"],autoPlace:["type",Zg],autoPlaceSelectionBehavior:["type",Jg]};function Pe(e,t){return wi(t,function(n){return w(e,n)})}function Us(e,t){for(typeof t=="string"&&(t=[t]);e=e.parent;)if(Pe(e,t))return e;return null}function Qg(e,t){if(w(t,"bpmn:TextAnnotation"))return LT(e,t);if(Pe(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"]))return BT(e,t);if(w(t,"bpmn:FlowNode"))return DT(e,t)}function DT(e,t){var n=ce(e),i=Ee(e),a=CT(e,{filter:function(p){return w(p,"bpmn:SequenceFlow")}}),r=30,o=80,s="left";w(e,"bpmn:BoundaryEvent")&&(s=St(e,e.host,-25),s.indexOf("top")!==-1&&(r*=-1));var u={x:n.right+a+t.width/2,y:i.y+OT(s,o)},c={y:{margin:r,minDistance:o}};return Tp(e,t,u,Cp(c))}function OT(e,t){return e.indexOf("top")!=-1?-1*t:e.indexOf("bottom")!=-1?t:0}function LT(e,t){var n=ce(e),i={x:n.right+t.width/2,y:n.top-50-t.height/2},a={y:{margin:-30,minDistance:20}};return Tp(e,t,i,Cp(a))}function BT(e,t){var n=ce(e),i={x:n.right-10+t.width/2,y:n.bottom+40+t.width/2},a={x:{margin:30,minDistance:30}};return Tp(e,t,i,Cp(a))}function ey(e){e.on("autoPlace",function(t){var n=t.shape,i=t.source;return Qg(i,n)})}ey.$inject=["eventBus"];const $T={__depends__:[kT],__init__:["bpmnAutoPlace"],bpmnAutoPlace:["type",ey]};var VT=1e3;function ie(e){this._eventBus=e}ie.$inject=["eventBus"];function FT(e,t){return function(n){return e.call(t||null,n.context,n.command,n)}}ie.prototype.on=function(e,t,n,i,a,r){if((bt(t)||ve(t))&&(r=a,a=i,i=n,n=t,t=null),bt(n)&&(r=a,a=i,i=n,n=VT),nt(a)&&(r=a,a=!1),!bt(i))throw new Error("handlerFn must be a function");xe(e)||(e=[e]);var o=this._eventBus;B(e,function(s){var u=["commandStack",s,t].filter(function(c){return c}).join(".");o.on(u,n,a?FT(i,r):i,r)})};var jT=["canExecute","preExecute","preExecuted","execute","executed","postExecute","postExecuted","revert","reverted"];B(jT,function(e){ie.prototype[e]=function(t,n,i,a,r){(bt(t)||ve(t))&&(r=a,a=i,i=n,n=t,t=null),this.on(t,e,n,i,a,r)}});function ai(e,t,n,i){ie.call(this,e),this._elementRegistry=t,this._modeling=n,this._rules=i;var a=this;this.postExecuted(["shape.create"],function(r){var o=r.context,s=o.hints||{},u=o.shape,c=o.parent||o.newParent;s.autoResize!==!1&&a._expand([u],c)}),this.postExecuted(["elements.move"],function(r){var o=r.context,s=Ba(al(o.closure.topLevel)),u=o.hints,c=u?u.autoResize:!0;if(c!==!1){var p=er(s,function(f){return f.parent.id});B(p,function(f,m){xe(c)&&(f=f.filter(function(v){return Me(c,ln({id:v.id}))})),a._expand(f,m)})}}),this.postExecuted(["shape.toggleCollapse"],function(r){var o=r.context,s=o.hints,u=o.shape;s&&s.autoResize===!1||u.collapsed||a._expand(u.children||[],u)}),this.postExecuted(["shape.resize"],function(r){var o=r.context,s=o.hints,u=o.shape,c=u.parent;s&&s.autoResize===!1||c&&a._expand([u],c)})}ai.$inject=["eventBus","elementRegistry","modeling","rules"];se(ai,ie);ai.prototype._getOptimalBounds=function(e,t){var n=this.getOffset(t),i=this.getPadding(t),a=ce(xt(e)),r=ce(t),o={};return a.top-r.top<i.top&&(o.top=a.top-n.top),a.left-r.left<i.left&&(o.left=a.left-n.left),r.right-a.right<i.right&&(o.right=a.right+n.right),r.bottom-a.bottom<i.bottom&&(o.bottom=a.bottom+n.bottom),up(G({},r,o))};ai.prototype._expand=function(e,t){typeof t=="string"&&(t=this._elementRegistry.get(t));var n=this._rules.allowed("element.autoResize",{elements:e,target:t});if(n){var i=this._getOptimalBounds(e,t);if(HT(i,t)){var a=zT(cn(t,["x","y","width","height"]),i);this.resize(t,i,{autoResize:a});var r=t.parent;r&&this._expand([t],r)}}};ai.prototype.getOffset=function(e){return{top:60,bottom:60,left:100,right:100}};ai.prototype.getPadding=function(e){return{top:2,bottom:2,left:15,right:15}};ai.prototype.resize=function(e,t,n){this._modeling.resizeShape(e,t,null,n)};function HT(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}function zT(e,t){var n="";return e=ce(e),t=ce(t),e.top>t.top&&(n=n.concat("n")),e.right<t.right&&(n=n.concat("w")),e.bottom<t.bottom&&(n=n.concat("s")),e.left>t.left&&(n=n.concat("e")),n}function Sl(e){e.invoke(ai,this)}Sl.$inject=["injector"];se(Sl,ai);Sl.prototype.resize=function(e,t,n){w(e,"bpmn:Participant")?this._modeling.resizeLane(e,t,null,n):this._modeling.resizeShape(e,t,null,n)};function Pi(e){ie.call(this,e),this.init()}Pi.$inject=["eventBus"];se(Pi,ie);Pi.prototype.addRule=function(e,t,n){var i=this;typeof e=="string"&&(e=[e]),e.forEach(function(a){i.canExecute(a,t,function(r,o,s){return n(r)},!0)})};Pi.prototype.init=function(){};function ro(e){Pi.call(this,e);var t=this;this.addRule("element.autoResize",function(n){return t.canResize(n.elements,n.target)})}ro.$inject=["eventBus"];se(ro,Pi);ro.prototype.canResize=function(e,t){return!1};function wl(e,t){ro.call(this,e),this._modeling=t}se(wl,ro);wl.$inject=["eventBus","modeling"];wl.prototype.canResize=function(e,t){if(!w(t,"bpmn:Participant")&&!w(t,"bpmn:Lane")&&!w(t,"bpmn:SubProcess"))return!1;var n=!0;return B(e,function(i){if(w(i,"bpmn:Lane")||i.labelTarget){n=!1;return}}),n};const GT={__init__:["bpmnAutoResize","bpmnAutoResizeProvider"],bpmnAutoResize:["type",Sl],bpmnAutoResizeProvider:["type",wl]};var ah=1500;function ty(e,t,n){var i=this,a=n.get("dragging",!1);function r(o){if(!o.hover){var s=o.originalEvent,u=i._findTargetGfx(s),c=u&&e.get(u);u&&c&&(o.stopPropagation(),a.hover({element:c,gfx:u}),a.move(s))}}a&&t.on("drag.start",function(o){t.once("drag.move",ah,function(s){r(s)})}),function(){var o,s;t.on("element.hover",function(u){o=u.gfx,s=u.element}),t.on("element.hover",ah,function(u){s&&t.fire("element.out",{element:s,gfx:o})}),t.on("element.out",function(){o=null,s=null})}(),this._findTargetGfx=function(o){var s,u;if(o instanceof MouseEvent)return s=xi(o),u=document.elementFromPoint(s.x,s.y),UT(u)}}ty.$inject=["elementRegistry","eventBus","injector"];function UT(e){return tr(e,"svg, .djs-element",!0)}const WT={__init__:["hoverFix"],hoverFix:["type",ty]};var br=Math.round,oh="djs-drag-active";function zi(e){e.preventDefault()}function qT(e){return typeof TouchEvent!="undefined"&&e instanceof TouchEvent}function YT(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function ny(e,t,n,i){var a={threshold:5,trapClick:!0},r;function o(A){var S=t.viewbox(),C=t._container.getBoundingClientRect();return{x:S.x+(A.x-C.left)/S.scale,y:S.y+(A.y-C.top)/S.scale}}function s(A,S){S=S||r;var C=e.createEvent(G({},S.payload,S.data,{isTouch:S.isTouch}));return e.fire("drag."+A,C)===!1?!1:e.fire(S.prefix+"."+A,C)}function u(A){var S=A.filter(function(C){return i.get(C.id)});S.length&&n.select(S)}function c(A,S){var C=r.payload,D=r.displacement,$=r.globalStart,M=xi(A),V=On(M,$),K=r.localStart,X=o(M),z=On(X,K);if(!r.active&&(S||YT(V)>r.threshold)){if(G(C,{x:br(K.x+D.x),y:br(K.y+D.y),dx:0,dy:0},{originalEvent:A}),s("start")===!1)return _();r.active=!0,r.keepSelection||(C.previousSelection=n.get(),n.select(null)),r.cursor&&xl(r.cursor),t.addMarker(t.getRootElement(),oh)}Mu(A),r.active&&(G(C,{x:br(X.x+D.x),y:br(X.y+D.y),dx:br(z.x),dy:br(z.y)},{originalEvent:A}),s("move"))}function p(A){var S,C=!0;r.active&&(A&&(r.payload.originalEvent=A,Mu(A)),C=s("end")),C===!1&&s("rejected"),S=k(C!==!0),s("ended",S)}function f(A){A.which===27&&(zi(A),_())}function m(A){var S;r.active&&(S=Hg(e),setTimeout(S,400),zi(A)),p(A)}function v(A){c(A)}function g(A){var S=r.payload;S.hoverGfx=A.gfx,S.hover=A.element,s("hover")}function b(A){s("out");var S=r.payload;S.hoverGfx=null,S.hover=null}function _(A){var S;if(r){var C=r.active;C&&s("cancel"),S=k(A),C&&s("canceled",S)}}function k(A){var S,C;s("cleanup"),jg(),r.trapClick?C=m:C=p,pe.unbind(document,"mousemove",c),pe.unbind(document,"dragstart",zi),pe.unbind(document,"selectstart",zi),pe.unbind(document,"mousedown",C,!0),pe.unbind(document,"mouseup",C,!0),pe.unbind(document,"keyup",f),pe.unbind(document,"touchstart",v,!0),pe.unbind(document,"touchcancel",_,!0),pe.unbind(document,"touchmove",c,!0),pe.unbind(document,"touchend",p,!0),e.off("element.hover",g),e.off("element.out",b),t.removeMarker(t.getRootElement(),oh);var D=r.payload.previousSelection;return A!==!1&&D&&!n.get().length&&u(D),S=r,r=null,S}function N(A,S,C,D){r&&_(!1),typeof S=="string"&&(D=C,C=S,S=null),D=G({},a,D||{});var $=D.data||{},M,V,K,X,z;D.trapClick?X=m:X=p,A?(M=Kr(A)||A,V=xi(A),Mu(A),M.type==="dragstart"&&zi(M)):(M=null,V={x:0,y:0}),K=o(V),S||(S=K),z=qT(M),r=G({prefix:C,data:$,payload:{},globalStart:V,displacement:On(S,K),localStart:K,isTouch:z},D),D.manual||(z?(pe.bind(document,"touchstart",v,!0),pe.bind(document,"touchcancel",_,!0),pe.bind(document,"touchmove",c,!0),pe.bind(document,"touchend",p,!0)):(pe.bind(document,"mousemove",c),pe.bind(document,"dragstart",zi),pe.bind(document,"selectstart",zi),pe.bind(document,"mousedown",X,!0),pe.bind(document,"mouseup",X,!0)),pe.bind(document,"keyup",f),e.on("element.hover",g),e.on("element.out",b)),s("init"),D.autoActivate&&c(A,!0)}e.on("diagram.destroy",_),this.init=N,this.move=c,this.hover=g,this.out=b,this.end=p,this.cancel=_,this.context=function(){return r},this.setOptions=function(A){G(a,A)}}ny.$inject=["eventBus","canvas","selection","elementRegistry"];const oi={__depends__:[WT,Fn],dragging:["type",ny]};function Qr(e,t,n){this._canvas=n,this._opts=G({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},e);var i=this;t.on("drag.move",function(a){var r=i._toBorderPoint(a);i.startScroll(r)}),t.on(["drag.cleanup"],function(){i.stopScroll()})}Qr.$inject=["config.autoScroll","eventBus","canvas"];Qr.prototype.startScroll=function(e){var t=this._canvas,n=this._opts,i=this,a=t.getContainer().getBoundingClientRect(),r=[e.x,e.y,a.width-e.x,a.height-e.y];this.stopScroll();for(var o=0,s=0,u=0;u<4;u++)KT(r[u],n.scrollThresholdOut[u],n.scrollThresholdIn[u])&&(u===0?o=n.scrollStep:u==1?s=n.scrollStep:u==2?o=-n.scrollStep:u==3&&(s=-n.scrollStep));(o!==0||s!==0)&&(t.scroll({dx:o,dy:s}),this._scrolling=setTimeout(function(){i.startScroll(e)},n.scrollRepeatTimeout))};function KT(e,t,n){return t<e&&e<n}Qr.prototype.stopScroll=function(){clearTimeout(this._scrolling)};Qr.prototype.setOptions=function(e){this._opts=G({},this._opts,e)};Qr.prototype._toBorderPoint=function(e){var t=this._canvas._container.getBoundingClientRect(),n=xi(e.originalEvent);return{x:n.x-t.left,y:n.y-t.top}};const XT={__depends__:[oi],__init__:["autoScroll"],autoScroll:["type",Qr]};function Ap(e){this._commandStack=e.get("commandStack",!1)}Ap.$inject=["injector"];Ap.prototype.allowed=function(e,t){var n=!0,i=this._commandStack;return i&&(n=i.canExecute(e,t)),n===void 0?!0:n};const Hn={__init__:["rules"],rules:["type",Ap]};var Xo=Math.round,ZT=Math.max;function JT(e,t){var n=e.x,i=e.y;return[["M",n,i],["m",0,-t],["a",t,t,0,1,1,0,2*t],["a",t,t,0,1,1,0,-2*t],["z"]]}function QT(e){var t=[];return e.forEach(function(n,i){t.push([i===0?"M":"L",n.x,n.y])}),t}var iy=10;function e1(e,t){var n,i;for(n=0;i=e[n];n++)if(Xa(i,t)<=iy)return{point:e[n],bendpoint:!0,index:n};return null}function t1(e,t){var n=Xv(JT(t,iy),QT(e)),i=n[0],a=n[n.length-1],r;return i?i!==a?i.segment2!==a.segment2?(r=ZT(i.segment2,a.segment2)-1,{point:e[r],bendpoint:!0,index:r}):{point:{x:Xo(i.x+a.x)/2,y:Xo(i.y+a.y)/2},index:i.segment2}:{point:{x:Xo(i.x),y:Xo(i.y)},index:i.segment2}:null}function Ac(e,t){return e1(e,t)||t1(e,t)}var ry="djs-bendpoint",ay="djs-segment-dragger";function n1(e,t){var n=xi(t),i=e._container.getBoundingClientRect(),a;a={x:i.left,y:i.top};var r=e.viewbox();return{x:r.x+(n.x-a.x)/r.scale,y:r.y+(n.y-a.y)/r.scale}}function Pc(e,t,n){var i=n1(e,n),a=Ac(t,i);return a}function Rc(e,t){var n=le("g");Se(n).add(ry),fe(e,n);var i=le("circle");ee(i,{cx:0,cy:0,r:4}),Se(i).add("djs-visual"),fe(n,i);var a=le("circle");return ee(a,{cx:0,cy:0,r:10}),Se(a).add("djs-hit"),fe(n,a),t&&Se(n).add(t),n}function i1(e,t,n,i){var a=le("g");fe(e,a);var r=14,o=3,s=11,u=r1(t,n,i),c=o+s,p=le("rect");ee(p,{x:-r/2,y:-o/2,width:r,height:o}),Se(p).add("djs-visual"),fe(a,p);var f=le("rect");return ee(f,{x:-u/2,y:-c/2,width:u,height:c}),Se(f).add("djs-hit"),fe(a,f),cg(a,i==="v"?90:0),a}function oy(e,t,n){var i=le("g"),a=yc(t,n),r=Kn(t,n);return fe(e,i),i1(i,t,n,r),Se(i).add(ay),Se(i).add(r==="h"?"horizontal":"vertical"),Ft(i,a.x,a.y),i}function Ic(e){return Math.abs(Math.round(e*2/3))}function r1(e,t,n){var i=t.x-e.x,a=t.y-e.y;return Ic(n==="h"?i:a)}var sy={exports:{}};/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */(function(e,t){(function(n,i){e.exports=i(n)})(typeof Ss!="undefined"?Ss:Ss,function(n){if(n.CSS&&n.CSS.escape)return n.CSS.escape;var i=function(a){if(arguments.length==0)throw new TypeError("`CSS.escape` requires an argument.");for(var r=String(a),o=r.length,s=-1,u,c="",p=r.charCodeAt(0);++s<o;){if(u=r.charCodeAt(s),u==0){c+="�";continue}if(u>=1&&u<=31||u==127||s==0&&u>=48&&u<=57||s==1&&u>=48&&u<=57&&p==45){c+="\\"+u.toString(16)+" ";continue}if(s==0&&o==1&&u==45){c+="\\"+r.charAt(s);continue}if(u>=128||u==45||u==95||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122){c+=r.charAt(s);continue}c+="\\"+r.charAt(s)}return c};return n.CSS||(n.CSS={}),n.CSS.escape=i,i})})(sy);var a1=sy.exports;const Nc=Fr(a1);var o1={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function sh(e){return e=""+e,e&&e.replace(/[&<>"']/g,function(t){return o1[t]})}function ly(e,t,n,i,a){function r(A,S,C){var D=A.index,$=A.point,M,V,K,X,z,U;return D<=0||A.bendpoint?!1:(M=S[D-1],V=S[D],K=yc(M,V),X=Kn(M,V),z=Math.abs($.x-K.x),U=Math.abs($.y-K.y),X&&z<=C&&U<=C)}function o(A,S){var C=A.waypoints,D,$,M,V;return S.index<=0||S.bendpoint||(D={start:C[S.index-1],end:C[S.index]},$=Kn(D.start,D.end),!$)?null:($==="h"?M=D.end.x-D.start.x:M=D.end.y-D.start.y,V=Ic(M)/2,V)}function s(A,S){var C=S.waypoints,D=Pc(t,C,A),$;if(D)return $=o(S,D),r(D,C,$)?a.start(A,S,D.index):i.start(A,S,D.index,!D.bendpoint),!0}function u(A,S,C){pe.bind(A,S,function(D){n.triggerMouseEvent(S,D,C),D.stopPropagation()})}function c(A,S){var C=t.getLayer("overlays"),D=Xe('.djs-bendpoints[data-element-id="'+Nc(A.id)+'"]',C);return!D&&S&&(D=le("g"),ee(D,{"data-element-id":A.id}),Se(D).add("djs-bendpoints"),fe(C,D),u(D,"mousedown",A),u(D,"click",A),u(D,"dblclick",A)),D}function p(A,S){return Xe('.djs-segment-dragger[data-segment-idx="'+A+'"]',S)}function f(A,S){S.waypoints.forEach(function(C,D){var $=Rc(A);fe(A,$),Ft($,C.x,C.y)}),Rc(A,"floating")}function m(A,S){for(var C=S.waypoints,D,$,M,V=1;V<C.length;V++)D=C[V-1],$=C[V],Kn(D,$)&&(M=oy(A,D,$),ee(M,{"data-segment-idx":V}),u(M,"mousemove",S))}function v(A){B(fc("."+ry,A),function(S){tt(S)})}function g(A){B(fc("."+ay,A),function(S){tt(S)})}function b(A){var S=c(A);return S||(S=c(A,!0),f(S,A),m(S,A)),S}function _(A){var S=c(A);S&&(g(S),v(S),m(S,A),f(S,A))}function k(A,S){var C=Xe(".floating",A),D=S.point;C&&Ft(C,D.x,D.y)}function N(A,S,C){var D=p(S.index,A),$=C[S.index-1],M=C[S.index],V=S.point,K=yc($,M),X=Kn($,M),z,U;D&&(z=s1(D),U={x:V.x-K.x,y:V.y-K.y},X==="v"&&(U={x:U.y,y:U.x}),Ft(z,U.x,U.y))}e.on("connection.changed",function(A){_(A.element)}),e.on("connection.remove",function(A){var S=c(A.element);S&&tt(S)}),e.on("element.marker.update",function(A){var S=A.element,C;S.waypoints&&(C=b(S),A.add?Se(C).add(A.marker):Se(C).remove(A.marker))}),e.on("element.mousemove",function(A){var S=A.element,C=S.waypoints,D,$;if(C){if(D=c(S,!0),$=Pc(t,C,A.originalEvent),!$)return;k(D,$),$.bendpoint||N(D,$,C)}}),e.on("element.mousedown",function(A){if(Ai(A)){var S=A.originalEvent,C=A.element;if(C.waypoints)return s(S,C)}}),e.on("selection.changed",function(A){var S=A.newSelection,C=S[0];C&&C.waypoints&&b(C)}),e.on("element.hover",function(A){var S=A.element;S.waypoints&&(b(S),n.registerEvent(A.gfx,"mousemove","element.mousemove"))}),e.on("element.out",function(A){n.unregisterEvent(A.gfx,"mousemove","element.mousemove")}),e.on("element.updateId",function(A){var S=A.element,C=A.newId;if(S.waypoints){var D=c(S);D&&ee(D,{"data-element-id":C})}}),this.addHandles=b,this.updateHandles=_,this.getBendpointsContainer=c,this.getSegmentDragger=p}ly.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];function s1(e){return Xe(".djs-visual",e)}var lh=Math.round,Wi="reconnectStart",qi="reconnectEnd",Ea="updateWaypoints";function Pp(e,t,n,i,a,r){this._injector=e,this.start=function(o,s,u,c){var p=n.getGraphics(s),f=s.source,m=s.target,v=s.waypoints,g;!c&&u===0?g=Wi:!c&&u===v.length-1?g=qi:g=Ea;var b=g===Ea?"connection.updateWaypoints":"connection.reconnect",_=a.allowed(b,{connection:s,source:f,target:m});_===!1&&(_=a.allowed(b,{connection:s,source:m,target:f})),_!==!1&&i.init(o,"bendpoint.move",{data:{connection:s,connectionGfx:p,context:{allowed:_,bendpointIndex:u,connection:s,source:f,target:m,insert:c,type:g}}})},t.on("bendpoint.move.hover",function(o){var s=o.context,u=s.connection,c=u.source,p=u.target,f=o.hover,m=s.type;s.hover=f;var v;if(f){var g=m===Ea?"connection.updateWaypoints":"connection.reconnect";if(v=s.allowed=a.allowed(g,{connection:u,source:m===Wi?f:c,target:m===qi?f:p}),v){s.source=m===Wi?f:c,s.target=m===qi?f:p;return}v===!1&&(v=s.allowed=a.allowed(g,{connection:u,source:m===qi?f:p,target:m===Wi?f:c})),v&&(s.source=m===qi?f:p,s.target=m===Wi?f:c)}}),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(o){var s=o.context,u=s.type;s.hover=null,s.source=null,s.target=null,u!==Ea&&(s.allowed=!1)}),t.on("bendpoint.move.end",function(o){var s=o.context,u=s.allowed,c=s.bendpointIndex,p=s.connection,f=s.insert,m=p.waypoints.slice(),v=s.source,g=s.target,b=s.type,_=s.hints||{},k={x:lh(o.x),y:lh(o.y)};if(!u)return!1;b===Ea?(f?m.splice(c,0,k):m[c]=k,_.bendpointMove={insert:f,bendpointIndex:c},m=this.cropWaypoints(p,m),r.updateWaypoints(p,zx(m),_)):(b===Wi?(_.docking="source",Ws(s)&&(_.docking="target",_.newWaypoints=m.reverse())):b===qi&&(_.docking="target",Ws(s)&&(_.docking="source",_.newWaypoints=m.reverse())),r.reconnect(p,v,g,k,_))},this)}Pp.$inject=["injector","eventBus","canvas","dragging","rules","modeling"];Pp.prototype.cropWaypoints=function(e,t){var n=this._injector.get("connectionDocking",!1);if(!n)return t;var i=e.waypoints;return e.waypoints=t,e.waypoints=n.getCroppedWaypoints(e),t=e.waypoints,e.waypoints=i,t};function Ws(e){var t=e.hover,n=e.source,i=e.target,a=e.type;if(a===Wi)return t&&i&&t===i&&n!==i;if(a===qi)return t&&n&&t===n&&n!==i}var l1="reconnectStart",u1="reconnectEnd",uh="updateWaypoints",ba="connect-ok",Zo="connect-not-ok",ch="connect-hover",ph="djs-updating",fh="djs-element-hidden",dh=1100;function uy(e,t,n,i){this._injector=t;var a=t.get("connectionPreview",!1);n.on("bendpoint.move.start",function(r){var o=r.context,s=o.bendpointIndex,u=o.connection,c=o.insert,p=u.waypoints,f=p.slice();o.waypoints=p,c&&f.splice(s,0,{x:r.x,y:r.y}),u.waypoints=f;var m=o.draggerGfx=Rc(i.getLayer("overlays"));Se(m).add("djs-dragging"),i.addMarker(u,fh),i.addMarker(u,ph)}),n.on("bendpoint.move.hover",function(r){var o=r.context,s=o.allowed,u=o.hover,c=o.type;if(u){if(i.addMarker(u,ch),c===uh)return;s?(i.removeMarker(u,Zo),i.addMarker(u,ba)):s===!1&&(i.removeMarker(u,ba),i.addMarker(u,Zo))}}),n.on(["bendpoint.move.out","bendpoint.move.cleanup"],dh,function(r){var o=r.context,s=o.hover,u=o.target;s&&(i.removeMarker(s,ch),i.removeMarker(s,u?ba:Zo))}),n.on("bendpoint.move.move",function(r){var o=r.context,s=o.allowed,u=o.bendpointIndex,c=o.draggerGfx,p=o.hover,f=o.type,m=o.connection,v=m.source,g=m.target,b=m.waypoints.slice(),_={x:r.x,y:r.y},k=o.hints||{},N={};a&&(k.connectionStart&&(N.connectionStart=k.connectionStart),k.connectionEnd&&(N.connectionEnd=k.connectionEnd),f===l1?Ws(o)?(N.connectionEnd=N.connectionEnd||_,N.source=g,N.target=p||v,b=b.reverse()):(N.connectionStart=N.connectionStart||_,N.source=p||v,N.target=g):f===u1?Ws(o)?(N.connectionStart=N.connectionStart||_,N.source=p||g,N.target=v,b=b.reverse()):(N.connectionEnd=N.connectionEnd||_,N.source=v,N.target=p||g):(N.noCropping=!0,N.noLayout=!0,b[u]=_),f===uh&&(b=e.cropWaypoints(m,b)),N.waypoints=b,a.drawPreview(o,s,N)),Ft(c,r.x,r.y)},this),n.on(["bendpoint.move.end","bendpoint.move.cancel"],dh,function(r){var o=r.context,s=o.connection,u=o.draggerGfx,c=o.hover,p=o.target,f=o.waypoints;s.waypoints=f,tt(u),i.removeMarker(s,ph),i.removeMarker(s,fh),c&&(i.removeMarker(c,ba),i.removeMarker(c,p?ba:Zo)),a&&a.cleanUp(o)})}uy.$inject=["bendpointMove","injector","eventBus","canvas"];var hh="connect-hover",mh="djs-updating";function vh(e,t,n){return Rp(e,t,e[t]+n)}function Rp(e,t,n){return{x:t==="x"?n:e.x,y:t==="y"?n:e.y}}function c1(e,t,n,i){var a=Math.max(t[i],n[i]),r=Math.min(t[i],n[i]),o=20,s=Math.min(Math.max(r+o,e[i]),a-o);return Rp(t,i,s)}function cy(e){return e==="x"?"y":"x"}function gh(e,t,n){var i,a;return e.original?e.original:(i=Ee(t),a=cy(n),Rp(e,a,i[a]))}function py(e,t,n,i,a,r){var o=e.get("connectionDocking",!1);this.start=function(f,m,v){var g,b=n.getGraphics(m),_=v-1,k=v,N=m.waypoints,A=N[_],S=N[k],C=Pc(n,N,f),D,$,M;D=Kn(A,S),D&&($=D==="v"?"x":"y",_===0&&(A=gh(A,m.source,$)),k===N.length-1&&(S=gh(S,m.target,$)),C?M=C.point:M={x:(A.x+S.x)/2,y:(A.y+S.y)/2},g={connection:m,segmentStartIndex:_,segmentEndIndex:k,segmentStart:A,segmentEnd:S,axis:$,dragPosition:M},i.init(f,M,"connectionSegment.move",{cursor:$==="x"?"resize-ew":"resize-ns",data:{connection:m,connectionGfx:b,context:g}}))};function s(f,m){if(!o)return m;var v=f.waypoints,g;return f.waypoints=m,g=o.getCroppedWaypoints(f),f.waypoints=v,g}function u(f){a.update("connection",f.connection,f.connectionGfx)}function c(f,m,v){var g=f.newWaypoints,b=f.segmentStartIndex+m,_=g[b],k=f.segmentEndIndex+m,N=g[k],A=cy(f.axis),S=c1(v,_,N,A);Ft(f.draggerGfx,S.x,S.y)}function p(f,m){var v=0,g=f.filter(function(b,_){return sp(f[_-1],f[_+1],b)?(v=_<=m?v-1:v,!1):!0});return{waypoints:g,segmentOffset:v}}t.on("connectionSegment.move.start",function(f){var m=f.context,v=f.connection,g=n.getLayer("overlays");m.originalWaypoints=v.waypoints.slice(),m.draggerGfx=oy(g,m.segmentStart,m.segmentEnd),Se(m.draggerGfx).add("djs-dragging"),n.addMarker(v,mh)}),t.on("connectionSegment.move.move",function(f){var m=f.context,v=m.connection,g=m.segmentStartIndex,b=m.segmentEndIndex,_=m.segmentStart,k=m.segmentEnd,N=m.axis,A=m.originalWaypoints.slice(),S=vh(_,N,f["d"+N]),C=vh(k,N,f["d"+N]),D=A.length,$=0;A[g]=S,A[b]=C;var M,V;g<2&&(M=St(v.source,S),g===1?M==="intersect"&&(A.shift(),A[0]=S,$--):M!=="intersect"&&(A.unshift(_),$++)),b>D-3&&(V=St(v.target,C),b===D-2?V==="intersect"&&(A.pop(),A[A.length-1]=C):V!=="intersect"&&A.push(k)),m.newWaypoints=v.waypoints=s(v,A),c(m,$,f),m.newSegmentStartIndex=g+$,u(f)}),t.on("connectionSegment.move.hover",function(f){f.context.hover=f.hover,n.addMarker(f.hover,hh)}),t.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(f){var m=f.context.hover;m&&n.removeMarker(m,hh)}),t.on("connectionSegment.move.cleanup",function(f){var m=f.context,v=m.connection;m.draggerGfx&&tt(m.draggerGfx),n.removeMarker(v,mh)}),t.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(f){var m=f.context,v=m.connection;v.waypoints=m.originalWaypoints,u(f)}),t.on("connectionSegment.move.end",function(f){var m=f.context,v=m.connection,g=m.newWaypoints,b=m.newSegmentStartIndex;g=g.map(function(C){return{original:C.original,x:Math.round(C.x),y:Math.round(C.y)}});var _=p(g,b),k=_.waypoints,N=s(v,k),A=_.segmentOffset,S={segmentMove:{segmentStartIndex:m.segmentStartIndex,newSegmentStartIndex:b+A}};r.updateWaypoints(v,N,S)})}py.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","modeling"];var p1=Math.abs,yh=Math.round;function f1(e,t,n){n=n===void 0?10:n;var i,a;for(i=0;i<t.length;i++)if(a=t[i],p1(a-e)<=n)return a}function fy(e){return{x:e.x,y:e.y}}function dy(e){return{x:e.x+e.width,y:e.y+e.height}}function on(e,t){return!e||isNaN(e.x)||isNaN(e.y)?t:{x:yh(e.x+e.width/2),y:yh(e.y+e.height/2)}}function Lr(e,t){var n=e.snapped;return n?typeof t=="string"?n[t]:n.x&&n.y:!1}function st(e,t,n){if(typeof t!="string")throw new Error("axis must be in [x, y]");if(typeof n!="number"&&n!==!1)throw new Error("value must be Number or false");var i,a=e[t],r=e.snapped=e.snapped||{};return n===!1?r[t]=!1:(r[t]=!0,i=n-a,e[t]+=i,e["d"+t]+=i),a}function hy(e){return e.children||[]}var d1=Math.abs,Eh=Math.round,Lu=10;function my(e){function t(r,o){if(xe(r)){for(var s=r.length;s--;)if(d1(r[s]-o)<=Lu)return r[s]}else{r=+r;var u=o%r;if(u<Lu)return o-u;if(u>r-Lu)return o-u+r}return o}function n(r){if(r.width)return{x:Eh(r.width/2+r.x),y:Eh(r.height/2+r.y)}}function i(r){var o=r.snapPoints,s=r.connection,u=s.waypoints,c=r.segmentStart,p=r.segmentStartIndex,f=r.segmentEnd,m=r.segmentEndIndex,v=r.axis;if(o)return o;var g=[u[p-1],c,f,u[m+1]];return p<2&&g.unshift(n(s.source)),m>u.length-3&&g.unshift(n(s.target)),r.snapPoints=o={horizontal:[],vertical:[]},B(g,function(b){b&&(b=b.original||b,v==="y"&&o.horizontal.push(b.y),v==="x"&&o.vertical.push(b.x))}),o}e.on("connectionSegment.move.move",1500,function(r){var o=r.context,s=i(o),u=r.x,c=r.y,p,f;if(s){p=t(s.vertical,u),f=t(s.horizontal,c);var m=u-p,v=c-f;G(r,{dx:r.dx-m,dy:r.dy-v,x:p,y:f}),(m||s.vertical.indexOf(u)!==-1)&&st(r,"x",p),(v||s.horizontal.indexOf(c)!==-1)&&st(r,"y",f)}});function a(r){var o=r.snapPoints,s=r.connection.waypoints,u=r.bendpointIndex;if(o)return o;var c=[s[u-1],s[u+1]];return r.snapPoints=o={horizontal:[],vertical:[]},B(c,function(p){p&&(p=p.original||p,o.horizontal.push(p.y),o.vertical.push(p.x))}),o}e.on(["bendpoint.move.move","bendpoint.move.end"],1500,function(r){var o=r.context,s=a(o),u=o.hover,c=u&&n(u),p=r.x,f=r.y,m,v;if(s){m=t(c?s.vertical.concat([c.x]):s.vertical,p),v=t(c?s.horizontal.concat([c.y]):s.horizontal,f);var g=p-m,b=f-v;G(r,{dx:r.dx-g,dy:r.dy-b,x:r.x-g,y:r.y-b}),(g||s.vertical.indexOf(p)!==-1)&&st(r,"x",m),(b||s.horizontal.indexOf(f)!==-1)&&st(r,"y",v)}})}my.$inject=["eventBus"];const h1={__depends__:[oi,Hn],__init__:["bendpoints","bendpointSnapping","bendpointMovePreview"],bendpoints:["type",ly],bendpointMove:["type",Pp],bendpointMovePreview:["type",uy],connectionSegmentMove:["type",py],bendpointSnapping:["type",my]};function vy(e,t,n,i){function a(o,s){return i.allowed("connection.create",{source:o,target:s})}function r(o,s){return a(s,o)}e.on("connect.hover",function(o){var s=o.context,u=s.start,c=o.hover,p;if(s.hover=c,p=s.canExecute=a(u,c),!$a(p)){if(p!==!1){s.source=u,s.target=c;return}p=s.canExecute=r(u,c),!$a(p)&&p!==!1&&(s.source=c,s.target=u)}}),e.on(["connect.out","connect.cleanup"],function(o){var s=o.context;s.hover=null,s.source=null,s.target=null,s.canExecute=!1}),e.on("connect.end",function(o){var s=o.context,u=s.canExecute,c=s.connectionStart,p={x:o.x,y:o.y},f=s.source,m=s.target;if(!u)return!1;var v=null,g={connectionStart:Mc(s)?p:c,connectionEnd:Mc(s)?c:p};nt(u)&&(v=u),n.connect(f,m,v,g)}),this.start=function(o,s,u,c){nt(u)||(c=u,u=Ee(s)),t.init(o,"connect",{autoActivate:c,data:{shape:s,context:{start:s,connectionStart:u}}})}}vy.$inject=["eventBus","dragging","modeling","rules"];function Mc(e){var t=e.hover,n=e.source,i=e.target;return t&&n&&t===n&&n!==i}var m1=1100,v1=900,bh="connect-ok",_h="connect-not-ok";function gy(e,t,n){var i=e.get("connectionPreview",!1);i&&t.on("connect.move",function(a){var r=a.context,o=r.canExecute,s=r.hover,u=r.source,c=r.start,p=r.startPosition,f=r.target,m=r.connectionStart||p,v=r.connectionEnd||{x:a.x,y:a.y},g=m,b=v;Mc(r)&&(g=v,b=m),i.drawPreview(r,o,{source:u||c,target:f||s,connectionStart:g,connectionEnd:b})}),t.on("connect.hover",v1,function(a){var r=a.context,o=a.hover,s=r.canExecute;s!==null&&n.addMarker(o,s?bh:_h)}),t.on(["connect.out","connect.cleanup"],m1,function(a){var r=a.hover;r&&(n.removeMarker(r,bh),n.removeMarker(r,_h))}),i&&t.on("connect.cleanup",function(a){i.cleanUp(a.context)})}gy.$inject=["injector","eventBus","canvas"];const Ip={__depends__:[Fn,Hn,oi],__init__:["connectPreview"],connect:["type",vy],connectPreview:["type",gy]};var g1="djs-connection-preview";function si(e,t,n,i){this._canvas=t,this._graphicsFactory=n,this._elementFactory=i,this._connectionDocking=e.get("connectionDocking",!1),this._layouter=e.get("layouter",!1)}si.$inject=["injector","canvas","graphicsFactory","elementFactory"];si.prototype.drawPreview=function(e,t,n){n=n||{};var i=e.connectionPreviewGfx,a=e.getConnection,r=n.source,o=n.target,s=n.waypoints,u=n.connectionStart,c=n.connectionEnd,p=n.noLayout,f=n.noCropping,m=n.noNoop,v,g=this;if(i||(i=e.connectionPreviewGfx=this.createConnectionPreviewGfx()),ip(i),a||(a=e.getConnection=y1(function(b,_,k){return g.getConnection(b,_,k)})),t&&(v=a(t,r,o)),!v){!m&&this.drawNoopPreview(i,n);return}v.waypoints=s||[],this._layouter&&!p&&(v.waypoints=this._layouter.layoutConnection(v,{source:r,target:o,connectionStart:u,connectionEnd:c,waypoints:n.waypoints||v.waypoints})),(!v.waypoints||!v.waypoints.length)&&(v.waypoints=[r?Ee(r):u,o?Ee(o):c]),this._connectionDocking&&(r||o)&&!f&&(v.waypoints=this._connectionDocking.getCroppedWaypoints(v,r,o)),this._graphicsFactory.drawConnection(i,v)};si.prototype.drawNoopPreview=function(e,t){var n=t.source,i=t.target,a=t.connectionStart||Ee(n),r=t.connectionEnd||Ee(i),o=this.cropWaypoints(a,r,n,i),s=this.createNoopConnection(o[0],o[1]);fe(e,s)};si.prototype.cropWaypoints=function(e,t,n,i){var a=this._graphicsFactory,r=n&&a.getShapePath(n),o=i&&a.getShapePath(i),s=a.getConnectionPath({waypoints:[e,t]});return e=n&&bc(r,s,!0)||e,t=i&&bc(o,s,!1)||t,[e,t]};si.prototype.cleanUp=function(e){e&&e.connectionPreviewGfx&&tt(e.connectionPreviewGfx)};si.prototype.getConnection=function(e){var t=E1(e);return this._elementFactory.createConnection(t)};si.prototype.createConnectionPreviewGfx=function(){var e=le("g");return ee(e,{pointerEvents:"none"}),Se(e).add(g1),fe(this._canvas.getActiveLayer(),e),e};si.prototype.createNoopConnection=function(e,t){var n=le("polyline");return ee(n,{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"}),ee(n,{points:[e.x,e.y,t.x,t.y]}),n};function y1(e){var t={};return function(n){var i=JSON.stringify(n),a=t[i];return a||(a=t[i]=e.apply(null,arguments)),a}}function E1(e){return nt(e)?e:{}}const b1={__init__:["connectionPreview"],connectionPreview:["type",si]};var xh=Math.min,Sh=Math.max;function Bu(e){e.preventDefault()}function ka(e){e.stopPropagation()}function _1(e){return e.nodeType===Node.TEXT_NODE}function x1(e){return[].slice.call(e)}function wn(e){this.container=e.container,this.parent=je('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=Xe("[contenteditable]",this.parent),this.keyHandler=e.keyHandler||function(){},this.resizeHandler=e.resizeHandler||function(){},this.autoResize=Pt(this.autoResize,this),this.handlePaste=Pt(this.handlePaste,this)}wn.prototype.create=function(e,t,n,i){var a=this,r=this.parent,o=this.content,s=this.container;i=this.options=i||{},t=this.style=t||{};var u=cn(t,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);G(r.style,{width:e.width+"px",height:e.height+"px",maxWidth:e.maxWidth+"px",maxHeight:e.maxHeight+"px",minWidth:e.minWidth+"px",minHeight:e.minHeight+"px",left:e.x+"px",top:e.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},u);var c=cn(t,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return G(o.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},c),i.centerVertically&&G(o.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},c),o.innerText=n,pe.bind(o,"keydown",this.keyHandler),pe.bind(o,"mousedown",ka),pe.bind(o,"paste",a.handlePaste),i.autoResize&&pe.bind(o,"input",this.autoResize),i.resizable&&this.resizable(t),s.appendChild(r),this.setSelection(o.lastChild,o.lastChild&&o.lastChild.length),r};wn.prototype.handlePaste=function(e){var t=this.options,n=this.style;e.preventDefault();var i;if(e.clipboardData?i=e.clipboardData.getData("text/plain"):i=window.clipboardData.getData("Text"),this.insertText(i),t.autoResize){var a=this.autoResize(n);a&&this.resizeHandler(a)}};wn.prototype.insertText=function(e){e=S1(e);var t=document.execCommand("insertText",!1,e);t||this._insertTextIE(e)};wn.prototype._insertTextIE=function(e){var t=this.getSelection(),n=t.startContainer,i=t.endContainer,a=t.startOffset,r=t.endOffset,o=t.commonAncestorContainer,s=x1(o.childNodes),u,c;if(_1(o)){var p=n.textContent;n.textContent=p.substring(0,a)+e+p.substring(r),u=n,c=a+e.length}else if(n===this.content&&i===this.content){var f=document.createTextNode(e);this.content.insertBefore(f,s[a]),u=f,c=f.textContent.length}else{var m=s.indexOf(n),v=s.indexOf(i);s.forEach(function(g,b){b===m?g.textContent=n.textContent.substring(0,a)+e+i.textContent.substring(r):b>m&&b<=v&&$n(g)}),u=n,c=a+e.length}u&&c!==void 0&&setTimeout(function(){self.setSelection(u,c)})};wn.prototype.autoResize=function(){var e=this.parent,t=this.content,n=parseInt(this.style.fontSize)||12;if(t.scrollHeight>e.offsetHeight||t.scrollHeight<e.offsetHeight-n){var i=e.getBoundingClientRect(),a=t.scrollHeight;e.style.height=a+"px",this.resizeHandler({width:i.width,height:i.height,dx:0,dy:a-i.height})}};wn.prototype.resizable=function(){var e=this,t=this.parent,n=this.resizeHandle,i=parseInt(this.style.minWidth)||0,a=parseInt(this.style.minHeight)||0,r=parseInt(this.style.maxWidth)||1/0,o=parseInt(this.style.maxHeight)||1/0;if(!n){n=this.resizeHandle=je('<div class="djs-direct-editing-resize-handle"></div>');var s,u,c,p,f=function(g){Bu(g),ka(g),s=g.clientX,u=g.clientY;var b=t.getBoundingClientRect();c=b.width,p=b.height,pe.bind(document,"mousemove",m),pe.bind(document,"mouseup",v)},m=function(g){Bu(g),ka(g);var b=xh(Sh(c+g.clientX-s,i),r),_=xh(Sh(p+g.clientY-u,a),o);t.style.width=b+"px",t.style.height=_+"px",e.resizeHandler({width:c,height:p,dx:g.clientX-s,dy:g.clientY-u})},v=function(g){Bu(g),ka(g),pe.unbind(document,"mousemove",m,!1),pe.unbind(document,"mouseup",v,!1)};pe.bind(n,"mousedown",f)}G(n.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),t.appendChild(n)};wn.prototype.destroy=function(){var e=this.parent,t=this.content,n=this.resizeHandle;t.innerText="",e.removeAttribute("style"),t.removeAttribute("style"),pe.unbind(t,"keydown",this.keyHandler),pe.unbind(t,"mousedown",ka),pe.unbind(t,"input",this.autoResize),pe.unbind(t,"paste",this.handlePaste),n&&(n.removeAttribute("style"),$n(n)),$n(e)};wn.prototype.getValue=function(){return this.content.innerText.trim()};wn.prototype.getSelection=function(){var e=window.getSelection(),t=e.getRangeAt(0);return t};wn.prototype.setSelection=function(e,t){var n=document.createRange();e===null?n.selectNodeContents(this.content):(n.setStart(e,t),n.setEnd(e,t));var i=window.getSelection();i.removeAllRanges(),i.addRange(n)};function S1(e){return e.replace(/\r\n|\r|\n/g,`
`)}function dn(e,t){this._eventBus=e,this._providers=[],this._textbox=new wn({container:t.getContainer(),keyHandler:Pt(this._handleKey,this),resizeHandler:Pt(this._handleResize,this)})}dn.$inject=["eventBus","canvas"];dn.prototype.registerProvider=function(e){this._providers.push(e)};dn.prototype.isActive=function(e){return!!(this._active&&(!e||this._active.element===e))};dn.prototype.cancel=function(){this._active&&(this._fire("cancel"),this.close())};dn.prototype._fire=function(e,t){this._eventBus.fire("directEditing."+e,t||{active:this._active})};dn.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0};dn.prototype.complete=function(){var e=this._active;if(e){var t,n=e.context.bounds,i=this.$textbox.getBoundingClientRect(),a=this.getValue(),r=e.context.text;(a!==r||i.height!==n.height||i.width!==n.width)&&(t=this._textbox.container.getBoundingClientRect(),e.provider.update(e.element,a,e.context.text,{x:i.left-t.left,y:i.top-t.top,width:i.width,height:i.height})),this._fire("complete"),this.close()}};dn.prototype.getValue=function(){return this._textbox.getValue()};dn.prototype._handleKey=function(e){e.stopPropagation();var t=e.keyCode||e.charCode;if(t===27)return e.preventDefault(),this.cancel();if(t===13&&!e.shiftKey)return e.preventDefault(),this.complete()};dn.prototype._handleResize=function(e){this._fire("resize",e)};dn.prototype.activate=function(e){this.isActive()&&this.cancel();var t,n=Me(this._providers,function(i){return(t=i.activate(e))?i:null});return t&&(this.$textbox=this._textbox.create(t.bounds,t.style,t.text,t.options),this._active={element:e,context:t,provider:n},t.options&&t.options.resizable&&(this.resizable=!0),this._fire("activate")),!!t};const yy={__depends__:[no],__init__:["directEditing"],directEditing:["type",dn]};var wh=".entry",w1=1e3;function hn(e,t,n){this._eventBus=t,this._overlays=n;var i=sn(e&&e.scale)?e.scale:{min:1,max:1.5};this._overlaysConfig={position:{right:-9,top:-6},scale:i},this._current=null,this._init()}hn.$inject=["config.contextPad","eventBus","overlays"];hn.prototype._init=function(){var e=this._eventBus,t=this;e.on("selection.changed",function(n){var i=n.newSelection;i.length===1?t.open(i[0]):t.close()}),e.on("elements.delete",function(n){var i=n.elements;B(i,function(a){t.isOpen(a)&&t.close()})}),e.on("element.changed",function(n){var i=n.element,a=t._current;a&&a.element===i&&t.open(i,!0)})};hn.prototype.registerProvider=function(e,t){t||(t=e,e=w1),this._eventBus.on("contextPad.getProviders",e,function(n){n.providers.push(t)})};hn.prototype.getEntries=function(e){var t=this._getProviders(),n={};return B(t,function(i){var a=i.getContextPadEntries(e);bt(a)?n=a(n):B(a,function(r,o){n[o]=r})}),n};hn.prototype.trigger=function(e,t,n){var i=this._current.element,a=this._current.entries,r,o,s,u=t.delegateTarget||t.target;if(!u)return t.preventDefault();if(r=a[Xt(u,"data-action")],o=r.action,s=t.originalEvent||t,bt(o)){if(e==="click")return o(s,i,n)}else if(o[e])return o[e](s,i,n);t.preventDefault()};hn.prototype.open=function(e,t){!t&&this.isOpen(e)||(this.close(),this._updateAndOpen(e))};hn.prototype._getProviders=function(){var e=this._eventBus.createEvent({type:"contextPad.getProviders",providers:[]});return this._eventBus.fire(e),e.providers};hn.prototype._updateAndOpen=function(e){var t=this.getEntries(e),n=this.getPad(e),i=n.html;B(t,function(a,r){var o=a.group||"default",s=je(a.html||'<div class="entry" draggable="true"></div>'),u;Xt(s,"data-action",r),u=Xe("[data-group="+o+"]",i),u||(u=je('<div class="group" data-group="'+o+'"></div>'),i.appendChild(u)),u.appendChild(s),a.className&&T1(s,a.className),a.title&&Xt(s,"title",a.title),a.imageUrl&&s.appendChild(je('<img src="'+a.imageUrl+'">'))}),lt(i).add("open"),this._current={element:e,pad:n,entries:t},this._eventBus.fire("contextPad.open",{current:this._current})};hn.prototype.getPad=function(e){if(this.isOpen())return this._current.pad;var t=this,n=this._overlays,i=je('<div class="djs-context-pad"></div>'),a=G({html:i},this._overlaysConfig);qt.bind(i,wh,"click",function(o){t.trigger("click",o)}),qt.bind(i,wh,"dragstart",function(o){t.trigger("dragstart",o)}),pe.bind(i,"mousedown",function(o){o.stopPropagation()}),this._overlayId=n.add(e,"context-pad",a);var r=n.get(this._overlayId);return this._eventBus.fire("contextPad.create",{element:e,pad:r}),r};hn.prototype.close=function(){this.isOpen()&&(this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)};hn.prototype.isOpen=function(e){return!!this._current&&(e?this._current.element===e:!0)};function T1(e,t){var n=lt(e),i=xe(t)?t:t.split(/\s+/g);i.forEach(function(a){n.add(a)})}const C1={__depends__:[no,bp],contextPad:["type",hn]};var A1=["marker-start","marker-mid","marker-end"],P1=["circle","ellipse","line","path","polygon","polyline","rect"];function rr(e,t,n,i){this._elementRegistry=e,this._canvas=n,this._styles=i,this._clonedMarkers={};var a=this;t.on("drag.cleanup",function(){B(a._clonedMarkers,function(r){tt(r)}),a._clonedMarkers={}})}rr.$inject=["elementRegistry","eventBus","canvas","styles"];rr.prototype.getGfx=function(e){return this._elementRegistry.getGraphics(e)};rr.prototype.addDragger=function(e,t,n){n=n||this.getGfx(e);var i=Vv(n),a=n.getBoundingClientRect();return this._cloneMarkers(Gs(i)),ee(i,this._styles.cls("djs-dragger",[],{x:a.top,y:a.left})),fe(t,i),i};rr.prototype.addFrame=function(e,t){var n=le("rect",{class:"djs-resize-overlay",width:e.width,height:e.height,x:e.x,y:e.y});return fe(t,n),n};rr.prototype._cloneMarkers=function(e){var t=this;if(e.childNodes)for(var n=0;n<e.childNodes.length;n++)t._cloneMarkers(e.childNodes[n]);M1(e)&&A1.forEach(function(i){if(ee(e,i)){var a=R1(e,i,t._canvas.getContainer());t._cloneMarker(e,a,i)}})};rr.prototype._cloneMarker=function(e,t,n){var i=t.id,a=this._clonedMarkers[i];if(!a){a=Vv(t);var r=i+"-clone";a.id=r,Se(a).add("djs-dragger").add("djs-dragger-marker"),this._clonedMarkers[i]=a;var o=Xe("defs",this._canvas._svg);o||(o=le("defs"),fe(this._canvas._svg,o)),fe(o,a)}var s=N1(this._clonedMarkers[i].id);ee(e,n,s)};function R1(e,t,n){var i=I1(ee(e,t));return Xe("marker#"+i,n||document)}function I1(e){return e.match(/url\(['"]?#([^'"]*)['"]?\)/)[1]}function N1(e){return"url(#"+e+")"}function M1(e){return P1.indexOf(e.nodeName)!==-1}const ao={__init__:["previewSupport"],previewSupport:["type",rr]};var k1="drop-ok",Th="drop-not-ok",Ch="attach-ok",Ah="new-parent",Ph="create",D1=2e3;function Ey(e,t,n,i,a){function r(u,c,p,f,m){if(!c)return!1;u=ge(u,function(N){var A=N.labelTarget;return!N.parent&&!(O1(N)&&u.indexOf(A)!==-1)});var v=Me(u,function(N){return!Pa(N)}),g=!1,b=!1,_=!1;Ih(u)&&(g=a.allowed("shape.attach",{position:p,shape:v,target:c})),g||(Ih(u)?_=a.allowed("shape.create",{position:p,shape:v,source:f,target:c}):_=a.allowed("elements.create",{elements:u,position:p,target:c}));var k=m.connectionTarget;return _||g?(v&&f&&(b=a.allowed("connection.create",{source:k===f?v:f,target:k===f?f:v,hints:{targetParent:c,targetAttach:g}})),{attach:g,connect:b}):_===null||g===null?null:!1}function o(u,c){[Ch,k1,Th,Ah].forEach(function(p){p===c?e.addMarker(u,p):e.removeMarker(u,p)})}n.on(["create.move","create.hover"],function(u){var c=u.context,p=c.elements,f=u.hover,m=c.source,v=c.hints||{};if(!f){c.canExecute=!1,c.target=null;return}Rh(u);var g={x:u.x,y:u.y},b=c.canExecute=f&&r(p,f,g,m,v);f&&b!==null&&(c.target=f,b&&b.attach?o(f,Ch):o(f,b?Ah:Th))}),n.on(["create.end","create.out","create.cleanup"],function(u){var c=u.hover;c&&o(c,null)}),n.on("create.end",function(u){var c=u.context,p=c.source,f=c.shape,m=c.elements,v=c.target,g=c.canExecute,b=g&&g.attach,_=g&&g.connect,k=c.hints||{};if(g===!1||!v)return!1;Rh(u);var N={x:u.x,y:u.y};_?f=i.appendShape(p,f,N,v,{attach:b,connection:_===!0?{}:_,connectionTarget:k.connectionTarget}):(m=i.createElements(m,N,v,G({},k,{attach:b})),f=Me(m,function(A){return!Pa(A)})),G(c,{elements:m,shape:f}),G(u,{elements:m,shape:f})});function s(){var u=t.context();u&&u.prefix===Ph&&t.cancel()}n.on("create.init",function(){n.on("elements.changed",s),n.once(["create.cancel","create.end"],D1,function(){n.off("elements.changed",s)})}),this.start=function(u,c,p){xe(c)||(c=[c]);var f=Me(c,function(v){return!Pa(v)});if(f){p=G({elements:c,hints:{},shape:f},p||{}),B(c,function(v){ve(v.x)||(v.x=0),ve(v.y)||(v.y=0)});var m=xt(c);B(c,function(v){Pa(v)&&(v.waypoints=pt(v.waypoints,function(g){return{x:g.x-m.x-m.width/2,y:g.y-m.y-m.height/2}})),G(v,{x:v.x-m.x-m.width/2,y:v.y-m.y-m.height/2})}),t.init(u,Ph,{cursor:"grabbing",autoActivate:!0,data:{shape:f,elements:c,context:p}})}}}Ey.$inject=["canvas","dragging","eventBus","modeling","rules"];function Rh(e){var t=e.context,n=t.createConstraints;n&&(n.left&&(e.x=Math.max(e.x,n.left)),n.right&&(e.x=Math.min(e.x,n.right)),n.top&&(e.y=Math.max(e.y,n.top)),n.bottom&&(e.y=Math.min(e.y,n.bottom)))}function Pa(e){return!!e.waypoints}function Ih(e){return e&&e.length===1&&!Pa(e[0])}function O1(e){return!!e.labelTarget}var L1=750;function by(e,t,n,i,a){function r(o){var s=le("g");ee(s,a.cls("djs-drag-group",["no-events"]));var u=le("g");return o.forEach(function(c){var p;c.hidden||(c.waypoints?(p=n._createContainer("connection",u),n.drawConnection(Gs(p),c)):(p=n._createContainer("shape",u),n.drawShape(Gs(p),c),Ft(p,c.x,c.y)),i.addDragger(c,s,p))}),s}t.on("create.move",L1,function(o){var s=o.hover,u=o.context,c=u.elements,p=u.dragGroup;p||(p=u.dragGroup=r(c));var f;s?(p.parentNode||(f=e.getActiveLayer(),fe(f,p)),Ft(p,o.x,o.y)):tt(p)}),t.on("create.cleanup",function(o){var s=o.context,u=s.dragGroup;u&&tt(u)})}by.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"];const Tl={__depends__:[oi,ao,Hn,Fn],__init__:["create","createPreview"],create:["type",Ey],createPreview:["type",by]};var _y="data-id",xy=["contextPad.close","canvas.viewbox.changing","commandStack.changed"],B1=1e3;function rt(e,t,n){var i=sn(e&&e.scale)?e.scale:{min:1,max:1.5};this._config={scale:i},this._eventBus=t,this._canvas=n,this._providers={},this._current={}}rt.$inject=["config.popupMenu","eventBus","canvas"];rt.prototype.registerProvider=function(e,t,n){n||(n=t,t=B1),this._eventBus.on("popupMenu.getProviders."+e,t,function(i){i.providers.push(n)})};rt.prototype.isEmpty=function(e,t){if(!e)throw new Error("element parameter is missing");if(!t)throw new Error("providerId parameter is missing");var n=this._getProviders(t);if(!n)return!0;var i=this._getEntries(e,n),a=this._getHeaderEntries(e,n),r=Rr(i)>0,o=a&&Rr(a)>0;return!r&&!o};rt.prototype.open=function(e,t,n){var i=this._getProviders(t);if(!e)throw new Error("Element is missing");if(!i||!i.length)throw new Error("No registered providers for: "+t);if(!n)throw new Error("the position argument is missing");this.isOpen()&&this.close(),this._emit("open");var a=this._current={className:t,element:e,position:n},r=this._getEntries(e,i),o=this._getHeaderEntries(e,i);a.entries=G({},r,o),a.container=this._createContainer(),Rr(o)&&a.container.appendChild(this._createEntries(o,"djs-popup-header")),Rr(r)&&a.container.appendChild(this._createEntries(r,"djs-popup-body"));var s=this._canvas,u=s.getContainer();this._attachContainer(a.container,u,n.cursor),this._bindAutoClose()};rt.prototype.close=function(){this.isOpen()&&(this._emit("close"),this._unbindAutoClose(),$n(this._current.container),this._current.container=null)};rt.prototype.isOpen=function(){return!!this._current.container};rt.prototype.trigger=function(e){e.preventDefault();var t=e.delegateTarget||e.target,n=Xt(t,_y),i=this._getEntry(n);if(i.action)return i.action.call(null,e,i)};rt.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"popupMenu.getProviders."+e,providers:[]});return this._eventBus.fire(t),t.providers};rt.prototype._getEntries=function(e,t){var n={};return B(t,function(i){if(!i.getPopupMenuEntries){B(i.getEntries(e),function(r){var o=r.id;if(!o)throw new Error("every entry must have the id property set");n[o]=ei(r,["id"])});return}var a=i.getPopupMenuEntries(e);bt(a)?n=a(n):B(a,function(r,o){n[o]=r})}),n};rt.prototype._getHeaderEntries=function(e,t){var n={};return B(t,function(i){if(!i.getPopupMenuHeaderEntries){if(!i.getHeaderEntries)return;B(i.getHeaderEntries(e),function(r){var o=r.id;if(!o)throw new Error("every entry must have the id property set");n[o]=ei(r,["id"])});return}var a=i.getPopupMenuHeaderEntries(e);bt(a)?n=a(n):B(a,function(r,o){n[o]=r})}),n};rt.prototype._getEntry=function(e){var t=this._current.entries[e];if(!t)throw new Error("entry not found");return t};rt.prototype._emit=function(e){this._eventBus.fire("popupMenu."+e)};rt.prototype._createContainer=function(){var e=je('<div class="djs-popup">'),t=this._current.position,n=this._current.className;return G(e.style,{position:"absolute",left:t.x+"px",top:t.y+"px",visibility:"hidden"}),lt(e).add(n),e};rt.prototype._attachContainer=function(e,t,n){var i=this;qt.bind(e,".entry","click",function(a){i.trigger(a)}),this._updateScale(e),t.appendChild(e),n&&this._assureIsInbounds(e,n)};rt.prototype._updateScale=function(e){var t=this._canvas.zoom(),n=this._config.scale,i,a,r=t;n!==!0&&(n===!1?(i=1,a=1):(i=n.min,a=n.max),sn(i)&&t<i&&(r=i),sn(a)&&t>a&&(r=a)),$1(e,"scale("+r+")")};rt.prototype._assureIsInbounds=function(e,t){var n=this._canvas,i=n._container.getBoundingClientRect(),a=e.offsetLeft,r=e.offsetTop,o=e.scrollWidth,s=e.scrollHeight,u={},c,p,f={x:t.x-i.left,y:t.y-i.top};a+o>i.width&&(u.x=!0),r+s>i.height&&(u.y=!0),u.x&&u.y?(c=f.x-o+"px",p=f.y-s+"px"):u.x?(c=f.x-o+"px",p=f.y+"px"):u.y&&f.y<s?(c=f.x+"px",p="10px"):u.y&&(c=f.x+"px",p=f.y-s+"px"),G(e.style,{left:c,top:p},{visibility:"visible","z-index":1e3})};rt.prototype._createEntries=function(e,t){var n=je("<div>"),i=this;return lt(n).add(t),B(e,function(a,r){var o=i._createEntry(a,r);n.appendChild(o)}),n};rt.prototype._createEntry=function(e,t){var n=je("<div>"),i=lt(n);if(i.add("entry"),e.className&&e.className.split(" ").forEach(function(r){i.add(r)}),Xt(n,_y,t),e.label){var a=je("<span>");a.textContent=e.label,n.appendChild(a)}return e.imageUrl&&n.appendChild(je('<img src="'+e.imageUrl+'" />')),e.active===!0&&i.add("active"),e.disabled===!0&&i.add("disabled"),e.title&&(n.title=e.title),n};rt.prototype._bindAutoClose=function(){this._eventBus.once(xy,this.close,this)};rt.prototype._unbindAutoClose=function(){this._eventBus.off(xy,this.close,this)};function $1(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){e.style[n+"transform"]=t})}const V1={__init__:["popupMenu"],popupMenu:["type",rt]};function oo(){}oo.prototype.get=function(){return this._data};oo.prototype.set=function(e){this._data=e};oo.prototype.clear=function(){var e=this._data;return delete this._data,e};oo.prototype.isEmpty=function(){return!this._data};const F1={clipboard:["type",oo]};function Np(e){var t=this;this._lastMoveEvent=null;function n(i){t._lastMoveEvent=i}e.on("canvas.init",function(i){var a=t._svg=i.svg;a.addEventListener("mousemove",n)}),e.on("canvas.destroy",function(){t._lastMouseEvent=null,t._svg.removeEventListener("mousemove",n)})}Np.$inject=["eventBus"];Np.prototype.getLastMoveEvent=function(){return this._lastMoveEvent||j1(0,0)};function j1(e,t){var n=document.createEvent("MouseEvent"),i=e,a=t,r=e,o=t;return n.initMouseEvent&&n.initMouseEvent("mousemove",!0,!0,window,0,i,a,r,o,!1,!1,!1,!1,0,null),n}const so={__init__:["mouse"],mouse:["type",Np]};function Tn(e,t,n,i,a,r,o,s){this._canvas=e,this._create=t,this._clipboard=n,this._elementFactory=i,this._eventBus=a,this._modeling=r,this._mouse=o,this._rules=s,a.on("copyPaste.copyElement",function(u){var c=u.descriptor,p=u.element,f=u.elements;c.priority=1,c.id=p.id;var m=Me(f,function(v){return v===p.parent});m&&(c.parent=p.parent.id),H1(p)&&(c.priority=2,c.host=p.host.id),Cl(p)&&(c.priority=3,c.source=p.source.id,c.target=p.target.id,c.waypoints=z1(p)),Al(p)&&(c.priority=4,c.labelTarget=p.labelTarget.id),B(["x","y","width","height"],function(v){ve(p[v])&&(c[v]=p[v])}),c.hidden=p.hidden,c.collapsed=p.collapsed}),a.on("copyPaste.pasteElements",function(u){var c=u.hints;G(c,{createElementsBehavior:!1})})}Tn.$inject=["canvas","create","clipboard","elementFactory","eventBus","modeling","mouse","rules"];Tn.prototype.copy=function(e){var t,n;return xe(e)||(e=e?[e]:[]),t=this._eventBus.fire("copyPaste.canCopyElements",{elements:e}),t===!1?n={}:n=this.createTree(xe(t)?t:e),this._clipboard.set(n),this._eventBus.fire("copyPaste.elementsCopied",{elements:e,tree:n}),n};Tn.prototype.paste=function(e){var t=this._clipboard.get();if(!this._clipboard.isEmpty()){var n=e&&e.hints||{};this._eventBus.fire("copyPaste.pasteElements",{hints:n});var i=this._createElements(t);if(e&&e.element&&e.point)return this._paste(i,e.element,e.point,n);this._create.start(this._mouse.getLastMoveEvent(),i,{hints:n||{}})}};Tn.prototype._paste=function(e,t,n,i){B(e,function(r){ve(r.x)||(r.x=0),ve(r.y)||(r.y=0)});var a=xt(e);return B(e,function(r){Cl(r)&&(r.waypoints=pt(r.waypoints,function(o){return{x:o.x-a.x-a.width/2,y:o.y-a.y-a.height/2}})),G(r,{x:r.x-a.x-a.width/2,y:r.y-a.y-a.height/2})}),this._modeling.createElements(e,n,t,G({},i))};Tn.prototype._createElements=function(e){var t=this,n=this._eventBus,i={},a=[];return B(e,function(r,o){r=un(r,"priority"),B(r,function(s){var u=G({},ei(s,["priority"]));i[s.parent]?u.parent=i[s.parent]:delete u.parent,n.fire("copyPaste.pasteElement",{cache:i,descriptor:u});var c;if(Cl(u)){u.source=i[s.source],u.target=i[s.target],c=i[s.id]=t.createConnection(u),a.push(c);return}if(Al(u)){u.labelTarget=i[u.labelTarget],c=i[s.id]=t.createLabel(u),a.push(c);return}u.host&&(u.host=i[u.host]),c=i[s.id]=t.createShape(u),a.push(c)})}),a};Tn.prototype.createConnection=function(e){var t=this._elementFactory.createConnection(ei(e,["id"]));return t};Tn.prototype.createLabel=function(e){var t=this._elementFactory.createLabel(ei(e,["id"]));return t};Tn.prototype.createShape=function(e){var t=this._elementFactory.createShape(ei(e,["id"]));return t};Tn.prototype.hasRelations=function(e,t){var n,i,a;return!(Cl(e)&&(i=Me(t,ln({id:e.source.id})),a=Me(t,ln({id:e.target.id})),!i||!a)||Al(e)&&(n=Me(t,ln({id:e.labelTarget.id})),!n))};Tn.prototype.createTree=function(e){var t=this._rules,n=this,i={},a=[],r=zv(e);function o(c,p){return t.allowed("element.copy",{element:c,elements:p})}function s(c,p){var f=Me(a,function(m){return c===m.element});if(!f){a.push({element:c,depth:p});return}f.depth<p&&(a=u(f,a),a.push({element:f.element,depth:p}))}function u(c,p){var f=p.indexOf(c);return f!==-1&&p.splice(f,1),p}return nr(r,function(c,p,f){if(Al(c))return;B(c.labels,function(v){s(v,f)});function m(v){v&&v.length&&B(v,function(g){B(g.labels,function(b){s(b,f)}),s(g,f)})}return B([c.attachers,c.incoming,c.outgoing],m),s(c,f),c.children}),e=pt(a,function(c){return c.element}),a=pt(a,function(c){return c.descriptor={},n._eventBus.fire("copyPaste.copyElement",{descriptor:c.descriptor,element:c.element,elements:e}),c}),a=un(a,function(c){return c.descriptor.priority}),e=pt(a,function(c){return c.element}),B(a,function(c){var p=c.depth;if(!n.hasRelations(c.element,e)){Mh(c.element,e);return}if(!o(c.element,e)){Mh(c.element,e);return}i[p]||(i[p]=[]),i[p].push(c.descriptor)}),i};function H1(e){return!!e.host}function Cl(e){return!!e.waypoints}function Al(e){return!!e.labelTarget}function z1(e){return pt(e.waypoints,function(t){return t=Nh(t),t.original&&(t.original=Nh(t.original)),t})}function Nh(e){return G({},e)}function Mh(e,t){var n=t.indexOf(e);return n===-1?t:t.splice(n,1)}const G1={__depends__:[F1,Tl,so,Hn],__init__:["copyPaste"],copyPaste:["type",Tn]};function Jo(e,t,n){xe(n)||(n=[n]),B(n,function(i){Qn(e[i])||(t[i]=e[i])})}function U1(e,t){xe(t)||(t=[t]),B(t,function(n){e[n]&&delete e[n]})}var W1=750;function Sy(e,t,n){t.on("copyPaste.copyElement",W1,function(r){var o=r.descriptor,s=r.element,u=o.oldBusinessObject=oe(s);if(o.type=s.type,Jo(u,o,"name"),o.di={},Jo(u.di,o.di,["fill","stroke","background-color","border-color","color"]),Jo(u.di,o,"isExpanded"),kh(o))return o;u.default&&(o.default=u.default.id)}),t.on("moddleCopy.canCopyProperty",function(r){var o=r.parent,s=r.property,u=r.propertyName,c;if(u==="processRef"&&w(o,"bpmn:Participant")&&w(s,"bpmn:Process"))return c=e.create("bpmn:Process"),n.copyElement(s,c)});var i;function a(r,o){var s=oe(r);r.default&&(i[r.default]={element:s,property:"default"}),r.host&&(oe(r).attachedToRef=oe(o[r.host])),i=ei(i,Ht(i,function(u,c,p){var f=c.element,m=c.property;return p===r.id&&(f[m]=s,u.push(r.id)),u},[]))}t.on("copyPaste.pasteElements",function(){i={}}),t.on("copyPaste.pasteElement",function(r){var o=r.cache,s=r.descriptor,u=s.oldBusinessObject,c;if(kh(s)){s.businessObject=oe(o[s.labelTarget]);return}c=e.create(u.$type),s.businessObject=n.copyElement(u,c),a(s,o),Jo(s,c,["isExpanded","name"]),U1(s,"oldBusinessObject")})}Sy.$inject=["bpmnFactory","eventBus","moddleCopy"];function kh(e){return!!e.labelTarget}var q1=["artifacts","dataInputAssociations","dataOutputAssociations","default","flowElements","lanes","incoming","outgoing"];function lo(e,t,n){this._bpmnFactory=t,this._eventBus=e,this._moddle=n,e.on("moddleCopy.canCopyProperties",function(i){var a=i.propertyNames;if(!(!a||!a.length))return un(a,function(r){return r==="extensionElements"})}),e.on("moddleCopy.canCopyProperty",function(i){var a=i.parent,r=nt(a)&&a.$descriptor,o=i.propertyName;if(o&&q1.indexOf(o)!==-1||o&&r&&!Me(r.properties,ln({name:o})))return!1}),e.on("moddleCopy.canSetCopiedProperty",function(i){var a=i.property;if(Y1(a,"bpmn:ExtensionElements")&&(!a.values||!a.values.length))return!1})}lo.$inject=["eventBus","bpmnFactory","moddle"];lo.prototype.copyElement=function(e,t,n){var i=this;n&&!xe(n)&&(n=[n]),n=n||kc(e.$descriptor);var a=this._eventBus.fire("moddleCopy.canCopyProperties",{propertyNames:n,sourceElement:e,targetElement:t});return a===!1||(xe(a)&&(n=a),B(n,function(r){var o;kn(e,r)&&(o=e.get(r));var s=i.copyProperty(o,t,r),u=i._eventBus.fire("moddleCopy.canSetCopiedProperty",{parent:t,property:s,propertyName:r});u!==!1&&sn(s)&&t.set(r,s)})),t};lo.prototype.copyProperty=function(e,t,n){var i=this,a=this._eventBus.fire("moddleCopy.canCopyProperty",{parent:t,property:e,propertyName:n});if(a!==!1){if(a)return nt(a)&&a.$type&&!a.$parent&&(a.$parent=t),a;var r=this._moddle.getPropertyDescriptor(t,n);if(!r.isReference)return r.isId?this._copyId(e,t):xe(e)?Ht(e,function(o,s){return a=i.copyProperty(s,t,n),a?(a.$parent=t,o.concat(a)):o},[]):nt(e)&&e.$type?this._moddle.getElementDescriptor(e).isGeneric?void 0:(a=i._bpmnFactory.create(e.$type),a.$parent=t,a=i.copyElement(e,a),a):e}};lo.prototype._copyId=function(e,t){if(!this._moddle.ids.assigned(e))return this._moddle.ids.claim(e,t),e};function kc(e,t){return Ht(e.properties,function(n,i){return t&&i.default?n:n.concat(i.name)},[])}function Y1(e,t){return e&&typeof e.$instanceOf=="function"&&e.$instanceOf(t)}const wy={__depends__:[G1],__init__:["bpmnCopyPaste","moddleCopy"],bpmnCopyPaste:["type",Sy],moddleCopy:["type",lo]};var Dh=Math.round;function Mp(e){this._modeling=e}Mp.$inject=["modeling"];Mp.prototype.replaceElement=function(e,t,n){if(e.waypoints)return null;var i=this._modeling,a=t.width||e.width,r=t.height||e.height,o=t.x||e.x,s=t.y||e.y,u=Dh(o+a/2),c=Dh(s+r/2);return i.replaceShape(e,G({},t,{x:u,y:c,width:a,height:r}),n)};const K1={__init__:["replace"],replace:["type",Mp]};function X1(e,t,n){xe(n)||(n=[n]),B(n,function(i){Qn(e[i])||(t[i]=e[i])})}var Z1=["cancelActivity","instantiate","eventGatewayType","triggeredByEvent","isInterrupting"];function J1(e,t){var n=e&&kn(e,"collapsed")?e.collapsed:!Le(e),i;return t&&(kn(t,"collapsed")||kn(t,"isExpanded"))?i=kn(t,"collapsed")?t.collapsed:!t.isExpanded:i=n,n!==i?(e.collapsed=n,!0):!1}function Ty(e,t,n,i,a,r,o){function s(u,c,p){p=p||{};var f=c.type,m=u.businessObject;if(Qo(m)&&f==="bpmn:SubProcess"&&J1(u,c))return i.toggleCollapse(u),u;var v=e.create(f),g={type:f,businessObject:v},b=kc(m.$descriptor),_=kc(v.$descriptor,!0),k=Q1(b,_);G(v,cn(c,Z1));var N=ge(k,function(A){return A==="eventDefinitions"?Oh(u,c.eventDefinitionType):A==="loopCharacteristics"?!Yt(v):!(kn(v,A)||A==="processRef"&&c.isExpanded===!1||A==="triggeredByEvent")});return v=n.copyElement(m,v,N),c.eventDefinitionType&&(Oh(v,c.eventDefinitionType)||(g.eventDefinitionType=c.eventDefinitionType,g.eventDefinitionAttrs=c.eventDefinitionAttrs)),w(m,"bpmn:Activity")&&(Qo(m)?g.isExpanded=Le(m):c&&kn(c,"isExpanded")&&(g.isExpanded=c.isExpanded),Le(m)&&!w(m,"bpmn:Task")&&g.isExpanded&&(g.width=u.width,g.height=u.height)),Qo(m)&&!Qo(v)&&(p.moveChildren=!1),w(m,"bpmn:Participant")&&(c.isExpanded===!0?v.processRef=e.create("bpmn:Process"):p.moveChildren=!1,g.width=u.width,g.height=t._getDefaultSize(v).height),r.allowed("shape.resize",{shape:v})||(g.height=t._getDefaultSize(v).height,g.width=t._getDefaultSize(v).width),v.name=m.name,Pe(m,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&Pe(v,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(v.default=m.default),c.host&&!w(m,"bpmn:BoundaryEvent")&&w(v,"bpmn:BoundaryEvent")&&(g.host=c.host),(g.type==="bpmn:DataStoreReference"||g.type==="bpmn:DataObjectReference")&&(g.x=u.x+(u.width-g.width)/2),g.di={},X1(m.di,g.di,["fill","stroke","background-color","border-color","color"]),g=a.replaceElement(u,g,p),p.select!==!1&&o.select(g),g}this.replaceElement=s}Ty.$inject=["bpmnFactory","elementFactory","moddleCopy","modeling","replace","rules","selection"];function Qo(e){return w(e,"bpmn:SubProcess")}function Oh(e,t){var n=oe(e);return t&&n.get("eventDefinitions").some(function(i){return w(i,t)})}function Q1(e,t){return e.filter(function(n){return t.indexOf(n)!==-1})}const Cy={__depends__:[wy,K1,Fn],bpmnReplace:["type",Ty]};function Lh(e){return function(t){var n=t.target,i=oe(e),a=i.eventDefinitions&&i.eventDefinitions[0],r=i.$type===n.type,o=(a&&a.$type)===n.eventDefinitionType,s=i.triggeredByEvent===n.triggeredByEvent,u=n.isExpanded===void 0||n.isExpanded===Le(i);return!r||!o||!s||!u}}var eC=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],tC=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}],nC=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Intermediate Catch Event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message Intermediate Throw Event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Intermediate Catch Event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Intermediate Throw Event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Intermediate Catch Event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link Intermediate Catch Event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link Intermediate Throw Event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation Intermediate Throw Event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal Intermediate Catch Event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal Intermediate Throw Event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],iC=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message End Event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation End Event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error End Event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel End Event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation End Event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal End Event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate End Event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],rC=[{label:"Exclusive Gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel Gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive Gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex Gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event based Gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],aC=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}}],oC=[{label:"Sub Process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}}],sC=[{label:"Sub Process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}}],Bh=[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"Send Task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive Task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"User Task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Manual Task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business Rule Task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Service Task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Script Task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call Activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub Process (expanded)",actionName:"replace-with-expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}}],lC=[{label:"Data Store Reference",actionName:"replace-with-data-store-reference",className:"bpmn-icon-data-store",target:{type:"bpmn:DataStoreReference"}}],uC=[{label:"Data Object Reference",actionName:"replace-with-data-object-reference",className:"bpmn-icon-data-object",target:{type:"bpmn:DataObjectReference"}}],cC=[{label:"Message Boundary Event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Boundary Event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Boundary Event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Boundary Event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Error Boundary Event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel Boundary Event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Signal Boundary Event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Compensation Boundary Event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],pC=[{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Error Start Event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Escalation Start Event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Compensation Start Event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],fC=[{label:"Sequence Flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default Flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional Flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],dC=[{label:"Expanded Pool",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:function(e){var t="Empty Pool";return e.children&&e.children.length&&(t+=" (removes content)"),t},actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}];function mn(e,t,n,i,a,r,o){this._bpmnFactory=e,this._popupMenu=t,this._modeling=n,this._moddle=i,this._bpmnReplace=a,this._rules=r,this._translate=o,this.register()}mn.$inject=["bpmnFactory","popupMenu","modeling","moddle","bpmnReplace","rules","translate"];mn.prototype.register=function(){this._popupMenu.registerProvider("bpmn-replace",this)};mn.prototype.getEntries=function(e){var t=e.businessObject,n=this._rules,i;if(!n.allowed("shape.replace",{element:e}))return[];var a=Lh(e);return w(t,"bpmn:DataObjectReference")?this._createEntries(e,lC):w(t,"bpmn:DataStoreReference")?this._createEntries(e,uC):w(t,"bpmn:StartEvent")&&!w(t.$parent,"bpmn:SubProcess")?(i=ge(eC,a),this._createEntries(e,i)):w(t,"bpmn:Participant")?(i=ge(dC,function(r){return Le(t)!==r.target.isExpanded}),this._createEntries(e,i)):w(t,"bpmn:StartEvent")&&Yt(t.$parent)?(i=ge(pC,function(r){var o=r.target,s=o.isInterrupting!==!1,u=oe(e).isInterrupting===s;return a(r)||!a(r)&&!u}),this._createEntries(e,i)):w(t,"bpmn:StartEvent")&&!Yt(t.$parent)&&w(t.$parent,"bpmn:SubProcess")?(i=ge(tC,a),this._createEntries(e,i)):w(t,"bpmn:EndEvent")?(i=ge(iC,function(r){var o=r.target;return o.eventDefinitionType=="bpmn:CancelEventDefinition"&&!w(t.$parent,"bpmn:Transaction")?!1:a(r)}),this._createEntries(e,i)):w(t,"bpmn:BoundaryEvent")?(i=ge(cC,function(r){var o=r.target;if(o.eventDefinitionType=="bpmn:CancelEventDefinition"&&!w(t.attachedToRef,"bpmn:Transaction"))return!1;var s=o.cancelActivity!==!1,u=t.cancelActivity==s;return a(r)||!a(r)&&!u}),this._createEntries(e,i)):w(t,"bpmn:IntermediateCatchEvent")||w(t,"bpmn:IntermediateThrowEvent")?(i=ge(nC,a),this._createEntries(e,i)):w(t,"bpmn:Gateway")?(i=ge(rC,a),this._createEntries(e,i)):w(t,"bpmn:Transaction")?(i=ge(oC,a),this._createEntries(e,i)):Yt(t)&&Le(t)?(i=ge(sC,a),this._createEntries(e,i)):w(t,"bpmn:SubProcess")&&Le(t)?(i=ge(aC,a),this._createEntries(e,i)):w(t,"bpmn:AdHocSubProcess")&&!Le(t)?(i=ge(Bh,function(r){var o=r.target,s=o.type==="bpmn:SubProcess",u=o.isExpanded===!0;return Lh(e)&&(!s||u)}),this._createEntries(e,i)):w(t,"bpmn:SequenceFlow")?this._createSequenceFlowEntries(e,fC):w(t,"bpmn:FlowNode")?(i=ge(Bh,a),w(t,"bpmn:SubProcess")&&!Le(t)&&(i=ge(i,function(r){return r.label!=="Sub Process (collapsed)"})),this._createEntries(e,i)):[]};mn.prototype.getHeaderEntries=function(e){var t=[];return w(e,"bpmn:Activity")&&!Yt(e)&&(t=t.concat(this._getLoopEntries(e))),w(e,"bpmn:DataObjectReference")&&(t=t.concat(this._getDataObjectIsCollection(e))),w(e,"bpmn:Participant")&&(t=t.concat(this._getParticipantMultiplicity(e))),w(e,"bpmn:SubProcess")&&!w(e,"bpmn:Transaction")&&!Yt(e)&&t.push(this._getAdHocEntry(e)),t};mn.prototype._createEntries=function(e,t){var n=[],i=this;return B(t,function(a){var r=i._createMenuEntry(a,e);n.push(r)}),n};mn.prototype._createSequenceFlowEntries=function(e,t){var n=oe(e),i=[],a=this._modeling,r=this._moddle,o=this;return B(t,function(s){switch(s.actionName){case"replace-with-default-flow":n.sourceRef.default!==n&&(w(n.sourceRef,"bpmn:ExclusiveGateway")||w(n.sourceRef,"bpmn:InclusiveGateway")||w(n.sourceRef,"bpmn:ComplexGateway")||w(n.sourceRef,"bpmn:Activity"))&&i.push(o._createMenuEntry(s,e,function(){a.updateProperties(e.source,{default:n})}));break;case"replace-with-conditional-flow":!n.conditionExpression&&w(n.sourceRef,"bpmn:Activity")&&i.push(o._createMenuEntry(s,e,function(){var u=r.create("bpmn:FormalExpression",{body:""});a.updateProperties(e,{conditionExpression:u})}));break;default:if(w(n.sourceRef,"bpmn:Activity")&&n.conditionExpression)return i.push(o._createMenuEntry(s,e,function(){a.updateProperties(e,{conditionExpression:void 0})}));if((w(n.sourceRef,"bpmn:ExclusiveGateway")||w(n.sourceRef,"bpmn:InclusiveGateway")||w(n.sourceRef,"bpmn:ComplexGateway")||w(n.sourceRef,"bpmn:Activity"))&&n.sourceRef.default===n)return i.push(o._createMenuEntry(s,e,function(){a.updateProperties(e.source,{default:void 0})}))}}),i};mn.prototype._createMenuEntry=function(e,t,n){var i=this._translate,a=this._bpmnReplace.replaceElement,r=function(){return a(t,e.target)},o=e.label;o&&typeof o=="function"&&(o=o(t)),n=n||r;var s={label:i(o),className:e.className,id:e.actionName,action:n};return s};mn.prototype._getLoopEntries=function(e){var t=this,n=this._translate;function i(p,f){var m;f.active?m=void 0:(m=t._moddle.create(f.options.loopCharacteristics),f.options.isSequential&&(m.isSequential=f.options.isSequential)),t._modeling.updateProperties(e,{loopCharacteristics:m})}var a=oe(e),r=a.loopCharacteristics,o,s,u;r&&(o=r.isSequential,s=r.isSequential===void 0,u=r.isSequential!==void 0&&!r.isSequential);var c=[{id:"toggle-parallel-mi",className:"bpmn-icon-parallel-mi-marker",title:n("Parallel Multi Instance"),active:u,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!1}},{id:"toggle-sequential-mi",className:"bpmn-icon-sequential-mi-marker",title:n("Sequential Multi Instance"),active:o,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!0}},{id:"toggle-loop",className:"bpmn-icon-loop-marker",title:n("Loop"),active:s,action:i,options:{loopCharacteristics:"bpmn:StandardLoopCharacteristics"}}];return c};mn.prototype._getDataObjectIsCollection=function(e){var t=this,n=this._translate;function i(s,u){t._modeling.updateModdleProperties(e,a,{isCollection:!u.active})}var a=e.businessObject.dataObjectRef,r=a.isCollection,o=[{id:"toggle-is-collection",className:"bpmn-icon-parallel-mi-marker",title:n("Collection"),active:r,action:i}];return o};mn.prototype._getParticipantMultiplicity=function(e){var t=this,n=this._bpmnFactory,i=this._translate;function a(s,u){var c=u.active,p;c||(p=n.create("bpmn:ParticipantMultiplicity")),t._modeling.updateProperties(e,{participantMultiplicity:p})}var r=e.businessObject.participantMultiplicity,o=[{id:"toggle-participant-multiplicity",className:"bpmn-icon-parallel-mi-marker",title:i("Participant Multiplicity"),active:!!r,action:a}];return o};mn.prototype._getAdHocEntry=function(e){var t=this._translate,n=oe(e),i=w(n,"bpmn:AdHocSubProcess"),a=this._bpmnReplace.replaceElement,r={id:"toggle-adhoc",className:"bpmn-icon-ad-hoc-marker",title:t("Ad-hoc"),active:i,action:function(o,s){return i?a(e,{type:"bpmn:SubProcess"},{autoResize:!1,layoutConnection:!1}):a(e,{type:"bpmn:AdHocSubProcess"},{autoResize:!1,layoutConnection:!1})}};return r};const hC={__depends__:[V1,Cy],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",mn]};var qs=Math.max,Ys=Math.min,mC=20;function Ay(e,t){return{top:e.top-t.top,right:e.right-t.right,bottom:e.bottom-t.bottom,left:e.left-t.left}}function vC(e,t,n){var i=n.x,a=n.y,r={x:e.x,y:e.y,width:e.width,height:e.height};return t.indexOf("n")!==-1?(r.y=e.y+a,r.height=e.height-a):t.indexOf("s")!==-1&&(r.height=e.height+a),t.indexOf("e")!==-1?r.width=e.width+i:t.indexOf("w")!==-1&&(r.x=e.x+i,r.width=e.width-i),r}function gC(e,t){return{x:e.x+(t.left||0),y:e.y+(t.top||0),width:e.width-(t.left||0)+(t.right||0),height:e.height-(t.top||0)+(t.bottom||0)}}function es(e,t,n){var i=t[e],a=n.min&&n.min[e],r=n.max&&n.max[e];return ve(a)&&(i=(/top|left/.test(e)?Ys:qs)(i,a)),ve(r)&&(i=(/top|left/.test(e)?qs:Ys)(i,r)),i}function yC(e,t){if(!t)return e;var n=ce(e);return up({top:es("top",n,t),right:es("right",n,t),bottom:es("bottom",n,t),left:es("left",n,t)})}function EC(e,t,n,i){var a=ce(t),r={top:/n/.test(e)?a.bottom-n.height:a.top,left:/w/.test(e)?a.right-n.width:a.left,bottom:/s/.test(e)?a.top+n.height:a.bottom,right:/e/.test(e)?a.left+n.width:a.right},o=i?ce(i):r,s={top:Ys(r.top,o.top),left:Ys(r.left,o.left),bottom:qs(r.bottom,o.bottom),right:qs(r.right,o.right)};return up(s)}function _a(e,t){return typeof e!="undefined"?e:mC}function bC(e,t){var n,i,a,r;return typeof t=="object"?(n=_a(t.left),i=_a(t.right),a=_a(t.top),r=_a(t.bottom)):n=i=a=r=_a(t),{x:e.x-n,y:e.y-a,width:e.width+n+i,height:e.height+a+r}}function _C(e){return!(e.waypoints||e.type==="label")}function Py(e,t){var n;if(e.length===void 0?n=ge(e.children,_C):n=e,n.length)return bC(xt(n),t)}var ts=Math.abs;function xC(e,t){return Ay(ce(t),ce(e))}var SC=["bpmn:Participant","bpmn:Process","bpmn:SubProcess"],Sr=30;function Pl(e,t){return t=t||[],e.children.filter(function(n){w(n,"bpmn:Lane")&&(Pl(n,t),t.push(n))}),t}function ar(e){return e.children.filter(function(t){return w(t,"bpmn:Lane")})}function bn(e){return Us(e,SC)||e}function wC(e,t){var n=bn(e),i=w(n,"bpmn:Process")?[]:[n],a=Pl(n,i),r=ce(e),o=ce(t),s=xC(e,t),u=[];return a.forEach(function(c){if(c!==e){var p=0,f=s.right,m=0,v=s.left,g=ce(c);s.top&&(ts(g.bottom-r.top)<10&&(m=o.top-g.bottom),ts(g.top-r.top)<5&&(p=o.top-g.top)),s.bottom&&(ts(g.top-r.bottom)<10&&(p=o.bottom-g.top),ts(g.bottom-r.bottom)<5&&(m=o.bottom-g.bottom)),(p||f||m||v)&&u.push({shape:c,newBounds:gC(c,{top:p,right:f,bottom:m,left:v})})}}),u}function kp(e,t,n,i,a,r,o,s,u,c,p,f){e=e||{},i.registerProvider(this),this._contextPad=i,this._modeling=a,this._elementFactory=r,this._connect=o,this._create=s,this._popupMenu=u,this._canvas=c,this._rules=p,this._translate=f,e.autoPlace!==!1&&(this._autoPlace=t.get("autoPlace",!1)),n.on("create.end",250,function(m){var v=m.context,g=v.shape;if(!(!Or(m)||!i.isOpen(g))){var b=i.getEntries(g);b.replace&&b.replace.action.click(m,g)}})}kp.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate"];kp.prototype.getContextPadEntries=function(e){var t=this._contextPad,n=this._modeling,i=this._elementFactory,a=this._connect,r=this._create,o=this._popupMenu,s=this._canvas,u=this._rules,c=this._autoPlace,p=this._translate,f={};if(e.type==="label")return f;var m=e.businessObject;function v(S,C){a.start(S,C)}function g(S){n.removeElements([e])}function b(S){var C=5,D=s.getContainer(),$=t.getPad(S).html,M=D.getBoundingClientRect(),V=$.getBoundingClientRect(),K=V.top-M.top,X=V.left-M.left,z={x:X,y:K+V.height+C};return z}function _(S,C,D,$){typeof D!="string"&&($=D,D=p("Append {type}",{type:S.replace(/^bpmn:/,"")}));function M(K,X){var z=i.createShape(G({type:S},$));r.start(K,z,{source:X})}var V=c?function(K,X){var z=i.createShape(G({type:S},$));c.append(X,z)}:M;return{group:"model",className:C,title:D,action:{dragstart:M,click:V}}}function k(S){return function(C,D){n.splitLane(D,S),t.open(D,!0)}}if(Pe(m,["bpmn:Lane","bpmn:Participant"])&&Le(m)){var N=ar(e);G(f,{"lane-insert-above":{group:"lane-insert-above",className:"bpmn-icon-lane-insert-above",title:p("Add Lane above"),action:{click:function(S,C){n.addLane(C,"top")}}}}),N.length<2&&(e.height>=120&&G(f,{"lane-divide-two":{group:"lane-divide",className:"bpmn-icon-lane-divide-two",title:p("Divide into two Lanes"),action:{click:k(2)}}}),e.height>=180&&G(f,{"lane-divide-three":{group:"lane-divide",className:"bpmn-icon-lane-divide-three",title:p("Divide into three Lanes"),action:{click:k(3)}}})),G(f,{"lane-insert-below":{group:"lane-insert-below",className:"bpmn-icon-lane-insert-below",title:p("Add Lane below"),action:{click:function(S,C){n.addLane(C,"bottom")}}}})}w(m,"bpmn:FlowNode")&&(w(m,"bpmn:EventBasedGateway")?G(f,{"append.receive-task":_("bpmn:ReceiveTask","bpmn-icon-receive-task",p("Append ReceiveTask")),"append.message-intermediate-event":_("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-message",p("Append MessageIntermediateCatchEvent"),{eventDefinitionType:"bpmn:MessageEventDefinition"}),"append.timer-intermediate-event":_("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-timer",p("Append TimerIntermediateCatchEvent"),{eventDefinitionType:"bpmn:TimerEventDefinition"}),"append.condition-intermediate-event":_("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-condition",p("Append ConditionIntermediateCatchEvent"),{eventDefinitionType:"bpmn:ConditionalEventDefinition"}),"append.signal-intermediate-event":_("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-signal",p("Append SignalIntermediateCatchEvent"),{eventDefinitionType:"bpmn:SignalEventDefinition"})}):$h(m,"bpmn:BoundaryEvent","bpmn:CompensateEventDefinition")?G(f,{"append.compensation-activity":_("bpmn:Task","bpmn-icon-task",p("Append compensation activity"),{isForCompensation:!0})}):!w(m,"bpmn:EndEvent")&&!m.isForCompensation&&!$h(m,"bpmn:IntermediateThrowEvent","bpmn:LinkEventDefinition")&&!Yt(m)&&G(f,{"append.end-event":_("bpmn:EndEvent","bpmn-icon-end-event-none",p("Append EndEvent")),"append.gateway":_("bpmn:ExclusiveGateway","bpmn-icon-gateway-none",p("Append Gateway")),"append.append-task":_("bpmn:Task","bpmn-icon-task",p("Append Task")),"append.intermediate-event":_("bpmn:IntermediateThrowEvent","bpmn-icon-intermediate-event-none",p("Append Intermediate/Boundary Event"))})),o.isEmpty(e,"bpmn-replace")||G(f,{replace:{group:"edit",className:"bpmn-icon-screw-wrench",title:p("Change type"),action:{click:function(S,C){var D=G(b(C),{cursor:{x:S.x,y:S.y}});o.open(C,"bpmn-replace",D)}}}}),Pe(m,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])&&G(f,{"append.text-annotation":_("bpmn:TextAnnotation","bpmn-icon-text-annotation"),connect:{group:"connect",className:"bpmn-icon-connection-multi",title:p("Connect using "+(m.isForCompensation?"":"Sequence/MessageFlow or ")+"Association"),action:{click:v,dragstart:v}}}),w(m,"bpmn:TextAnnotation")&&G(f,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:p("Connect using Association"),action:{click:v,dragstart:v}}}),Pe(m,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&G(f,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:p("Connect using DataInputAssociation"),action:{click:v,dragstart:v}}}),w(m,"bpmn:Group")&&G(f,{"append.text-annotation":_("bpmn:TextAnnotation","bpmn-icon-text-annotation")});var A=u.allowed("elements.delete",{elements:[e]});return xe(A)&&(A=A[0]===e),A&&G(f,{delete:{group:"edit",className:"bpmn-icon-trash",title:p("Remove"),action:{click:g}}}),f};function $h(e,t,n){var i=e.$instanceOf(t),a=!1,r=e.eventDefinitions||[];return B(r,function(o){o.$type===n&&(a=!0)}),i&&a}const TC={__depends__:[yy,C1,Fn,Ip,Tl,hC],__init__:["contextPadProvider"],contextPadProvider:["type",kp]};var CC={horizontal:["x","width"],vertical:["y","height"]},Vh=5;function li(e){this._modeling=e,this._filters=[],this.registerFilter(function(t,n,i){var a=0,r=0,o;return B(t,function(s){s.waypoints||s.labelTarget||(a+=s[i],r+=1)}),o=Math.round(a/r),ge(t,function(s){return s[i]<o+50})})}li.$inject=["modeling"];li.prototype.registerFilter=function(e){if(typeof e!="function")throw new Error("the filter has to be a function");this._filters.push(e)};li.prototype.trigger=function(e,t){var n=this._modeling,i,a;if(!(e.length<3)&&(this._setOrientation(t),a=this._filterElements(e),i=this._createGroups(a),!(i.length<=2)))return n.distributeElements(i,this._axis,this._dimension),i};li.prototype._filterElements=function(e){var t=this._filters,n=this._axis,i=this._dimension,a=[].concat(e);return t.length?(B(t,function(r){a=r(a,n,i)}),a):e};li.prototype._createGroups=function(e){var t=[],n=this,i=this._axis,a=this._dimension;if(!i)throw new Error('must have a defined "axis" and "dimension"');var r=un(e,i);return B(r,function(o,s){var u=n._findRange(o,i,a),c,p=t[t.length-1];p&&n._hasIntersection(p.range,u)?t[t.length-1].elements.push(o):(c={range:u,elements:[o]},t.push(c))}),t};li.prototype._setOrientation=function(e){var t=CC[e];this._axis=t[0],this._dimension=t[1]};li.prototype._hasIntersection=function(e,t){return Math.max(e.min,e.max)>=Math.min(t.min,t.max)&&Math.min(e.min,e.max)<=Math.max(t.min,t.max)};li.prototype._findRange=function(e){var t=e[this._axis],n=e[this._dimension];return{min:t+Vh,max:t+n-Vh}};const AC={__init__:["distributeElements"],distributeElements:["type",li]};function Ry(e){e.registerFilter(function(t){return ge(t,function(n){var i=Pe(n,["bpmn:Association","bpmn:BoundaryEvent","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:Lane","bpmn:MessageFlow","bpmn:Participant","bpmn:SequenceFlow","bpmn:TextAnnotation"]);return!(n.labelTarget||i)})})}Ry.$inject=["distributeElements"];const PC={__depends__:[AC],__init__:["bpmnDistributeElements"],bpmnDistributeElements:["type",Ry]};var Iy="is not a registered action",RC="is already registered";function vn(e,t){this._actions={};var n=this;e.on("diagram.init",function(){n._registerDefaultActions(t),e.fire("editorActions.init",{editorActions:n})})}vn.$inject=["eventBus","injector"];vn.prototype._registerDefaultActions=function(e){var t=e.get("commandStack",!1),n=e.get("modeling",!1),i=e.get("selection",!1),a=e.get("zoomScroll",!1),r=e.get("copyPaste",!1),o=e.get("canvas",!1),s=e.get("rules",!1),u=e.get("keyboardMove",!1),c=e.get("keyboardMoveSelection",!1);t&&(this.register("undo",function(){t.undo()}),this.register("redo",function(){t.redo()})),r&&i&&this.register("copy",function(){var p=i.get();r.copy(p)}),r&&this.register("paste",function(){r.paste()}),a&&this.register("stepZoom",function(p){a.stepZoom(p.value)}),o&&this.register("zoom",function(p){o.zoom(p.value)}),n&&i&&s&&this.register("removeSelection",function(){var p=i.get();if(p.length){var f=s.allowed("elements.delete",{elements:p}),m;f!==!1&&(xe(f)?m=f:m=p,m.length&&n.removeElements(m.slice()))}}),u&&this.register("moveCanvas",function(p){u.moveCanvas(p)}),c&&this.register("moveSelection",function(p){c.moveSelection(p.direction,p.accelerated)})};vn.prototype.trigger=function(e,t){if(!this._actions[e])throw Dp(e,Iy);return this._actions[e](t)};vn.prototype.register=function(e,t){var n=this;if(typeof e=="string")return this._registerAction(e,t);B(e,function(i,a){n._registerAction(a,i)})};vn.prototype._registerAction=function(e,t){if(this.isRegistered(e))throw Dp(e,RC);this._actions[e]=t};vn.prototype.unregister=function(e){if(!this.isRegistered(e))throw Dp(e,Iy);this._actions[e]=void 0};vn.prototype.getActions=function(){return Object.keys(this._actions)};vn.prototype.isRegistered=function(e){return!!this._actions[e]};function Dp(e,t){return new Error(e+" "+t)}const IC={__init__:["editorActions"],editorActions:["type",vn]};function Rl(e){e.invoke(vn,this)}se(Rl,vn);Rl.$inject=["injector"];Rl.prototype._registerDefaultActions=function(e){vn.prototype._registerDefaultActions.call(this,e);var t=e.get("canvas",!1),n=e.get("elementRegistry",!1),i=e.get("selection",!1),a=e.get("spaceTool",!1),r=e.get("lassoTool",!1),o=e.get("handTool",!1),s=e.get("globalConnect",!1),u=e.get("distributeElements",!1),c=e.get("alignElements",!1),p=e.get("directEditing",!1),f=e.get("searchPad",!1),m=e.get("modeling",!1);t&&n&&i&&this._registerAction("selectElements",function(){var v=t.getRootElement(),g=n.filter(function(b){return b!==v});return i.select(g),g}),a&&this._registerAction("spaceTool",function(){a.toggle()}),r&&this._registerAction("lassoTool",function(){r.toggle()}),o&&this._registerAction("handTool",function(){o.toggle()}),s&&this._registerAction("globalConnectTool",function(){s.toggle()}),i&&u&&this._registerAction("distributeElements",function(v){var g=i.get(),b=v.type;g.length&&u.trigger(g,b)}),i&&c&&this._registerAction("alignElements",function(v){var g=i.get(),b=[],_=v.type;g.length&&(b=ge(g,function(k){return!w(k,"bpmn:Lane")}),c.trigger(b,_))}),i&&m&&this._registerAction("setColor",function(v){var g=i.get();g.length&&m.setColor(g,v)}),i&&p&&this._registerAction("directEditing",function(){var v=i.get();v.length&&p.activate(v[0])}),f&&this._registerAction("find",function(){f.toggle()}),t&&m&&this._registerAction("moveToOrigin",function(){var v=t.getRootElement(),g,b;w(v,"bpmn:Collaboration")?b=n.filter(function(_){return w(_.parent,"bpmn:Collaboration")}):b=n.filter(function(_){return _!==v&&!w(_.parent,"bpmn:SubProcess")}),g=xt(b),m.moveElements(b,{x:-g.x,y:-g.y},v)})};const NC={__depends__:[IC],editorActions:["type",Rl]};function Ny(e){e.on(["create.init","shape.move.init"],function(t){var n=t.context,i=t.shape;Pe(i,["bpmn:Participant","bpmn:SubProcess","bpmn:TextAnnotation"])&&(n.gridSnappingContext||(n.gridSnappingContext={}),n.gridSnappingContext.snapLocation="top-left")})}Ny.$inject=["eventBus"];var Rs=10;function $u(e,t,n){return n||(n="round"),Math[n](e/t)*t}var MC=1200,kC=800;function Ri(e,t,n){var i=!n||n.active!==!1;this._eventBus=t;var a=this;t.on("diagram.init",kC,function(){a.setActive(i)}),t.on(["create.move","create.end","bendpoint.move.move","bendpoint.move.end","connect.move","connect.end","connectionSegment.move.move","connectionSegment.move.end","resize.move","resize.end","shape.move.move","shape.move.end"],MC,function(r){var o=r.originalEvent;if(!(!a.active||o&&Kt(o))){var s=r.context,u=s.gridSnappingContext;u||(u=s.gridSnappingContext={}),["x","y"].forEach(function(c){var p={},f=OC(r,c,e);f&&(p.offset=f);var m=DC(r,c);m&&G(p,m),Lr(r,c)||a.snapEvent(r,c,p)})}})}Ri.prototype.snapEvent=function(e,t,n){var i=this.snapValue(e[t],n);st(e,t,i)};Ri.prototype.getGridSpacing=function(){return Rs};Ri.prototype.snapValue=function(e,t){var n=0;t&&t.offset&&(n=t.offset),e+=n,e=$u(e,Rs);var i,a;return t&&t.min&&(i=t.min,ve(i)&&(i=$u(i+n,Rs,"ceil"),e=Math.max(e,i))),t&&t.max&&(a=t.max,ve(a)&&(a=$u(a+n,Rs,"floor"),e=Math.min(e,a))),e-=n,e};Ri.prototype.isActive=function(){return this.active};Ri.prototype.setActive=function(e){this.active=e,this._eventBus.fire("gridSnapping.toggle",{active:e})};Ri.prototype.toggleActive=function(){this.setActive(!this.active)};Ri.$inject=["elementRegistry","eventBus","config.gridSnapping"];function DC(e,t){var n=e.context,i=n.createConstraints,a=n.resizeConstraints||{},r=n.gridSnappingContext,o=r.snapConstraints;if(o&&o[t])return o[t];o||(o=r.snapConstraints={}),o[t]||(o[t]={});var s=n.direction;i&&(Is(t)?(o.x.min=i.left,o.x.max=i.right):(o.y.min=i.top,o.y.max=i.bottom));var u=a.min,c=a.max;return u&&(Is(t)?jh(s)?o.x.max=u.left:o.x.min=u.right:Fh(s)?o.y.max=u.top:o.y.min=u.bottom),c&&(Is(t)?jh(s)?o.x.min=c.left:o.x.max=c.right:Fh(s)?o.y.min=c.top:o.y.max=c.bottom),o[t]}function OC(e,t,n){var i=e.context,a=e.shape,r=i.gridSnappingContext,o=r.snapLocation,s=r.snapOffset;return s&&ve(s[t])||(s||(s=r.snapOffset={}),ve(s[t])||(s[t]=0),!a)||(n.get(a.id)||(Is(t)?s[t]+=a[t]+a.width/2:s[t]+=a[t]+a.height/2),!o)||(t==="x"?/left/.test(o)?s[t]-=a.width/2:/right/.test(o)&&(s[t]+=a.width/2):/top/.test(o)?s[t]-=a.height/2:/bottom/.test(o)&&(s[t]+=a.height/2)),s[t]}function Is(e){return e==="x"}function Fh(e){return e.indexOf("n")!==-1}function jh(e){return e.indexOf("w")!==-1}function or(e,t){ie.call(this,e),this._gridSnapping=t;var n=this;this.preExecute("shape.resize",function(i){var a=i.context,r=a.hints||{},o=r.autoResize;if(o){var s=a.shape,u=a.newBounds;jt(o)?a.newBounds=n.snapComplex(u,o):a.newBounds=n.snapSimple(s,u)}})}or.$inject=["eventBus","gridSnapping","modeling"];se(or,ie);or.prototype.snapSimple=function(e,t){var n=this._gridSnapping;return t.width=n.snapValue(t.width,{min:t.width}),t.height=n.snapValue(t.height,{min:t.height}),t.x=e.x+e.width/2-t.width/2,t.y=e.y+e.height/2-t.height/2,t};or.prototype.snapComplex=function(e,t){return/w|e/.test(t)&&(e=this.snapHorizontally(e,t)),/n|s/.test(t)&&(e=this.snapVertically(e,t)),e};or.prototype.snapHorizontally=function(e,t){var n=this._gridSnapping,i=/w/.test(t),a=/e/.test(t),r={};return r.width=n.snapValue(e.width,{min:e.width}),a&&(i?(r.x=n.snapValue(e.x,{max:e.x}),r.width+=n.snapValue(e.x-r.x,{min:e.x-r.x})):e.x=e.x+e.width-r.width),G(e,r),e};or.prototype.snapVertically=function(e,t){var n=this._gridSnapping,i=/n/.test(t),a=/s/.test(t),r={};return r.height=n.snapValue(e.height,{min:e.height}),i&&(a?(r.y=n.snapValue(e.y,{max:e.y}),r.height+=n.snapValue(e.y-r.y,{min:e.y-r.y})):e.y=e.y+e.height-r.height),G(e,r),e};var LC=2e3;function My(e,t){e.on(["spaceTool.move","spaceTool.end"],LC,function(n){var i=n.context;if(i.initialized){var a=i.axis,r;a==="x"?(r=t.snapValue(n.dx),n.x=n.x+r-n.dx,n.dx=r):(r=t.snapValue(n.dy),n.y=n.y+r-n.dy,n.dy=r)}})}My.$inject=["eventBus","gridSnapping"];const BC={__init__:["gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior"],gridSnappingResizeBehavior:["type",or],gridSnappingSpaceToolBehavior:["type",My]},$C={__depends__:[BC],__init__:["gridSnapping"],gridSnapping:["type",Ri]};var VC=2e3;function ky(e,t){e.on("autoPlace",VC,function(n){var i=n.source,a=Ee(i),r=n.shape,o=Qg(i,r);return["x","y"].forEach(function(s){var u={};o[s]!==a[s]&&(o[s]>a[s]?u.min=o[s]:u.max=o[s],w(r,"bpmn:TextAnnotation")&&(FC(s)?u.offset=-r.width/2:u.offset=-r.height/2),o[s]=t.snapValue(o[s],u))}),o})}ky.$inject=["eventBus","gridSnapping"];function FC(e){return e==="x"}var jC=1750;function Dy(e,t,n){t.on(["create.start","shape.move.start"],jC,function(i){var a=i.context,r=a.shape,o=e.getRootElement();if(!(!w(r,"bpmn:Participant")||!w(o,"bpmn:Process")||!o.children.length)){var s=a.createConstraints;s&&(r.width=n.snapValue(r.width,{min:r.width}),r.height=n.snapValue(r.height,{min:r.height}))}})}Dy.$inject=["canvas","eventBus","gridSnapping"];var HC=3e3;function Il(e,t,n){ie.call(this,e),this._gridSnapping=t;var i=this;this.postExecuted(["connection.create","connection.layout"],HC,function(a){var r=a.context,o=r.connection,s=r.hints||{},u=o.waypoints;s.connectionStart||s.connectionEnd||s.createElementsBehavior===!1||zC(u)&&n.updateWaypoints(o,i.snapMiddleSegments(u))})}Il.$inject=["eventBus","gridSnapping","modeling"];se(Il,ie);Il.prototype.snapMiddleSegments=function(e){var t=this._gridSnapping,n;e=e.slice();for(var i=1;i<e.length-2;i++)n=WC(t,e[i],e[i+1]),e[i]=n[0],e[i+1]=n[1];return e};function zC(e){return e.length>3}function GC(e){return e==="h"}function UC(e){return e==="v"}function WC(e,t,n){var i=Kn(t,n),a={};return GC(i)&&(a.y=e.snapValue(t.y)),UC(i)&&(a.x=e.snapValue(t.x)),("x"in a||"y"in a)&&(t=G({},t,a),n=G({},n,a)),[t,n]}const qC={__init__:["gridSnappingAutoPlaceBehavior","gridSnappingCreateParticipantBehavior","gridSnappingLayoutConnectionBehavior"],gridSnappingAutoPlaceBehavior:["type",ky],gridSnappingCreateParticipantBehavior:["type",Dy],gridSnappingLayoutConnectionBehavior:["type",Il]},YC={__depends__:[$C,qC],__init__:["bpmnGridSnapping"],bpmnGridSnapping:["type",Ny]};var KC=30,XC=30;function uo(e,t){this._interactionEvents=t;var n=this;e.on(["interactionEvents.createHit","interactionEvents.updateHit"],function(i){var a=i.element,r=i.gfx;if(w(a,"bpmn:Lane"))return n.createParticipantHit(a,r);if(w(a,"bpmn:Participant"))return Le(a)?n.createParticipantHit(a,r):n.createDefaultHit(a,r);if(w(a,"bpmn:SubProcess"))return Le(a)?n.createSubProcessHit(a,r):n.createDefaultHit(a,r)})}uo.$inject=["eventBus","interactionEvents"];uo.prototype.createDefaultHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createDefaultHit(e,t),!0};uo.prototype.createParticipantHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:KC,height:e.height}),!0};uo.prototype.createSubProcessHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:e.width,height:XC}),!0};const ZC={__init__:["bpmnInteractionEvents"],bpmnInteractionEvents:["type",uo]};function Nl(e){e.invoke(Zr,this)}se(Nl,Zr);Nl.$inject=["injector"];Nl.prototype.registerBindings=function(e,t){Zr.prototype.registerBindings.call(this,e,t);function n(i,a){t.isRegistered(i)&&e.addListener(a)}n("selectElements",function(i){var a=i.keyEvent;if(e.isKey(["a","A"],a)&&e.isCmd(a))return t.trigger("selectElements"),!0}),n("find",function(i){var a=i.keyEvent;if(e.isKey(["f","F"],a)&&e.isCmd(a))return t.trigger("find"),!0}),n("spaceTool",function(i){var a=i.keyEvent;if(!e.hasModifier(a)&&e.isKey(["s","S"],a))return t.trigger("spaceTool"),!0}),n("lassoTool",function(i){var a=i.keyEvent;if(!e.hasModifier(a)&&e.isKey(["l","L"],a))return t.trigger("lassoTool"),!0}),n("handTool",function(i){var a=i.keyEvent;if(!e.hasModifier(a)&&e.isKey(["h","H"],a))return t.trigger("handTool"),!0}),n("globalConnectTool",function(i){var a=i.keyEvent;if(!e.hasModifier(a)&&e.isKey(["c","C"],a))return t.trigger("globalConnectTool"),!0}),n("directEditing",function(i){var a=i.keyEvent;if(!e.hasModifier(a)&&e.isKey(["e","E"],a))return t.trigger("directEditing"),!0})};const JC={__depends__:[xp],__init__:["keyboardBindings"],keyboardBindings:["type",Nl]};var QC={moveSpeed:1,moveSpeedAccelerated:10},eA=1500,Hh="left",zh="up",Gh="right",Uh="down",tA={ArrowLeft:Hh,Left:Hh,ArrowUp:zh,Up:zh,ArrowRight:Gh,Right:Gh,ArrowDown:Uh,Down:Uh},nA={left:function(e){return{x:-e,y:0}},up:function(e){return{x:0,y:-e}},right:function(e){return{x:e,y:0}},down:function(e){return{x:0,y:e}}};function Oy(e,t,n,i,a){var r=this;this._config=G({},QC,e||{}),t.addListener(eA,function(o){var s=o.keyEvent,u=tA[s.key];if(u&&!t.isCmd(s)){var c=t.isShift(s);return r.moveSelection(u,c),!0}}),this.moveSelection=function(o,s){var u=a.get();if(u.length){var c=this._config[s?"moveSpeedAccelerated":"moveSpeed"],p=nA[o](c),f=i.allowed("elements.move",{shapes:u});f&&n.moveElements(u,p)}}}Oy.$inject=["config.keyboardMoveSelection","keyboard","modeling","rules","selection"];const iA={__depends__:[xp,Fn],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",Oy]};function Ly(e,t,n,i){e.on("element.changed",function(a){var r=a.element;(r.parent||r===t.getRootElement())&&(a.gfx=n.getGraphics(r)),a.gfx&&e.fire(Uv(r)+".changed",a)}),e.on("elements.changed",function(a){var r=a.elements;r.forEach(function(o){e.fire("element.changed",{element:o})}),i.updateContainments(r)}),e.on("shape.changed",function(a){i.update("shape",a.element,a.gfx)}),e.on("connection.changed",function(a){i.update("connection",a.element,a.gfx)})}Ly.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"];const By={__init__:["changeSupport"],changeSupport:["type",Ly]};var Wh=10;function co(e,t,n,i){this._dragging=i,this._rules=t;var a=this;function r(u,c){var p=u.shape,f=u.direction,m=u.resizeConstraints,v;u.delta=c,v=vC(p,f,c),u.newBounds=yC(v,m),u.canExecute=a.canResize(u)}function o(u){var c=u.resizeConstraints,p=u.minBounds;c===void 0&&(p===void 0&&(p=a.computeMinResizeBox(u)),u.resizeConstraints={min:ce(p)})}function s(u){var c=u.shape,p=u.canExecute,f=u.newBounds;if(p){if(f=Zv(f),!rA(c,f))return;n.resizeShape(c,f)}}e.on("resize.start",function(u){o(u.context)}),e.on("resize.move",function(u){var c={x:u.dx,y:u.dy};r(u.context,c)}),e.on("resize.end",function(u){s(u.context)})}co.prototype.canResize=function(e){var t=this._rules,n=cn(e,["newBounds","shape","delta","direction"]);return t.allowed("shape.resize",n)};co.prototype.activate=function(e,t,n){var i=this._dragging,a,r;if(typeof n=="string"&&(n={direction:n}),a=G({shape:t},n),r=a.direction,!r)throw new Error("must provide a direction (n|w|s|e|nw|se|ne|sw)");i.init(e,$y(t,r),"resize",{autoActivate:!0,cursor:aA(r),data:{shape:t,context:a}})};co.prototype.computeMinResizeBox=function(e){var t=e.shape,n=e.direction,i,a;return i=e.minDimensions||{width:Wh,height:Wh},a=Py(t,e.childrenBoxPadding),EC(n,t,i,a)};co.$inject=["eventBus","rules","modeling","dragging"];function rA(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}function $y(e,t){var n=Ee(e),i=ce(e),a={x:n.x,y:n.y};return t.indexOf("n")!==-1?a.y=i.top:t.indexOf("s")!==-1&&(a.y=i.bottom),t.indexOf("e")!==-1?a.x=i.right:t.indexOf("w")!==-1&&(a.x=i.left),a}function aA(e){var t="resize-";return e==="n"||e==="s"?t+"ns":e==="e"||e==="w"?t+"ew":e==="nw"||e==="se"?t+"nwse":t+"nesw"}var qh="djs-resizing",Yh="resize-not-ok",oA=500;function Vy(e,t,n){function i(r){var o=r.shape,s=r.newBounds,u=r.frame;u||(u=r.frame=n.addFrame(o,t.getActiveLayer()),t.addMarker(o,qh)),s.width>5&&ee(u,{x:s.x,width:s.width}),s.height>5&&ee(u,{y:s.y,height:s.height}),r.canExecute?Se(u).remove(Yh):Se(u).add(Yh)}function a(r){var o=r.shape,s=r.frame;s&&tt(r.frame),t.removeMarker(o,qh)}e.on("resize.move",oA,function(r){i(r.context)}),e.on("resize.cleanup",function(r){a(r.context)})}Vy.$inject=["eventBus","canvas","previewSupport"];var ns=-6,is=4,rs=20,xa="djs-resizer",sA=["n","w","s","e","nw","ne","se","sw"];function Ii(e,t,n,i){this._resize=i,this._canvas=t;var a=this;e.on("selection.changed",function(r){var o=r.newSelection;a.removeResizers(),o.length===1&&B(o,Pt(a.addResizer,a))}),e.on("shape.changed",function(r){var o=r.element;n.isSelected(o)&&(a.removeResizers(),a.addResizer(o))})}Ii.prototype.makeDraggable=function(e,t,n){var i=this._resize;function a(r){Ai(r)&&i.activate(r,e,n)}pe.bind(t,"mousedown",a),pe.bind(t,"touchstart",a)};Ii.prototype._createResizer=function(e,t,n,i){var a=this._getResizersParent(),r=lA(i),o=le("g");Se(o).add(xa),Se(o).add(xa+"-"+e.id),Se(o).add(xa+"-"+i),fe(a,o);var s=le("rect");ee(s,{x:-is/2+r.x,y:-is/2+r.y,width:is,height:is}),Se(s).add(xa+"-visual"),fe(o,s);var u=le("rect");return ee(u,{x:-rs/2+r.x,y:-rs/2+r.y,width:rs,height:rs}),Se(u).add(xa+"-hit"),fe(o,u),xc(o,t,n),o};Ii.prototype.createResizer=function(e,t){var n=$y(e,t),i=this._createResizer(e,n.x,n.y,t);this.makeDraggable(e,i,t)};Ii.prototype.addResizer=function(e){var t=this,n=this._resize;n.canResize({shape:e})&&B(sA,function(i){t.createResizer(e,i)})};Ii.prototype.removeResizers=function(){var e=this._getResizersParent();ip(e)};Ii.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")};Ii.$inject=["eventBus","canvas","selection","resize"];function lA(e){var t={x:0,y:0};return e.indexOf("e")!==-1?t.x=-ns:e.indexOf("w")!==-1&&(t.x=ns),e.indexOf("s")!==-1?t.y=-ns:e.indexOf("n")!==-1&&(t.y=ns),t}const Fy={__depends__:[Hn,oi,ao],__init__:["resize","resizePreview","resizeHandles"],resize:["type",co],resizePreview:["type",Vy],resizeHandles:["type",Ii]};function Dc(e,t){var n=t.create("bpmn:CategoryValue"),i=t.create("bpmn:Category",{categoryValue:[n]});return Qe(e.get("rootElements"),i),oe(i).$parent=e,oe(n).$parent=i,n}function po(e,t,n,i,a,r,o){this._bpmnFactory=t,this._canvas=n,this._modeling=a,this._textRenderer=o,i.registerProvider(this),e.on("element.dblclick",function(u){s(u.element,!0)}),e.on(["autoPlace.start","canvas.viewbox.changing","drag.init","element.mousedown","popupMenu.open"],function(u){i.isActive()&&i.complete()}),e.on(["commandStack.changed"],function(u){i.isActive()&&i.cancel()}),e.on("directEditing.activate",function(u){r.removeResizers()}),e.on("create.end",500,function(u){var c=u.context,p=c.shape,f=u.context.canExecute,m=u.isTouch;m||f&&(c.hints&&c.hints.createElementsBehavior===!1||s(p))}),e.on("autoPlace.end",500,function(u){s(u.shape)});function s(u,c){(c||Pe(u,["bpmn:Task","bpmn:TextAnnotation"])||Op(u))&&i.activate(u)}}po.$inject=["eventBus","bpmnFactory","canvas","directEditing","modeling","resizeHandles","textRenderer"];po.prototype.activate=function(e){var t=Sn(e);if(t!==void 0){var n={text:t},i=this.getEditingBBox(e);G(n,i);var a={};return(Pe(e,["bpmn:Task","bpmn:Participant","bpmn:Lane","bpmn:CallActivity"])||Op(e))&&G(a,{centerVertically:!0}),Dr(e)&&G(a,{autoResize:!0}),w(e,"bpmn:TextAnnotation")&&G(a,{resizable:!0,autoResize:!0}),G(n,{options:a}),n}};po.prototype.getEditingBBox=function(e){var t=this._canvas,n=e.label||e,i=t.getAbsoluteBBox(n),a={x:i.x+i.width/2,y:i.y+i.height/2},r={x:i.x,y:i.y},o=t.zoom(),s=this._textRenderer.getDefaultStyle(),u=this._textRenderer.getExternalStyle(),c=u.fontSize*o,p=u.lineHeight,f=s.fontSize*o,m=s.lineHeight,v={fontFamily:this._textRenderer.getDefaultStyle().fontFamily,fontWeight:this._textRenderer.getDefaultStyle().fontWeight};(w(e,"bpmn:Lane")||pA(e))&&(G(r,{width:i.height,height:30*o,x:i.x-i.height/2+15*o,y:a.y-30*o/2}),G(v,{fontSize:f+"px",lineHeight:m,paddingTop:7*o+"px",paddingBottom:7*o+"px",paddingLeft:5*o+"px",paddingRight:5*o+"px",transform:"rotate(-90deg)"})),(Pe(e,["bpmn:Task","bpmn:CallActivity"])||cA(e)||Op(e))&&(G(r,{width:i.width,height:i.height}),G(v,{fontSize:f+"px",lineHeight:m,paddingTop:7*o+"px",paddingBottom:7*o+"px",paddingLeft:5*o+"px",paddingRight:5*o+"px"})),uA(e)&&(G(r,{width:i.width,x:i.x}),G(v,{fontSize:f+"px",lineHeight:m,paddingTop:7*o+"px",paddingBottom:7*o+"px",paddingLeft:5*o+"px",paddingRight:5*o+"px"}));var g=90*o,b=7*o,_=4*o;if(n.labelTarget&&(G(r,{width:g,height:i.height+b+_,x:a.x-g/2,y:i.y-b}),G(v,{fontSize:c+"px",lineHeight:p,paddingTop:b+"px",paddingBottom:_+"px"})),Dr(n)&&!yl(n)&&!_t(n)){var k=El(e),N=t.getAbsoluteBBox({x:k.x,y:k.y,width:0,height:0}),A=c+b+_;G(r,{width:g,height:A,x:N.x-g/2,y:N.y-A/2}),G(v,{fontSize:c+"px",lineHeight:p,paddingTop:b+"px",paddingBottom:_+"px"})}return w(e,"bpmn:TextAnnotation")&&(G(r,{width:i.width,height:i.height,minWidth:30*o,minHeight:10*o}),G(v,{textAlign:"left",paddingTop:5*o+"px",paddingBottom:7*o+"px",paddingLeft:7*o+"px",paddingRight:5*o+"px",fontSize:f+"px",lineHeight:m})),{bounds:r,style:v}};po.prototype.update=function(e,t,n,i){var a,r;if(w(e,"bpmn:TextAnnotation")&&(r=this._canvas.getAbsoluteBBox(e),a={x:e.x,y:e.y,width:e.width/r.width*i.width,height:e.height/r.height*i.height}),w(e,"bpmn:Group")){var o=oe(e);if(!o.categoryValueRef){var s=this._canvas.getRootElement(),u=oe(s).$parent,c=Dc(u,this._bpmnFactory);oe(e).categoryValueRef=c}}fA(t)&&(t=null),this._modeling.updateLabel(e,t,a)};function Op(e){return w(e,"bpmn:SubProcess")&&!Le(e)}function uA(e){return w(e,"bpmn:SubProcess")&&Le(e)}function cA(e){return w(e,"bpmn:Participant")&&!Le(e)}function pA(e){return w(e,"bpmn:Participant")&&Le(e)}function fA(e){return!e||!e.trim()}var Kh="djs-element-hidden",Xh="djs-label-hidden";function jy(e,t,n,i){var a=this,r=t.getDefaultLayer(),o,s,u;e.on("directEditing.activate",function(c){var p=c.active;if(o=p.element.label||p.element,w(o,"bpmn:TextAnnotation")){s=t.getAbsoluteBBox(o),u=le("g");var f=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:o.width,containerHeight:o.height,position:{mx:0,my:0}}),m=a.path=le("path");ee(m,{d:f,strokeWidth:2,stroke:dA(o)}),fe(u,m),fe(r,u),Ft(u,o.x,o.y)}w(o,"bpmn:TextAnnotation")||o.labelTarget?t.addMarker(o,Kh):(w(o,"bpmn:Task")||w(o,"bpmn:CallActivity")||w(o,"bpmn:SubProcess")||w(o,"bpmn:Participant"))&&t.addMarker(o,Xh)}),e.on("directEditing.resize",function(c){if(w(o,"bpmn:TextAnnotation")){var p=c.height,f=c.dy,m=Math.max(o.height/s.height*(p+f),0),v=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:o.width,containerHeight:m,position:{mx:0,my:0}});ee(a.path,{d:v})}}),e.on(["directEditing.complete","directEditing.cancel"],function(c){var p=c.active;p&&(t.removeMarker(p.element.label||p.element,Kh),t.removeMarker(o,Xh)),o=void 0,s=void 0,u&&(tt(u),u=void 0)})}jy.$inject=["eventBus","canvas","elementRegistry","pathMap"];function dA(e,t){var n=oe(e);return n.di.get("stroke")||t||"black"}const hA={__depends__:[By,Fy,yy],__init__:["labelEditingProvider","labelEditingPreview"],labelEditingProvider:["type",po],labelEditingPreview:["type",jy]};var Lp=["top","bottom","left","right"],as=10;function Bp(e,t){ie.call(this,e),this.postExecuted(["connection.create","connection.layout","connection.updateWaypoints"],function(a){var r=a.context,o=r.connection,s=o.source,u=o.target,c=r.hints||{};c.createElementsBehavior!==!1&&(n(s),n(u))}),this.postExecuted(["label.create"],function(a){var r=a.context,o=r.shape,s=r.hints||{};s.createElementsBehavior!==!1&&n(o.labelTarget)}),this.postExecuted(["elements.create"],function(a){var r=a.context,o=r.elements,s=r.hints||{};s.createElementsBehavior!==!1&&o.forEach(function(u){n(u)})});function n(a){if(yl(a)){var r=gA(a);r&&i(a,r)}}function i(a,r){var o=Ee(a),s=a.label,u=Ee(s);if(s.parent){var c=ce(a),p;switch(r){case"top":p={x:o.x,y:c.top-as-s.height/2};break;case"left":p={x:c.left-as-s.width/2,y:o.y};break;case"bottom":p={x:o.x,y:c.bottom+as+s.height/2};break;case"right":p={x:c.right+as+s.width/2,y:o.y};break}var f=On(p,u);t.moveShape(s,f)}}}se(Bp,ie);Bp.$inject=["eventBus","modeling"];function mA(e){var t=e.host,n=Ee(e),i=St(n,t),a;i.indexOf("-")>=0?a=i.split("-"):a=[i];var r=Lp.filter(function(o){return a.indexOf(o)===-1});return r}function vA(e){var t=Ee(e),n=[].concat(e.incoming.map(function(i){return i.waypoints[i.waypoints.length-2]}),e.outgoing.map(function(i){return i.waypoints[1]})).map(function(i){return Hy(t,i)});return n}function gA(e){var t=Ee(e.label),n=Ee(e),i=Hy(n,t);if(yA(i)){var a=vA(e);if(e.host){var r=mA(e);a=a.concat(r)}var o=Lp.filter(function(s){return a.indexOf(s)===-1});if(o.indexOf(i)===-1)return o[0]}}function Hy(e,t){return St(t,e,5)}function yA(e){return Lp.indexOf(e)!==-1}function $p(e,t,n){ie.call(this,e),this.preExecute("shape.append",function(i){var a=i.source,r=i.shape;i.position||(w(r,"bpmn:TextAnnotation")?i.position={x:a.x+a.width/2+75,y:a.y-50-r.height/2}:i.position={x:a.x+a.width+80+r.width/2,y:a.y+a.height/2})},!0)}se($p,ie);$p.$inject=["eventBus","elementFactory","bpmnRules"];function Vp(e,t){e.invoke(ie,this),this.postExecute("shape.move",function(n){var i=n.newParent,a=n.shape,r=ge(a.incoming.concat(a.outgoing),function(o){return w(o,"bpmn:Association")});B(r,function(o){t.moveConnection(o,{x:0,y:0},i)})},!0)}se(Vp,ie);Vp.$inject=["injector","modeling"];var Zh=500;function Ml(e,t){t.invoke(ie,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",Zh,function(i){var a=i.elements;a=a.filter(function(r){var o=r.host;return Jh(r,o)}),a.length===1&&a.map(function(r){return a.indexOf(r)}).forEach(function(r){var o=a[r];i.elements[r]=n.replaceShape(a[r],o)})},!0),this.preExecute("elements.move",Zh,function(i){var a=i.shapes,r=i.newHost;if(a.length===1){var o=a[0];Jh(o,r)&&(i.shapes=[n.replaceShape(o,r)])}},!0)}Ml.$inject=["bpmnReplace","injector"];se(Ml,ie);Ml.prototype.replaceShape=function(e,t){var n=EA(e),i={type:"bpmn:BoundaryEvent",host:t};return n&&(i.eventDefinitionType=n.$type),this._bpmnReplace.replaceElement(e,i,{layoutConnection:!1})};function EA(e){var t=oe(e),n=t.eventDefinitions;return n&&n[0]}function Jh(e,t){return!_t(e)&&Pe(e,["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&!!t}var bA=2e3;function Fp(e,t,n){ie.call(this,e);function i(a){return ge(a.attachers,function(r){return w(r,"bpmn:BoundaryEvent")})}this.postExecute("connection.create",function(a){var r=a.context.source,o=a.context.target,s=i(o);w(r,"bpmn:EventBasedGateway")&&w(o,"bpmn:ReceiveTask")&&s.length>0&&n.removeElements(s)}),this.postExecute("connection.reconnect",function(a){var r=a.context.oldSource,o=a.context.newSource;w(r,"bpmn:Gateway")&&w(o,"bpmn:EventBasedGateway")&&B(o.outgoing,function(s){var u=s.target,c=i(u);w(u,"bpmn:ReceiveTask")&&c.length>0&&n.removeElements(c)})}),e.on("moddleCopy.canCopyProperty",bA,function(a){var r=a.parent,o=a.property,s=a.propertyName,u=t.getPropertyDescriptor(r,s);u&&u.isReference&&w(o,"bpmn:RootElement")&&r.set(s,o)})}Fp.$inject=["eventBus","moddle","modeling"];se(Fp,ie);var _A=500;function jp(e,t,n,i,a){n.invoke(ie,this);function r(p){return Pe(p,["bpmn:ReceiveTask","bpmn:SendTask"])||xA(p,["bpmn:ErrorEventDefinition","bpmn:EscalationEventDefinition","bpmn:MessageEventDefinition","bpmn:SignalEventDefinition"])}function o(p){var f=e.getDefinitions(),m=f.get("rootElements");return!!Me(m,ln({id:p.id}))}function s(p){if(w(p,"bpmn:ErrorEventDefinition"))return"errorRef";if(w(p,"bpmn:EscalationEventDefinition"))return"escalationRef";if(w(p,"bpmn:MessageEventDefinition"))return"messageRef";if(w(p,"bpmn:SignalEventDefinition"))return"signalRef"}function u(p){if(Pe(p,["bpmn:ReceiveTask","bpmn:SendTask"]))return p.get("messageRef");var f=p.get("eventDefinitions"),m=f[0];return m.get(s(m))}function c(p,f){if(Pe(p,["bpmn:ReceiveTask","bpmn:SendTask"]))return p.set("messageRef",f);var m=p.get("eventDefinitions"),v=m[0];return v.set(s(v),f)}this.executed("shape.create",function(p){var f=p.shape;if(r(f)){var m=oe(f),v=u(m),g;v&&!o(v)&&(g=e.getDefinitions().get("rootElements"),Qe(g,v),p.addedRootElement=v)}},!0),this.reverted("shape.create",function(p){var f=p.addedRootElement;if(f){var m=e.getDefinitions().get("rootElements");Je(m,f)}},!0),t.on("copyPaste.copyElement",function(p){var f=p.descriptor,m=p.element;if(r(m)){var v=oe(m),g=u(v);g&&(f.referencedRootElement=g)}}),t.on("copyPaste.pasteElement",_A,function(p){var f=p.descriptor,m=f.businessObject;if(r(m)){var v=f.referencedRootElement;v&&(o(v)||(v=i.copyElement(v,a.create(v.$type))),c(m,v))}})}jp.$inject=["bpmnjs","eventBus","injector","moddleCopy","bpmnFactory"];se(jp,ie);function xA(e,t){return xe(t)||(t=[t]),wi(t,function(n){return ml(e,n)})}function Hp(e){e.invoke(ie,this),this.preExecute("shape.create",1500,function(t){var n=t.context,i=n.parent,a=n.shape;w(i,"bpmn:Lane")&&!w(a,"bpmn:Lane")&&(n.parent=Us(i,"bpmn:Participant"))})}Hp.$inject=["injector"];se(Hp,ie);var os=1500,SA=2e3;function zy(e,t,n){t.on(["create.hover","create.move","create.out","create.end","shape.move.hover","shape.move.move","shape.move.out","shape.move.end"],os,function(i){var a=i.context,r=a.shape||i.shape,o=i.hover;w(o,"bpmn:Lane")&&!Pe(r,["bpmn:Lane","bpmn:Participant"])&&(i.hover=bn(o),i.hoverGfx=e.getGraphics(i.hover));var s=n.getRootElement();o!==s&&(r.labelTarget||w(r,"bpmn:Group"))&&(i.hover=s,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["connect.hover","connect.out","connect.end","connect.cleanup","global-connect.hover","global-connect.out","global-connect.end","global-connect.cleanup"],os,function(i){var a=i.hover;w(a,"bpmn:Lane")&&(i.hover=bn(a)||a,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["bendpoint.move.hover"],os,function(i){var a=i.context,r=i.hover,o=a.type;w(r,"bpmn:Lane")&&/reconnect/.test(o)&&(i.hover=bn(r)||r,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["connect.start"],os,function(i){var a=i.context,r=a.start;w(r,"bpmn:Lane")&&(a.start=bn(r)||r)}),t.on("shape.move.start",SA,function(i){var a=i.shape;w(a,"bpmn:Lane")&&(i.shape=bn(a)||a)})}zy.$inject=["elementRegistry","eventBus","canvas"];function zp(e,t,n){ie.call(this,e),this.preExecute("shape.create",function(i){var a=i.context,r=a.shape;if(w(r,"bpmn:DataObjectReference")&&r.type!=="label"){var o=t.create("bpmn:DataObject");r.businessObject.dataObjectRef=o}})}zp.$inject=["eventBus","bpmnFactory","moddle"];se(zp,ie);var Oc=20,Lc=20,Gy=30,ss=2e3;function Gp(e,t,n){ie.call(this,t),t.on(["create.start","shape.move.start"],ss,function(a){var r=a.context,o=r.shape,s=e.getRootElement();if(!(!w(o,"bpmn:Participant")||!w(s,"bpmn:Process")||!s.children.length)){var u=s.children.filter(function(f){return!w(f,"bpmn:Group")&&!_t(f)&&!CA(f)});if(u.length){var c=xt(u),p=wA(o,c);G(o,p),r.createConstraints=TA(o,c)}}}),t.on("create.start",ss,function(a){var r=a.context,o=r.shape,s=e.getRootElement(),u=e.getGraphics(s);function c(p){p.element=s,p.gfx=u}w(o,"bpmn:Participant")&&w(s,"bpmn:Process")&&(t.on("element.hover",ss,c),t.once("create.cleanup",function(){t.off("element.hover",c)}))});function i(a){var r=a.parent,o,s=e.getRootElement();w(s,"bpmn:Collaboration")?o=s:(o=n.makeCollaboration(),a.process=r),a.parent=o}this.preExecute("shape.create",function(a){var r=a.parent,o=a.shape;w(o,"bpmn:Participant")&&w(r,"bpmn:Process")&&i(a)},!0),this.execute("shape.create",function(a){var r=a.process,o=a.shape;r&&(a.oldProcessRef=o.businessObject.processRef,o.businessObject.processRef=r.businessObject)},!0),this.revert("shape.create",function(a){var r=a.process,o=a.shape;r&&(o.businessObject.processRef=a.oldProcessRef)},!0),this.postExecute("shape.create",function(a){var r=a.process,o=a.shape;if(r){var s=r.children.slice();n.moveElements(s,{x:0,y:0},o)}},!0),this.preExecute("elements.create",ss,function(a){var r=a.elements,o=a.parent,s,u=ls(r);u&&w(o,"bpmn:Process")&&(i(a),s=ls(r),a.oldProcessRef=s.businessObject.processRef,s.businessObject.processRef=o.businessObject)},!0),this.revert("elements.create",function(a){var r=a.elements,o=a.process,s;o&&(s=ls(r),s.businessObject.processRef=a.oldProcessRef)},!0),this.postExecute("elements.create",function(a){var r=a.elements,o=a.process,s;if(o){s=ls(r);var u=o.children.slice();n.moveElements(u,{x:0,y:0},s)}},!0)}Gp.$inject=["canvas","eventBus","modeling"];se(Gp,ie);function wA(e,t){t={width:t.width+Oc*2+Gy,height:t.height+Lc*2};var n=Math.max(e.width,t.width),i=Math.max(e.height,t.height);return{x:-n/2,y:-i/2,width:n,height:i}}function TA(e,t){return t=ce(t),{bottom:t.top+e.height/2-Lc,left:t.right-e.width/2+Oc,top:t.bottom-e.height/2+Lc,right:t.left+e.width/2-Oc-Gy}}function CA(e){return!!e.waypoints}function ls(e){return Me(e,function(t){return w(t,"bpmn:Participant")})}var Qh="__targetRef_placeholder";function Up(e,t){ie.call(this,e),this.executed(["connection.create","connection.delete","connection.move","connection.reconnect"],em(r)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnect"],em(r));function n(o,s,u){var c=o.get("dataInputAssociations");return Me(c,function(p){return p!==u&&p.targetRef===s})}function i(o,s){var u=o.get("properties"),c=Me(u,function(p){return p.name===Qh});return!c&&s&&(c=t.create("bpmn:Property",{name:Qh}),Qe(u,c)),c}function a(o,s){var u=i(o);u&&(n(o,u,s)||Je(o.get("properties"),u))}function r(o){var s=o.context,u=s.connection,c=u.businessObject,p=u.target,f=p&&p.businessObject,m=s.newTarget,v=m&&m.businessObject,g=s.oldTarget||s.target,b=g&&g.businessObject,_=u.businessObject,k;b&&b!==f&&a(b,c),v&&v!==f&&a(v,c),f?(k=i(f,!0),_.targetRef=k):_.targetRef=null}}Up.$inject=["eventBus","bpmnFactory"];se(Up,ie);function em(e){return function(t){var n=t.context,i=n.connection;if(w(i,"bpmn:DataInputAssociation"))return e(t)}}function kl(e){this._bpmnUpdater=e}kl.$inject=["bpmnUpdater"];kl.prototype.execute=function(e){var t=e.dataStoreBo,n=e.newSemanticParent,i=e.newDiParent;e.oldSemanticParent=t.$parent,e.oldDiParent=t.di.$parent,this._bpmnUpdater.updateSemanticParent(t,n),this._bpmnUpdater.updateDiParent(t.di,i)};kl.prototype.revert=function(e){var t=e.dataStoreBo,n=e.oldSemanticParent,i=e.oldDiParent;this._bpmnUpdater.updateSemanticParent(t,n),this._bpmnUpdater.updateDiParent(t.di,i)};function Wp(e,t,n,i){ie.call(this,i),t.registerHandler("dataStore.updateContainment",kl);function a(){return n.filter(function(s){return w(s,"bpmn:Participant")&&oe(s).processRef})[0]}function r(s){return s.children.filter(function(u){return w(u,"bpmn:DataStoreReference")&&!u.labelTarget})}function o(s,u){var c=s.businessObject||s;if(u=u||a(),u){var p=u.businessObject||u;t.execute("dataStore.updateContainment",{dataStoreBo:c,newSemanticParent:p.processRef||p,newDiParent:p.di})}}this.preExecute("shape.create",function(s){var u=s.context,c=u.shape;w(c,"bpmn:DataStoreReference")&&c.type!=="label"&&(u.hints||(u.hints={}),u.hints.autoResize=!1)}),this.preExecute("elements.move",function(s){var u=s.context,c=u.shapes,p=c.filter(function(f){return w(f,"bpmn:DataStoreReference")});p.length&&(u.hints||(u.hints={}),u.hints.autoResize=c.filter(function(f){return!w(f,"bpmn:DataStoreReference")}))}),this.postExecute("shape.create",function(s){var u=s.context,c=u.shape,p=c.parent;w(c,"bpmn:DataStoreReference")&&c.type!=="label"&&w(p,"bpmn:Collaboration")&&o(c)}),this.postExecute("shape.move",function(s){var u=s.context,c=u.shape,p=u.oldParent,f=c.parent;if(!w(p,"bpmn:Collaboration")&&w(c,"bpmn:DataStoreReference")&&c.type!=="label"&&w(f,"bpmn:Collaboration")){var m=w(p,"bpmn:Participant")?p:PA(p,"bpmn:Participant");o(c,m)}}),this.postExecute("shape.delete",function(s){var u=s.context,c=u.shape,p=e.getRootElement();Pe(c,["bpmn:Participant","bpmn:SubProcess"])&&w(p,"bpmn:Collaboration")&&r(p).filter(function(f){return AA(f,c)}).forEach(function(f){o(f)})}),this.postExecute("canvas.updateRoot",function(s){var u=s.context,c=u.oldRoot,p=u.newRoot,f=r(c);f.forEach(function(m){w(p,"bpmn:Process")&&o(m,p)})})}Wp.$inject=["canvas","commandStack","elementRegistry","eventBus"];se(Wp,ie);function AA(e,t){for(var n=e.businessObject||e,i=t.businessObject||t;n.$parent;){if(n.$parent===i.processRef||i)return!0;n=n.$parent}return!1}function PA(e,t){for(;e.parent;){if(w(e.parent,t))return e.parent;e=e.parent}}var RA=500;function qp(e,t,n){ie.call(this,e);function i(a,r){var o=ar(r),s=[],u=[];if(nr(o,function(m){return m.y>a.y?u.push(m):s.push(m),m.children}),!!o.length){var c;u.length&&s.length?c=a.height/2:c=a.height;var p,f;s.length&&(p=n.calculateAdjustments(s,"y",c,a.y-10),n.makeSpace(p.movingShapes,p.resizingShapes,{x:0,y:c},"s")),u.length&&(f=n.calculateAdjustments(u,"y",-c,a.y+a.height+10),n.makeSpace(f.movingShapes,f.resizingShapes,{x:0,y:-c},"n"))}}this.postExecuted("shape.delete",RA,function(a){var r=a.context,o=r.hints,s=r.shape,u=r.oldParent;w(s,"bpmn:Lane")&&(o&&o.nested||i(s,u))})}qp.$inject=["eventBus","modeling","spaceTool"];se(qp,ie);var tm=500;function Dl(e,t){t.invoke(ie,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",tm,function(i){var a=i.elements;a.filter(function(r){var o=r.host;return nm(r,o)}).map(function(r){return a.indexOf(r)}).forEach(function(r){i.elements[r]=n.replaceShape(a[r])})},!0),this.preExecute("elements.move",tm,function(i){var a=i.shapes,r=i.newHost;a.forEach(function(o,s){var u=o.host;nm(o,NA(a,u)?u:r)&&(a[s]=n.replaceShape(o))})},!0)}Dl.$inject=["bpmnReplace","injector"];se(Dl,ie);Dl.prototype.replaceShape=function(e){var t=IA(e),n;return t?n={type:"bpmn:IntermediateCatchEvent",eventDefinitionType:t.$type}:n={type:"bpmn:IntermediateThrowEvent"},this._bpmnReplace.replaceElement(e,n,{layoutConnection:!1})};function IA(e){var t=oe(e),n=t.eventDefinitions;return n&&n[0]}function nm(e,t){return!_t(e)&&w(e,"bpmn:BoundaryEvent")&&!t}function NA(e,t){return e.indexOf(t)!==-1}function Yp(e,t,n){ie.call(this,e);function i(a,r,o){var s=r.waypoints,u,c,p,f,m,v,g,b=a.outgoing.slice(),_=a.incoming.slice(),k;ve(o.width)?k=Ee(o):k=o;var N=Ac(s,k);if(N){if(u=s.slice(0,N.index),c=s.slice(N.index+(N.bendpoint?1:0)),!u.length||!c.length)return;p=N.bendpoint?s[N.index]:k,(u.length===1||!im(a,u[u.length-1]))&&u.push(rm(p)),(c.length===1||!im(a,c[0]))&&c.unshift(rm(p))}f=r.source,m=r.target,t.canConnect(f,a,r)&&(n.reconnectEnd(r,a,u||k),v=r),t.canConnect(a,m,r)&&(v?g=n.connect(a,m,{type:r.type,waypoints:c}):(n.reconnectStart(r,a,c||k),g=r));var A=[].concat(v&&ge(_,function(S){return S.source===v.source})||[],g&&ge(b,function(S){return S.target===g.target})||[]);A.length&&n.removeElements(A)}this.preExecute("elements.move",function(a){var r=a.newParent,o=a.shapes,s=a.delta,u=o[0];if(!(!u||!r)){r&&r.waypoints&&(a.newParent=r=r.parent);var c=Ee(u),p={x:c.x+s.x,y:c.y+s.y},f=Me(r.children,function(m){var v=t.canInsert(o,m);return v&&Ac(m.waypoints,p)});f&&(a.targetFlow=f,a.position=p)}},!0),this.postExecuted("elements.move",function(a){var r=a.shapes,o=a.targetFlow,s=a.position;o&&i(r[0],o,s)},!0),this.preExecute("shape.create",function(a){var r=a.parent,o=a.shape;t.canInsert(o,r)&&(a.targetFlow=r,a.parent=r.parent)},!0),this.postExecuted("shape.create",function(a){var r=a.shape,o=a.targetFlow,s=a.position;o&&i(r,o,s)},!0)}se(Yp,ie);Yp.$inject=["eventBus","bpmnRules","modeling"];function im(e,t){var n=t.x,i=t.y;return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function rm(e){return G({},e)}function Kp(e,t){ie.call(this,e),this.preExecuted("connection.create",function(n){var i=n.context,a=i.source,r=i.target,o=r.incoming.slice();i.hints&&i.hints.createElementsBehavior===!1||w(a,"bpmn:EventBasedGateway")&&r.incoming.length&&o.filter(Vu).forEach(function(s){t.removeConnection(s)})}),this.preExecuted("shape.replace",function(n){var i=n.context.newShape,a,r;w(i,"bpmn:EventBasedGateway")&&(a=i.outgoing.filter(Vu).map(function(o){return o.target}),r=a.reduce(function(o,s){var u=s.incoming.filter(Vu);return o.concat(u)},[]),r.forEach(function(o){o.source!==i&&t.removeConnection(o)}))})}Kp.$inject=["eventBus","modeling"];se(Kp,ie);function Vu(e){return w(e,"bpmn:SequenceFlow")}var MA=2e3;function Xp(e,t,n,i,a,r){a.invoke(ie,this);function o(){var f=t.getRootElement(),m=oe(f);return m.$parent}function s(f){var m=oe(f),v=m.categoryValueRef;if(v){var g=v.$parent;v&&(Je(g.categoryValue,v),g&&!g.categoryValue.length&&u(g))}}function u(f){var m=o();Je(m.get("rootElements"),f)}function c(){return n.filter(function(f){return w(f,"bpmn:Group")})}function p(f,m){return f.some(function(v){var g=oe(v);return g.categoryValueRef&&g.categoryValueRef===m})}this.executed("shape.delete",function(f){var m=f.context,v=m.shape;if(w(v,"bpmn:Group")){var g=oe(v),b=g.categoryValueRef,_=c();p(_,b)||s(v)}}),this.reverted("shape.delete",function(f){var m=f.context,v=m.shape;if(w(v,"bpmn:Group")){var g=oe(v),b=g.categoryValueRef,_=o(),k=b?b.$parent:null;Qe(k.get("categoryValue"),b),Qe(_.get("rootElements"),k)}}),this.execute("shape.create",function(f){var m=f.context,v=m.shape,g=oe(v);if(w(g,"bpmn:Group")&&!g.categoryValueRef){var b=o(),_=Dc(b,e);g.categoryValueRef=_}}),this.revert("shape.create",function(f){var m=f.context,v=m.shape;w(v,"bpmn:Group")&&(s(v),delete oe(v).categoryValueRef)}),i.on("moddleCopy.canCopyProperty",MA,function(f){var m=f.property,v;if(w(m,"bpmn:CategoryValue"))return v=Dc(o(),e),r.copyElement(m,v)})}Xp.$inject=["bpmnFactory","canvas","elementRegistry","eventBus","injector","moddleCopy"];se(Xp,ie);function Bc(e,t,n,i){var a,r,o,s,u;return a=(i.y-n.y)*(t.x-e.x)-(i.x-n.x)*(t.y-e.y),a==0?null:(r=e.y-n.y,o=e.x-n.x,u=(i.x-n.x)*r-(i.y-n.y)*o,s=u/a,{x:Math.round(e.x+s*(t.x-e.x)),y:Math.round(e.y+s*(t.y-e.y))})}function Uy(e){function t(i,a,r){var o={x:r.x,y:r.y-50},s={x:r.x-50,y:r.y},u=Bc(i,a,r,o),c=Bc(i,a,r,s),p;u&&c?am(u,r)>am(c,r)?p=c:p=u:p=u||c,i.original=p}function n(i){var a=i.waypoints;t(a[0],a[1],Ee(i.source)),t(a[a.length-1],a[a.length-2],Ee(i.target))}e.on("bpmnElement.added",function(i){var a=i.element;a.waypoints&&n(a)})}Uy.$inject=["eventBus"];function am(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Zp(e){ie.call(this,e);var t=["bpmn:Participant","bpmn:Lane"];this.executed(["shape.move","shape.create","shape.resize"],function(n){var i=oe(n.context.shape);Pe(i,t)&&!i.di.get("isHorizontal")&&i.di.set("isHorizontal",!0)})}Zp.$inject=["eventBus"];se(Zp,ie);function Wy(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function om(e){return Math.atan((e[1].y-e[0].y)/(e[1].x-e[0].x))}function kA(e,t){return t?{x:Math.cos(t)*e.x-Math.sin(t)*e.y,y:Math.sin(t)*e.x+Math.cos(t)*e.y}:e}function DA(e,t,n){var i=[{n:e[0]-n[0],lambda:t[0]},{n:e[1]-n[1],lambda:t[1]}],a=i[0].n*t[0]+i[1].n*t[1],r=i[0].lambda*t[0]+i[1].lambda*t[1];return-a/r}function qy(e,t){var n=t[0],i=t[1],a={x:i.x-n.x,y:i.y-n.y},r=DA([n.x,n.y],[a.x,a.y],[e.x,e.y]);return{x:n.x+r*a.x,y:n.y+r*a.y}}function OA(e,t){var n=qy(e,t),i={x:n.x-e.x,y:n.y-e.y};return Wy(i)}function Ks(e,t){return Wy({x:e.x-t.x,y:e.y-t.y})}var Yy=Math.sqrt,Ky=Math.min,LA=Math.max,sm=Math.abs;function lm(e){return Math.pow(e,2)}function Sa(e,t){return Yy(lm(e.x-t.x)+lm(e.y-t.y))}function BA(e,t){var n=0,i,a,r,o,s,u,c,p,f,m,v;for(n=0;n<t.length-1;n++){if(i=t[n],a=t[n+1],cm(i,a)?c=[i]:(r=Sa(e,i),o=Sa(e,a),u=Ky(r,o),c=$A(i,a,e,u)),c.length<1)throw new Error("expected between [1, 2] circle -> line intersections");c.length===1&&(p={type:"bendpoint",position:c[0],segmentIndex:n,bendpointIndex:cm(i,c[0])?n:n+1}),c.length===2&&(s=FA(c[0],c[1]),p={type:"segment",position:s,segmentIndex:n,relativeLocation:Sa(i,s)/Sa(i,a)}),f=Sa(p.position,e),(!v||m>f)&&(v=p,m=f)}return v}function $A(e,t,n,i){var a=t.x-e.x,r=t.y-e.y,o=n.x-e.x,s=n.y-e.y,u=a*a+r*r,c=a*o+r*s,p=o*o+s*s-i*i,f=c/u,m=p/u,v=f*f-m;if(v<0&&v>-1e-6&&(v=0),v<0)return[];var g=Yy(v),b=-f+g,_=-f-g,k={x:e.x-a*b,y:e.y-r*b};if(v===0)return[k];var N={x:e.x-a*_,y:e.y-r*_};return[k,N].filter(function(A){return VA(A,e,t)})}function VA(e,t,n){return um(e.x,t.x,n.x)&&um(e.y,t.y,n.y)}function um(e,t,n){return e>=Ky(t,n)-Xs&&e<=LA(t,n)+Xs}function FA(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}var Xs=.1;function cm(e,t){return sm(e.x-t.x)<=Xs&&sm(e.y-t.y)<=Xs}function jA(e,t,n,i){var a=n.segmentIndex,r=t.length-e.length;if(i.segmentMove){var o=i.segmentMove.segmentStartIndex,s=i.segmentMove.newSegmentStartIndex;return a===o?s:a>=s?a+r<s?s:a+r:a}if(i.bendpointMove){var u=i.bendpointMove.insert,c=i.bendpointMove.bendpointIndex,p;if(r===0)return a;if(a>=c&&(p=u?a+1:a-1),a<c&&(p=a,u&&n.type!=="bendpoint"&&c-1===a)){var f=Xy(t,c);f<n.relativeLocation&&p++}return p}return r===0?a:i.connectionStart?a===0?0:null:i.connectionEnd&&a===e.length-2?t.length-2:null}function HA(e,t,n,i){var a=0,r=0,o=zA(e),s=BA(o,n),u=s.segmentIndex,c=jA(n,t,s,i);if(c===null)return{x:a,y:r};if(c<0||c>t.length-2)return{x:a,y:r};var p=pm(n,u),f=pm(t,c),m=s.position,v=UA(p,m),g=GA(p,f);if(s.type==="bendpoint"){var b=t.length-n.length,_=s.bendpointIndex,k=n[_];if(t.indexOf(k)!==-1)return{x:a,y:r};if(b===0){var N=t[_];return{x:N.x-s.position.x,y:N.y-s.position.y}}b<0&&_!==0&&_<n.length-1&&(v=Xy(n,_))}var A={x:(f[1].x-f[0].x)*v+f[0].x,y:(f[1].y-f[0].y)*v+f[0].y},S=kA({x:o.x-m.x,y:o.y-m.y},g);return a=A.x+S.x-o.x,r=A.y+S.y-o.y,gi({x:a,y:r})}function Xy(e,t){var n=Ks(e[t-1],e[t]),i=Ks(e[t],e[t+1]),a=n/(n+i);return a}function zA(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function GA(e,t){var n=om(e),i=om(t);return i-n}function pm(e,t){return[e[t],e[t+1]]}function UA(e,t){var n=Ks(e[0],e[1]),i=Ks(e[0],t);return n===0?0:i/n}function fo(e,t,n){var i=Ma(t),a=Ma(n),r=On(e,i),o={x:r.x*(n.width/t.width),y:r.y*(n.height/t.height)};return gi({x:a.x+o.x,y:a.y+o.y})}function fm(e,t,n){var i=Ma(e),a=Ma(t),r=Ma(n),o=On(e,i),s=On(i,a),u=WA(i,t,n);if(u)return u;var c={x:s.x*(n.width/t.width),y:s.y*(n.height/t.height)},p={x:r.x+c.x,y:r.y+c.y};return gi({x:p.x+o.x-e.x,y:p.y+o.y-e.y})}function WA(e,t,n){var i=ce(t),a=ce(n);if(qA(i,a))return null;var r=St(t,e),o,s,u;if(r==="top")o={x:0,y:a.bottom-i.bottom};else if(r==="bottom")o={x:0,y:a.top-i.top};else if(r==="right")o={x:a.left-i.left,y:0};else if(r==="left")o={x:a.right-i.right,y:0};else return null;return s={x:e.x+o.x,y:e.y+o.y},u=St(n,s),u!==r?null:o}function qA(e,t){return YA(e,t)||KA(e,t)}function YA(e,t){return e.right!==t.right&&e.left!==t.left}function KA(e,t){return e.top!==t.top&&e.bottom!==t.bottom}var XA={width:90,height:20},dm="name",hm="text";function Jp(e,t,n,i){ie.call(this,e),this.postExecute("element.updateProperties",function(r){var o=r.context,s=o.element,u=o.properties;if(dm in u&&t.updateLabel(s,u[dm]),hm in u&&w(s,"bpmn:TextAnnotation")){var c=i.getTextAnnotationBounds({x:s.x,y:s.y,width:s.width,height:s.height},u[hm]||"");t.updateLabel(s,u.text,c)}}),this.postExecute(["shape.create","connection.create"],function(r){var o=r.context,s=o.hints||{};if(s.createElementsBehavior!==!1){var u=o.shape||o.connection,c=u.businessObject;if(!(_t(u)||!Dr(u))&&Sn(u)){var p=El(u),f=i.getExternalLabelBounds(XA,Sn(u));t.createLabel(u,p,{id:c.id+"_label",businessObject:c,width:f.width,height:f.height})}}}),this.postExecute("shape.delete",function(r){var o=r.context,s=o.labelTarget,u=o.hints||{};s&&u.unsetLabel!==!1&&t.updateLabel(s,null,null,{removeShape:!1})}),this.postExecute(["label.create"],function(r){var o=r.context,s=o.shape,u,c;s.labelTarget&&w(s.labelTarget||s,"bpmn:BaseElement")&&(u=s.businessObject,c=u.di,c.label||(c.label=n.create("bpmndi:BPMNLabel",{bounds:n.create("dc:Bounds")})),G(c.label.bounds,{x:s.x,y:s.y,width:s.width,height:s.height}))});function a(r){var o=r.context,s=o.connection,u=s.label,c=G({},o.hints),p=o.newWaypoints||s.waypoints,f=o.oldWaypoints;return typeof c.startChanged=="undefined"&&(c.startChanged=!!c.connectionStart),typeof c.endChanged=="undefined"&&(c.endChanged=!!c.connectionEnd),HA(u,p,f,c)}this.postExecute(["connection.layout","connection.updateWaypoints"],function(r){var o=r.context,s=o.hints||{};if(s.labelBehavior!==!1){var u=o.connection,c=u.label,p;!c||!c.parent||(p=a(r),t.moveShape(c,p))}}),this.postExecute(["shape.replace"],function(r){var o=r.context,s=o.newShape,u=o.oldShape,c=oe(s);c&&Dr(c)&&u.label&&s.label&&(s.label.x=u.label.x,s.label.y=u.label.y)}),this.postExecute("shape.resize",function(r){var o=r.context,s=o.shape,u=o.newBounds,c=o.oldBounds;if(yl(s)){var p=s.label,f=Ee(p),m=QA(c),v=JA(f,m),g=ZA(v,c,u);t.moveShape(p,g)}})}se(Jp,ie);Jp.$inject=["eventBus","modeling","bpmnFactory","textRenderer"];function ZA(e,t,n){var i=fo(e,t,n);return gi(On(i,e))}function JA(e,t){if(t.length){var n=eP(e,t);return qy(e,n)}}function QA(e){return[[{x:e.x,y:e.y},{x:e.x+(e.width||0),y:e.y}],[{x:e.x+(e.width||0),y:e.y},{x:e.x+(e.width||0),y:e.y+(e.height||0)}],[{x:e.x,y:e.y+(e.height||0)},{x:e.x+(e.width||0),y:e.y+(e.height||0)}],[{x:e.x,y:e.y},{x:e.x,y:e.y+(e.height||0)}]]}function eP(e,t){var n=t.map(function(a){return{line:a,distance:OA(e,a)}}),i=un(n,"distance");return i[0].line}function Ol(e,t,n){var i=Bl(e),a=Jy(i,t),r=i[0];return a.length?a[a.length-1]:fo(r.original||r,n,t)}function Ll(e,t,n){var i=Bl(e),a=Jy(i,t),r=i[i.length-1];return a.length?a[0]:fo(r.original||r,n,t)}function Qp(e,t,n){var i=Bl(e),a=Zy(t,n),r=i[0];return fo(r.original||r,a,t)}function ef(e,t,n){var i=Bl(e),a=Zy(t,n),r=i[i.length-1];return fo(r.original||r,a,t)}function Zy(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function Bl(e){var t=e.waypoints;if(!t.length)throw new Error("connection#"+e.id+": no waypoints");return t}function Jy(e,t){var n=pt(e,nP);return ge(n,function(i){return tP(i,t)})}function tP(e,t){return St(t,e,1)==="intersect"}function nP(e){return e.original||e}function tf(e,t){ie.call(this,e),this.postExecute("shape.replace",function(n){var i=n.oldShape,a=n.newShape;if(iP(i,a)){var r=rP(i);r.incoming.forEach(function(o){var s=Ll(o,a,i);t.reconnectEnd(o,a,s)}),r.outgoing.forEach(function(o){var s=Ol(o,a,i);t.reconnectStart(o,a,s)})}},!0)}tf.$inject=["eventBus","modeling"];se(tf,ie);function iP(e,t){return w(e,"bpmn:Participant")&&Le(e)&&w(t,"bpmn:Participant")&&!Le(t)}function rP(e){var t=sl([e],!1),n=[],i=[];return t.forEach(function(a){a!==e&&(a.incoming.forEach(function(r){w(r,"bpmn:MessageFlow")&&n.push(r)}),a.outgoing.forEach(function(r){w(r,"bpmn:MessageFlow")&&i.push(r)}))},[]),{incoming:n,outgoing:i}}var aP="flow elements must be children of pools/participants";function Qy(e,t,n){function i(a,r,o){t.add({position:{x:a.x+5,y:a.y+5},type:"error",timeout:o||2e3,html:"<div>"+r+"</div>"})}e.on(["shape.move.rejected","create.rejected"],function(a){var r=a.context,o=r.shape,s=r.target;w(s,"bpmn:Collaboration")&&w(o,"bpmn:FlowNode")&&i(a,n(aP))})}Qy.$inject=["eventBus","tooltips","translate"];function nf(e,t,n,i){ie.call(this,e);var a=i.get("dragging",!1);function r(u){var c=u.source,p=u.target,f=u.parent;if(f){var m,v;w(u,"bpmn:SequenceFlow")&&(n.canConnectSequenceFlow(c,p)||(v=!0),n.canConnectMessageFlow(c,p)&&(m="bpmn:MessageFlow")),w(u,"bpmn:MessageFlow")&&(n.canConnectMessageFlow(c,p)||(v=!0),n.canConnectSequenceFlow(c,p)&&(m="bpmn:SequenceFlow")),w(u,"bpmn:Association")&&!n.canConnectAssociation(c,p)&&(v=!0),v&&t.removeConnection(u),m&&t.connect(c,p,{type:m,waypoints:u.waypoints.slice()})}}function o(u){var c=u.context,p=c.connection,f=c.newSource||p.source,m=c.newTarget||p.target,v,g;v=n.canConnect(f,m),!(!v||v.type===p.type)&&(g=t.connect(f,m,{type:v.type,waypoints:p.waypoints.slice()}),t.removeConnection(p),c.connection=g,a&&s(p,g))}function s(u,c){var p=a.context(),f=p&&p.payload.previousSelection,m;!f||!f.length||(m=f.indexOf(u),m!==-1&&f.splice(m,1,c))}this.postExecuted("elements.move",function(u){var c=u.closure,p=c.allConnections;B(p,r)},!0),this.preExecute("connection.reconnect",o),this.postExecuted("element.updateProperties",function(u){var c=u.context,p=c.properties,f=c.element,m=f.businessObject,v;p.default&&(v=Me(f.outgoing,ln({id:f.businessObject.default.id})),v&&t.updateProperties(v,{conditionExpression:void 0})),p.conditionExpression&&m.sourceRef.default===m&&t.updateProperties(f.source,{default:void 0})})}se(nf,ie);nf.$inject=["eventBus","modeling","bpmnRules","injector"];function rf(e,t){ie.call(this,e),this.preExecute("shape.delete",function(n){var i=n.shape,a=i.parent;w(i,"bpmn:Participant")&&(n.collaborationRoot=a)},!0),this.postExecute("shape.delete",function(n){var i=n.collaborationRoot;i&&!i.businessObject.participants.length&&t.makeProcess()},!0)}rf.$inject=["eventBus","modeling"];se(rf,ie);function $l(e,t,n,i,a,r){i.invoke(ie,this),this._bpmnReplace=e,this._elementRegistry=n,this._selection=r,this.postExecuted(["elements.create"],500,function(o){var s=o.context,u=s.parent,c=s.elements,p=t.canReplace(c,u);p&&this.replaceElements(c,p.replacements)},this),this.postExecuted(["elements.move"],500,function(o){var s=o.context,u=s.newParent,c=s.newHost,p=[];B(s.closure.topLevel,function(m){Yt(m)?p=p.concat(m.children):p=p.concat(m)}),p.length===1&&c&&(u=c);var f=t.canReplace(p,u);f&&this.replaceElements(p,f.replacements,c)},this),this.postExecute(["shape.replace"],1500,function(o){var s=o.context,u=s.oldShape,c=s.newShape,p=u.attachers,f;p&&p.length&&(f=t.canReplace(p,c),this.replaceElements(p,f.replacements))},this),this.postExecuted(["shape.replace"],1500,function(o){var s=o.context,u=s.oldShape,c=s.newShape;a.unclaimId(u.businessObject.id,u.businessObject),a.updateProperties(c,{id:u.id})})}se($l,ie);$l.prototype.replaceElements=function(e,t){var n=this._elementRegistry,i=this._bpmnReplace,a=this._selection;B(t,function(r){var o={type:r.newElementType},s=n.get(r.oldElementId),u=e.indexOf(s);e[u]=i.replaceElement(s,o,{select:!1})}),t&&a.select(e)};$l.$inject=["bpmnReplace","bpmnRules","elementRegistry","injector","modeling","selection"];var oP=1500,Yi={width:300,height:60},za={width:300,height:150},eE={width:140,height:120},tE={width:50,height:30};function nE(e){e.on("resize.start",oP,function(t){var n=t.context,i=n.shape,a=n.direction,r=n.balanced;(w(i,"bpmn:Lane")||w(i,"bpmn:Participant"))&&(n.resizeConstraints=dP(i,a,r)),w(i,"bpmn:Participant")&&(n.minDimensions=za),w(i,"bpmn:SubProcess")&&Le(i)&&(n.minDimensions=eE),w(i,"bpmn:TextAnnotation")&&(n.minDimensions=tE)})}nE.$inject=["eventBus"];var us=Math.abs,sP=Math.min,lP=Math.max;function iE(e,t,n,i){var a=e[t];e[t]=a===void 0?n:i(n,a)}function cs(e,t,n){return iE(e,t,n,sP)}function ps(e,t,n){return iE(e,t,n,lP)}var uP=20,cP=50,pP=20,fP=20;function dP(e,t,n){var i=bn(e),a=!0,r=!0,o=Pl(i,[i]),s=ce(e),u={},c={};/e/.test(t)?c.right=s.left+Yi.width:/w/.test(t)&&(c.left=s.right-Yi.width),o.forEach(function(f){var m=ce(f);/n/.test(t)&&(m.top<s.top-10&&(a=!1),n&&us(s.top-m.bottom)<10&&ps(u,"top",m.top+Yi.height),us(s.top-m.top)<5&&cs(c,"top",m.bottom-Yi.height)),/s/.test(t)&&(m.bottom>s.bottom+10&&(r=!1),n&&us(s.bottom-m.top)<10&&cs(u,"bottom",m.bottom-Yi.height),us(s.bottom-m.bottom)<5&&ps(c,"bottom",m.top+Yi.height))});var p=i.children.filter(function(f){return!f.hidden&&!f.waypoints&&(w(f,"bpmn:FlowElement")||w(f,"bpmn:Artifact"))});return p.forEach(function(f){var m=ce(f);a&&/n/.test(t)&&cs(c,"top",m.top-pP),/e/.test(t)&&ps(c,"right",m.right+uP),r&&/s/.test(t)&&ps(c,"bottom",m.bottom+fP),/w/.test(t)&&cs(c,"left",m.left-cP)}),{min:c,max:u}}var mm=1001;function rE(e,t){e.on("resize.start",mm+500,function(n){var i=n.context,a=i.shape;(w(a,"bpmn:Lane")||w(a,"bpmn:Participant"))&&(i.balanced=!Or(n))}),e.on("resize.end",mm,function(n){var i=n.context,a=i.shape,r=i.canExecute,o=i.newBounds;if(w(a,"bpmn:Lane")||w(a,"bpmn:Participant"))return r&&(o=Zv(o),t.resizeLane(a,o,i.balanced)),!1})}rE.$inject=["eventBus","modeling"];function af(e,t,n){ie.call(this,e),this.preExecute("shape.delete",function(i){var a=i.context.shape;if(!(a.incoming.length!==1||a.outgoing.length!==1)){var r=a.incoming[0],o=a.outgoing[0];if(!(!w(r,"bpmn:SequenceFlow")||!w(o,"bpmn:SequenceFlow"))&&t.canConnect(r.source,o.target,r)){var s=hP(r.waypoints,o.waypoints);n.reconnectEnd(r,o.target,s)}}})}se(af,ie);af.$inject=["eventBus","bpmnRules","modeling"];function _r(e){return e.original||e}function hP(e,t){var n=Bc(_r(e[e.length-2]),_r(e[e.length-1]),_r(t[1]),_r(t[0]));return n?[].concat(e.slice(0,e.length-1),[n],t.slice(1)):[_r(e[0]),_r(t[t.length-1])]}var mP=Math.max;function aE(e){e.on("spaceTool.getMinDimensions",function(t){var n=t.shapes,i=t.axis,a=t.start,r={};return B(n,function(o){var s=o.id;w(o,"bpmn:Participant")&&(vP(i)?r[s]=za:r[s]={width:za.width,height:gP(o,a)}),w(o,"bpmn:SubProcess")&&Le(o)&&(r[s]=eE),w(o,"bpmn:TextAnnotation")&&(r[s]=tE)}),r})}aE.$inject=["eventBus"];function vP(e){return e==="x"}function gP(e,t){var n;return yP(e)?(n=EP(e,t),mP(za.height,n)):za.height}function yP(e){return!!ar(e).length}function EP(e,t){var n=ar(e),i;return i=oE(n,t),e.height-i.height+Yi.height}function oE(e,t){var n,i,a;for(n=0;n<e.length;n++)if(i=e[n],t>=i.y&&t<=i.y+i.height)return a=ar(i),a.length?oE(a,t):i}function of(e,t){e.invoke(ie,this),this.postExecuted("shape.replace",function(n){var i=n.context.oldShape,a=n.context.newShape;if(!(!w(a,"bpmn:SubProcess")||!w(i,"bpmn:Task")||!Le(a))){var r=bP(a);t.createShape({type:"bpmn:StartEvent"},r,a)}})}of.$inject=["injector","modeling"];se(of,ie);function bP(e){return{x:e.x+e.width/6,y:e.y+e.height/2}}var Fu=500;function sf(e,t,n,i){ie.call(this,e);function a(s){s.length&&s.forEach(function(u){u.type==="label"&&!u.businessObject.name&&(u.hidden=!0)})}function r(s,u){var c=s.children,p=u,f,m;return f=_P(c).concat([s]),m=Py(f),m?(p.width=Math.max(m.width,p.width),p.height=Math.max(m.height,p.height),p.x=m.x+(m.width-p.width)/2,p.y=m.y+(m.height-p.height)/2):(p.x=s.x+(s.width-p.width)/2,p.y=s.y+(s.height-p.height)/2),p}function o(s,u){return{x:s.x+(s.width-u.width)/2,y:s.y+(s.height-u.height)/2,width:u.width,height:u.height}}this.executed(["shape.toggleCollapse"],Fu,function(s){var u=s.context,c=u.shape;w(c,"bpmn:SubProcess")&&(c.collapsed?oe(c).di.isExpanded=!1:(a(c.children),oe(c).di.isExpanded=!0))}),this.reverted(["shape.toggleCollapse"],Fu,function(s){var u=s.context,c=u.shape;c.collapsed?oe(c).di.isExpanded=!1:oe(c).di.isExpanded=!0}),this.postExecuted(["shape.toggleCollapse"],Fu,function(s){var u=s.context.shape,c=t._getDefaultSize(u),p;u.collapsed?p=o(u,c):p=r(u,c),n.resizeShape(u,p,null,{autoResize:u.collapsed?!1:"nwse"})})}se(sf,ie);sf.$inject=["eventBus","elementFactory","modeling"];function _P(e){return e.filter(function(t){return!t.hidden})}function lf(e,t,n,i){t.invoke(ie,this),this.preExecute("shape.delete",function(a){var r=a.context,o=r.shape,s=o.businessObject;_t(o)||(w(o,"bpmn:Participant")&&Le(o)&&n.ids.unclaim(s.processRef.id),i.unclaimId(s.id,s))}),this.preExecute("connection.delete",function(a){var r=a.context,o=r.connection,s=o.businessObject;i.unclaimId(s.id,s)}),this.preExecute("canvas.updateRoot",function(){var a=e.getRootElement(),r=a.businessObject;n.ids.unclaim(r.id)})}se(lf,ie);lf.$inject=["canvas","injector","moddle","modeling"];var xP=500,SP=5e3;function uf(e,t,n){ie.call(this,e);var i;function a(){return i=i||new wP,i.enter(),i}function r(){if(!i)throw new Error(n("out of bounds release"));return i}function o(){if(!i)throw new Error(n("out of bounds release"));var u=i.leave();return u&&(t.updateLaneRefs(i.flowNodes,i.lanes),i=null),u}var s=["spaceTool","lane.add","lane.resize","lane.split","elements.create","elements.delete","elements.move","shape.create","shape.delete","shape.move","shape.resize"];this.preExecute(s,SP,function(u){a()}),this.postExecuted(s,xP,function(u){o()}),this.preExecute(["shape.create","shape.move","shape.delete","shape.resize"],function(u){var c=u.context,p=c.shape,f=r();p.labelTarget||(w(p,"bpmn:Lane")&&f.addLane(p),w(p,"bpmn:FlowNode")&&f.addFlowNode(p))})}uf.$inject=["eventBus","modeling","translate"];se(uf,ie);function wP(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(e){this.lanes.push(e)},this.addFlowNode=function(e){this.flowNodes.push(e)},this.enter=function(){this.counter++},this.leave=function(){return this.counter--,!this.counter}}function cf(e,t){ie.call(this,e),this.preExecute("connection.delete",function(n){var i=n.context,a=i.connection,r=a.source;TP(a,r)&&t.updateProperties(r,{default:null})})}se(cf,ie);cf.$inject=["eventBus","modeling"];function TP(e,t){if(!w(e,"bpmn:SequenceFlow"))return!1;var n=oe(t),i=oe(e);return n.get("default")===i}const CP={__init__:["adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","rootElementReferenceBehavior","createBehavior","fixHoverBehavior","createDataObjectBehavior","createParticipantBehavior","dataStoreBehavior","dataInputAssociationBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","groupBehavior","importDockingFix","isHorizontalFix","labelBehavior","messageFlowBehavior","modelingFeedback","removeElementBehavior","removeParticipantBehavior","replaceConnectionBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","toggleElementCollapseBehaviour","spaceToolBehavior","subProcessStartEventBehavior","unclaimIdBehavior","unsetDefaultFlowBehavior","updateFlowNodeRefsBehavior"],adaptiveLabelPositioningBehavior:["type",Bp],appendBehavior:["type",$p],associationBehavior:["type",Vp],attachEventBehavior:["type",Ml],boundaryEventBehavior:["type",Fp],rootElementReferenceBehavior:["type",jp],createBehavior:["type",Hp],fixHoverBehavior:["type",zy],createDataObjectBehavior:["type",zp],createParticipantBehavior:["type",Gp],dataInputAssociationBehavior:["type",Up],dataStoreBehavior:["type",Wp],deleteLaneBehavior:["type",qp],detachEventBehavior:["type",Dl],dropOnFlowBehavior:["type",Yp],eventBasedGatewayBehavior:["type",Kp],groupBehavior:["type",Xp],importDockingFix:["type",Uy],isHorizontalFix:["type",Zp],labelBehavior:["type",Jp],messageFlowBehavior:["type",tf],modelingFeedback:["type",Qy],replaceConnectionBehavior:["type",nf],removeParticipantBehavior:["type",rf],replaceElementBehaviour:["type",$l],resizeBehavior:["type",nE],resizeLaneBehavior:["type",rE],removeElementBehavior:["type",af],toggleElementCollapseBehaviour:["type",sf],spaceToolBehavior:["type",aE],subProcessStartEventBehavior:["type",of],unclaimIdBehavior:["type",lf],updateFlowNodeRefsBehavior:["type",uf],unsetDefaultFlowBehavior:["type",cf]};function sE(e,t){var n=St(e,t,-15);return n!=="intersect"?n:null}function wt(e){Pi.call(this,e)}se(wt,Pi);wt.$inject=["eventBus"];wt.prototype.init=function(){this.addRule("connection.start",function(e){var t=e.source;return AP(t)}),this.addRule("connection.create",function(e){var t=e.source,n=e.target,i=e.hints||{},a=i.targetParent,r=i.targetAttach;if(r)return!1;a&&(n.parent=a);try{return Ns(t,n)}finally{a&&(n.parent=null)}}),this.addRule("connection.reconnect",function(e){var t=e.connection,n=e.source,i=e.target;return Ns(n,i,t)}),this.addRule("connection.updateWaypoints",function(e){return{type:e.connection.type}}),this.addRule("shape.resize",function(e){var t=e.shape,n=e.newBounds;return hE(t,n)}),this.addRule("elements.create",function(e){var t=e.elements,n=e.position,i=e.target;return Zs(i)&&!Js(t,i)?!1:Qi(t,function(a){return Zs(a)?Ns(a.source,a.target,a):a.host?Da(a,a.host,null,n):jc(a,i,null)})}),this.addRule("elements.move",function(e){var t=e.target,n=e.shapes,i=e.position;return Da(n,t,null,i)||fE(n,t,i)||dE(n,t)||Js(n,t)}),this.addRule("shape.create",function(e){return jc(e.shape,e.target,e.source,e.position)}),this.addRule("shape.attach",function(e){return Da(e.shape,e.target,null,e.position)}),this.addRule("element.copy",function(e){var t=e.element,n=e.elements;return yE(n,t)})};wt.prototype.canConnectMessageFlow=vE;wt.prototype.canConnectSequenceFlow=gE;wt.prototype.canConnectDataAssociation=df;wt.prototype.canConnectAssociation=mE;wt.prototype.canMove=dE;wt.prototype.canAttach=Da;wt.prototype.canReplace=fE;wt.prototype.canDrop=Br;wt.prototype.canInsert=Js;wt.prototype.canCreate=jc;wt.prototype.canConnect=Ns;wt.prototype.canResize=hE;wt.prototype.canCopy=yE;function AP(e){return $c(e)?null:Pe(e,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference","bpmn:Group","bpmn:TextAnnotation"])}function $c(e){return!e||_t(e)}function PP(e,t){return e===t}function vm(e){do{if(w(e,"bpmn:Process"))return oe(e);if(w(e,"bpmn:Participant"))return oe(e).processRef||oe(e)}while(e=e.parent)}function Vc(e){return w(e,"bpmn:TextAnnotation")}function pf(e){return w(e,"bpmn:Group")&&!e.labelTarget}function ff(e){return w(e,"bpmn:BoundaryEvent")&&Dn(e,"bpmn:CompensateEventDefinition")}function ea(e){return oe(e).isForCompensation}function RP(e,t){var n=vm(e),i=vm(t);return n===i}function IP(e){return w(e,"bpmn:InteractionNode")&&!w(e,"bpmn:BoundaryEvent")&&(!w(e,"bpmn:Event")||w(e,"bpmn:ThrowEvent")&&lE(e,"bpmn:MessageEventDefinition"))}function NP(e){return w(e,"bpmn:InteractionNode")&&!ea(e)&&(!w(e,"bpmn:Event")||w(e,"bpmn:CatchEvent")&&lE(e,"bpmn:MessageEventDefinition"))&&!(w(e,"bpmn:BoundaryEvent")&&!Dn(e,"bpmn:MessageEventDefinition"))}function gm(e){for(var t=e;t=t.parent;){if(w(t,"bpmn:FlowElementsContainer"))return oe(t);if(w(t,"bpmn:Participant"))return oe(t).processRef}return null}function MP(e,t){var n=gm(e),i=gm(t);return n===i}function Dn(e,t){var n=oe(e);return!!Me(n.eventDefinitions||[],function(i){return w(i,t)})}function lE(e,t){var n=oe(e);return(n.eventDefinitions||[]).every(function(i){return w(i,t)})}function kP(e){return w(e,"bpmn:FlowNode")&&!w(e,"bpmn:EndEvent")&&!Yt(e)&&!(w(e,"bpmn:IntermediateThrowEvent")&&Dn(e,"bpmn:LinkEventDefinition"))&&!ff(e)&&!ea(e)}function DP(e){return w(e,"bpmn:FlowNode")&&!w(e,"bpmn:StartEvent")&&!w(e,"bpmn:BoundaryEvent")&&!Yt(e)&&!(w(e,"bpmn:IntermediateCatchEvent")&&Dn(e,"bpmn:LinkEventDefinition"))&&!ea(e)}function ym(e){return w(e,"bpmn:ReceiveTask")||w(e,"bpmn:IntermediateCatchEvent")&&(Dn(e,"bpmn:MessageEventDefinition")||Dn(e,"bpmn:TimerEventDefinition")||Dn(e,"bpmn:ConditionalEventDefinition")||Dn(e,"bpmn:SignalEventDefinition"))}function Zs(e){return e.waypoints}function OP(e){for(var t=[];e;)e=e.parent,e&&t.push(e);return t}function Fc(e,t){var n=OP(t);return n.indexOf(e)!==-1}function Ns(e,t,n){if($c(e)||$c(t))return null;if(!w(n,"bpmn:DataAssociation")){if(vE(e,t))return{type:"bpmn:MessageFlow"};if(gE(e,t))return{type:"bpmn:SequenceFlow"}}var i=df(e,t);return i||(ff(e)&&ea(t)?{type:"bpmn:Association",associationDirection:"One"}:mE(e,t)?{type:"bpmn:Association"}:!1)}function Br(e,t,n){return _t(e)||pf(e)?!0:w(t,"bpmn:Participant")&&!Le(t)?!1:w(e,"bpmn:Participant")?w(t,"bpmn:Process")||w(t,"bpmn:Collaboration"):Pe(e,["bpmn:DataInput","bpmn:DataOutput"])&&e.parent?t===e.parent:w(e,"bpmn:Lane")?w(t,"bpmn:Participant")||w(t,"bpmn:Lane"):w(e,"bpmn:BoundaryEvent")&&!LP(e)?!1:w(e,"bpmn:FlowElement")&&!w(e,"bpmn:DataStoreReference")?w(t,"bpmn:FlowElementsContainer")?Le(t):Pe(t,["bpmn:Participant","bpmn:Lane"]):w(e,"bpmn:DataStoreReference")&&w(t,"bpmn:Collaboration")?wi(oe(t).get("participants"),function(i){return!!i.get("processRef")}):Pe(e,["bpmn:Artifact","bpmn:DataAssociation","bpmn:DataStoreReference"])?Pe(t,["bpmn:Collaboration","bpmn:Lane","bpmn:Participant","bpmn:Process","bpmn:SubProcess"]):w(e,"bpmn:MessageFlow")?w(t,"bpmn:Collaboration")||e.source.parent==t||e.target.parent==t:!1}function LP(e){return oe(e).cancelActivity&&(uE(e)||cE(e))}function BP(e){return!_t(e)&&w(e,"bpmn:BoundaryEvent")}function $P(e){return w(e,"bpmn:Lane")}function VP(e){return BP(e)||w(e,"bpmn:IntermediateThrowEvent")&&uE(e)?!0:w(e,"bpmn:IntermediateCatchEvent")&&cE(e)}function uE(e){var t=oe(e);return t&&!(t.eventDefinitions&&t.eventDefinitions.length)}function cE(e){return pE(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])}function pE(e,t){return t.some(function(n){return Dn(e,n)})}function FP(e){return w(e,"bpmn:ReceiveTask")&&Me(e.incoming,function(t){return w(t.source,"bpmn:EventBasedGateway")})}function Da(e,t,n,i){if(Array.isArray(e)||(e=[e]),e.length!==1)return!1;var a=e[0];return _t(a)||!VP(a)||Yt(t)||!w(t,"bpmn:Activity")||ea(t)||i&&!sE(i,t)||FP(t)?!1:"attach"}function fE(e,t,n){if(!t)return!1;var i={replacements:[]};return B(e,function(a){Yt(t)||w(a,"bpmn:StartEvent")&&a.type!=="label"&&Br(a,t)&&(qw(a)||i.replacements.push({oldElementId:a.id,newElementType:"bpmn:StartEvent"}),(Yw(a)||Kw(a)||Xw(a))&&i.replacements.push({oldElementId:a.id,newElementType:"bpmn:StartEvent"}),pE(a,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])&&w(t,"bpmn:SubProcess")&&i.replacements.push({oldElementId:a.id,newElementType:"bpmn:StartEvent"})),w(t,"bpmn:Transaction")||Dn(a,"bpmn:CancelEventDefinition")&&a.type!=="label"&&(w(a,"bpmn:EndEvent")&&Br(a,t)&&i.replacements.push({oldElementId:a.id,newElementType:"bpmn:EndEvent"}),w(a,"bpmn:BoundaryEvent")&&Da(a,t,null,n)&&i.replacements.push({oldElementId:a.id,newElementType:"bpmn:BoundaryEvent"}))}),i.replacements.length?i:!1}function dE(e,t){return wi(e,$P)?!1:t?e.every(function(n){return Br(n,t)}):!0}function jc(e,t,n,i){return t?_t(e)||pf(e)?!0:PP(n,t)||n&&Fc(n,t)?!1:Br(e,t)||Js(e,t):!1}function hE(e,t){return w(e,"bpmn:SubProcess")?Le(e)&&(!t||t.width>=100&&t.height>=80):w(e,"bpmn:Lane")?!t||t.width>=130&&t.height>=60:w(e,"bpmn:Participant")?!t||t.width>=250&&t.height>=50:!!(Vc(e)||pf(e))}function jP(e,t){var n=Vc(e),i=Vc(t);return(n||i)&&n!==i}function mE(e,t){return Zs(e)||Zs(t)?!1:ff(e)&&ea(t)?!0:Fc(t,e)||Fc(e,t)?!1:jP(e,t)?!0:!!df(e,t)}function vE(e,t){return Em(e)&&!Em(t)?!1:IP(e)&&NP(t)&&!RP(e,t)}function gE(e,t){return ym(t)&&t.incoming.length>0&&GP(t.incoming)&&!w(e,"bpmn:EventBasedGateway")?!1:kP(e)&&DP(t)&&MP(e,t)&&!(w(e,"bpmn:EventBasedGateway")&&!ym(t))}function df(e,t){return Pe(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&Pe(t,["bpmn:Activity","bpmn:ThrowEvent"])?{type:"bpmn:DataInputAssociation"}:Pe(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&Pe(e,["bpmn:Activity","bpmn:CatchEvent"])?{type:"bpmn:DataOutputAssociation"}:!1}function Js(e,t,n){if(!t)return!1;if(Array.isArray(e)){if(e.length!==1)return!1;e=e[0]}return t.source===e||t.target===e?!1:Pe(t,["bpmn:SequenceFlow","bpmn:MessageFlow"])&&!_t(t)&&w(e,"bpmn:FlowNode")&&!w(e,"bpmn:BoundaryEvent")&&Br(e,t.parent)}function HP(e,t){return e&&t&&e.indexOf(t)!==-1}function yE(e,t){return _t(t)?!0:!(w(t,"bpmn:Lane")&&!HP(e,t.parent))}function zP(e){if(e&&e.source)return w(e.source,"bpmn:EventBasedGateway")}function GP(e){return e=e||[],e.some(zP)}function Em(e){return Us(e,"bpmn:Process")||Us(e,"bpmn:Collaboration")}const UP={__depends__:[Hn],__init__:["bpmnRules"],bpmnRules:["type",wt]};var WP=2e3;function EE(e,t){e.on("saveXML.start",WP,n);function n(){var i=t.getRootElement(),a=oe(i).di,r,o;r=sl([i],!1),r=ge(r,function(s){return s!==i&&!s.labelTarget}),o=pt(r,kr),a.set("planeElement",o)}}EE.$inject=["eventBus","canvas"];const qP={__init__:["bpmnDiOrdering"],bpmnDiOrdering:["type",EE]};function Vl(e){ie.call(this,e);var t=this;this.preExecute(["shape.create","connection.create"],function(n){var i=n.context,a=i.shape||i.connection,r=i.parent,o=t.getOrdering(a,r);o&&(o.parent!==void 0&&(i.parent=o.parent),i.parentIndex=o.index)}),this.preExecute(["shape.move","connection.move"],function(n){var i=n.context,a=i.shape||i.connection,r=i.newParent||a.parent,o=t.getOrdering(a,r);o&&(o.parent!==void 0&&(i.newParent=o.parent),i.newParentIndex=o.index)})}Vl.prototype.getOrdering=function(e,t){return null};se(Vl,ie);function hf(e,t,n){Vl.call(this,e);var i=[{type:"bpmn:SubProcess",order:{level:6}},{type:"bpmn:SequenceFlow",order:{level:3,containers:["bpmn:Participant","bpmn:FlowElementsContainer"]}},{type:"bpmn:DataAssociation",order:{level:9,containers:["bpmn:Collaboration","bpmn:Process"]}},{type:"bpmn:MessageFlow",order:{level:9,containers:["bpmn:Collaboration"]}},{type:"bpmn:Association",order:{level:6,containers:["bpmn:Participant","bpmn:FlowElementsContainer","bpmn:Collaboration"]}},{type:"bpmn:BoundaryEvent",order:{level:8}},{type:"bpmn:Group",order:{level:10,containers:["bpmn:Collaboration","bpmn:Process"]}},{type:"bpmn:FlowElement",order:{level:5}},{type:"bpmn:Participant",order:{level:-2}},{type:"bpmn:Lane",order:{level:-1}}];function a(s){if(s.labelTarget)return{level:10};var u=Me(i,function(c){return Pe(s,[c.type])});return u&&u.order||{level:1}}function r(s){var u=s.order;if(u||(s.order=u=a(s)),!u)throw new Error("no order for <"+s.id+">");return u}function o(s,u,c){for(var p=u;p&&!Pe(p,c);)p=p.parent;if(!p)throw new Error("no parent for <"+s.id+"> in <"+(u&&u.id)+">");return p}this.getOrdering=function(s,u){if(s.labelTarget)return{parent:t.getRootElement(),index:-1};var c=r(s);c.containers&&(u=o(s,u,c.containers));var p=u.children.indexOf(s),f=Xc(u.children,function(m){return!s.labelTarget&&m.labelTarget?!1:c.level<r(m).level});return f!==-1&&p!==-1&&p<f&&(f-=1),{index:f,parent:u}}}hf.$inject=["eventBus","canvas","translate"];se(hf,Vl);const YP={__depends__:[gl],__init__:["bpmnOrderingProvider"],bpmnOrderingProvider:["type",hf]};function qe(e,t){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[],trigger:null},this._injector=t,this._eventBus=e,this._uid=1,e.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}qe.$inject=["eventBus","injector"];qe.prototype.execute=function(e,t){if(!e)throw new Error("command required");this._currentExecution.trigger="execute";var n={command:e,context:t};this._pushAction(n),this._internalExecute(n),this._popAction(n)};qe.prototype.canExecute=function(e,t){var n={command:e,context:t},i=this._getHandler(e),a=this._fire(e,"canExecute",n);if(a===void 0){if(!i)return!1;i.canExecute&&(a=i.canExecute(t))}return a};qe.prototype.clear=function(e){this._stack.length=0,this._stackIdx=-1,e!==!1&&this._fire("changed",{trigger:"clear"})};qe.prototype.undo=function(){var e=this._getUndoAction(),t;if(e){for(this._currentExecution.trigger="undo",this._pushAction(e);e&&(this._internalUndo(e),t=this._getUndoAction(),!(!t||t.id!==e.id));)e=t;this._popAction()}};qe.prototype.redo=function(){var e=this._getRedoAction(),t;if(e){for(this._currentExecution.trigger="redo",this._pushAction(e);e&&(this._internalExecute(e,!0),t=this._getRedoAction(),!(!t||t.id!==e.id));)e=t;this._popAction()}};qe.prototype.register=function(e,t){this._setHandler(e,t)};qe.prototype.registerHandler=function(e,t){if(!e||!t)throw new Error("command and handlerCls must be defined");var n=this._injector.instantiate(t);this.register(e,n)};qe.prototype.canUndo=function(){return!!this._getUndoAction()};qe.prototype.canRedo=function(){return!!this._getRedoAction()};qe.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]};qe.prototype._getUndoAction=function(){return this._stack[this._stackIdx]};qe.prototype._internalUndo=function(e){var t=this,n=e.command,i=e.context,a=this._getHandler(n);this._atomicDo(function(){t._fire(n,"revert",e),a.revert&&t._markDirty(a.revert(i)),t._revertedAction(e),t._fire(n,"reverted",e)})};qe.prototype._fire=function(e,t,n){arguments.length<3&&(n=t,t=null);var i=t?[e+"."+t,t]:[e],a,r,o;for(n=this._eventBus.createEvent(n),a=0;(r=i[a])&&(o=this._eventBus.fire("commandStack."+r,n),!n.cancelBubble);a++);return o};qe.prototype._createId=function(){return this._uid++};qe.prototype._atomicDo=function(e){var t=this._currentExecution;t.atomic=!0;try{e()}finally{t.atomic=!1}};qe.prototype._internalExecute=function(e,t){var n=this,i=e.command,a=e.context,r=this._getHandler(i);if(!r)throw new Error("no command handler registered for <"+i+">");this._pushAction(e),t||(this._fire(i,"preExecute",e),r.preExecute&&r.preExecute(a),this._fire(i,"preExecuted",e)),this._atomicDo(function(){n._fire(i,"execute",e),r.execute&&n._markDirty(r.execute(a)),n._executedAction(e,t),n._fire(i,"executed",e)}),t||(this._fire(i,"postExecute",e),r.postExecute&&r.postExecute(a),this._fire(i,"postExecuted",e)),this._popAction(e)};qe.prototype._pushAction=function(e){var t=this._currentExecution,n=t.actions,i=n[0];if(t.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+e.command+")");e.id||(e.id=i&&i.id||this._createId()),n.push(e)};qe.prototype._popAction=function(){var e=this._currentExecution,t=e.trigger,n=e.actions,i=e.dirty;n.pop(),n.length||(this._eventBus.fire("elements.changed",{elements:Zc("id",i.reverse())}),i.length=0,this._fire("changed",{trigger:t}),e.trigger=null)};qe.prototype._markDirty=function(e){var t=this._currentExecution;e&&(e=xe(e)?e:[e],t.dirty=t.dirty.concat(e))};qe.prototype._executedAction=function(e,t){var n=++this._stackIdx;t||this._stack.splice(n,this._stack.length,e)};qe.prototype._revertedAction=function(e){this._stackIdx--};qe.prototype._getHandler=function(e){return this._handlerMap[e]};qe.prototype._setHandler=function(e,t){if(!e||!t)throw new Error("command and handler required");if(this._handlerMap[e])throw new Error("overriding handler for command <"+e+">");this._handlerMap[e]=t};const KP={commandStack:["type",qe]};var XP=new Ep("tt");function ZP(e){var t=je('<div class="djs-tooltip-container" style="position: absolute; width: 0; height: 0;" />');return e.insertBefore(t,e.firstChild),t}function JP(e,t,n){G(e.style,{left:t+"px",top:n+"px"})}function mf(e,t){e.style.display=t===!1?"none":""}var bE="djs-tooltip",ju="."+bE;function Lt(e,t){this._eventBus=e,this._canvas=t,this._ids=XP,this._tooltipDefaults={show:{minZoom:.7,maxZoom:5}},this._tooltips={},this._tooltipRoot=ZP(t.getContainer());var n=this;qt.bind(this._tooltipRoot,ju,"mousedown",function(i){i.stopPropagation()}),qt.bind(this._tooltipRoot,ju,"mouseover",function(i){n.trigger("mouseover",i)}),qt.bind(this._tooltipRoot,ju,"mouseout",function(i){n.trigger("mouseout",i)}),this._init()}Lt.$inject=["eventBus","canvas"];Lt.prototype.add=function(e){if(!e.position)throw new Error("must specifiy tooltip position");if(!e.html)throw new Error("must specifiy tooltip html");var t=this._ids.next();return e=G({},this._tooltipDefaults,e,{id:t}),this._addTooltip(e),e.timeout&&this.setTimeout(e),t};Lt.prototype.trigger=function(e,t){var n=t.delegateTarget||t.target,i=this.get(Xt(n,"data-tooltip-id"));i&&(e==="mouseover"&&i.timeout&&this.clearTimeout(i),e==="mouseout"&&i.timeout&&(i.timeout=1e3,this.setTimeout(i)))};Lt.prototype.get=function(e){return typeof e!="string"&&(e=e.id),this._tooltips[e]};Lt.prototype.clearTimeout=function(e){if(e=this.get(e),!!e){var t=e.removeTimer;t&&(clearTimeout(t),e.removeTimer=null)}};Lt.prototype.setTimeout=function(e){if(e=this.get(e),!!e){this.clearTimeout(e);var t=this;e.removeTimer=setTimeout(function(){t.remove(e)},e.timeout)}};Lt.prototype.remove=function(e){var t=this.get(e);t&&($n(t.html),$n(t.htmlContainer),delete t.htmlContainer,delete this._tooltips[t.id])};Lt.prototype.show=function(){mf(this._tooltipRoot)};Lt.prototype.hide=function(){mf(this._tooltipRoot,!1)};Lt.prototype._updateRoot=function(e){var t=e.scale||1,n=e.scale||1,i="matrix("+t+",0,0,"+n+","+-1*e.x*t+","+-1*e.y*n+")";this._tooltipRoot.style.transform=i,this._tooltipRoot.style["-ms-transform"]=i};Lt.prototype._addTooltip=function(e){var t=e.id,n=e.html,i,a=this._tooltipRoot;n.get&&n.constructor.prototype.jquery&&(n=n.get(0)),jt(n)&&(n=je(n)),i=je('<div data-tooltip-id="'+t+'" class="'+bE+'" style="position: absolute">'),i.appendChild(n),e.type&&lt(i).add("djs-tooltip-"+e.type),e.className&&lt(i).add(e.className),e.htmlContainer=i,a.appendChild(i),this._tooltips[t]=e,this._updateTooltip(e)};Lt.prototype._updateTooltip=function(e){var t=e.position,n=e.htmlContainer;JP(n,t.x,t.y)};Lt.prototype._updateTooltipVisibilty=function(e){B(this._tooltips,function(t){var n=t.show,i=t.htmlContainer,a=!0;n&&((n.minZoom>e.scale||n.maxZoom<e.scale)&&(a=!1),mf(i,a))})};Lt.prototype._init=function(){var e=this;function t(n){e._updateRoot(n),e._updateTooltipVisibilty(n),e.show()}this._eventBus.on("canvas.viewbox.changing",function(n){e.hide()}),this._eventBus.on("canvas.viewbox.changed",function(n){t(n.viewbox)})};const QP={__init__:["tooltips"],tooltips:["type",Lt]};function Cr(e,t){if(typeof t!="function")throw new Error("removeFn iterator must be a function");if(e){for(var n;n=e[0];)t(n);return e}}var eR=250,bm=1400;function vf(e,t,n){ie.call(this,t);var i=e.get("movePreview",!1);t.on("shape.move.start",bm,function(a){var r=a.context,o=r.shapes,s=r.validatedShapes;r.shapes=_m(o),r.validatedShapes=_m(s)}),i&&t.on("shape.move.start",eR,function(a){var r=a.context,o=r.shapes,s=[];B(o,function(u){B(u.labels,function(c){!c.hidden&&r.shapes.indexOf(c)===-1&&s.push(c),u.labelTarget&&s.push(u)})}),B(s,function(u){i.makeDraggable(r,u,!0)})}),this.preExecuted("elements.move",bm,function(a){var r=a.context,o=r.closure,s=o.enclosedElements,u=[];B(s,function(c){B(c.labels,function(p){s[p.id]||u.push(p)})}),o.addAll(u)}),this.preExecute(["connection.delete","shape.delete"],function(a){var r=a.context,o=r.connection||r.shape;Cr(o.labels,function(s){n.removeShape(s,{nested:!0})})}),this.execute("shape.delete",function(a){var r=a.context,o=r.shape,s=o.labelTarget;s&&(r.labelTargetIndex=op(s.labels,o),r.labelTarget=s,o.labelTarget=null)}),this.revert("shape.delete",function(a){var r=a.context,o=r.shape,s=r.labelTarget,u=r.labelTargetIndex;s&&(Qe(s.labels,o,u),o.labelTarget=s)})}se(vf,ie);vf.$inject=["injector","eventBus","modeling"];function _m(e){return ge(e,function(t){return e.indexOf(t.labelTarget)===-1})}const tR={__init__:["labelSupport"],labelSupport:["type",vf]};var nR=251,xm=1401,Sm="attach-ok";function gf(e,t,n,i,a){ie.call(this,t);var r=e.get("movePreview",!1);t.on("shape.move.start",xm,function(o){var s=o.context,u=s.shapes,c=s.validatedShapes;s.shapes=iR(u),s.validatedShapes=rR(c)}),r&&t.on("shape.move.start",nR,function(o){var s=o.context,u=s.shapes,c=Hc(u);B(c,function(p){r.makeDraggable(s,p,!0),B(p.labels,function(f){r.makeDraggable(s,f,!0)})})}),r&&t.on("shape.move.start",function(o){var s=o.context,u=s.shapes;if(u.length===1){var c=u[0],p=c.host;p&&(n.addMarker(p,Sm),t.once(["shape.move.out","shape.move.cleanup"],function(){n.removeMarker(p,Sm)}))}}),this.preExecuted("elements.move",xm,function(o){var s=o.context,u=s.closure,c=s.shapes,p=Hc(c);B(p,function(f){u.add(f,u.topLevel[f.host.id])})}),this.postExecuted("elements.move",function(o){var s=o.context,u=s.shapes,c=s.newHost,p;c&&u.length!==1||(c?p=u:p=ge(u,function(f){var m=f.host;return aR(f)&&!oR(u,m)}),B(p,function(f){a.updateAttachment(f,c)}))}),this.postExecuted("elements.move",function(o){var s=o.context.shapes;B(s,function(u){B(u.attachers,function(c){B(c.outgoing.slice(),function(p){var f=i.allowed("connection.reconnect",{connection:p,source:p.source,target:p.target});f||a.removeConnection(p)}),B(c.incoming.slice(),function(p){var f=i.allowed("connection.reconnect",{connection:p,source:p.source,target:p.target});f||a.removeConnection(p)})})})}),this.postExecute("shape.create",function(o){var s=o.context,u=s.shape,c=s.host;c&&a.updateAttachment(u,c)}),this.postExecute("shape.replace",function(o){var s=o.context,u=s.oldShape,c=s.newShape;Cr(u.attachers,function(p){var f=i.allowed("elements.move",{target:c,shapes:[p]});f==="attach"?a.updateAttachment(p,c):a.removeShape(p)}),c.attachers.length&&B(c.attachers,function(p){var f=fm(p,u,c);a.moveShape(p,f,p.parent)})}),this.postExecute("shape.resize",function(o){var s=o.context,u=s.shape,c=s.oldBounds,p=s.newBounds,f=u.attachers,m=s.hints||{};m.attachSupport!==!1&&B(f,function(v){var g=fm(v,c,p);a.moveShape(v,g,v.parent),B(v.labels,function(b){a.moveShape(b,g,b.parent)})})}),this.preExecute("shape.delete",function(o){var s=o.context.shape;Cr(s.attachers,function(u){a.removeShape(u)}),s.host&&a.updateAttachment(s,null)})}se(gf,ie);gf.$inject=["injector","eventBus","canvas","rules","modeling"];function Hc(e){return Ba(pt(e,function(t){return t.attachers||[]}))}function iR(e){var t=Hc(e);return Iv("id",e,t)}function rR(e){var t=er(e,"id");return ge(e,function(n){for(;n;){if(n.host&&t[n.host.id])return!1;n=n.parent}return!0})}function aR(e){return!!e.host}function oR(e,t){return e.indexOf(t)!==-1}const sR={__depends__:[Hn],__init__:["attachSupport"],attachSupport:["type",gf]};var lR=250;function sr(e,t){this._eventBus=e,this._dragging=t,this._tools=[],this._active=null}sr.$inject=["eventBus","dragging"];sr.prototype.registerTool=function(e,t){var n=this._tools;if(!t)throw new Error(`A tool has to be registered with it's "events"`);n.push(e),this.bindEvents(e,t)};sr.prototype.isActive=function(e){return e&&this._active===e};sr.prototype.length=function(e){return this._tools.length};sr.prototype.setActive=function(e){var t=this._eventBus;this._active!==e&&(this._active=e,t.fire("tool-manager.update",{tool:e}))};sr.prototype.bindEvents=function(e,t){var n=this._eventBus,i=this._dragging,a=[];n.on(t.tool+".init",function(r){var o=r.context;if(!o.reactivate&&this.isActive(e)){this.setActive(null),i.cancel();return}this.setActive(e)},this),B(t,function(r){a.push(r+".ended"),a.push(r+".canceled")}),n.on(a,lR,function(r){this._active&&(uR(r)||this.setActive(null))},this)};function uR(e){var t=e.originalEvent&&e.originalEvent.target;return t&&tr(t,'.group[data-group="tools"]')}const Fl={__depends__:[oi],__init__:["toolManager"],toolManager:["type",sr]};function cR(e,t){if(e==="x"){if(t>0)return"e";if(t<0)return"w"}if(e==="y"){if(t>0)return"s";if(t<0)return"n"}return null}function pR(e,t){var n=[];return B(e.concat(t),function(i){var a=i.incoming,r=i.outgoing;B(a.concat(r),function(o){var s=o.source,u=o.target;(wa(e,s)||wa(e,u)||wa(t,s)||wa(t,u))&&(wa(n,o)||n.push(o))})}),n}function wa(e,t){return e.indexOf(t)!==-1}function fR(e,t,n){var i=e.x,a=e.y,r=e.width,o=e.height,s=n.x,u=n.y;switch(t){case"n":return{x:i,y:a+u,width:r,height:o-u};case"s":return{x:i,y:a,width:r,height:o+u};case"w":return{x:i+s,y:a,width:r-s,height:o};case"e":return{x:i,y:a,width:r+s,height:o};default:throw new Error("unknown direction: "+t)}}var Hu=Math.abs,dR=Math.round,qn={x:"width",y:"height"},_E="crosshair",fs={n:"top",w:"left",s:"bottom",e:"right"},hR=1500,wm={n:"s",w:"e",s:"n",e:"w"},ds=20;function ui(e,t,n,i,a,r,o){this._canvas=e,this._dragging=t,this._eventBus=n,this._modeling=i,this._rules=a,this._toolManager=r,this._mouse=o;var s=this;r.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),n.on("spaceTool.selection.end",function(u){n.once("spaceTool.selection.ended",function(){s.activateMakeSpace(u.originalEvent)})}),n.on("spaceTool.move",hR,function(u){var c=u.context,p=c.initialized;p||(p=c.initialized=s.init(u,c)),p&&Cm(u)}),n.on("spaceTool.end",function(u){var c=u.context,p=c.axis,f=c.direction,m=c.movingShapes,v=c.resizingShapes,g=c.start;if(c.initialized){Cm(u);var b={x:0,y:0};b[p]=dR(u["d"+p]),s.makeSpace(m,v,b,f,g),n.once("spaceTool.ended",function(_){s.activateSelection(_.originalEvent,!0,!0)})}})}ui.$inject=["canvas","dragging","eventBus","modeling","rules","toolManager","mouse"];ui.prototype.activateSelection=function(e,t,n){this._dragging.init(e,"spaceTool.selection",{autoActivate:t,cursor:_E,data:{context:{reactivate:n}},trapClick:!1})};ui.prototype.activateMakeSpace=function(e){this._dragging.init(e,"spaceTool",{autoActivate:!0,cursor:_E,data:{context:{}}})};ui.prototype.makeSpace=function(e,t,n,i,a){return this._modeling.createSpace(e,t,n,i,a)};ui.prototype.init=function(e,t){var n=Hu(e.dx)>Hu(e.dy)?"x":"y",i=e["d"+n],a=e[n]-i;if(Hu(i)<5)return!1;i<0&&(i*=-1),Or(e)&&(i*=-1);var r=cR(n,i),o=this._canvas.getRootElement(),s=sl(o,!0),u=this.calculateAdjustments(s,n,i,a),c=this._eventBus.fire("spaceTool.getMinDimensions",{axis:n,direction:r,shapes:u.resizingShapes,start:a}),p=mR(u,n,r,a,c);return G(t,u,{axis:n,direction:r,spaceToolConstraints:p,start:a}),xl("resize-"+(n==="x"?"ew":"ns")),!0};ui.prototype.calculateAdjustments=function(e,t,n,i){var a=this._rules,r=[],o=[];return B(e,function(s){if(!(!s.parent||zc(s))){var u=s[t],c=u+s[qn[t]];if(n>0&&u>i||n<0&&c<i)return r.push(s);if(u<i&&c>i&&a.allowed("shape.resize",{shape:s}))return o.push(s)}}),{movingShapes:r,resizingShapes:o}};ui.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)};ui.prototype.isActive=function(){var e=this._dragging.context();return e&&/^spaceTool/.test(e.prefix)};function Tm(e){return{top:e.top-ds,right:e.right+ds,bottom:e.bottom+ds,left:e.left-ds}}function Cm(e){var t=e.context,n=t.spaceToolConstraints;if(n){var i,a;ve(n.left)&&(i=Math.max(e.x,n.left),e.dx=e.dx+i-e.x,e.x=i),ve(n.right)&&(i=Math.min(e.x,n.right),e.dx=e.dx+i-e.x,e.x=i),ve(n.top)&&(a=Math.max(e.y,n.top),e.dy=e.dy+a-e.y,e.y=a),ve(n.bottom)&&(a=Math.min(e.y,n.bottom),e.dy=e.dy+a-e.y,e.y=a)}}function mR(e,t,n,i,a){var r=e.movingShapes,o=e.resizingShapes;if(o.length){var s={},u,c;return B(o,function(p){var f=ce(p),m=ge(p.children,function(N){return!zc(N)&&!Am(N)&&!zu(r,N)&&!zu(o,N)}),v=ge(p.children,function(N){return!zc(N)&&!Am(N)&&zu(r,N)}),g,b,_;m.length&&(b=Tm(ce(xt(m))),g=i-f[fs[n]]+b[fs[n]],n==="n"?s.bottom=c=ve(c)?Math.min(c,g):g:n==="w"?s.right=c=ve(c)?Math.min(c,g):g:n==="s"?s.top=u=ve(u)?Math.max(u,g):g:n==="e"&&(s.left=u=ve(u)?Math.max(u,g):g)),v.length&&(_=Tm(ce(xt(v))),g=i-_[fs[wm[n]]]+f[fs[wm[n]]],n==="n"?s.bottom=c=ve(c)?Math.min(c,g):g:n==="w"?s.right=c=ve(c)?Math.min(c,g):g:n==="s"?s.top=u=ve(u)?Math.max(u,g):g:n==="e"&&(s.left=u=ve(u)?Math.max(u,g):g));var k=a&&a[p.id];k&&(n==="n"?(g=i+p[qn[t]]-k[qn[t]],s.bottom=c=ve(c)?Math.min(c,g):g):n==="w"?(g=i+p[qn[t]]-k[qn[t]],s.right=c=ve(c)?Math.min(c,g):g):n==="s"?(g=i-p[qn[t]]+k[qn[t]],s.top=u=ve(u)?Math.max(u,g):g):n==="e"&&(g=i-p[qn[t]]+k[qn[t]],s.left=u=ve(u)?Math.max(u,g):g))}),s}}function zu(e,t){return e.indexOf(t)!==-1}function zc(e){return!!e.waypoints}function Am(e){return!!e.labelTarget}var Gu="djs-dragging",Pm="djs-resizing",vR=250,hs=Math.max;function xE(e,t,n,i,a){function r(o,s){B(o,function(u){a.addDragger(u,s),n.addMarker(u,Gu)})}e.on("spaceTool.selection.start",function(o){var s=n.getLayer("space"),u=o.context,c={x:"M 0,-10000 L 0,10000",y:"M -10000,0 L 10000,0"},p=le("g");ee(p,i.cls("djs-crosshair-group",["no-events"])),fe(s,p);var f=le("path");ee(f,"d",c.x),Se(f).add("djs-crosshair"),fe(p,f);var m=le("path");ee(m,"d",c.y),Se(m).add("djs-crosshair"),fe(p,m),u.crosshairGroup=p}),e.on("spaceTool.selection.move",function(o){var s=o.context.crosshairGroup;Ft(s,o.x,o.y)}),e.on("spaceTool.selection.cleanup",function(o){var s=o.context,u=s.crosshairGroup;u&&tt(u)}),e.on("spaceTool.move",vR,function(o){var s=o.context,u=s.line,c=s.axis,p=s.movingShapes,f=s.resizingShapes;if(s.initialized){if(!s.dragGroup){var m=n.getLayer("space");u=le("path"),ee(u,"d","M0,0 L0,0"),Se(u).add("djs-crosshair"),fe(m,u),s.line=u;var v=le("g");ee(v,i.cls("djs-drag-group",["no-events"])),fe(n.getActiveLayer(),v),r(p,v);var g=s.movingConnections=t.filter(function(S){var C=!1;B(p,function(V){B(V.outgoing,function(K){S===K&&(C=!0)})});var D=!1;B(p,function(V){B(V.incoming,function(K){S===K&&(D=!0)})});var $=!1;B(f,function(V){B(V.outgoing,function(K){S===K&&($=!0)})});var M=!1;return B(f,function(V){B(V.incoming,function(K){S===K&&(M=!0)})}),gR(S)&&(C||$)&&(D||M)});r(g,v),s.dragGroup=v}if(!s.frameGroup){var b=le("g");ee(b,i.cls("djs-frame-group",["no-events"])),fe(n.getActiveLayer(),b);var _=[];B(f,function(S){var C=a.addFrame(S,b),D=C.getBBox();_.push({element:C,initialBounds:D}),n.addMarker(S,Pm)}),s.frameGroup=b,s.frames=_}var k={x:"M"+o.x+", -10000 L"+o.x+", 10000",y:"M -10000, "+o.y+" L 10000, "+o.y};ee(u,{d:k[c]});var N={x:"y",y:"x"},A={x:o.dx,y:o.dy};A[N[s.axis]]=0,Ft(s.dragGroup,A.x,A.y),B(s.frames,function(S){var C=S.element,D=S.initialBounds,$,M;s.direction==="e"?ee(C,{width:hs(D.width+A.x,5)}):($=hs(D.width-A.x,5),ee(C,{width:$,x:D.x+D.width-$})),s.direction==="s"?ee(C,{height:hs(D.height+A.y,5)}):(M=hs(D.height-A.y,5),ee(C,{height:M,y:D.y+D.height-M}))})}}),e.on("spaceTool.cleanup",function(o){var s=o.context,u=s.movingShapes,c=s.movingConnections,p=s.resizingShapes,f=s.line,m=s.dragGroup,v=s.frameGroup;B(u,function(g){n.removeMarker(g,Gu)}),B(c,function(g){n.removeMarker(g,Gu)}),m&&(tt(f),tt(m)),B(p,function(g){n.removeMarker(g,Pm)}),v&&tt(v)})}xE.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];function gR(e){return e.waypoints}const SE={__init__:["spaceToolPreview"],__depends__:[oi,Hn,Fl,ao,so],spaceTool:["type",ui],spaceToolPreview:["type",xE]};function gn(e){this._model=e}gn.$inject=["moddle"];gn.prototype._needsId=function(e){return Pe(e,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])};gn.prototype._ensureId=function(e){var t;w(e,"bpmn:Activity")?t="Activity":w(e,"bpmn:Event")?t="Event":w(e,"bpmn:Gateway")?t="Gateway":Pe(e,["bpmn:SequenceFlow","bpmn:MessageFlow"])?t="Flow":t=(e.$type||"").replace(/^[^:]*:/g,""),t+="_",!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))};gn.prototype.create=function(e,t){var n=this._model.create(e,t||{});return this._ensureId(n),n};gn.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})};gn.prototype.createDiShape=function(e,t,n){return this.create("bpmndi:BPMNShape",G({bpmnElement:e,bounds:this.createDiBounds(t)},n))};gn.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)};gn.prototype.createDiWaypoints=function(e){var t=this;return pt(e,function(n){return t.createDiWaypoint(n)})};gn.prototype.createDiWaypoint=function(e){return this.create("dc:Point",cn(e,["x","y"]))};gn.prototype.createDiEdge=function(e,t,n){return this.create("bpmndi:BPMNEdge",G({bpmnElement:e,waypoint:this.createDiWaypoints(t)},n))};gn.prototype.createDiPlane=function(e){return this.create("bpmndi:BPMNPlane",{bpmnElement:e})};function Gt(e,t,n,i){ie.call(this,e),this._bpmnFactory=t,this._translate=i;var a=this;function r(v){var g=v.context,b=g.hints||{},_;!g.cropped&&b.createElementsBehavior!==!1&&(_=g.connection,_.waypoints=n.getCroppedWaypoints(_),g.cropped=!0)}this.executed(["connection.layout","connection.create"],r),this.reverted(["connection.layout"],function(v){delete v.context.cropped});function o(v){var g=v.context;a.updateParent(g.shape||g.connection,g.oldParent)}function s(v){var g=v.context,b=g.shape||g.connection,_=g.parent||g.newParent;a.updateParent(b,_)}this.executed(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],tn(o)),this.reverted(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],tn(s));function u(v){var g=v.context,b=g.oldRoot,_=b.children;B(_,function(k){w(k,"bpmn:BaseElement")&&a.updateParent(k)})}this.executed(["canvas.updateRoot"],u),this.reverted(["canvas.updateRoot"],u);function c(v){var g=v.context.shape;w(g,"bpmn:BaseElement")&&a.updateBounds(g)}this.executed(["shape.move","shape.create","shape.resize"],tn(function(v){v.context.shape.type!=="label"&&c(v)})),this.reverted(["shape.move","shape.create","shape.resize"],tn(function(v){v.context.shape.type!=="label"&&c(v)})),e.on("shape.changed",function(v){v.element.type==="label"&&c({context:{shape:v.element}})});function p(v){a.updateConnection(v.context)}this.executed(["connection.create","connection.move","connection.delete","connection.reconnect"],tn(p)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnect"],tn(p));function f(v){a.updateConnectionWaypoints(v.context.connection)}this.executed(["connection.layout","connection.move","connection.updateWaypoints"],tn(f)),this.reverted(["connection.layout","connection.move","connection.updateWaypoints"],tn(f)),this.executed("connection.reconnect",tn(function(v){var g=v.context,b=g.connection,_=g.oldSource,k=g.newSource,N=oe(b),A=oe(_),S=oe(k);N.conditionExpression&&!Pe(S,["bpmn:Activity","bpmn:ExclusiveGateway","bpmn:InclusiveGateway"])&&(g.oldConditionExpression=N.conditionExpression,delete N.conditionExpression),_!==k&&A.default===N&&(g.oldDefault=A.default,delete A.default)})),this.reverted("connection.reconnect",tn(function(v){var g=v.context,b=g.connection,_=g.oldSource,k=g.newSource,N=oe(b),A=oe(_),S=oe(k);g.oldConditionExpression&&(N.conditionExpression=g.oldConditionExpression),g.oldDefault&&(A.default=g.oldDefault,delete S.default)}));function m(v){a.updateAttachment(v.context)}this.executed(["element.updateAttachment"],tn(m)),this.reverted(["element.updateAttachment"],tn(m))}se(Gt,ie);Gt.$inject=["eventBus","bpmnFactory","connectionDocking","translate"];Gt.prototype.updateAttachment=function(e){var t=e.shape,n=t.businessObject,i=t.host;n.attachedToRef=i&&i.businessObject};Gt.prototype.updateParent=function(e,t){if(!(e instanceof ul)&&!(w(e,"bpmn:DataStoreReference")&&e.parent&&w(e.parent,"bpmn:Collaboration"))){var n=e.parent,i=e.businessObject,a=n&&n.businessObject,r=a&&a.di;w(e,"bpmn:FlowNode")&&this.updateFlowNodeRefs(i,a,t&&t.businessObject),w(e,"bpmn:DataOutputAssociation")&&(e.source?a=e.source.businessObject:a=null),w(e,"bpmn:DataInputAssociation")&&(e.target?a=e.target.businessObject:a=null),this.updateSemanticParent(i,a),w(e,"bpmn:DataObjectReference")&&i.dataObjectRef&&this.updateSemanticParent(i.dataObjectRef,a),this.updateDiParent(i.di,r)}};Gt.prototype.updateBounds=function(e){var t=e.businessObject.di,n=e instanceof ul?this._getLabel(t):t,i=n.bounds;i||(i=this._bpmnFactory.createDiBounds(),n.set("bounds",i)),G(i,{x:e.x,y:e.y,width:e.width,height:e.height})};Gt.prototype.updateFlowNodeRefs=function(e,t,n){if(n!==t){var i,a;w(n,"bpmn:Lane")&&(i=n.get("flowNodeRef"),Je(i,e)),w(t,"bpmn:Lane")&&(a=t.get("flowNodeRef"),Qe(a,e))}};Gt.prototype.updateDiConnection=function(e,t,n){e.sourceElement&&e.sourceElement.bpmnElement!==t&&(e.sourceElement=t&&t.di),e.targetElement&&e.targetElement.bpmnElement!==n&&(e.targetElement=n&&n.di)};Gt.prototype.updateDiParent=function(e,t){if(t&&!w(t,"bpmndi:BPMNPlane")&&(t=t.$parent),e.$parent!==t){var n=(t||e.$parent).get("planeElement");t?(n.push(e),e.$parent=t):(Je(n,e),e.$parent=null)}};function yR(e){for(;e&&!w(e,"bpmn:Definitions");)e=e.$parent;return e}Gt.prototype.getLaneSet=function(e){var t,n;return w(e,"bpmn:Lane")?(t=e.childLaneSet,t||(t=this._bpmnFactory.create("bpmn:LaneSet"),e.childLaneSet=t,t.$parent=e),t):(w(e,"bpmn:Participant")&&(e=e.processRef),n=e.get("laneSets"),t=n[0],t||(t=this._bpmnFactory.create("bpmn:LaneSet"),t.$parent=e,n.push(t)),t)};Gt.prototype.updateSemanticParent=function(e,t,n){var i,a=this._translate;if(e.$parent!==t&&!((w(e,"bpmn:DataInput")||w(e,"bpmn:DataOutput"))&&(w(t,"bpmn:Participant")&&"processRef"in t&&(t=t.processRef),"ioSpecification"in t&&t.ioSpecification===e.$parent))){if(w(e,"bpmn:Lane"))t&&(t=this.getLaneSet(t)),i="lanes";else if(w(e,"bpmn:FlowElement")){if(t){if(w(t,"bpmn:Participant"))t=t.processRef;else if(w(t,"bpmn:Lane"))do t=t.$parent.$parent;while(w(t,"bpmn:Lane"))}i="flowElements"}else if(w(e,"bpmn:Artifact")){for(;t&&!w(t,"bpmn:Process")&&!w(t,"bpmn:SubProcess")&&!w(t,"bpmn:Collaboration");)if(w(t,"bpmn:Participant")){t=t.processRef;break}else t=t.$parent;i="artifacts"}else if(w(e,"bpmn:MessageFlow"))i="messageFlows";else if(w(e,"bpmn:Participant")){i="participants";var r=e.processRef,o;r&&(o=yR(e.$parent||t),e.$parent&&(Je(o.get("rootElements"),r),r.$parent=null),t&&(Qe(o.get("rootElements"),r),r.$parent=o))}else w(e,"bpmn:DataOutputAssociation")?i="dataOutputAssociations":w(e,"bpmn:DataInputAssociation")&&(i="dataInputAssociations");if(!i)throw new Error(a("no parent for {element} in {parent}",{element:e.id,parent:t.id}));var s;if(e.$parent&&(s=e.$parent.get(i),Je(s,e)),t?(s=t.get(i),s.push(e),e.$parent=t):e.$parent=null,n){var u=n.get(i);Je(s,e),t&&(u||(u=[],t.set(i,u)),u.push(e))}}};Gt.prototype.updateConnectionWaypoints=function(e){e.businessObject.di.set("waypoint",this._bpmnFactory.createDiWaypoints(e.waypoints))};Gt.prototype.updateConnection=function(e){var t=e.connection,n=oe(t),i=oe(t.source),a=oe(t.target),r;if(w(n,"bpmn:DataAssociation"))w(n,"bpmn:DataInputAssociation")?(n.get("sourceRef")[0]=i,r=e.parent||e.newParent||a,this.updateSemanticParent(n,a,r)):w(n,"bpmn:DataOutputAssociation")&&(r=e.parent||e.newParent||i,this.updateSemanticParent(n,i,r),n.targetRef=a);else{var o=w(n,"bpmn:SequenceFlow");n.sourceRef!==i&&(o&&(Je(n.sourceRef&&n.sourceRef.get("outgoing"),n),i&&i.get("outgoing")&&i.get("outgoing").push(n)),n.sourceRef=i),n.targetRef!==a&&(o&&(Je(n.targetRef&&n.targetRef.get("incoming"),n),a&&a.get("incoming")&&a.get("incoming").push(n)),n.targetRef=a)}this.updateConnectionWaypoints(t),this.updateDiConnection(n.di,i,a)};Gt.prototype._getLabel=function(e){return e.label||(e.label=this._bpmnFactory.createDiLabel()),e.label};function tn(e){return function(t){var n=t.context,i=n.shape||n.connection;w(i,"bpmn:BaseElement")&&e(t)}}function Ni(e,t,n){ni.call(this),this._bpmnFactory=e,this._moddle=t,this._translate=n}se(Ni,ni);Ni.$inject=["bpmnFactory","moddle","translate"];Ni.prototype.baseCreate=ni.prototype.create;Ni.prototype.create=function(e,t){return e==="label"?this.baseCreate(e,G({type:"label"},ja,t)):this.createBpmnElement(e,t)};Ni.prototype.createBpmnElement=function(e,t){var n,i=this._translate;t=t||{};var a=t.businessObject;if(!a){if(!t.type)throw new Error(i("no shape type specified"));a=this._bpmnFactory.create(t.type)}a.di||(e==="root"?a.di=this._bpmnFactory.createDiPlane(a,[],{id:a.id+"_di"}):e==="connection"?a.di=this._bpmnFactory.createDiEdge(a,[],{id:a.id+"_di"}):a.di=this._bpmnFactory.createDiShape(a,{},{id:a.id+"_di"})),w(a,"bpmn:Group")&&(t=G({isFrame:!0},t)),t.di&&(G(a.di,t.di),delete t.di),ER(a,t,["processRef","isInterrupting","associationDirection","isForCompensation"]),t.isExpanded&&wE(a.di,t,"isExpanded"),w(a,"bpmn:ExclusiveGateway")&&(a.di.isMarkerVisible=!0);var r,o;return t.eventDefinitionType&&(r=a.get("eventDefinitions")||[],o=this._bpmnFactory.create(t.eventDefinitionType,t.eventDefinitionAttrs),t.eventDefinitionType==="bpmn:ConditionalEventDefinition"&&(o.condition=this._bpmnFactory.create("bpmn:FormalExpression")),r.push(o),o.$parent=a,a.eventDefinitions=r,delete t.eventDefinitionType),n=this._getDefaultSize(a),t=G({businessObject:a,id:a.id},n,t),this.baseCreate(e,t)};Ni.prototype._getDefaultSize=function(e){return w(e,"bpmn:SubProcess")?Le(e)?{width:350,height:200}:{width:100,height:80}:w(e,"bpmn:Task")?{width:100,height:80}:w(e,"bpmn:Gateway")?{width:50,height:50}:w(e,"bpmn:Event")?{width:36,height:36}:w(e,"bpmn:Participant")?Le(e)?{width:600,height:250}:{width:400,height:60}:w(e,"bpmn:Lane")?{width:400,height:100}:w(e,"bpmn:DataObjectReference")?{width:36,height:50}:w(e,"bpmn:DataStoreReference")?{width:50,height:50}:w(e,"bpmn:TextAnnotation")?{width:100,height:30}:w(e,"bpmn:Group")?{width:300,height:300}:{width:100,height:80}};Ni.prototype.createParticipantShape=function(e){return nt(e)||(e={isExpanded:e}),e=G({type:"bpmn:Participant"},e||{}),e.isExpanded!==!1&&(e.processRef=this._bpmnFactory.create("bpmn:Process")),this.createShape(e)};function ER(e,t,n){B(n,function(i){t[i]!==void 0&&wE(e,t,i)})}function wE(e,t,n){e[n]=t[n],delete t[n]}function jl(e,t){this._modeling=e,this._canvas=t}jl.$inject=["modeling","canvas"];jl.prototype.preExecute=function(e){var t=this._modeling,n=e.elements,i=e.alignment;B(n,function(a){var r={x:0,y:0};i.left?r.x=i.left-a.x:i.right?r.x=i.right-a.width-a.x:i.center?r.x=i.center-Math.round(a.width/2)-a.x:i.top?r.y=i.top-a.y:i.bottom?r.y=i.bottom-a.height-a.y:i.middle&&(r.y=i.middle-Math.round(a.height/2)-a.y),t.moveElements([a],r,a.parent)})};jl.prototype.postExecute=function(e){};function Hl(e){this._modeling=e}Hl.$inject=["modeling"];Hl.prototype.preExecute=function(e){var t=e.source;if(!t)throw new Error("source required");var n=e.target||t.parent,i=e.shape,a=e.hints||{};i=e.shape=this._modeling.createShape(i,e.position,n,{attach:a.attach}),e.shape=i};Hl.prototype.postExecute=function(e){var t=e.hints||{};bR(e.source,e.shape)||(t.connectionTarget===e.source?this._modeling.connect(e.shape,e.source,e.connection):this._modeling.connect(e.source,e.shape,e.connection))};function bR(e,t){return wi(e.outgoing,function(n){return n.target===t})}function zl(e,t){this._canvas=e,this._layouter=t}zl.$inject=["canvas","layouter"];zl.prototype.execute=function(e){var t=e.connection,n=e.source,i=e.target,a=e.parent,r=e.parentIndex,o=e.hints;if(!n||!i)throw new Error("source and target required");if(!a)throw new Error("parent required");return t.source=n,t.target=i,t.waypoints||(t.waypoints=this._layouter.layoutConnection(t,o)),this._canvas.addConnection(t,a,r),t};zl.prototype.revert=function(e){var t=e.connection;return this._canvas.removeConnection(t),t.source=null,t.target=null,t};var ms=Math.round;function yf(e){this._modeling=e}yf.$inject=["modeling"];yf.prototype.preExecute=function(e){var t=e.elements,n=e.parent,i=e.parentIndex,a=e.position,r=e.hints,o=this._modeling;B(t,function(p){ve(p.x)||(p.x=0),ve(p.y)||(p.y=0)});var s=xt(t);B(t,function(p){Rm(p)&&(p.waypoints=pt(p.waypoints,function(f){return{x:ms(f.x-s.x-s.width/2+a.x),y:ms(f.y-s.y-s.height/2+a.y)}})),G(p,{x:ms(p.x-s.x-s.width/2+a.x),y:ms(p.y-s.y-s.height/2+a.y)})});var u=zv(t),c={};B(t,function(p){if(Rm(p)){c[p.id]=ve(i)?o.createConnection(c[p.source.id],c[p.target.id],i,p,p.parent||n,r):o.createConnection(c[p.source.id],c[p.target.id],p,p.parent||n,r);return}var f=G({},r);u.indexOf(p)===-1&&(f.autoResize=!1),c[p.id]=ve(i)?o.createShape(p,cn(p,["x","y","width","height"]),p.parent||n,i,f):o.createShape(p,cn(p,["x","y","width","height"]),p.parent||n,f)}),e.elements=al(c)};function Rm(e){return!!e.waypoints}var Im=Math.round;function Mi(e){this._canvas=e}Mi.$inject=["canvas"];Mi.prototype.execute=function(e){var t=e.shape,n=e.position,i=e.parent,a=e.parentIndex;if(!i)throw new Error("parent required");if(!n)throw new Error("position required");return n.width!==void 0?G(t,n):G(t,{x:n.x-Im(t.width/2),y:n.y-Im(t.height/2)}),this._canvas.addShape(t,i,a),t};Mi.prototype.revert=function(e){var t=e.shape;return this._canvas.removeShape(t),t};function ho(e){Mi.call(this,e)}se(ho,Mi);ho.$inject=["canvas"];var _R=Mi.prototype.execute;ho.prototype.execute=function(e){var t=e.shape;return SR(t),t.labelTarget=e.labelTarget,_R.call(this,e)};var xR=Mi.prototype.revert;ho.prototype.revert=function(e){return e.shape.labelTarget=null,xR.call(this,e)};function SR(e){["width","height"].forEach(function(t){typeof e[t]=="undefined"&&(e[t]=0)})}function Gl(e,t){this._canvas=e,this._modeling=t}Gl.$inject=["canvas","modeling"];Gl.prototype.execute=function(e){var t=e.connection,n=t.parent;return e.parent=n,e.parentIndex=op(n.children,t),e.source=t.source,e.target=t.target,this._canvas.removeConnection(t),t.source=null,t.target=null,t};Gl.prototype.revert=function(e){var t=e.connection,n=e.parent,i=e.parentIndex;return t.source=e.source,t.target=e.target,Qe(n.children,t,i),this._canvas.addConnection(t,n),t};function Ef(e,t){this._modeling=e,this._elementRegistry=t}Ef.$inject=["modeling","elementRegistry"];Ef.prototype.postExecute=function(e){var t=this._modeling,n=this._elementRegistry,i=e.elements;B(i,function(a){n.get(a.id)&&(a.waypoints?t.removeConnection(a):t.removeShape(a))})};function mo(e,t){this._canvas=e,this._modeling=t}mo.$inject=["canvas","modeling"];mo.prototype.preExecute=function(e){var t=this._modeling,n=e.shape;Cr(n.incoming,function(i){t.removeConnection(i,{nested:!0})}),Cr(n.outgoing,function(i){t.removeConnection(i,{nested:!0})}),Cr(n.children,function(i){wR(i)?t.removeConnection(i,{nested:!0}):t.removeShape(i,{nested:!0})})};mo.prototype.execute=function(e){var t=this._canvas,n=e.shape,i=n.parent;return e.oldParent=i,e.oldParentIndex=op(i.children,n),t.removeShape(n),n};mo.prototype.revert=function(e){var t=this._canvas,n=e.shape,i=e.oldParent,a=e.oldParentIndex;return Qe(i.children,n,a),t.addShape(n,i),n};function wR(e){return e.waypoints}function Ul(e){this._modeling=e}Ul.$inject=["modeling"];var Nm={x:"y",y:"x"};Ul.prototype.preExecute=function(e){var t=this._modeling,n=e.groups,i=e.axis,a=e.dimension;function r(_,k){_.range.min=Math.min(k[i],_.range.min),_.range.max=Math.max(k[i]+k[a],_.range.max)}function o(_){return _[i]+_[a]/2}function s(_){return _.length-1}function u(_){return _.max-_.min}function c(_,k){var N={y:0};N[i]=_-o(k),N[i]&&(N[Nm[i]]=0,t.moveElements([k],N,k.parent))}var p=n[0],f=s(n),m=n[f],v,g,b=0;B(n,function(_,k){var N,A,S;if(_.elements.length<2){k&&k!==n.length-1&&(r(_,_.elements[0]),b+=u(_.range));return}N=un(_.elements,i),A=N[0],k===f&&(A=N[s(N)]),S=o(A),_.range=null,B(N,function(C){if(c(S,C),_.range===null){_.range={min:C[i],max:C[i]+C[a]};return}r(_,C)}),k&&k!==n.length-1&&(b+=u(_.range))}),g=Math.abs(m.range.min-p.range.max),v=Math.round((g-b)/(n.length-1)),!(v<n.length-1)&&B(n,function(_,k){var N={},A;_===p||_===m||(A=n[k-1],_.range.max=0,B(_.elements,function(S,C){N[Nm[i]]=0,N[i]=A.range.max-S[i]+v,_.range.min!==S[i]&&(N[i]+=S[i]-_.range.min),N[i]&&t.moveElements([S],N,S.parent),_.range.max=Math.max(S[i]+S[a],C?_.range.max:0)}))})};Ul.prototype.postExecute=function(e){};function Wl(e,t){this._layouter=e,this._canvas=t}Wl.$inject=["layouter","canvas"];Wl.prototype.execute=function(e){var t=e.connection,n=t.waypoints;return G(e,{oldWaypoints:n}),t.waypoints=this._layouter.layoutConnection(t,e.hints),t};Wl.prototype.revert=function(e){var t=e.connection;return t.waypoints=e.oldWaypoints,t};function bf(){}bf.prototype.execute=function(e){var t=e.connection,n=e.delta,i=e.newParent||t.parent,a=e.newParentIndex,r=t.parent;return e.oldParent=r,e.oldParentIndex=Je(r.children,t),Qe(i.children,t,a),t.parent=i,B(t.waypoints,function(o){o.x+=n.x,o.y+=n.y,o.original&&(o.original.x+=n.x,o.original.y+=n.y)}),t};bf.prototype.revert=function(e){var t=e.connection,n=t.parent,i=e.oldParent,a=e.oldParentIndex,r=e.delta;return Je(n.children,t),Qe(i.children,t,a),t.parent=i,B(t.waypoints,function(o){o.x-=r.x,o.y-=r.y,o.original&&(o.original.x-=r.x,o.original.y-=r.y)}),t};function _f(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}_f.prototype.add=function(e,t){return this.addAll([e],t)};_f.prototype.addAll=function(e,t){var n=xx(e,!!t,this);return G(this,n),this};function vo(e){this._modeling=e}vo.prototype.moveRecursive=function(e,t,n){return e?this.moveClosure(this.getClosure(e),t,n):[]};vo.prototype.moveClosure=function(e,t,n,i,a){var r=this._modeling,o=e.allShapes,s=e.allConnections,u=e.enclosedConnections,c=e.topLevel,p=!1;a&&a.parent===n&&(p=!0),B(o,function(f){r.moveShape(f,t,c[f.id]&&!p&&n,{recurse:!1,layout:!1})}),B(s,function(f){var m=!!o[f.source.id],v=!!o[f.target.id];u[f.id]&&m&&v?r.moveConnection(f,t,c[f.id]&&!p&&n):r.layoutConnection(f,{connectionStart:m&&Qp(f,f.source,t),connectionEnd:v&&ef(f,f.target,t)})})};vo.prototype.getClosure=function(e){return new _f().addAll(e,!0)};function ql(e){this._helper=new vo(e)}ql.$inject=["modeling"];ql.prototype.preExecute=function(e){e.closure=this._helper.getClosure(e.shapes)};ql.prototype.postExecute=function(e){var t=e.hints,n;t&&t.primaryShape&&(n=t.primaryShape,t.oldParent=n.parent),this._helper.moveClosure(e.closure,e.delta,e.newParent,e.newHost,n)};function lr(e){this._modeling=e,this._helper=new vo(e)}lr.$inject=["modeling"];lr.prototype.execute=function(e){var t=e.shape,n=e.delta,i=e.newParent||t.parent,a=e.newParentIndex,r=t.parent;return e.oldBounds=cn(t,["x","y","width","height"]),e.oldParent=r,e.oldParentIndex=Je(r.children,t),Qe(i.children,t,a),G(t,{parent:i,x:t.x+n.x,y:t.y+n.y}),t};lr.prototype.postExecute=function(e){var t=e.shape,n=e.delta,i=e.hints,a=this._modeling;i.layout!==!1&&(B(t.incoming,function(r){a.layoutConnection(r,{connectionEnd:ef(r,t,n)})}),B(t.outgoing,function(r){a.layoutConnection(r,{connectionStart:Qp(r,t,n)})})),i.recurse!==!1&&this.moveChildren(e)};lr.prototype.revert=function(e){var t=e.shape,n=e.oldParent,i=e.oldParentIndex,a=e.delta;return Qe(n.children,t,i),G(t,{parent:n,x:t.x-a.x,y:t.y-a.y}),t};lr.prototype.moveChildren=function(e){var t=e.delta,n=e.shape;this._helper.moveRecursive(n.children,t,null)};lr.prototype.getNewParent=function(e){return e.newParent||e.shape.parent};function go(e){this._modeling=e}go.$inject=["modeling"];go.prototype.execute=function(e){var t=e.newSource,n=e.newTarget,i=e.connection,a=e.dockingOrPoints;if(!t&&!n)throw new Error("newSource or newTarget required");return xe(a)&&(e.oldWaypoints=i.waypoints,i.waypoints=a),t&&(e.oldSource=i.source,i.source=t),n&&(e.oldTarget=i.target,i.target=n),i};go.prototype.postExecute=function(e){var t=e.connection,n=e.newSource,i=e.newTarget,a=e.dockingOrPoints,r=e.hints||{},o={};r.connectionStart&&(o.connectionStart=r.connectionStart),r.connectionEnd&&(o.connectionEnd=r.connectionEnd),r.layoutConnection!==!1&&(n&&(!i||r.docking==="source")&&(o.connectionStart=o.connectionStart||Mm(xe(a)?a[0]:a)),i&&(!n||r.docking==="target")&&(o.connectionEnd=o.connectionEnd||Mm(xe(a)?a[a.length-1]:a)),r.newWaypoints&&(o.waypoints=r.newWaypoints),this._modeling.layoutConnection(t,o))};go.prototype.revert=function(e){var t=e.oldSource,n=e.oldTarget,i=e.oldWaypoints,a=e.connection;return t&&(a.source=t),n&&(a.target=n),i&&(a.waypoints=i),a};function Mm(e){return e.original||e}function ci(e,t){this._modeling=e,this._rules=t}ci.$inject=["modeling","rules"];ci.prototype.preExecute=function(e){var t=this,n=this._modeling,i=this._rules,a=e.oldShape,r=e.newData,o=e.hints||{},s;function u(g,b,_){return i.allowed("connection.reconnect",{connection:_,source:g,target:b})}var c={x:r.x,y:r.y},p={x:a.x,y:a.y,width:a.width,height:a.height};s=e.newShape=e.newShape||t.createShape(r,c,a.parent,o),a.host&&n.updateAttachment(s,a.host);var f;o.moveChildren!==!1&&(f=a.children.slice(),n.moveElements(f,{x:0,y:0},s,o));var m=a.incoming.slice(),v=a.outgoing.slice();B(m,function(g){var b=g.source,_=u(b,s,g);_&&t.reconnectEnd(g,s,Ll(g,s,p),o)}),B(v,function(g){var b=g.target,_=u(s,b,g);_&&t.reconnectStart(g,s,Ol(g,s,p),o)})};ci.prototype.postExecute=function(e){var t=e.oldShape;this._modeling.removeShape(t)};ci.prototype.execute=function(e){};ci.prototype.revert=function(e){};ci.prototype.createShape=function(e,t,n,i){return this._modeling.createShape(e,t,n,i)};ci.prototype.reconnectStart=function(e,t,n,i){this._modeling.reconnectStart(e,t,n,i)};ci.prototype.reconnectEnd=function(e,t,n,i){this._modeling.reconnectEnd(e,t,n,i)};function yo(e){this._modeling=e}yo.$inject=["modeling"];yo.prototype.execute=function(e){var t=e.shape,n=e.newBounds,i=e.minBounds;if(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)throw new Error("newBounds must have {x, y, width, height} properties");if(i&&(n.width<i.width||n.height<i.height))throw new Error("width and height cannot be less than minimum height and width");if(!i&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return e.oldBounds={width:t.width,height:t.height,x:t.x,y:t.y},G(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};yo.prototype.postExecute=function(e){var t=this._modeling,n=e.shape,i=e.oldBounds,a=e.hints||{};a.layout!==!1&&(B(n.incoming,function(r){t.layoutConnection(r,{connectionEnd:Ll(r,n,i)})}),B(n.outgoing,function(r){t.layoutConnection(r,{connectionStart:Ol(r,n,i)})}))};yo.prototype.revert=function(e){var t=e.shape,n=e.oldBounds;return G(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};function ki(e){this._modeling=e}ki.$inject=["modeling"];ki.prototype.preExecute=function(e){var t=e.delta,n=e.direction,i=e.movingShapes,a=e.resizingShapes,r=e.start,o={};this.moveShapes(i,t),B(a,function(s){o[s.id]=CR(s)}),this.resizeShapes(a,t,n),this.updateConnectionWaypoints(pR(i,a),t,n,r,i,a,o)};ki.prototype.execute=function(){};ki.prototype.revert=function(){};ki.prototype.moveShapes=function(e,t){var n=this;B(e,function(i){n._modeling.moveShape(i,t,null,{autoResize:!1,layout:!1,recurse:!1})})};ki.prototype.resizeShapes=function(e,t,n){var i=this;B(e,function(a){var r=fR(a,n,t);i._modeling.resizeShape(a,r,null,{attachSupport:!1,autoResize:!1,layout:!1})})};ki.prototype.updateConnectionWaypoints=function(e,t,n,i,a,r,o){var s=this,u=a.concat(r);B(e,function(c){var p=c.source,f=c.target,m=TR(c),v=TE(n),g={labelBehavior:!1};hi(u,p)&&hi(u,f)?(m=pt(m,function(b){return Dm(b,i,n)&&(b[v]=b[v]+t[v]),b.original&&Dm(b.original,i,n)&&(b.original[v]=b.original[v]+t[v]),b}),s._modeling.updateWaypoints(c,m,{labelBehavior:!1})):(hi(u,p)||hi(u,f))&&(hi(a,p)?g.connectionStart=Qp(c,p,t):hi(a,f)?g.connectionEnd=ef(c,f,t):hi(r,p)?g.connectionStart=Ol(c,p,o[p.id]):hi(r,f)&&(g.connectionEnd=Ll(c,f,o[f.id])),s._modeling.layoutConnection(c,g))})};function km(e){return G({},e)}function TR(e){return pt(e.waypoints,function(t){return t=km(t),t.original&&(t.original=km(t.original)),t})}function TE(e){switch(e){case"n":return"y";case"w":return"x";case"s":return"y";case"e":return"x"}}function Dm(e,t,n){var i=TE(n);if(/e|s/.test(n))return e[i]>t;if(/n|w/.test(n))return e[i]<t}function hi(e,t){return e.indexOf(t)!==-1}function CR(e){return{x:e.x,y:e.y,height:e.height,width:e.width}}function Yl(e){this._modeling=e}Yl.$inject=["modeling"];Yl.prototype.execute=function(e){var t=e.shape,n=t.children;e.oldChildrenVisibility=CE(n),t.collapsed=!t.collapsed;var i=AE(n,t.collapsed);return[t].concat(i)};Yl.prototype.revert=function(e){var t=e.shape,n=e.oldChildrenVisibility,i=t.children,a=PE(i,n);return t.collapsed=!t.collapsed,[t].concat(a)};function CE(e){var t={};return B(e,function(n){t[n.id]=n.hidden,n.children&&(t=G({},t,CE(n.children)))}),t}function AE(e,t){var n=[];return B(e,function(i){i.hidden=t,n=n.concat(i),i.children&&(n=n.concat(AE(i.children,i.collapsed||t)))}),n}function PE(e,t){var n=[];return B(e,function(i){i.hidden=t[i.id],n=n.concat(i),i.children&&(n=n.concat(PE(i.children,t)))}),n}function Kl(e){this._modeling=e}Kl.$inject=["modeling"];Kl.prototype.execute=function(e){var t=e.shape,n=e.newHost,i=t.host;return e.oldHost=i,e.attacherIdx=RE(i,t),IE(n,t),t.host=n,t};Kl.prototype.revert=function(e){var t=e.shape,n=e.newHost,i=e.oldHost,a=e.attacherIdx;return t.host=i,RE(n,t),IE(i,t,a),t};function RE(e,t){return Je(e&&e.attachers,t)}function IE(e,t,n){if(e){var i=e.attachers;i||(e.attachers=i=[]),Qe(i,t,n)}}function xf(){}xf.prototype.execute=function(e){var t=e.connection,n=e.newWaypoints;return e.oldWaypoints=t.waypoints,t.waypoints=n,t};xf.prototype.revert=function(e){var t=e.connection,n=e.oldWaypoints;return t.waypoints=n,t};function Be(e,t,n){this._eventBus=e,this._elementFactory=t,this._commandStack=n;var i=this;e.on("diagram.init",function(){i.registerHandlers(n)})}Be.$inject=["eventBus","elementFactory","commandStack"];Be.prototype.getHandlers=function(){return{"shape.append":Hl,"shape.create":Mi,"shape.delete":mo,"shape.move":lr,"shape.resize":yo,"shape.replace":ci,"shape.toggleCollapse":Yl,spaceTool:ki,"label.create":ho,"connection.create":zl,"connection.delete":Gl,"connection.move":bf,"connection.layout":Wl,"connection.updateWaypoints":xf,"connection.reconnect":go,"elements.create":yf,"elements.move":ql,"elements.delete":Ef,"elements.distribute":Ul,"elements.align":jl,"element.updateAttachment":Kl}};Be.prototype.registerHandlers=function(e){B(this.getHandlers(),function(t,n){e.registerHandler(n,t)})};Be.prototype.moveShape=function(e,t,n,i,a){typeof i=="object"&&(a=i,i=null);var r={shape:e,delta:t,newParent:n,newParentIndex:i,hints:a||{}};this._commandStack.execute("shape.move",r)};Be.prototype.updateAttachment=function(e,t){var n={shape:e,newHost:t};this._commandStack.execute("element.updateAttachment",n)};Be.prototype.moveElements=function(e,t,n,i){i=i||{};var a=i.attach,r=n,o;a===!0?(o=n,r=n.parent):a===!1&&(o=null);var s={shapes:e,delta:t,newParent:r,newHost:o,hints:i};this._commandStack.execute("elements.move",s)};Be.prototype.moveConnection=function(e,t,n,i,a){typeof i=="object"&&(a=i,i=void 0);var r={connection:e,delta:t,newParent:n,newParentIndex:i,hints:a||{}};this._commandStack.execute("connection.move",r)};Be.prototype.layoutConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.layout",n)};Be.prototype.createConnection=function(e,t,n,i,a,r){typeof n=="object"&&(r=a,a=i,i=n,n=void 0),i=this._create("connection",i);var o={source:e,target:t,parent:a,parentIndex:n,connection:i,hints:r};return this._commandStack.execute("connection.create",o),o.connection};Be.prototype.createShape=function(e,t,n,i,a){typeof i!="number"&&(a=i,i=void 0),a=a||{};var r=a.attach,o,s;e=this._create("shape",e),r?(o=n.parent,s=n):o=n;var u={position:t,shape:e,parent:o,parentIndex:i,host:s,hints:a};return this._commandStack.execute("shape.create",u),u.shape};Be.prototype.createElements=function(e,t,n,i,a){xe(e)||(e=[e]),typeof i!="number"&&(a=i,i=void 0),a=a||{};var r={position:t,elements:e,parent:n,parentIndex:i,hints:a};return this._commandStack.execute("elements.create",r),r.elements};Be.prototype.createLabel=function(e,t,n,i){n=this._create("label",n);var a={labelTarget:e,position:t,parent:i||e.parent,shape:n};return this._commandStack.execute("label.create",a),a.shape};Be.prototype.appendShape=function(e,t,n,i,a){a=a||{},t=this._create("shape",t);var r={source:e,position:n,target:i,shape:t,connection:a.connection,connectionParent:a.connectionParent,hints:a};return this._commandStack.execute("shape.append",r),r.shape};Be.prototype.removeElements=function(e){var t={elements:e};this._commandStack.execute("elements.delete",t)};Be.prototype.distributeElements=function(e,t,n){var i={groups:e,axis:t,dimension:n};this._commandStack.execute("elements.distribute",i)};Be.prototype.removeShape=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.delete",n)};Be.prototype.removeConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.delete",n)};Be.prototype.replaceShape=function(e,t,n){var i={oldShape:e,newData:t,hints:n||{}};return this._commandStack.execute("shape.replace",i),i.newShape};Be.prototype.alignElements=function(e,t){var n={elements:e,alignment:t};this._commandStack.execute("elements.align",n)};Be.prototype.resizeShape=function(e,t,n,i){var a={shape:e,newBounds:t,minBounds:n,hints:i};this._commandStack.execute("shape.resize",a)};Be.prototype.createSpace=function(e,t,n,i,a){var r={delta:n,direction:i,movingShapes:e,resizingShapes:t,start:a};this._commandStack.execute("spaceTool",r)};Be.prototype.updateWaypoints=function(e,t,n){var i={connection:e,newWaypoints:t,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",i)};Be.prototype.reconnect=function(e,t,n,i,a){var r={connection:e,newSource:t,newTarget:n,dockingOrPoints:i,hints:a||{}};this._commandStack.execute("connection.reconnect",r)};Be.prototype.reconnectStart=function(e,t,n,i){i||(i={}),this.reconnect(e,t,e.target,n,G(i,{docking:"source"}))};Be.prototype.reconnectEnd=function(e,t,n,i){i||(i={}),this.reconnect(e,e.source,t,n,G(i,{docking:"target"}))};Be.prototype.connect=function(e,t,n,i){return this.createConnection(e,t,n||{},e.parent,i)};Be.prototype._create=function(e,t){return t instanceof Za?t:this._elementFactory.create(e,t)};Be.prototype.toggleCollapse=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.toggleCollapse",n)};function Eo(e){this._elementRegistry=e}Eo.$inject=["elementRegistry"];Eo.prototype.execute=function(e){var t=e.element,n=e.moddleElement,i=e.properties;if(!n)throw new Error("<moddleElement> required");var a=e.changed||this.getVisualReferences(n).concat(t),r=e.oldProperties||AR(n,Va(i));return NE(n,i),e.oldProperties=r,e.changed=a,a};Eo.prototype.revert=function(e){var t=e.oldProperties,n=e.moddleElement,i=e.changed;return NE(n,t),i};Eo.prototype.getVisualReferences=function(e){var t=this._elementRegistry;return w(e,"bpmn:DataObject")?PR(e,t):[]};function AR(e,t){return Ht(t,function(n,i){return n[i]=e.get(i),n},{})}function NE(e,t){B(t,function(n,i){e.set(i,n)})}function PR(e,t){return t.filter(function(n){return w(n,"bpmn:DataObjectReference")&&oe(n).dataObjectRef===e})}var Ta="default",Zn="id",ME="di",RR={width:0,height:0};function bo(e,t,n,i,a){this._elementRegistry=e,this._moddle=t,this._translate=n,this._modeling=i,this._textRenderer=a}bo.$inject=["elementRegistry","moddle","translate","modeling","textRenderer"];bo.prototype.execute=function(e){var t=e.element,n=[t],i=this._translate;if(!t)throw new Error(i("element required"));var a=this._elementRegistry,r=this._moddle.ids,o=t.businessObject,s=DR(e.properties),u=e.oldProperties||IR(o,s);return kE(s,o)&&(r.unclaim(o[Zn]),a.updateId(t,s[Zn]),r.claim(s[Zn],o)),Ta in s&&(s[Ta]&&n.push(a.get(s[Ta].id)),o[Ta]&&n.push(a.get(o[Ta].id))),DE(o,s),e.oldProperties=u,e.changed=n,n};bo.prototype.postExecute=function(e){var t=e.element,n=t.label,i=n&&oe(n).name;if(i){var a=this._textRenderer.getExternalLabelBounds(n,i);this._modeling.resizeShape(n,a,RR)}};bo.prototype.revert=function(e){var t=e.element,n=e.properties,i=e.oldProperties,a=t.businessObject,r=this._elementRegistry,o=this._moddle.ids;return DE(a,i),kE(n,a)&&(o.unclaim(n[Zn]),r.updateId(t,i[Zn]),o.claim(i[Zn],a)),e.changed};function kE(e,t){return Zn in e&&e[Zn]!==t[Zn]}function IR(e,t){var n=Va(t);return Ht(n,function(i,a){return a!==ME?i[a]=e.get(a):i[a]=NR(e.di,Va(t.di)),i},{})}function NR(e,t){return Ht(t,function(n,i){return n[i]=e.get(i),n},{})}function DE(e,t){B(t,function(n,i){i!==ME?e.set(i,n):e.di&&MR(e.di,n)})}function MR(e,t){B(t,function(n,i){e.set(i,n)})}var kR=["default"];function DR(e){var t=G({},e);return kR.forEach(function(n){n in e&&(t[n]=oe(t[n]))}),t}function Xl(e,t){this._canvas=e,this._modeling=t}Xl.$inject=["canvas","modeling"];Xl.prototype.execute=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,a=t.getRootElement(),r=a.businessObject,o=r.$parent,s=r.di;t.setRootElement(n,!0),Qe(o.rootElements,i),i.$parent=o,Je(o.rootElements,r),r.$parent=null,r.di=null,s.bpmnElement=i,i.di=s,e.oldRoot=a};Xl.prototype.revert=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,a=e.oldRoot,r=a.businessObject,o=i.$parent,s=i.di;t.setRootElement(a,!0),Je(o.rootElements,i),i.$parent=null,Qe(o.rootElements,r),r.$parent=o,i.di=null,s.bpmnElement=r,r.di=s};function Sf(e,t){this._modeling=e,this._spaceTool=t}Sf.$inject=["modeling","spaceTool"];Sf.prototype.preExecute=function(e){var t=this._spaceTool,n=this._modeling,i=e.shape,a=e.location,r=bn(i),o=r===i,s=o?i:i.parent,u=ar(s);u.length||n.createShape({type:"bpmn:Lane"},{x:i.x+Sr,y:i.y,width:i.width-Sr,height:i.height},s);var c=[];nr(r,function(b){return c.push(b),b.label&&c.push(b.label),b===i?[]:ge(b.children,function(_){return _!==i})});var p=a==="top"?-120:120,f=a==="top"?i.y:i.y+i.height,m=f+(a==="top"?10:-10),v=a==="top"?"n":"s",g=t.calculateAdjustments(c,"y",p,m);t.makeSpace(g.movingShapes,g.resizingShapes,{x:0,y:p},v,m),e.newLane=n.createShape({type:"bpmn:Lane"},{x:i.x+(o?Sr:0),y:f-(a==="top"?120:0),width:i.width-(o?Sr:0),height:120},s)};function wf(e,t){this._modeling=e,this._translate=t}wf.$inject=["modeling","translate"];wf.prototype.preExecute=function(e){var t=this._modeling,n=this._translate,i=e.shape,a=e.count,r=ar(i),o=r.length;if(o>a)throw new Error(n("more than {count} child lanes",{count:a}));var s=Math.round(i.height/a),u,c,p,f,m;for(m=0;m<a;m++)u=i.y+m*s,m===a-1?c=i.height-s*m:c=s,p={x:i.x+Sr,y:u,width:i.width-Sr,height:c},m<o?t.resizeShape(r[m],p):(f={type:"bpmn:Lane"},t.createShape(f,p,i))};function _o(e,t){this._modeling=e,this._spaceTool=t}_o.$inject=["modeling","spaceTool"];_o.prototype.preExecute=function(e){var t=e.shape,n=e.newBounds,i=e.balanced;i!==!1?this.resizeBalanced(t,n):this.resizeSpace(t,n)};_o.prototype.resizeBalanced=function(e,t){var n=this._modeling,i=wC(e,t);n.resizeShape(e,t),i.forEach(function(a){n.resizeShape(a.shape,a.newBounds)})};_o.prototype.resizeSpace=function(e,t){var n=this._spaceTool,i=ce(e),a=ce(t),r=Ay(a,i),o=bn(e),s=[],u=[];nr(o,function(g){return s.push(g),(w(g,"bpmn:Lane")||w(g,"bpmn:Participant"))&&u.push(g),g.children});var c,p,f,m,v;(r.bottom||r.top)&&(c=r.bottom||r.top,p=e.y+(r.bottom?e.height:0)+(r.bottom?-10:10),f=r.bottom?"s":"n",m=r.top>0||r.bottom<0?-c:c,v=n.calculateAdjustments(s,"y",m,p),n.makeSpace(v.movingShapes,v.resizingShapes,{x:0,y:c},f)),(r.left||r.right)&&(c=r.right||r.left,p=e.x+(r.right?e.width:0)+(r.right?-10:100),f=r.right?"e":"w",m=r.left>0||r.right<0?-c:c,v=n.calculateAdjustments(u,"x",m,p),n.makeSpace(v.movingShapes,v.resizingShapes,{x:c,y:0},f))};var Ga="flowNodeRef",Tf="lanes";function xo(e){this._elementRegistry=e}xo.$inject=["elementRegistry"];xo.prototype.computeUpdates=function(e,t){var n=[],i=[],a={},r=[];function o(p,f){var m=ce(f),v={x:p.x+p.width/2,y:p.y+p.height/2};return v.x>m.left&&v.x<m.right&&v.y>m.top&&v.y<m.bottom}function s(p){n.indexOf(p)===-1&&(r.push(p),n.push(p))}function u(p){var f=bn(p);return a[f.id]||(a[f.id]=Pl(f)),a[f.id]}function c(p){if(!p.parent)return[];var f=u(p);return f.filter(function(m){return o(p,m)}).map(function(m){return m.businessObject})}return t.forEach(function(p){var f=bn(p);if(!(!f||n.indexOf(f)!==-1)){var m=f.children.filter(function(v){return w(v,"bpmn:FlowNode")});m.forEach(s),n.push(f)}}),e.forEach(s),r.forEach(function(p){var f=p.businessObject,m=f.get(Tf),v=m.slice(),g=c(p);i.push({flowNode:f,remove:v,add:g})}),t.forEach(function(p){var f=p.businessObject;p.parent||f.get(Ga).forEach(function(m){i.push({flowNode:m,remove:[f],add:[]})})}),i};xo.prototype.execute=function(e){var t=e.updates;t||(t=e.updates=this.computeUpdates(e.flowNodeShapes,e.laneShapes)),t.forEach(function(n){var i=n.flowNode,a=i.get(Tf);n.remove.forEach(function(r){Je(a,r),Je(r.get(Ga),i)}),n.add.forEach(function(r){Qe(a,r),Qe(r.get(Ga),i)})})};xo.prototype.revert=function(e){var t=e.updates;t.forEach(function(n){var i=n.flowNode,a=i.get(Tf);n.add.forEach(function(r){Je(a,r),Je(r.get(Ga),i)}),n.remove.forEach(function(r){Qe(a,r),Qe(r.get(Ga),i)})})};function Zl(e){this._moddle=e}Zl.$inject=["moddle"];Zl.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,i=e.element,a=e.claiming;a?t.claim(n,i):t.unclaim(n)};Zl.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,i=e.element,a=e.claiming;a?t.unclaim(n):t.claim(n,i)};var OR={fill:void 0,stroke:void 0};function Cf(e){this._commandStack=e,this._normalizeColor=function(t){if(t){if(jt(t)){var n=LR(t);if(n)return n}throw new Error("invalid color value: "+t)}}}Cf.$inject=["commandStack"];Cf.prototype.postExecute=function(e){var t=e.elements,n=e.colors||OR,i=this,a={};"fill"in n&&G(a,{"background-color":this._normalizeColor(n.fill)}),"stroke"in n&&G(a,{"border-color":this._normalizeColor(n.stroke)}),B(t,function(r){var o=BR(r)?cn(a,["border-color"]):a;$R(o),r.labelTarget?i._commandStack.execute("element.updateModdleProperties",{element:r,moddleElement:r.businessObject.di.label,properties:{color:a["background-color"]}}):i._commandStack.execute("element.updateProperties",{element:r,properties:{di:o}})})};function LR(e){var t=document.createElement("canvas").getContext("2d");return t.fillStyle="transparent",t.fillStyle=e,/^#[0-9a-fA-F]{6}$/.test(t.fillStyle)?t.fillStyle:null}function BR(e){return!!e.waypoints}function $R(e){"border-color"in e&&(e.stroke=e["border-color"]),"background-color"in e&&(e.fill=e["background-color"])}var VR={width:0,height:0};function OE(e,t){function n(s,u){var c=s.label||s,p=s.labelTarget||s;return Jw(c,u),[c,p]}function i(s){var u=s.element,c=u.businessObject,p=s.newLabel;if(!_t(u)&&Dr(u)&&!yl(u)&&!Om(p)){var f=7,m=El(u);m={x:m.x,y:m.y+f},e.createLabel(u,m,{id:c.id+"_label",businessObject:c})}}function a(s){return s.oldLabel=Sn(s.element),n(s.element,s.newLabel)}function r(s){return n(s.element,s.oldLabel)}function o(s){var u=s.element,c=u.label||u,p=s.newLabel,f=s.newBounds,m=s.hints||{};if(!(!_t(c)&&!w(c,"bpmn:TextAnnotation"))){if(_t(c)&&Om(p)){m.removeShape!==!1&&e.removeShape(c,{unsetLabel:!1});return}var v=Sn(c);typeof f=="undefined"&&(f=t.getExternalLabelBounds(c,v)),f&&e.resizeShape(c,f,VR)}}this.preExecute=i,this.execute=a,this.revert=r,this.postExecute=o}OE.$inject=["modeling","textRenderer"];function Om(e){return!e||!e.trim()}function Tt(e,t,n,i){Be.call(this,e,t,n),this._bpmnRules=i}se(Tt,Be);Tt.$inject=["eventBus","elementFactory","commandStack","bpmnRules"];Tt.prototype.getHandlers=function(){var e=Be.prototype.getHandlers.call(this);return e["element.updateModdleProperties"]=Eo,e["element.updateProperties"]=bo,e["canvas.updateRoot"]=Xl,e["lane.add"]=Sf,e["lane.resize"]=_o,e["lane.split"]=wf,e["lane.updateRefs"]=xo,e["id.updateClaim"]=Zl,e["element.setColor"]=Cf,e["element.updateLabel"]=OE,e};Tt.prototype.updateLabel=function(e,t,n,i){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t,newBounds:n,hints:i||{}})};Tt.prototype.connect=function(e,t,n,i){var a=this._bpmnRules;if(n||(n=a.canConnect(e,t)),!!n)return this.createConnection(e,t,n,e.parent,i)};Tt.prototype.updateModdleProperties=function(e,t,n){this._commandStack.execute("element.updateModdleProperties",{element:e,moddleElement:t,properties:n})};Tt.prototype.updateProperties=function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})};Tt.prototype.resizeLane=function(e,t,n){this._commandStack.execute("lane.resize",{shape:e,newBounds:t,balanced:n})};Tt.prototype.addLane=function(e,t){var n={shape:e,location:t};return this._commandStack.execute("lane.add",n),n.newLane};Tt.prototype.splitLane=function(e,t){this._commandStack.execute("lane.split",{shape:e,count:t})};Tt.prototype.makeCollaboration=function(){var e=this._create("root",{type:"bpmn:Collaboration"}),t={newRoot:e};return this._commandStack.execute("canvas.updateRoot",t),e};Tt.prototype.updateLaneRefs=function(e,t){this._commandStack.execute("lane.updateRefs",{flowNodeShapes:e,laneShapes:t})};Tt.prototype.makeProcess=function(){var e=this._create("root",{type:"bpmn:Process"}),t={newRoot:e};this._commandStack.execute("canvas.updateRoot",t)};Tt.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})};Tt.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})};Tt.prototype.setColor=function(e,t){e.length||(e=[e]),this._commandStack.execute("element.setColor",{elements:e,colors:t})};function LE(){}LE.prototype.layoutConnection=function(e,t){return t=t||{},[t.connectionStart||Ee(t.source||e.source),t.connectionEnd||Ee(t.target||e.target)]};var vs=20,FR=5,Qs=Math.round,Lm=20,jR={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function HR(e,t){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[t].test(e)}function zR(e,t){return{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[e].test(t)}function BE(e,t,n){var i=St(t,e,FR),a=n.split(":")[0],r=Qs((t.x-e.x)/2+e.x),o=Qs((t.y-e.y)/2+e.y),s,u,c=zR(a,i),p=/h|r|l/.test(a),f=!1,m=!1;return c?(s=p?{x:r,y:e.y}:{x:e.x,y:o},u=p?"h:h":"v:v"):(f=HR(i,a),u=p?"h:v":"v:h",f?p?(m=o===e.y,s={x:e.x+vs*(/l/.test(a)?-1:1),y:m?o+vs:o}):(m=r===e.x,s={x:m?r+vs:r,y:e.y+vs*(/t/.test(a)?-1:1)}):s={x:r,y:o}),{waypoints:Af(e,s,u).concat(s),directions:u,turnNextDirections:m}}function GR(e,t,n){return BE(e,t,n)}function UR(e,t,n){var i=BE(t,e,Bm(n));return{waypoints:i.waypoints.slice().reverse(),directions:Bm(i.directions),turnNextDirections:i.turnNextDirections}}function WR(e,t){var n=e.directions.split(":")[1],i=t.directions.split(":")[0];e.turnNextDirections&&(n=n=="h"?"v":"h"),t.turnNextDirections&&(i=i=="h"?"v":"h");var a=n+":"+i,r=Af(e.waypoints[e.waypoints.length-1],t.waypoints[0],a);return{waypoints:r,directions:a}}function Bm(e){return e.split(":").reverse().join(":")}function qR(e,t,n){var i=Qs((t.x-e.x)/2+e.x),a=Qs((t.y-e.y)/2+e.y);if(n==="h:v")return[{x:t.x,y:e.y}];if(n==="v:h")return[{x:e.x,y:t.y}];if(n==="h:h")return[{x:i,y:e.y},{x:i,y:t.y}];if(n==="v:v")return[{x:e.x,y:a},{x:t.x,y:a}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}function Af(e,t,n){if(n=n||"h:h",!nI(n))throw new Error("unknown directions: <"+n+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if($E(n)){var i=GR(e,t,n),a=UR(e,t,n),r=WR(i,a);return[].concat(i.waypoints,r.waypoints,a.waypoints)}return qR(e,t,n)}function YR(e,t,n){var i=Af(e,t,n);return i.unshift(e),i.push(t),VE(i)}function KR(e,t,n,i,a){var r=a&&a.preferredLayouts||[],o=Rv(r,"straight")[0]||"h:h",s=jR[o]||0,u=St(e,t,s),c=tI(u,o);n=n||Ee(e),i=i||Ee(t);var p=c.split(":"),f=Vm(n,e,p[0],iI(u)),m=Vm(i,t,p[1],u);return YR(f,m,c)}function XR(e,t,n,i,a,r){xe(n)&&(a=n,r=i,n=Ee(e),i=Ee(t)),r=G({preferredLayouts:[]},r),a=a||[];var o=r.preferredLayouts,s=o.indexOf("straight")!==-1,u;return u=s&&JR(e,t,n,i,r),u||(u=r.connectionEnd&&eI(t,e,i,a),u)||(u=r.connectionStart&&QR(e,t,n,a),u)?u:!r.connectionStart&&!r.connectionEnd&&a&&a.length?a:KR(e,t,n,i,r)}function ZR(e,t,n){return e>=t&&e<=n}function $m(e,t,n){var i={x:"width",y:"height"};return ZR(t[e],n[e],n[e]+n[i[e]])}function JR(e,t,n,i,a){var r={},o,s;return s=St(e,t),/^(top|bottom|left|right)$/.test(s)?(/top|bottom/.test(s)&&(o="x"),/left|right/.test(s)&&(o="y"),a.preserveDocking==="target"?$m(o,i,e)?(r[o]=i[o],[{x:r.x!==void 0?r.x:n.x,y:r.y!==void 0?r.y:n.y,original:{x:r.x!==void 0?r.x:n.x,y:r.y!==void 0?r.y:n.y}},{x:i.x,y:i.y}]):null:$m(o,n,t)?(r[o]=n[o],[{x:n.x,y:n.y},{x:r.x!==void 0?r.x:i.x,y:r.y!==void 0?r.y:i.y,original:{x:r.x!==void 0?r.x:i.x,y:r.y!==void 0?r.y:i.y}}]):null):null}function QR(e,t,n,i){return Pf(e,t,n,i)}function eI(e,t,n,i){var a=i.slice().reverse();return a=Pf(e,t,n,a),a?a.reverse():null}function Pf(e,t,n,i){function a(p){return p.length<3?!0:p.length>4?!1:!!Me(p,function(f,m){var v=p[m-1];return v&&Xa(f,v)<3})}function r(p,f,m){var v=Kn(f,p);switch(v){case"v":return{x:m.x,y:p.y};case"h":return{x:p.x,y:m.y}}return{x:p.x,y:p.y}}function o(p,f,m){var v;for(v=p.length-2;v!==0;v--)if(Id(p[v],f,Lm)||Id(p[v],m,Lm))return p.slice(v);return p}if(a(i))return null;var s=i[0],u=i.slice(),c;return u[0]=n,u[1]=r(u[1],s,n),c=o(u,e,t),c!==u&&(u=Pf(e,t,n,c)),u&&Kn(u)?null:u}function tI(e,t){if($E(t))return t;switch(e){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return t}}function nI(e){return e&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(e)}function $E(e){return e&&/t|r|b|l/.test(e)}function iI(e){return{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[e]}function Vm(e,t,n,i){if(n==="h"&&(n=/left/.test(i)?"l":"r"),n==="v"&&(n=/top/.test(i)?"t":"b"),n==="t")return{original:e,x:e.x,y:t.y};if(n==="r")return{original:e,x:t.x+t.width,y:e.y};if(n==="b")return{original:e,x:e.x,y:t.y+t.height};if(n==="l")return{original:e,x:t.x,y:e.y};throw new Error("unexpected dockingDirection: <"+n+">")}function VE(e){return e.reduce(function(t,n,i){var a=t[t.length-1],r=e[i+1];return sp(a,r,n,0)||t.push(n),t},[])}var rI=-10,aI=40,Rf={top:"bottom","top-right":"bottom-left","top-left":"bottom-right",right:"left",bottom:"top","bottom-right":"top-left","bottom-left":"top-right",left:"right"},Ms={top:"t",right:"r",bottom:"b",left:"l"};function If(){}se(If,LE);If.prototype.layoutConnection=function(e,t){t||(t={});var n=t.source||e.source,i=t.target||e.target,a=t.waypoints||e.waypoints,r=t.connectionStart,o=t.connectionEnd,s,u;return r||(r=Fm(a&&a[0],n)),o||(o=Fm(a&&a[a.length-1],i)),(w(e,"bpmn:Association")||w(e,"bpmn:DataAssociation"))&&a&&!jm(n,i)?[].concat([r],a.slice(1,-1),[o]):(w(e,"bpmn:MessageFlow")?s=sI(n,i):(w(e,"bpmn:SequenceFlow")||jm(n,i))&&(n===i?s={preferredLayouts:mI(n,e)}:w(n,"bpmn:BoundaryEvent")?s={preferredLayouts:vI(n,i,o)}:Ua(n)||Ua(i)?s=uI(n):w(n,"bpmn:Gateway")?s={preferredLayouts:["v:h"]}:w(i,"bpmn:Gateway")?s={preferredLayouts:["h:v"]}:s={preferredLayouts:["h:h"]}),s&&(s=G(s,t),u=VE(XR(n,i,r,o,a,s))),u||[r,o])};function oI(e){var t=e.host;return St(Ee(e),t,rI)}function sI(e,t){return{preferredLayouts:["straight","v:v"],preserveDocking:lI(e,t)}}function lI(e,t){return w(t,"bpmn:Participant")?"source":w(e,"bpmn:Participant")?"target":Ua(t)?"source":Ua(e)||w(t,"bpmn:Event")?"target":w(e,"bpmn:Event")?"source":null}function uI(e){return{preferredLayouts:["straight","h:h"],preserveDocking:cI(e)}}function cI(e){return Ua(e)?"target":"source"}function Fm(e,t){return e?e.original||e:Ee(t)}function jm(e,t){return w(t,"bpmn:Activity")&&w(e,"bpmn:BoundaryEvent")&&t.businessObject.isForCompensation}function Ua(e){return w(e,"bpmn:SubProcess")&&Le(e)}function Oa(e,t){return e===t}function pI(e,t){return t.indexOf(e)!==-1}function La(e){var t=/right|left/.exec(e);return t&&t[0]}function Ki(e){var t=/top|bottom/.exec(e);return t&&t[0]}function fI(e,t){return Rf[e]===t}function dI(e,t){var n=La(e),i=Rf[n];return t.indexOf(i)!==-1}function hI(e,t){var n=Ki(e),i=Rf[n];return t.indexOf(i)!==-1}function Gc(e){return e==="right"||e==="left"}function mI(e,t){var n=t.waypoints,i=n&&n.length&&St(n[0],e);return i==="top"?["t:r"]:i==="right"?["r:b"]:i==="left"?["l:t"]:["b:l"]}function vI(e,t,n){var i=Ee(e),a=Ee(t),r=oI(e),o,s,u=Oa(e.host,t),c=pI(r,["top","right","bottom","left"]),p=St(a,i,{x:e.width/2+t.width/2,y:e.height/2+t.height/2});return u?gI(r,c,e,t,n):(o=yI(r,p,c),s=EI(r,p,c),[o+":"+s])}function gI(e,t,n,i,a){var r=t?e:Ki(e),o=Ms[r],s;return t?Gc(e)?s=Hm("y",n,i,a)?"h":"b":s=Hm("x",n,i,a)?"v":"l":s="v",[o+":"+s]}function Hm(e,t,n,i){var a=aI;return!(Uu(e,i,n,a)||Uu(e,i,{x:n.x+n.width,y:n.y+n.height},a)||Uu(e,i,Ee(t),a))}function Uu(e,t,n,i){return Math.abs(t[e]-n[e])<i}function yI(e,t,n){return n?Ms[e]:Oa(Ki(e),Ki(t))||fI(La(e),La(t))?Ms[Ki(e)]:Ms[La(e)]}function EI(e,t,n){return n?Gc(e)?dI(e,t)||Oa(e,t)?"h":"v":hI(e,t)||Oa(e,t)?"v":"h":Gc(t)||Oa(Ki(e),Ki(t))&&La(t)?"h":"v"}function zm(e){return G({original:e.point.original||e.point},e.actual)}function Di(e,t){this._elementRegistry=e,this._graphicsFactory=t}Di.$inject=["elementRegistry","graphicsFactory"];Di.prototype.getCroppedWaypoints=function(e,t,n){t=t||e.source,n=n||e.target;var i=this.getDockingPoint(e,t,!0),a=this.getDockingPoint(e,n),r=e.waypoints.slice(i.idx+1,a.idx);return r.unshift(zm(i)),r.push(zm(a)),r};Di.prototype.getDockingPoint=function(e,t,n){var i=e.waypoints,a,r,o;return a=n?0:i.length-1,r=i[a],o=this._getIntersection(t,e,n),{point:r,actual:o||r,idx:a}};Di.prototype._getIntersection=function(e,t,n){var i=this._getShapePath(e),a=this._getConnectionPath(t);return bc(i,a,n)};Di.prototype._getConnectionPath=function(e){return this._graphicsFactory.getConnectionPath(e)};Di.prototype._getShapePath=function(e){return this._graphicsFactory.getShapePath(e)};Di.prototype._getGfx=function(e){return this._elementRegistry.getGraphics(e)};const bI={__init__:["modeling","bpmnUpdater"],__depends__:[CP,UP,qP,YP,Cy,KP,QP,tR,sR,Fn,By,SE],bpmnFactory:["type",gn],bpmnUpdater:["type",Gt],elementFactory:["type",Ni],modeling:["type",Tt],layouter:["type",If],connectionDocking:["type",Di]};var _I=500,xI=1250,SI=1500,el=Math.round;function wI(e){return{x:e.x+el(e.width/2),y:e.y+el(e.height/2)}}function FE(e,t,n,i,a){function r(s,u,c,p){return a.allowed("elements.move",{shapes:s,delta:u,position:c,target:p})}e.on("shape.move.start",SI,function(s){var u=s.context,c=s.shape,p=i.get().slice();p.indexOf(c)===-1&&(p=[c]),p=TI(p),G(u,{shapes:p,validatedShapes:p,shape:c})}),e.on("shape.move.start",xI,function(s){var u=s.context,c=u.validatedShapes,p;if(p=u.canExecute=r(c),!p)return!1}),e.on("shape.move.move",_I,function(s){var u=s.context,c=u.validatedShapes,p=s.hover,f={x:s.dx,y:s.dy},m={x:s.x,y:s.y},v;if(v=r(c,f,m,p),u.delta=f,u.canExecute=v,v===null){u.target=null;return}u.target=p}),e.on("shape.move.end",function(s){var u=s.context,c=u.delta,p=u.canExecute,f=p==="attach",m=u.shapes;if(p===!1)return!1;c.x=el(c.x),c.y=el(c.y),!(c.x===0&&c.y===0)&&n.moveElements(m,c,u.target,{primaryShape:u.shape,attach:f})}),e.on("element.mousedown",function(s){if(Ai(s)){var u=Kr(s);if(!u)throw new Error("must supply DOM mousedown event");return o(u,s.element)}});function o(s,u,c,p){if(nt(c)&&(p=c,c=!1),!(u.waypoints||!u.parent)){var f=wI(u);return t.init(s,f,"shape.move",{cursor:"grabbing",autoActivate:c,data:{shape:u,context:p||{}}}),!0}}this.start=o}FE.$inject=["eventBus","dragging","modeling","selection","rules"];function TI(e){var t=er(e,"id");return ge(e,function(n){for(;n=n.parent;)if(t[n.id])return!1;return!0})}var Gm=499,Wu="djs-dragging",Um="drop-ok",Wm="drop-not-ok",qm="new-parent",Ym="attach-ok";function jE(e,t,n,i){function a(u){var c=r(u),p=CI(c);return p}function r(u){var c=sl(u,!0),p=pt(c,function(f){return(f.incoming||[]).concat(f.outgoing||[])});return Ba(c.concat(p))}function o(u,c){[Ym,Um,Wm,qm].forEach(function(p){p===c?t.addMarker(u,p):t.removeMarker(u,p)})}function s(u,c,p){i.addDragger(c,u.dragGroup),p&&t.addMarker(c,Wu),u.allDraggedElements?u.allDraggedElements.push(c):u.allDraggedElements=[c]}e.on("shape.move.start",Gm,function(u){var c=u.context,p=c.shapes,f=c.allDraggedElements,m=a(p);if(!c.dragGroup){var v=le("g");ee(v,n.cls("djs-drag-group",["no-events"]));var g=t.getActiveLayer();fe(g,v),c.dragGroup=v}m.forEach(function(b){i.addDragger(b,c.dragGroup)}),f?f=Ba([f,r(p)]):f=r(p),B(f,function(b){t.addMarker(b,Wu)}),c.allDraggedElements=f,c.differentParents=AI(p)}),e.on("shape.move.move",Gm,function(u){var c=u.context,p=c.dragGroup,f=c.target,m=c.shape.parent,v=c.canExecute;f&&(v==="attach"?o(f,Ym):c.canExecute&&f&&f.id!==m.id?o(f,qm):o(f,c.canExecute?Um:Wm)),Ft(p,u.dx,u.dy)}),e.on(["shape.move.out","shape.move.cleanup"],function(u){var c=u.context,p=c.target;p&&o(p,null)}),e.on("shape.move.cleanup",function(u){var c=u.context,p=c.allDraggedElements,f=c.dragGroup;B(p,function(m){t.removeMarker(m,Wu)}),f&&tt(f)}),this.makeDraggable=s}jE.$inject=["eventBus","canvas","styles","previewSupport"];function CI(e){var t=ge(e,function(n){return PI(n)?Me(e,ln({id:n.source.id}))&&Me(e,ln({id:n.target.id})):!0});return t}function AI(e){return Rr(er(e,function(t){return t.parent&&t.parent.id}))!==1}function PI(e){return e.waypoints}const RI={__depends__:[no,Fn,kg,Hn,oi,ao],__init__:["move","movePreview"],move:["type",FE],movePreview:["type",jE]};var HE=".djs-palette-toggle",zE=".entry",II=HE+", "+zE,Uc="djs-palette-",NI="shown",Wc="open",Km="two-column",MI=1e3;function it(e,t){this._eventBus=e,this._canvas=t;var n=this;e.on("tool-manager.update",function(i){var a=i.tool;n.updateToolHighlight(a)}),e.on("i18n.changed",function(){n._update()}),e.on("diagram.init",function(){n._diagramInitialized=!0,n._rebuild()})}it.$inject=["eventBus","canvas"];it.prototype.registerProvider=function(e,t){t||(t=e,e=MI),this._eventBus.on("palette.getProviders",e,function(n){n.providers.push(t)}),this._rebuild()};it.prototype.getEntries=function(){var e=this._getProviders();return e.reduce(DI,{})};it.prototype._rebuild=function(){if(this._diagramInitialized){var e=this._getProviders();e.length&&(this._container||this._init(),this._update())}};it.prototype._init=function(){var e=this,t=this._eventBus,n=this._getParentContainer(),i=this._container=je(it.HTML_MARKUP);n.appendChild(i),lt(n).add(Uc+NI),qt.bind(i,II,"click",function(a){var r=a.delegateTarget;if($s(r,HE))return e.toggle();e.trigger("click",a)}),pe.bind(i,"mousedown",function(a){a.stopPropagation()}),qt.bind(i,zE,"dragstart",function(a){e.trigger("dragstart",a)}),t.on("canvas.resized",this._layoutChanged,this),t.fire("palette.create",{container:i})};it.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"palette.getProviders",providers:[]});return this._eventBus.fire(t),t.providers};it.prototype._toggleState=function(e){e=e||{};var t=this._getParentContainer(),n=this._container,i=this._eventBus,a,r=lt(n),o=lt(t);"twoColumn"in e?a=e.twoColumn:a=this._needsCollapse(t.clientHeight,this._entries||{}),r.toggle(Km,a),o.toggle(Uc+Km,a),"open"in e&&(r.toggle(Wc,e.open),o.toggle(Uc+Wc,e.open)),i.fire("palette.changed",{twoColumn:a,open:this.isOpen()})};it.prototype._update=function(){var e=Xe(".djs-palette-entries",this._container),t=this._entries=this.getEntries();ol(e),B(t,function(n,i){var a=n.group||"default",r=Xe("[data-group="+a+"]",e);r||(r=je('<div class="group" data-group="'+a+'"></div>'),e.appendChild(r));var o=n.html||(n.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),s=je(o);r.appendChild(s),n.separator||(Xt(s,"data-action",i),n.title&&Xt(s,"title",n.title),n.className&&kI(s,n.className),n.imageUrl&&s.appendChild(je('<img src="'+n.imageUrl+'">')))}),this.open()};it.prototype.trigger=function(e,t,n){var i=this._entries,a,r,o,s=t.delegateTarget||t.target;if(!s)return t.preventDefault();a=i[Xt(s,"data-action")],a&&(r=a.action,o=t.originalEvent||t,bt(r)?e==="click"&&r(o,n):r[e]&&r[e](o,n),t.preventDefault())};it.prototype._layoutChanged=function(){this._toggleState({})};it.prototype._needsCollapse=function(e,t){var n=50,i=Object.keys(t).length*46;return e<i+n};it.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})};it.prototype.open=function(){this._toggleState({open:!0})};it.prototype.toggle=function(e){this.isOpen()?this.close():this.open()};it.prototype.isActiveTool=function(e){return e&&this._activeTool===e};it.prototype.updateToolHighlight=function(e){var t,n;this._toolsContainer||(t=Xe(".djs-palette-entries",this._container),this._toolsContainer=Xe("[data-group=tools]",t)),n=this._toolsContainer,B(n.children,function(i){var a=i.getAttribute("data-action");if(a){var r=lt(i);a=a.replace("-tool",""),r.contains("entry")&&a===e?r.add("highlighted-entry"):r.remove("highlighted-entry")}})};it.prototype.isOpen=function(){return lt(this._container).has(Wc)};it.prototype._getParentContainer=function(){return this._canvas.getContainer()};it.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';function kI(e,t){var n=lt(e),i=xe(t)?t:t.split(/\s+/g);i.forEach(function(a){n.add(a)})}function DI(e,t){var n=t.getPaletteEntries();return bt(n)?n(e):(B(n,function(i,a){e[a]=i}),e)}const OI={__init__:["palette"],palette:["type",it]};var GE="crosshair";function ur(e,t,n,i,a,r,o){this._selection=a,this._dragging=n,this._mouse=o;var s=this,u={create:function(c){var p=t.getActiveLayer(),f;f=c.frame=le("rect"),ee(f,{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),fe(p,f)},update:function(c){var p=c.frame,f=c.bbox;ee(p,{x:f.x,y:f.y,width:f.width,height:f.height})},remove:function(c){c.frame&&tt(c.frame)}};r.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),e.on("lasso.selection.end",function(c){var p=c.originalEvent.target;!c.hover&&!(p instanceof SVGElement)||e.once("lasso.selection.ended",function(){s.activateLasso(c.originalEvent,!0)})}),e.on("lasso.end",function(c){var p=qu(c),f=i.filter(function(m){return m});s.select(f,p)}),e.on("lasso.start",function(c){var p=c.context;p.bbox=qu(c),u.create(p)}),e.on("lasso.move",function(c){var p=c.context;p.bbox=qu(c),u.update(p)}),e.on("lasso.cleanup",function(c){var p=c.context;u.remove(p)}),e.on("element.mousedown",1500,function(c){if(Ng(c))return s.activateLasso(c.originalEvent),!0})}ur.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager","mouse"];ur.prototype.activateLasso=function(e,t){this._dragging.init(e,"lasso",{autoActivate:t,cursor:GE,data:{context:{}}})};ur.prototype.activateSelection=function(e,t){this._dragging.init(e,"lasso.selection",{trapClick:!1,autoActivate:t,cursor:GE,data:{context:{}}})};ur.prototype.select=function(e,t){var n=Sx(e,t);this._selection.select(al(n))};ur.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)};ur.prototype.isActive=function(){var e=this._dragging.context();return e&&/^lasso/.test(e.prefix)};function qu(e){var t={x:e.x-e.dx,y:e.y-e.dy},n={x:e.x,y:e.y},i;return t.x<=n.x&&t.y<n.y||t.x<n.x&&t.y<=n.y?i={x:t.x,y:t.y,width:n.x-t.x,height:n.y-t.y}:t.x>=n.x&&t.y<n.y||t.x>n.x&&t.y<=n.y?i={x:n.x,y:t.y,width:t.x-n.x,height:n.y-t.y}:t.x<=n.x&&t.y>n.y||t.x<n.x&&t.y>=n.y?i={x:t.x,y:n.y,width:n.x-t.x,height:t.y-n.y}:t.x>=n.x&&t.y>n.y||t.x>n.x&&t.y>=n.y?i={x:n.x,y:n.y,width:t.x-n.x,height:t.y-n.y}:i={x:n.x,y:n.y,width:0,height:0},i}const LI={__depends__:[Fl,so],__init__:["lassoTool"],lassoTool:["type",ur]};var Yu=1500,UE="grab";function ta(e,t,n,i,a,r){this._dragging=n,this._mouse=r;var o=this,s=i.get("keyboard",!1);a.registerTool("hand",{tool:"hand",dragging:"hand.move"}),e.on("element.mousedown",Yu,function(u){if(Or(u))return o.activateMove(u.originalEvent,!0),!1}),s&&s.addListener(Yu,function(u){if(!(!Xm(u.keyEvent)||o.isActive())){var c=o._mouse.getLastMoveEvent();o.activateMove(c,!!c)}},"keyboard.keydown"),s&&s.addListener(Yu,function(u){!Xm(u.keyEvent)||!o.isActive()||o.toggle()},"keyboard.keyup"),e.on("hand.end",function(u){var c=u.originalEvent.target;if(!u.hover&&!(c instanceof SVGElement))return!1;e.once("hand.ended",function(){o.activateMove(u.originalEvent,{reactivate:!0})})}),e.on("hand.move.move",function(u){var c=t.viewbox().scale;t.scroll({dx:u.dx*c,dy:u.dy*c})}),e.on("hand.move.end",function(u){var c=u.context,p=c.reactivate;return!Or(u)&&p&&e.once("hand.move.ended",function(f){o.activateHand(f.originalEvent,!0,!0)}),!1})}ta.$inject=["eventBus","canvas","dragging","injector","toolManager","mouse"];ta.prototype.activateMove=function(e,t,n){typeof t=="object"&&(n=t,t=!1),this._dragging.init(e,"hand.move",{autoActivate:t,cursor:UE,data:{context:n||{}}})};ta.prototype.activateHand=function(e,t,n){this._dragging.init(e,"hand",{trapClick:!1,autoActivate:t,cursor:UE,data:{context:{reactivate:n}}})};ta.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateHand(e,!!e)};ta.prototype.isActive=function(){var e=this._dragging.context();return e?/^(hand|hand\.move)$/.test(e.prefix):!1};function Xm(e){return _n(" ",e)}const BI={__depends__:[Fl,so],__init__:["handTool"],handTool:["type",ta]};var Zm="connect-ok",Jm="connect-not-ok";function na(e,t,n,i,a,r,o){var s=this;this._dragging=t,this._rules=r,this._mouse=o,a.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),e.on("global-connect.hover",function(u){var c=u.context,p=u.hover,f=c.canStartConnect=s.canStartConnect(p);f!==null&&(c.startTarget=p,i.addMarker(p,f?Zm:Jm))}),e.on(["global-connect.out","global-connect.cleanup"],function(u){var c=u.context.startTarget,p=u.context.canStartConnect;c&&i.removeMarker(c,p?Zm:Jm)}),e.on(["global-connect.ended"],function(u){var c=u.context,p=c.startTarget,f={x:u.x,y:u.y},m=s.canStartConnect(p);if(m)return e.once("element.out",function(){e.once(["connect.ended","connect.canceled"],function(){e.fire("global-connect.drag.ended")}),n.start(null,p,f)}),!1})}na.$inject=["eventBus","dragging","connect","canvas","toolManager","rules","mouse"];na.prototype.start=function(e,t){this._dragging.init(e,"global-connect",{autoActivate:t,trapClick:!1,data:{context:{}}})};na.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();return this.start(e,!!e)};na.prototype.isActive=function(){var e=this._dragging.context();return e&&/^global-connect/.test(e.prefix)};na.prototype.canStartConnect=function(e){return this._rules.allowed("connection.start",{source:e})};const $I={__depends__:[Ip,Hn,oi,Fl,so],globalConnect:["type",na]};function Nf(e,t,n,i,a,r,o,s){this._palette=e,this._create=t,this._elementFactory=n,this._spaceTool=i,this._lassoTool=a,this._handTool=r,this._globalConnect=o,this._translate=s,e.registerProvider(this)}Nf.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"];Nf.prototype.getPaletteEntries=function(e){var t={},n=this._create,i=this._elementFactory,a=this._spaceTool,r=this._lassoTool,o=this._handTool,s=this._globalConnect,u=this._translate;function c(m,v,g,b,_){function k(A){var S=i.createShape(G({type:m},_));_&&(S.businessObject.di.isExpanded=_.isExpanded),n.start(A,S)}var N=m.replace(/^bpmn:/,"");return{group:v,className:g,title:b||u("Create {type}",{type:N}),action:{dragstart:k,click:k}}}function p(m){var v=i.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),g=i.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:v});n.start(m,[v,g],{hints:{autoSelect:[v]}})}function f(m){n.start(m,i.createParticipantShape())}return G(t,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:u("Activate the hand tool"),action:{click:function(m){o.activateHand(m)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:u("Activate the lasso tool"),action:{click:function(m){r.activateSelection(m)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:u("Activate the create/remove space tool"),action:{click:function(m){a.activateSelection(m)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:u("Activate the global connect tool"),action:{click:function(m){s.start(m)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":c("bpmn:StartEvent","event","bpmn-icon-start-event-none",u("Create StartEvent")),"create.intermediate-event":c("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",u("Create Intermediate/Boundary Event")),"create.end-event":c("bpmn:EndEvent","event","bpmn-icon-end-event-none",u("Create EndEvent")),"create.exclusive-gateway":c("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",u("Create Gateway")),"create.task":c("bpmn:Task","activity","bpmn-icon-task",u("Create Task")),"create.data-object":c("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",u("Create DataObjectReference")),"create.data-store":c("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",u("Create DataStoreReference")),"create.subprocess-expanded":{group:"activity",className:"bpmn-icon-subprocess-expanded",title:u("Create expanded SubProcess"),action:{dragstart:p,click:p}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:u("Create Pool/Participant"),action:{dragstart:f,click:f}},"create.group":c("bpmn:Group","artifact","bpmn-icon-group",u("Create Group"))}),t};const VI={__depends__:[OI,Tl,SE,LI,BI,$I,gl],__init__:["paletteProvider"],paletteProvider:["type",Nf]};var FI=250;function Mf(e,t,n,i,a){ie.call(this,e);function r(s){var u=s.canExecute.replacements;B(u,function(c){var p=c.oldElementId,f={type:c.newElementType};if(!s.visualReplacements[p]){var m=t.get(p);G(f,{x:m.x,y:m.y});var v=n.createShape(f);i.addShape(v,m.parent);var g=Xe('[data-element-id="'+Nc(m.id)+'"]',s.dragGroup);g&&ee(g,{display:"none"});var b=a.addDragger(v,s.dragGroup);s.visualReplacements[p]=b,i.removeShape(v)}})}function o(s){var u=s.visualReplacements;B(u,function(c,p){var f=Xe('[data-element-id="'+Nc(p)+'"]',s.dragGroup);f&&ee(f,{display:"inline"}),c.remove(),u[p]&&delete u[p]})}e.on("shape.move.move",FI,function(s){var u=s.context,c=u.canExecute;u.visualReplacements||(u.visualReplacements={}),c&&c.replacements?r(u):o(u)})}Mf.$inject=["eventBus","elementRegistry","elementFactory","canvas","previewSupport"];se(Mf,ie);const jI={__depends__:[ao],__init__:["bpmnReplacePreview"],bpmnReplacePreview:["type",Mf]};var HI=1250,Ku=40,zI=20,GI=10,Qm=20,WE=["x","y"],UI=Math.abs;function qE(e){e.on(["connect.hover","connect.move","connect.end"],HI,function(t){var n=t.context,i=n.canExecute,a=n.start,r=n.hover,o=n.source,s=n.target;t.originalEvent&&Kt(t.originalEvent)||(n.initialConnectionStart||(n.initialConnectionStart=n.connectionStart),i&&r&&WI(t,r,XI(r)),r&&KI(i,["bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:SequenceFlow"])?(n.connectionStart=on(a),Pe(r,["bpmn:Event","bpmn:Gateway"])&&ev(t,on(r)),Pe(r,["bpmn:Task","bpmn:SubProcess"])&&qI(t,r),w(o,"bpmn:BoundaryEvent")&&s===o.host&&YI(t)):YE(i,"bpmn:MessageFlow")?(w(a,"bpmn:Event")&&(n.connectionStart=on(a)),w(r,"bpmn:Event")&&ev(t,on(r))):n.connectionStart=n.initialConnectionStart)})}qE.$inject=["eventBus"];function WI(e,t,n){WE.forEach(function(i){var a=KE(i,t);e[i]<t[i]+n?st(e,i,t[i]+n):e[i]>t[i]+a-n&&st(e,i,t[i]+a-n)})}function qI(e,t){var n=on(t);WE.forEach(function(i){ZI(e,t,i)&&st(e,i,n[i])})}function YI(e){var t=e.context,n=t.source,i=t.target;if(!JI(t)){var a=on(n),r=St(a,i,-10),o=[];/top|bottom/.test(r)&&o.push("x"),/left|right/.test(r)&&o.push("y"),o.forEach(function(s){var u=e[s],c;UI(u-a[s])<Ku&&(u>a[s]?c=a[s]+Ku:c=a[s]-Ku,st(e,s,c))})}}function ev(e,t){st(e,"x",t.x),st(e,"y",t.y)}function YE(e,t){return e&&e.type===t}function KI(e,t){return wi(t,function(n){return YE(e,n)})}function KE(e,t){return e==="x"?t.width:t.height}function XI(e){return w(e,"bpmn:Task")?GI:zI}function ZI(e,t,n){return e[n]>t[n]+Qm&&e[n]<t[n]+KE(n,t)-Qm}function JI(e){var t=e.hover,n=e.source;return t&&n&&t===n}function Oi(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}Oi.prototype.getSnapOrigin=function(e){return this._snapOrigins[e]};Oi.prototype.setSnapOrigin=function(e,t){this._snapOrigins[e]=t,this._snapLocations.indexOf(e)===-1&&this._snapLocations.push(e)};Oi.prototype.addDefaultSnap=function(e,t){var n=this._defaultSnaps[e];n||(n=this._defaultSnaps[e]=[]),n.push(t)};Oi.prototype.getSnapLocations=function(){return this._snapLocations};Oi.prototype.setSnapLocations=function(e){this._snapLocations=e};Oi.prototype.pointsForTarget=function(e){var t=e.id||e,n=this._targets[t];return n||(n=this._targets[t]=new Jl,n.initDefaults(this._defaultSnaps)),n};function Jl(e){this._snapValues={}}Jl.prototype.add=function(e,t){var n=this._snapValues[e];n||(n=this._snapValues[e]={x:[],y:[]}),n.x.indexOf(t.x)===-1&&n.x.push(t.x),n.y.indexOf(t.y)===-1&&n.y.push(t.y)};Jl.prototype.snap=function(e,t,n,i){var a=this._snapValues[t];return a&&f1(e[n],a[n],i)};Jl.prototype.initDefaults=function(e){var t=this;B(e||{},function(n,i){B(n,function(a){t.add(i,a)})})};var QI=1250;function zn(e,t,n){var i=this;this._elementRegistry=e,t.on(["create.start","shape.move.start"],function(a){i.initSnap(a)}),t.on(["create.move","create.end","shape.move.move","shape.move.end"],QI,function(a){var r=a.context,o=r.shape,s=r.snapContext,u=r.target;if(!(a.originalEvent&&Kt(a.originalEvent))&&!(Lr(a)||!u)){var c=s.pointsForTarget(u);c.initialized||(c=i.addSnapTargetPoints(c,o,u),c.initialized=!0),n.snap(a,c)}}),t.on(["create.cleanup","shape.move.cleanup"],function(){n.hide()})}zn.$inject=["elementRegistry","eventBus","snapping"];zn.prototype.initSnap=function(e){var t=this._elementRegistry,n=e.context,i=n.shape,a=n.snapContext;a||(a=n.snapContext=new Oi);var r;t.get(i.id)?r=on(i,e):r={x:e.x+on(i).x,y:e.y+on(i).y};var o={x:r.x-i.width/2,y:r.y-i.height/2},s={x:r.x+i.width/2,y:r.y+i.height/2};return a.setSnapOrigin("mid",{x:r.x-e.x,y:r.y-e.y}),qc(i)||(a.setSnapOrigin("top-left",{x:o.x-e.x,y:o.y-e.y}),a.setSnapOrigin("bottom-right",{x:s.x-e.x,y:s.y-e.y})),a};zn.prototype.addSnapTargetPoints=function(e,t,n){var i=this.getSnapTargets(t,n);return B(i,function(a){if(qc(a)){qc(t)&&e.add("mid",on(a));return}if(eN(a)){if(a.waypoints.length<3)return;var r=a.waypoints.slice(1,-1);B(r,function(o){e.add("mid",o)});return}e.add("mid",on(a))}),!ve(t.x)||!ve(t.y)||this._elementRegistry.get(t.id)&&e.add("mid",on(t)),e};zn.prototype.getSnapTargets=function(e,t){return hy(t).filter(function(n){return!tN(n)})};function eN(e){return!!e.waypoints}function tN(e){return!!e.hidden}function qc(e){return!!e.labelTarget}var tv=1500;function ia(e,t){t.invoke(zn,this),e.on(["create.move","create.end"],tv,aN),e.on(["create.move","create.end","shape.move.move","shape.move.end"],tv,function(n){var i=n.context,a=i.canExecute,r=i.target,o=a&&(a==="attach"||a.attach);o&&!Lr(n)&&nN(n,r)})}se(ia,zn);ia.$inject=["eventBus","injector"];ia.prototype.initSnap=function(e){var t=zn.prototype.initSnap.call(this,e),n=e.shape,i=!!this._elementRegistry.get(n.id);return B(n.outgoing,function(a){var r=a.waypoints[0];r=r.original||r,t.setSnapOrigin(a.id+"-docking",iv(r,i,e))}),B(n.incoming,function(a){var r=a.waypoints[a.waypoints.length-1];r=r.original||r,t.setSnapOrigin(a.id+"-docking",iv(r,i,e))}),w(n,"bpmn:Participant")&&t.setSnapLocations(["top-left","bottom-right","mid"]),t};ia.prototype.addSnapTargetPoints=function(e,t,n){zn.prototype.addSnapTargetPoints.call(this,e,t,n);var i=this.getSnapTargets(t,n);B(i,function(r){(rN(r)||iN([t,r],"bpmn:TextAnnotation"))&&(e.add("top-left",fy(r)),e.add("bottom-right",dy(r)))});var a=this._elementRegistry;return B(t.incoming,function(r){if(a.get(t.id)){nv(i,r.source)||e.add("mid",Ee(r.source));var o=r.waypoints[0];e.add(r.id+"-docking",o.original||o)}}),B(t.outgoing,function(r){if(a.get(t.id)){nv(i,r.target)||e.add("mid",Ee(r.target));var o=r.waypoints[r.waypoints.length-1];e.add(r.id+"-docking",o.original||o)}}),w(n,"bpmn:SequenceFlow")&&(e=this.addSnapTargetPoints(e,t,n.parent)),e};ia.prototype.getSnapTargets=function(e,t){return zn.prototype.getSnapTargets.call(this,e,t).filter(function(n){return!w(n,"bpmn:Lane")})};function nN(e,t){var n=ce(t),i=sE(e,t),a=e.context,r=a.shape,o;r.parent?o={x:0,y:0}:o=Ee(r),/top/.test(i)?st(e,"y",n.top-o.y):/bottom/.test(i)&&st(e,"y",n.bottom-o.y),/left/.test(i)?st(e,"x",n.left-o.x):/right/.test(i)&&st(e,"x",n.right-o.x)}function iN(e,t){return e.every(function(n){return w(n,t)})}function rN(e){return w(e,"bpmn:SubProcess")&&Le(e)?!0:w(e,"bpmn:Participant")}function aN(e){var t=e.context,n=t.createConstraints;if(n){var i=n.top,a=n.right,r=n.bottom,o=n.left;(o&&o>=e.x||a&&a<=e.x)&&st(e,"x",e.x),(i&&i>=e.y||r&&r<=e.y)&&st(e,"y",e.y)}}function nv(e,t){return e.indexOf(t)!==-1}function iv(e,t,n){return t?{x:e.x-n.x,y:e.y-n.y}:{x:e.x,y:e.y}}var oN=1250;function So(e,t){var n=this;e.on(["resize.start"],function(i){n.initSnap(i)}),e.on(["resize.move","resize.end"],oN,function(i){var a=i.context,r=a.shape,o=r.parent,s=a.direction,u=a.snapContext;if(!(i.originalEvent&&Kt(i.originalEvent))&&!Lr(i)){var c=u.pointsForTarget(o);c.initialized||(c=n.addSnapTargetPoints(c,r,o,s),c.initialized=!0),pN(s)&&st(i,"x",i.x),fN(s)&&st(i,"y",i.y),t.snap(i,c)}}),e.on(["resize.cleanup"],function(){t.hide()})}So.prototype.initSnap=function(e){var t=e.context,n=t.shape,i=t.direction,a=t.snapContext;a||(a=t.snapContext=new Oi);var r=XE(n,i);return a.setSnapOrigin("corner",{x:r.x-e.x,y:r.y-e.y}),a};So.prototype.addSnapTargetPoints=function(e,t,n,i){var a=this.getSnapTargets(t,n);return B(a,function(r){e.add("corner",dy(r)),e.add("corner",fy(r))}),e.add("corner",XE(t,i)),e};So.$inject=["eventBus","snapping"];So.prototype.getSnapTargets=function(e,t){return hy(t).filter(function(n){return!sN(n,e)&&!lN(n)&&!uN(n)&&!cN(n)})};function XE(e,t){var n=Ee(e),i=ce(e),a={x:n.x,y:n.y};return t.indexOf("n")!==-1?a.y=i.top:t.indexOf("s")!==-1&&(a.y=i.bottom),t.indexOf("e")!==-1?a.x=i.right:t.indexOf("w")!==-1&&(a.x=i.left),a}function sN(e,t){return e.host===t}function lN(e){return!!e.waypoints}function uN(e){return!!e.hidden}function cN(e){return!!e.labelTarget}function pN(e){return e==="n"||e==="s"}function fN(e){return e==="e"||e==="w"}var dN=7,hN=1e3;function Li(e){this._canvas=e,this._asyncHide=ep(Pt(this.hide,this),hN)}Li.$inject=["canvas"];Li.prototype.snap=function(e,t){var n=e.context,i=n.snapContext,a=i.getSnapLocations(),r={x:Lr(e,"x"),y:Lr(e,"y")};B(a,function(o){var s=i.getSnapOrigin(o),u={x:e.x+s.x,y:e.y+s.y};if(B(["x","y"],function(c){var p;r[c]||(p=t.snap(u,o,c,dN),p!==void 0&&(r[c]={value:p,originValue:p-s[c]}))}),r.x&&r.y)return!1}),this.showSnapLine("vertical",r.x&&r.x.value),this.showSnapLine("horizontal",r.y&&r.y.value),B(["x","y"],function(o){var s=r[o];nt(s)&&st(e,o,s.originValue)})};Li.prototype._createLine=function(e){var t=this._canvas.getLayer("snap"),n=le("path");return ee(n,{d:"M0,0 L0,0"}),Se(n).add("djs-snap-line"),fe(t,n),{update:function(i){ve(i)?e==="horizontal"?ee(n,{d:"M-100000,"+i+" L+100000,"+i,display:""}):ee(n,{d:"M "+i+",-100000 L "+i+", +100000",display:""}):ee(n,{display:"none"})}}};Li.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}};Li.prototype.showSnapLine=function(e,t){var n=this.getSnapLine(e);n&&n.update(t),this._asyncHide()};Li.prototype.getSnapLine=function(e){return this._snapLines||this._createSnapLines(),this._snapLines[e]};Li.prototype.hide=function(){B(this._snapLines,function(e){e.update()})};const mN={__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",zn],resizeSnapping:["type",So],snapping:["type",Li]},vN={__depends__:[mN],__init__:["connectSnapping","createMoveSnapping"],connectSnapping:["type",qE],createMoveSnapping:["type",ia]};function de(e,t,n,i){this._open=!1,this._results=[],this._eventMaps=[],this._canvas=e,this._eventBus=t,this._overlays=n,this._selection=i,this._container=je(de.BOX_HTML),this._searchInput=Xe(de.INPUT_SELECTOR,this._container),this._resultsContainer=Xe(de.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),t.on(["canvas.destroy","diagram.destroy"],this.close,this)}de.$inject=["canvas","eventBus","overlays","selection"];de.prototype._bindEvents=function(){var e=this;function t(n,i,a,r){e._eventMaps.push({el:n,type:a,listener:qt.bind(n,i,a,r)})}t(document,"html","click",function(n){e.close()}),t(this._container,de.INPUT_SELECTOR,"click",function(n){n.stopPropagation(),n.delegateTarget.focus()}),t(this._container,de.RESULT_SELECTOR,"mouseover",function(n){n.stopPropagation(),e._scrollToNode(n.delegateTarget),e._preselect(n.delegateTarget)}),t(this._container,de.RESULT_SELECTOR,"click",function(n){n.stopPropagation(),e._select(n.delegateTarget)}),t(this._container,de.INPUT_SELECTOR,"keydown",function(n){n.keyCode===38&&n.preventDefault(),n.keyCode===40&&n.preventDefault()}),t(this._container,de.INPUT_SELECTOR,"keyup",function(n){if(n.keyCode===27)return e.close();if(n.keyCode===13){var i=e._getCurrentResult();return i?e._select(i):e.close()}if(n.keyCode===38)return e._scrollToDirection(!0);if(n.keyCode===40)return e._scrollToDirection();n.keyCode===37||n.keyCode===39||e._search(n.delegateTarget.value)})};de.prototype._unbindEvents=function(){this._eventMaps.forEach(function(e){qt.unbind(e.el,e.type,e.listener)})};de.prototype._search=function(e){var t=this;if(this._clearResults(),!(!e||e==="")){var n=this._searchProvider.find(e);if(n.length){n.forEach(function(a){var r=a.element.id,o=t._createResultNode(a,r);t._results[r]={element:a.element,node:o}});var i=Xe(de.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(i),this._preselect(i)}}};de.prototype._scrollToDirection=function(e){var t=this._getCurrentResult();if(t){var n=e?t.previousElementSibling:t.nextElementSibling;n&&(this._scrollToNode(n),this._preselect(n))}};de.prototype._scrollToNode=function(e){if(!(!e||e===this._getCurrentResult())){var t=e.offsetTop,n=this._resultsContainer.scrollTop,i=t-this._resultsContainer.clientHeight+e.clientHeight;t<n?this._resultsContainer.scrollTop=t:n<i&&(this._resultsContainer.scrollTop=i)}};de.prototype._clearResults=function(){ol(this._resultsContainer),this._results=[],this._resetOverlay(),this._eventBus.fire("searchPad.cleared")};de.prototype._getCurrentResult=function(){return Xe(de.RESULT_SELECTED_SELECTOR,this._resultsContainer)};de.prototype._createResultNode=function(e,t){var n=je(de.RESULT_HTML);return e.primaryTokens.length>0&&rv(n,e.primaryTokens,de.RESULT_PRIMARY_HTML),rv(n,e.secondaryTokens,de.RESULT_SECONDARY_HTML),Xt(n,de.RESULT_ID_ATTRIBUTE,t),this._resultsContainer.appendChild(n),n};de.prototype.registerProvider=function(e){this._searchProvider=e};de.prototype.open=function(){if(!this._searchProvider)throw new Error("no search provider registered");this.isOpen()||(this._bindEvents(),this._open=!0,lt(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))};de.prototype.close=function(){this.isOpen()&&(this._unbindEvents(),this._open=!1,lt(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._resetOverlay(),this._eventBus.fire("searchPad.closed"))};de.prototype.toggle=function(){this.isOpen()?this.close():this.open()};de.prototype.isOpen=function(){return this._open};de.prototype._preselect=function(e){var t=this._getCurrentResult();if(e!==t){t&&lt(t).remove(de.RESULT_SELECTED_CLASS);var n=Xt(e,de.RESULT_ID_ATTRIBUTE),i=this._results[n].element;lt(e).add(de.RESULT_SELECTED_CLASS),this._resetOverlay(i),this._canvas.scrollToElement(i,{top:400}),this._selection.select(i),this._eventBus.fire("searchPad.preselected",i)}};de.prototype._select=function(e){var t=Xt(e,de.RESULT_ID_ATTRIBUTE),n=this._results[t].element;this.close(),this._resetOverlay(),this._canvas.scrollToElement(n,{top:400}),this._selection.select(n),this._eventBus.fire("searchPad.selected",n)};de.prototype._resetOverlay=function(e){if(this._overlayId&&this._overlays.remove(this._overlayId),e){var t=xt(e),n=gN(t);this._overlayId=this._overlays.add(e,n)}};function gN(e){var t=6,n=e.width+t*2,i=e.height+t*2,a=["width: "+n+"px","height: "+i+"px"].join("; ");return{position:{bottom:i-t,right:n-t},show:!0,html:'<div style="'+a+'" class="'+de.OVERLAY_CLASS+'"></div>'}}function rv(e,t,n){var i=yN(t),a=je(n);a.innerHTML=i,e.appendChild(a)}function yN(e){var t="";return e.forEach(function(n){n.matched?t+='<strong class="'+de.RESULT_HIGHLIGHT_CLASS+'">'+sh(n.matched)+"</strong>":t+=sh(n.normal)}),t!==""?t:null}de.CONTAINER_SELECTOR=".djs-search-container";de.INPUT_SELECTOR=".djs-search-input input";de.RESULTS_CONTAINER_SELECTOR=".djs-search-results";de.RESULT_SELECTOR=".djs-search-result";de.RESULT_SELECTED_CLASS="djs-search-result-selected";de.RESULT_SELECTED_SELECTOR="."+de.RESULT_SELECTED_CLASS;de.RESULT_ID_ATTRIBUTE="data-result-id";de.RESULT_HIGHLIGHT_CLASS="djs-search-highlight";de.OVERLAY_CLASS="djs-search-overlay";de.BOX_HTML='<div class="djs-search-container djs-draggable djs-scrollable"><div class="djs-search-input"><input type="text"/></div><div class="djs-search-results"></div></div>';de.RESULT_HTML='<div class="djs-search-result"></div>';de.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>';de.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>';const EN={__depends__:[bp,Fn],searchPad:["type",de]};function kf(e,t,n){this._elementRegistry=e,this._canvas=n,t.registerProvider(this)}kf.$inject=["elementRegistry","searchPad","canvas"];kf.prototype.find=function(e){var t=this._canvas.getRootElement(),n=this._elementRegistry.filter(function(i){return!i.labelTarget});return n=ge(n,function(i){return i!==t}),n=pt(n,function(i){return{primaryTokens:ov(Sn(i),e),secondaryTokens:ov(i.id,e),element:i}}),n=ge(n,function(i){return av(i.primaryTokens)||av(i.secondaryTokens)}),n=un(n,function(i){return Sn(i.element)+i.element.id}),n};function av(e){var t=ge(e,function(n){return!!n.matched});return t.length>0}function ov(e,t){var n=[],i=e;if(!e)return n;e=e.toLowerCase(),t=t.toLowerCase();var a=e.indexOf(t);return a>-1?(a!==0&&n.push({normal:i.substr(0,a)}),n.push({matched:i.substr(a,t.length)}),t.length+a<e.length&&n.push({normal:i.substr(t.length+a,e.length)})):n.push({normal:i}),n}const bN={__depends__:[EN],__init__:["bpmnSearch"],bpmnSearch:["type",kf]};var _N='<?xml version="1.0" encoding="UTF-8"?><bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" targetNamespace="http://bpmn.io/schema/bpmn" id="Definitions_1"><bpmn:process id="Process_1" isExecutable="false"><bpmn:startEvent id="StartEvent_1"/></bpmn:process><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1"><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds height="36.0" width="36.0" x="173.0" y="102.0"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>';function Ln(e){to.call(this,e)}se(Ln,to);Ln.Viewer=ri;Ln.NavigatedViewer=Ha;Ln.prototype.createDiagram=Yr(function(){return this.importXML(_N)});Ln.prototype._interactionModules=[Fg,Gg,bT,qg];Ln.prototype._modelingModules=[xT,$T,XT,GT,h1,Ip,b1,TC,wy,Tl,PC,NC,YC,ZC,JC,iA,hA,bI,RI,VI,jI,Fy,vN,bN];Ln.prototype._modules=[].concat(ri.prototype._modules,Ln.prototype._interactionModules,Ln.prototype._modelingModules);const ZE=(e,t,n)=>(n||(n="camunda"),`<?xml version="1.0" encoding="UTF-8"?>
<bpmn2:definitions 
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL"
  xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
  xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
  xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
  id="diagram_${e}"
  targetNamespace="${{activiti:"http://activiti.org/bpmn",camunda:"http://bpmn.io/schema/bpmn",flowable:"http://flowable.org/bpmn"}[n]}">
  <bpmn2:process id="${e}" name="${t}" isExecutable="true">
  </bpmn2:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="${e}">
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn2:definitions>`);function xN(e){return function(t,n){return n=n||{},t=e[t]||t,t.replace(/{([^}]+)}/g,function(i,a){let r=n[a];return e[n[a]]!==null&&e[n[a]]!==void 0&&(r=e[n[a]]),r||"{"+a+"}"})}}const SN={"Append EndEvent":"追加结束事件","Append Gateway":"追加网关","Append Task":"追加任务","Append Intermediate/Boundary Event":"追加中间抛出事件/边界事件","Activate the global connect tool":"激活全局连接工具","Append {type}":"添加 {type}","Add Lane above":"在上面添加道","Divide into two Lanes":"分割成两个道","Divide into three Lanes":"分割成三个道","Add Lane below":"在下面添加道","Append compensation activity":"追加补偿活动","Change type":"修改类型","Connect using Association":"使用关联连接","Connect using Sequence/MessageFlow or Association":"使用顺序/消息流或者关联连接","Connect using DataInputAssociation":"使用数据输入关联连接",Remove:"移除","Activate the hand tool":"激活抓手工具","Activate the lasso tool":"激活套索工具","Activate the create/remove space tool":"激活创建/删除空间工具","Create expanded SubProcess":"创建扩展子过程","Create IntermediateThrowEvent/BoundaryEvent":"创建中间抛出事件/边界事件","Create Pool/Participant":"创建池/参与者","Parallel Multi Instance":"并行多重事件","Sequential Multi Instance":"时序多重事件",DataObjectReference:"数据对象参考",DataStoreReference:"数据存储参考",Loop:"循环","Ad-hoc":"即席","Create {type}":"创建 {type}",Task:"任务","Send Task":"发送任务","Receive Task":"接收任务","User Task":"用户任务","Manual Task":"手工任务","Business Rule Task":"业务规则任务","Service Task":"服务任务","Script Task":"脚本任务","Call Activity":"调用活动","Sub Process (collapsed)":"子流程（折叠的）","Sub Process (expanded)":"子流程（展开的）","Start Event":"开始事件",StartEvent:"开始事件","Intermediate Throw Event":"中间事件","End Event":"结束事件",EndEvent:"结束事件","Create StartEvent":"创建开始事件","Create EndEvent":"创建结束事件","Create Task":"创建任务","Create User Task":"创建用户任务","Create Gateway":"创建网关","Create DataObjectReference":"创建数据对象","Create DataStoreReference":"创建数据存储","Create Group":"创建分组","Create Intermediate/Boundary Event":"创建中间/边界事件","Message Start Event":"消息开始事件","Timer Start Event":"定时开始事件","Conditional Start Event":"条件开始事件","Signal Start Event":"信号开始事件","Error Start Event":"错误开始事件","Escalation Start Event":"升级开始事件","Compensation Start Event":"补偿开始事件","Message Start Event (non-interrupting)":"消息开始事件（非中断）","Timer Start Event (non-interrupting)":"定时开始事件（非中断）","Conditional Start Event (non-interrupting)":"条件开始事件（非中断）","Signal Start Event (non-interrupting)":"信号开始事件（非中断）","Escalation Start Event (non-interrupting)":"升级开始事件（非中断）","Message Intermediate Catch Event":"消息中间捕获事件","Message Intermediate Throw Event":"消息中间抛出事件","Timer Intermediate Catch Event":"定时中间捕获事件","Escalation Intermediate Throw Event":"升级中间抛出事件","Conditional Intermediate Catch Event":"条件中间捕获事件","Link Intermediate Catch Event":"链接中间捕获事件","Link Intermediate Throw Event":"链接中间抛出事件","Compensation Intermediate Throw Event":"补偿中间抛出事件","Signal Intermediate Catch Event":"信号中间捕获事件","Signal Intermediate Throw Event":"信号中间抛出事件","Message End Event":"消息结束事件","Escalation End Event":"定时结束事件","Error End Event":"错误结束事件","Cancel End Event":"取消结束事件","Compensation End Event":"补偿结束事件","Signal End Event":"信号结束事件","Terminate End Event":"终止结束事件","Message Boundary Event":"消息边界事件","Message Boundary Event (non-interrupting)":"消息边界事件（非中断）","Timer Boundary Event":"定时边界事件","Timer Boundary Event (non-interrupting)":"定时边界事件（非中断）","Escalation Boundary Event":"升级边界事件","Escalation Boundary Event (non-interrupting)":"升级边界事件（非中断）","Conditional Boundary Event":"条件边界事件","Conditional Boundary Event (non-interrupting)":"条件边界事件（非中断）","Error Boundary Event":"错误边界事件","Cancel Boundary Event":"取消边界事件","Signal Boundary Event":"信号边界事件","Signal Boundary Event (non-interrupting)":"信号边界事件（非中断）","Compensation Boundary Event":"补偿边界事件","Exclusive Gateway":"互斥网关","Parallel Gateway":"并行网关","Inclusive Gateway":"相容网关","Complex Gateway":"复杂网关","Event based Gateway":"事件网关",Transaction:"转运","Sub Process":"子流程","Event Sub Process":"事件子流程","Collapsed Pool":"折叠池","Expanded Pool":"展开池","no parent for {element} in {parent}":"在{parent}里，{element}没有父类","no shape type specified":"没有指定的形状类型","flow elements must be children of pools/participants":"流元素必须是池/参与者的子类","out of bounds release":"out of bounds release","more than {count} child lanes":"子道大于{count} ","element required":"元素不能为空","diagram not part of bpmn:Definitions":"流程图不符合bpmn规范","no diagram to display":"没有可展示的流程图","no process or collaboration to display":"没有可展示的流程/协作","element {element} referenced by {referenced}#{property} not yet drawn":"由{referenced}#{property}引用的{element}元素仍未绘制","already rendered {element}":"{element} 已被渲染","failed to import {element}":"导入{element}失败",Id:"编号",Name:"名称",General:"常规",Details:"详情","Message Name":"消息名称",Message:"消息",Initiator:"创建者","Asynchronous Continuations":"持续异步","Asynchronous Before":"异步前","Asynchronous After":"异步后","Job Configuration":"工作配置",Exclusive:"排除","Job Priority":"工作优先级","Retry Time Cycle":"重试时间周期",Documentation:"文档","Element Documentation":"元素文档","History Configuration":"历史配置","History Time To Live":"历史的生存时间",Forms:"表单","Form Key":"表单key","Form Fields":"表单字段","Business Key":"业务key","Form Field":"表单字段",ID:"编号",Type:"类型",Label:"名称","Default Value":"默认值","Default Flow":"默认流转路径","Conditional Flow":"条件流转路径","Sequence Flow":"普通流转路径",Validation:"校验","Add Constraint":"添加约束",Config:"配置",Properties:"属性","Add Property":"添加属性",Value:"值",Listeners:"监听器","Execution Listener":"执行监听","Event Type":"事件类型","Listener Type":"监听器类型","Java Class":"Java类",Expression:"表达式","Must provide a value":"必须提供一个值","Delegate Expression":"代理表达式",Script:"脚本","Script Format":"脚本格式","Script Type":"脚本类型","Inline Script":"内联脚本","External Script":"外部脚本",Resource:"资源","Field Injection":"字段注入",Extensions:"扩展","Input/Output":"输入/输出","Input Parameters":"输入参数","Output Parameters":"输出参数",Parameters:"参数","Output Parameter":"输出参数","Timer Definition Type":"定时器定义类型","Timer Definition":"定时器定义",Date:"日期",Duration:"持续",Cycle:"循环",Signal:"信号","Signal Name":"信号名称",Escalation:"升级",Error:"错误","Link Name":"链接名称",Condition:"条件名称","Variable Name":"变量名称","Variable Event":"变量事件","Specify more than one variable change event as a comma separated list.":"多个变量事件以逗号隔开","Wait for Completion":"等待完成","Activity Ref":"活动参考","Version Tag":"版本标签",Executable:"可执行文件","External Task Configuration":"扩展任务配置","Task Priority":"任务优先级",External:"外部",Connector:"连接器","Must configure Connector":"必须配置连接器","Connector Id":"连接器编号",Implementation:"实现方式","Field Injections":"字段注入",Fields:"字段","Result Variable":"结果变量",Topic:"主题","Configure Connector":"配置连接器","Input Parameter":"输入参数",Assignee:"代理人","Candidate Users":"候选用户","Candidate Groups":"候选组","Due Date":"到期时间","Follow Up Date":"跟踪日期",Priority:"优先级","The follow up date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)":"跟踪日期必须符合EL表达式，如： ${someDate} ,或者一个ISO标准日期，如：2015-06-26T09:54:00","The due date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)":"跟踪日期必须符合EL表达式，如： ${someDate} ,或者一个ISO标准日期，如：2015-06-26T09:54:00",Variables:"变量","Candidate Starter Configuration":"候选人起动器配置","Candidate Starter Groups":"候选人起动器组","This maps to the process definition key.":"这映射到流程定义键。","Candidate Starter Users":"候选人起动器的用户","Specify more than one user as a comma separated list.":"指定多个用户作为逗号分隔的列表。","Tasklist Configuration":"Tasklist配置",Startable:"启动","Specify more than one group as a comma separated list.":"指定多个组作为逗号分隔的列表。"};var JE={exports:{}};/*!
* svg.js - A lightweight library for manipulating and animating SVG.
* @version 2.7.1
* https://svgdotjs.github.io/
*
* @copyright Wout Fierens <wout@mick-wout.com>
* @license MIT
*
* BUILT: Fri Nov 30 2018 10:01:55 GMT+0100 (GMT+01:00)
*/(function(e,t){(function(n,i){e.exports=n.document?i(n,n.document):function(a){return i(a,a.document)}})(typeof window!="undefined"?window:Ss,function(n,i){var a=typeof this!="undefined"?this:n,r=a.SVG=function(l){if(r.supported)return l=new r.Doc(l),r.parser.draw||r.prepare(),l};if(r.ns="http://www.w3.org/2000/svg",r.xmlns="http://www.w3.org/2000/xmlns/",r.xlink="http://www.w3.org/1999/xlink",r.svgjs="http://svgjs.com/svgjs",r.supported=function(){return!!i.createElementNS&&!!i.createElementNS(r.ns,"svg").createSVGRect}(),!r.supported)return!1;r.did=1e3,r.eid=function(l){return"Svgjs"+_(l)+r.did++},r.create=function(l){var d=i.createElementNS(this.ns,l);return d.setAttribute("id",this.eid(l)),d},r.extend=function(){var l,d,E,y;for(l=[].slice.call(arguments),d=l.pop(),y=l.length-1;y>=0;y--)if(l[y])for(E in d)l[y].prototype[E]=d[E];r.Set&&r.Set.inherit&&r.Set.inherit()},r.invent=function(l){var d=typeof l.create=="function"?l.create:function(){this.constructor.call(this,r.create(l.create))};return l.inherit&&(d.prototype=new l.inherit),l.extend&&r.extend(d,l.extend),l.construct&&r.extend(l.parent||r.Container,l.construct),d},r.adopt=function(l){if(!l)return null;if(l.instance)return l.instance;var d;return l.nodeName=="svg"?d=l.parentNode instanceof n.SVGElement?new r.Nested:new r.Doc:l.nodeName=="linearGradient"?d=new r.Gradient("linear"):l.nodeName=="radialGradient"?d=new r.Gradient("radial"):r[_(l.nodeName)]?d=new r[_(l.nodeName)]:d=new r.Element(l),d.type=l.nodeName,d.node=l,l.instance=d,d instanceof r.Doc&&d.namespace().defs(),d.setData(JSON.parse(l.getAttribute("svgjs:data"))||{}),d},r.prepare=function(){var l=i.getElementsByTagName("body")[0],d=(l?new r.Doc(l):r.adopt(i.documentElement).nested()).size(2,0);r.parser={body:l||i.documentElement,draw:d.style("opacity:0;position:absolute;left:-100%;top:-100%;overflow:hidden").attr("focusable","false").node,poly:d.polyline().node,path:d.path().node,native:r.create("svg")}},r.parser={native:r.create("svg")},i.addEventListener("DOMContentLoaded",function(){r.parser.draw||r.prepare()},!1),r.regex={numberAndUnit:/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,hex:/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,rgb:/rgb\((\d+),(\d+),(\d+)\)/,reference:/#([a-z0-9\-_]+)/i,transforms:/\)\s*,?\s*/,whitespace:/\s/g,isHex:/^#[a-f0-9]{3,6}$/i,isRgb:/^rgb\(/,isCss:/[^:]+:[^;]+;?/,isBlank:/^(\s+)?$/,isNumber:/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,isPercent:/^-?[\d\.]+%$/,isImage:/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,delimiter:/[\s,]+/,hyphen:/([^e])\-/gi,pathLetters:/[MLHVCSQTAZ]/gi,isPathLetter:/[MLHVCSQTAZ]/i,numbersWithDots:/((\d?\.\d+(?:e[+-]?\d+)?)((?:\.\d+(?:e[+-]?\d+)?)+))+/gi,dots:/\./g},r.utils={map:function(l,d){var E,y=l.length,h=[];for(E=0;E<y;E++)h.push(d(l[E]));return h},filter:function(l,d){var E,y=l.length,h=[];for(E=0;E<y;E++)d(l[E])&&h.push(l[E]);return h},radians:function(l){return l%360*Math.PI/180},degrees:function(l){return l*180/Math.PI%360},filterSVGElements:function(l){return this.filter(l,function(d){return d instanceof n.SVGElement})}},r.defaults={attrs:{"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","font-size":16,"font-family":"Helvetica, Arial, sans-serif","text-anchor":"start"}},r.Color=function(l){var d;this.r=0,this.g=0,this.b=0,l&&(typeof l=="string"?r.regex.isRgb.test(l)?(d=r.regex.rgb.exec(l.replace(r.regex.whitespace,"")),this.r=parseInt(d[1]),this.g=parseInt(d[2]),this.b=parseInt(d[3])):r.regex.isHex.test(l)&&(d=r.regex.hex.exec(k(l)),this.r=parseInt(d[1],16),this.g=parseInt(d[2],16),this.b=parseInt(d[3],16)):typeof l=="object"&&(this.r=l.r,this.g=l.g,this.b=l.b))},r.extend(r.Color,{toString:function(){return this.toHex()},toHex:function(){return"#"+N(this.r)+N(this.g)+N(this.b)},toRgb:function(){return"rgb("+[this.r,this.g,this.b].join()+")"},brightness:function(){return this.r/255*.3+this.g/255*.59+this.b/255*.11},morph:function(l){return this.destination=new r.Color(l),this},at:function(l){return this.destination?(l=l<0?0:l>1?1:l,new r.Color({r:~~(this.r+(this.destination.r-this.r)*l),g:~~(this.g+(this.destination.g-this.g)*l),b:~~(this.b+(this.destination.b-this.b)*l)})):this}}),r.Color.test=function(l){return l+="",r.regex.isHex.test(l)||r.regex.isRgb.test(l)},r.Color.isRgb=function(l){return l&&typeof l.r=="number"&&typeof l.g=="number"&&typeof l.b=="number"},r.Color.isColor=function(l){return r.Color.isRgb(l)||r.Color.test(l)},r.Array=function(l,d){l=(l||[]).valueOf(),l.length==0&&d&&(l=d.valueOf()),this.value=this.parse(l)},r.extend(r.Array,{morph:function(l){if(this.destination=this.parse(l),this.value.length!=this.destination.length){for(var d=this.value[this.value.length-1],E=this.destination[this.destination.length-1];this.value.length>this.destination.length;)this.destination.push(E);for(;this.value.length<this.destination.length;)this.value.push(d)}return this},settle:function(){for(var l=0,d=this.value.length,E=[];l<d;l++)E.indexOf(this.value[l])==-1&&E.push(this.value[l]);return this.value=E},at:function(l){if(!this.destination)return this;for(var d=0,E=this.value.length,y=[];d<E;d++)y.push(this.value[d]+(this.destination[d]-this.value[d])*l);return new r.Array(y)},toString:function(){return this.value.join(" ")},valueOf:function(){return this.value},parse:function(l){return l=l.valueOf(),Array.isArray(l)?l:this.split(l)},split:function(l){return l.trim().split(r.regex.delimiter).map(parseFloat)},reverse:function(){return this.value.reverse(),this},clone:function(){var l=new this.constructor;return l.value=m(this.value),l}}),r.PointArray=function(l,d){r.Array.call(this,l,d||[[0,0]])},r.PointArray.prototype=new r.Array,r.PointArray.prototype.constructor=r.PointArray,r.extend(r.PointArray,{toString:function(){for(var l=0,d=this.value.length,E=[];l<d;l++)E.push(this.value[l].join(","));return E.join(" ")},toLine:function(){return{x1:this.value[0][0],y1:this.value[0][1],x2:this.value[1][0],y2:this.value[1][1]}},at:function(l){if(!this.destination)return this;for(var d=0,E=this.value.length,y=[];d<E;d++)y.push([this.value[d][0]+(this.destination[d][0]-this.value[d][0])*l,this.value[d][1]+(this.destination[d][1]-this.value[d][1])*l]);return new r.PointArray(y)},parse:function(l){var d=[];if(l=l.valueOf(),Array.isArray(l)){if(Array.isArray(l[0]))return l.map(function(h){return h.slice()});if(l[0].x!=null)return l.map(function(h){return[h.x,h.y]})}else l=l.trim().split(r.regex.delimiter).map(parseFloat);l.length%2!==0&&l.pop();for(var E=0,y=l.length;E<y;E=E+2)d.push([l[E],l[E+1]]);return d},move:function(l,d){var E=this.bbox();if(l-=E.x,d-=E.y,!isNaN(l)&&!isNaN(d))for(var y=this.value.length-1;y>=0;y--)this.value[y]=[this.value[y][0]+l,this.value[y][1]+d];return this},size:function(l,d){var E,y=this.bbox();for(E=this.value.length-1;E>=0;E--)y.width&&(this.value[E][0]=(this.value[E][0]-y.x)*l/y.width+y.x),y.height&&(this.value[E][1]=(this.value[E][1]-y.y)*d/y.height+y.y);return this},bbox:function(){return r.parser.poly.setAttribute("points",this.toString()),r.parser.poly.getBBox()}});for(var o={M:function(l,d,E){return d.x=E.x=l[0],d.y=E.y=l[1],["M",d.x,d.y]},L:function(l,d){return d.x=l[0],d.y=l[1],["L",l[0],l[1]]},H:function(l,d){return d.x=l[0],["H",l[0]]},V:function(l,d){return d.y=l[0],["V",l[0]]},C:function(l,d){return d.x=l[4],d.y=l[5],["C",l[0],l[1],l[2],l[3],l[4],l[5]]},S:function(l,d){return d.x=l[2],d.y=l[3],["S",l[0],l[1],l[2],l[3]]},Q:function(l,d){return d.x=l[2],d.y=l[3],["Q",l[0],l[1],l[2],l[3]]},T:function(l,d){return d.x=l[0],d.y=l[1],["T",l[0],l[1]]},Z:function(l,d,E){return d.x=E.x,d.y=E.y,["Z"]},A:function(l,d){return d.x=l[5],d.y=l[6],["A",l[0],l[1],l[2],l[3],l[4],l[5],l[6]]}},s="mlhvqtcsaz".split(""),u=0,c=s.length;u<c;++u)o[s[u]]=function(l){return function(d,E,y){if(l=="H")d[0]=d[0]+E.x;else if(l=="V")d[0]=d[0]+E.y;else if(l=="A")d[5]=d[5]+E.x,d[6]=d[6]+E.y;else for(var h=0,x=d.length;h<x;++h)d[h]=d[h]+(h%2?E.y:E.x);return o[l](d,E,y)}}(s[u].toUpperCase());r.PathArray=function(l,d){r.Array.call(this,l,d||[["M",0,0]])},r.PathArray.prototype=new r.Array,r.PathArray.prototype.constructor=r.PathArray,r.extend(r.PathArray,{toString:function(){return M(this.value)},move:function(l,d){var E=this.bbox();if(l-=E.x,d-=E.y,!isNaN(l)&&!isNaN(d))for(var y,h=this.value.length-1;h>=0;h--)y=this.value[h][0],y=="M"||y=="L"||y=="T"?(this.value[h][1]+=l,this.value[h][2]+=d):y=="H"?this.value[h][1]+=l:y=="V"?this.value[h][1]+=d:y=="C"||y=="S"||y=="Q"?(this.value[h][1]+=l,this.value[h][2]+=d,this.value[h][3]+=l,this.value[h][4]+=d,y=="C"&&(this.value[h][5]+=l,this.value[h][6]+=d)):y=="A"&&(this.value[h][6]+=l,this.value[h][7]+=d);return this},size:function(l,d){var E,y,h=this.bbox();for(E=this.value.length-1;E>=0;E--)y=this.value[E][0],y=="M"||y=="L"||y=="T"?(this.value[E][1]=(this.value[E][1]-h.x)*l/h.width+h.x,this.value[E][2]=(this.value[E][2]-h.y)*d/h.height+h.y):y=="H"?this.value[E][1]=(this.value[E][1]-h.x)*l/h.width+h.x:y=="V"?this.value[E][1]=(this.value[E][1]-h.y)*d/h.height+h.y:y=="C"||y=="S"||y=="Q"?(this.value[E][1]=(this.value[E][1]-h.x)*l/h.width+h.x,this.value[E][2]=(this.value[E][2]-h.y)*d/h.height+h.y,this.value[E][3]=(this.value[E][3]-h.x)*l/h.width+h.x,this.value[E][4]=(this.value[E][4]-h.y)*d/h.height+h.y,y=="C"&&(this.value[E][5]=(this.value[E][5]-h.x)*l/h.width+h.x,this.value[E][6]=(this.value[E][6]-h.y)*d/h.height+h.y)):y=="A"&&(this.value[E][1]=this.value[E][1]*l/h.width,this.value[E][2]=this.value[E][2]*d/h.height,this.value[E][6]=(this.value[E][6]-h.x)*l/h.width+h.x,this.value[E][7]=(this.value[E][7]-h.y)*d/h.height+h.y);return this},equalCommands:function(l){var d,E,y;for(l=new r.PathArray(l),y=this.value.length===l.value.length,d=0,E=this.value.length;y&&d<E;d++)y=this.value[d][0]===l.value[d][0];return y},morph:function(l){return l=new r.PathArray(l),this.equalCommands(l)?this.destination=l:this.destination=null,this},at:function(l){if(!this.destination)return this;var d=this.value,E=this.destination.value,y=[],h=new r.PathArray,x,I,F,O;for(x=0,I=d.length;x<I;x++){for(y[x]=[d[x][0]],F=1,O=d[x].length;F<O;F++)y[x][F]=d[x][F]+(E[x][F]-d[x][F])*l;y[x][0]==="A"&&(y[x][4]=+(y[x][4]!=0),y[x][5]=+(y[x][5]!=0))}return h.value=y,h},parse:function(l){if(l instanceof r.PathArray)return l.valueOf();var d,y,E={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0};typeof l=="string"?l=l.replace(r.regex.numbersWithDots,f).replace(r.regex.pathLetters," $& ").replace(r.regex.hyphen,"$1 -").trim().split(r.regex.delimiter):l=l.reduce(function(O,H){return[].concat.call(O,H)},[]);var y=[],h=new r.Point,x=new r.Point,I=0,F=l.length;do r.regex.isPathLetter.test(l[I])?(d=l[I],++I):d=="M"?d="L":d=="m"&&(d="l"),y.push(o[d].call(null,l.slice(I,I=I+E[d.toUpperCase()]).map(parseFloat),h,x));while(F>I);return y},bbox:function(){return r.parser.path.setAttribute("d",this.toString()),r.parser.path.getBBox()}}),r.Number=r.invent({create:function(l,d){this.value=0,this.unit=d||"",typeof l=="number"?this.value=isNaN(l)?0:isFinite(l)?l:l<0?-34e37:34e37:typeof l=="string"?(d=l.match(r.regex.numberAndUnit),d&&(this.value=parseFloat(d[1]),d[5]=="%"?this.value/=100:d[5]=="s"&&(this.value*=1e3),this.unit=d[5])):l instanceof r.Number&&(this.value=l.valueOf(),this.unit=l.unit)},extend:{toString:function(){return(this.unit=="%"?~~(this.value*1e8)/1e6:this.unit=="s"?this.value/1e3:this.value)+this.unit},toJSON:function(){return this.toString()},valueOf:function(){return this.value},plus:function(l){return l=new r.Number(l),new r.Number(this+l,this.unit||l.unit)},minus:function(l){return l=new r.Number(l),new r.Number(this-l,this.unit||l.unit)},times:function(l){return l=new r.Number(l),new r.Number(this*l,this.unit||l.unit)},divide:function(l){return l=new r.Number(l),new r.Number(this/l,this.unit||l.unit)},to:function(l){var d=new r.Number(this);return typeof l=="string"&&(d.unit=l),d},morph:function(l){return this.destination=new r.Number(l),l.relative&&(this.destination.value+=this.value),this},at:function(l){return this.destination?new r.Number(this.destination).minus(this).times(l).plus(this):this}}}),r.Element=r.invent({create:function(l){this._stroke=r.defaults.attrs.stroke,this._event=null,this._events={},this.dom={},(this.node=l)&&(this.type=l.nodeName,this.node.instance=this,this._events=l._events||{},this._stroke=l.getAttribute("stroke")||this._stroke)},extend:{x:function(l){return this.attr("x",l)},y:function(l){return this.attr("y",l)},cx:function(l){return l==null?this.x()+this.width()/2:this.x(l-this.width()/2)},cy:function(l){return l==null?this.y()+this.height()/2:this.y(l-this.height()/2)},move:function(l,d){return this.x(l).y(d)},center:function(l,d){return this.cx(l).cy(d)},width:function(l){return this.attr("width",l)},height:function(l){return this.attr("height",l)},size:function(l,d){var E=A(this,l,d);return this.width(new r.Number(E.width)).height(new r.Number(E.height))},clone:function(l){this.writeDataToDom();var d=V(this.node.cloneNode(!0));return l?l.add(d):this.after(d),d},remove:function(){return this.parent()&&this.parent().removeElement(this),this},replace:function(l){return this.after(l).remove(),l},addTo:function(l){return l.put(this)},putIn:function(l){return l.add(this)},id:function(l){return this.attr("id",l)},inside:function(l,d){var E=this.bbox();return l>E.x&&d>E.y&&l<E.x+E.width&&d<E.y+E.height},show:function(){return this.style("display","")},hide:function(){return this.style("display","none")},visible:function(){return this.style("display")!="none"},toString:function(){return this.attr("id")},classes:function(){var l=this.attr("class");return l==null?[]:l.trim().split(r.regex.delimiter)},hasClass:function(l){return this.classes().indexOf(l)!=-1},addClass:function(l){if(!this.hasClass(l)){var d=this.classes();d.push(l),this.attr("class",d.join(" "))}return this},removeClass:function(l){return this.hasClass(l)&&this.attr("class",this.classes().filter(function(d){return d!=l}).join(" ")),this},toggleClass:function(l){return this.hasClass(l)?this.removeClass(l):this.addClass(l)},reference:function(l){return r.get(this.attr(l))},parent:function(l){var d=this;if(!d.node.parentNode)return null;if(d=r.adopt(d.node.parentNode),!l)return d;for(;d&&d.node instanceof n.SVGElement;){if(typeof l=="string"?d.matches(l):d instanceof l)return d;if(!d.node.parentNode||d.node.parentNode.nodeName=="#document"||d.node.parentNode.nodeName=="#document-fragment")return null;d=r.adopt(d.node.parentNode)}},doc:function(){return this instanceof r.Doc?this:this.parent(r.Doc)},parents:function(l){var d=[],E=this;do{if(E=E.parent(l),!E||!E.node)break;d.push(E)}while(E.parent);return d},matches:function(l){return g(this.node,l)},native:function(){return this.node},svg:function(l){var d=i.createElement("svg");if(l&&this instanceof r.Parent){d.innerHTML="<svg>"+l.replace(/\n/,"").replace(/<([\w:-]+)([^<]+?)\/>/g,"<$1$2></$1>")+"</svg>";for(var E=0,y=d.firstChild.childNodes.length;E<y;E++)this.node.appendChild(d.firstChild.firstChild)}else return d.appendChild(l=i.createElement("svg")),this.writeDataToDom(),l.appendChild(this.node.cloneNode(!0)),d.innerHTML.replace(/^<svg>/,"").replace(/<\/svg>$/,"");return this},writeDataToDom:function(){if(this.each||this.lines){var l=this.each?this:this.lines();l.each(function(){this.writeDataToDom()})}return this.node.removeAttribute("svgjs:data"),Object.keys(this.dom).length&&this.node.setAttribute("svgjs:data",JSON.stringify(this.dom)),this},setData:function(l){return this.dom=l,this},is:function(l){return v(this,l)}}}),r.easing={"-":function(l){return l},"<>":function(l){return-Math.cos(l*Math.PI)/2+.5},">":function(l){return Math.sin(l*Math.PI/2)},"<":function(l){return-Math.cos(l*Math.PI/2)+1}},r.morph=function(l){return function(d,E){return new r.MorphObj(d,E).at(l)}},r.Situation=r.invent({create:function(l){this.init=!1,this.reversed=!1,this.reversing=!1,this.duration=new r.Number(l.duration).valueOf(),this.delay=new r.Number(l.delay).valueOf(),this.start=+new Date+this.delay,this.finish=this.start+this.duration,this.ease=l.ease,this.loop=0,this.loops=!1,this.animations={},this.attrs={},this.styles={},this.transforms=[],this.once={}}}),r.FX=r.invent({create:function(l){this._target=l,this.situations=[],this.active=!1,this.situation=null,this.paused=!1,this.lastPos=0,this.pos=0,this.absPos=0,this._speed=1},extend:{animate:function(l,d,E){typeof l=="object"&&(d=l.ease,E=l.delay,l=l.duration);var y=new r.Situation({duration:l||1e3,delay:E||0,ease:r.easing[d||"-"]||d});return this.queue(y),this},delay:function(l){var d=new r.Situation({duration:l,delay:0,ease:r.easing["-"]});return this.queue(d)},target:function(l){return l&&l instanceof r.Element?(this._target=l,this):this._target},timeToAbsPos:function(l){return(l-this.situation.start)/(this.situation.duration/this._speed)},absPosToTime:function(l){return this.situation.duration/this._speed*l+this.situation.start},startAnimFrame:function(){this.stopAnimFrame(),this.animationFrame=n.requestAnimationFrame(function(){this.step()}.bind(this))},stopAnimFrame:function(){n.cancelAnimationFrame(this.animationFrame)},start:function(){return!this.active&&this.situation&&(this.active=!0,this.startCurrent()),this},startCurrent:function(){return this.situation.start=+new Date+this.situation.delay/this._speed,this.situation.finish=this.situation.start+this.situation.duration/this._speed,this.initAnimations().step()},queue:function(l){return(typeof l=="function"||l instanceof r.Situation)&&this.situations.push(l),this.situation||(this.situation=this.situations.shift()),this},dequeue:function(){return this.stop(),this.situation=this.situations.shift(),this.situation&&(this.situation instanceof r.Situation?this.start():this.situation.call(this)),this},initAnimations:function(){var l,d,E,y=this.situation;if(y.init)return this;for(l in y.animations)for(E=this.target()[l](),Array.isArray(E)||(E=[E]),Array.isArray(y.animations[l])||(y.animations[l]=[y.animations[l]]),d=E.length;d--;)y.animations[l][d]instanceof r.Number&&(E[d]=new r.Number(E[d])),y.animations[l][d]=E[d].morph(y.animations[l][d]);for(l in y.attrs)y.attrs[l]=new r.MorphObj(this.target().attr(l),y.attrs[l]);for(l in y.styles)y.styles[l]=new r.MorphObj(this.target().style(l),y.styles[l]);return y.initialTransformation=this.target().matrixify(),y.init=!0,this},clearQueue:function(){return this.situations=[],this},clearCurrent:function(){return this.situation=null,this},stop:function(l,d){var E=this.active;return this.active=!1,d&&this.clearQueue(),l&&this.situation&&(!E&&this.startCurrent(),this.atEnd()),this.stopAnimFrame(),this.clearCurrent()},reset:function(){if(this.situation){var l=this.situation;this.stop(),this.situation=l,this.atStart()}return this},finish:function(){for(this.stop(!0,!1);this.dequeue().situation&&this.stop(!0,!1););return this.clearQueue().clearCurrent(),this},atStart:function(){return this.at(0,!0)},atEnd:function(){return this.situation.loops===!0&&(this.situation.loops=this.situation.loop+1),typeof this.situation.loops=="number"?this.at(this.situation.loops,!0):this.at(1,!0)},at:function(l,d){var E=this.situation.duration/this._speed;return this.absPos=l,d||(this.situation.reversed&&(this.absPos=1-this.absPos),this.absPos+=this.situation.loop),this.situation.start=+new Date-this.absPos*E,this.situation.finish=this.situation.start+E,this.step(!0)},speed:function(l){return l===0?this.pause():l?(this._speed=l,this.at(this.absPos,!0)):this._speed},loop:function(l,d){var E=this.last();return E.loops=l!=null?l:!0,E.loop=0,d&&(E.reversing=!0),this},pause:function(){return this.paused=!0,this.stopAnimFrame(),this},play:function(){return this.paused?(this.paused=!1,this.at(this.absPos,!0)):this},reverse:function(l){var d=this.last();return typeof l=="undefined"?d.reversed=!d.reversed:d.reversed=l,this},progress:function(l){return l?this.situation.ease(this.pos):this.pos},after:function(l){var d=this.last(),E=function y(h){h.detail.situation==d&&(l.call(this,d),this.off("finished.fx",y))};return this.target().on("finished.fx",E),this._callStart()},during:function(l){var d=this.last(),E=function(y){y.detail.situation==d&&l.call(this,y.detail.pos,r.morph(y.detail.pos),y.detail.eased,d)};return this.target().off("during.fx",E).on("during.fx",E),this.after(function(){this.off("during.fx",E)}),this._callStart()},afterAll:function(l){var d=function E(y){l.call(this),this.off("allfinished.fx",E)};return this.target().off("allfinished.fx",d).on("allfinished.fx",d),this._callStart()},duringAll:function(l){var d=function(E){l.call(this,E.detail.pos,r.morph(E.detail.pos),E.detail.eased,E.detail.situation)};return this.target().off("during.fx",d).on("during.fx",d),this.afterAll(function(){this.off("during.fx",d)}),this._callStart()},last:function(){return this.situations.length?this.situations[this.situations.length-1]:this.situation},add:function(l,d,E){return this.last()[E||"animations"][l]=d,this._callStart()},step:function(l){if(l||(this.absPos=this.timeToAbsPos(+new Date)),this.situation.loops!==!1){var d,E,y;d=Math.max(this.absPos,0),E=Math.floor(d),this.situation.loops===!0||E<this.situation.loops?(this.pos=d-E,y=this.situation.loop,this.situation.loop=E):(this.absPos=this.situation.loops,this.pos=1,y=this.situation.loop-1,this.situation.loop=this.situation.loops),this.situation.reversing&&(this.situation.reversed=this.situation.reversed!=!!((this.situation.loop-y)%2))}else this.absPos=Math.min(this.absPos,1),this.pos=this.absPos;this.pos<0&&(this.pos=0),this.situation.reversed&&(this.pos=1-this.pos);var h=this.situation.ease(this.pos);for(var x in this.situation.once)x>this.lastPos&&x<=h&&(this.situation.once[x].call(this.target(),this.pos,h),delete this.situation.once[x]);return this.active&&this.target().fire("during",{pos:this.pos,eased:h,fx:this,situation:this.situation}),this.situation?(this.eachAt(),this.pos==1&&!this.situation.reversed||this.situation.reversed&&this.pos==0?(this.stopAnimFrame(),this.target().fire("finished",{fx:this,situation:this.situation}),this.situations.length||(this.target().fire("allfinished"),this.situations.length||(this.target().off(".fx"),this.active=!1)),this.active?this.dequeue():this.clearCurrent()):!this.paused&&this.active&&this.startAnimFrame(),this.lastPos=h,this):this},eachAt:function(){var l,d,E,y=this,h=this.target(),x=this.situation;for(l in x.animations)E=[].concat(x.animations[l]).map(function(F){return typeof F!="string"&&F.at?F.at(x.ease(y.pos),y.pos):F}),h[l].apply(h,E);for(l in x.attrs)E=[l].concat(x.attrs[l]).map(function(F){return typeof F!="string"&&F.at?F.at(x.ease(y.pos),y.pos):F}),h.attr.apply(h,E);for(l in x.styles)E=[l].concat(x.styles[l]).map(function(F){return typeof F!="string"&&F.at?F.at(x.ease(y.pos),y.pos):F}),h.style.apply(h,E);if(x.transforms.length){for(E=x.initialTransformation,l=0,d=x.transforms.length;l<d;l++){var I=x.transforms[l];if(I instanceof r.Matrix){I.relative?E=E.multiply(new r.Matrix().morph(I).at(x.ease(this.pos))):E=E.morph(I).at(x.ease(this.pos));continue}I.relative||I.undo(E.extract()),E=E.multiply(I.at(x.ease(this.pos)))}h.matrix(E)}return this},once:function(l,d,E){var y=this.last();return E||(l=y.ease(l)),y.once[l]=d,this},_callStart:function(){return setTimeout(function(){this.start()}.bind(this),0),this}},parent:r.Element,construct:{animate:function(l,d,E){return(this.fx||(this.fx=new r.FX(this))).animate(l,d,E)},delay:function(l){return(this.fx||(this.fx=new r.FX(this))).delay(l)},stop:function(l,d){return this.fx&&this.fx.stop(l,d),this},finish:function(){return this.fx&&this.fx.finish(),this},pause:function(){return this.fx&&this.fx.pause(),this},play:function(){return this.fx&&this.fx.play(),this},speed:function(l){if(this.fx){if(l==null)return this.fx.speed();this.fx.speed(l)}return this}}}),r.MorphObj=r.invent({create:function(l,d){if(r.Color.isColor(d))return new r.Color(l).morph(d);if(r.regex.delimiter.test(l))return r.regex.pathLetters.test(l)?new r.PathArray(l).morph(d):new r.Array(l).morph(d);if(r.regex.numberAndUnit.test(d))return new r.Number(l).morph(d);this.value=l,this.destination=d},extend:{at:function(l,d){return d<1?this.value:this.destination},valueOf:function(){return this.value}}}),r.extend(r.FX,{attr:function(l,d,E){if(typeof l=="object")for(var y in l)this.attr(y,l[y]);else this.add(l,d,"attrs");return this},style:function(l,d){if(typeof l=="object")for(var E in l)this.style(E,l[E]);else this.add(l,d,"styles");return this},x:function(l,d){if(this.target()instanceof r.G)return this.transform({x:l},d),this;var E=new r.Number(l);return E.relative=d,this.add("x",E)},y:function(l,d){if(this.target()instanceof r.G)return this.transform({y:l},d),this;var E=new r.Number(l);return E.relative=d,this.add("y",E)},cx:function(l){return this.add("cx",new r.Number(l))},cy:function(l){return this.add("cy",new r.Number(l))},move:function(l,d){return this.x(l).y(d)},center:function(l,d){return this.cx(l).cy(d)},size:function(l,d){if(this.target()instanceof r.Text)this.attr("font-size",l);else{var E;(!l||!d)&&(E=this.target().bbox()),l||(l=E.width/E.height*d),d||(d=E.height/E.width*l),this.add("width",new r.Number(l)).add("height",new r.Number(d))}return this},width:function(l){return this.add("width",new r.Number(l))},height:function(l){return this.add("height",new r.Number(l))},plot:function(l,d,E,y){return arguments.length==4?this.plot([l,d,E,y]):this.add("plot",new(this.target()).morphArray(l))},leading:function(l){return this.target().leading?this.add("leading",new r.Number(l)):this},viewbox:function(l,d,E,y){return this.target()instanceof r.Container&&this.add("viewbox",new r.ViewBox(l,d,E,y)),this},update:function(l){if(this.target()instanceof r.Stop){if(typeof l=="number"||l instanceof r.Number)return this.update({offset:arguments[0],color:arguments[1],opacity:arguments[2]});l.opacity!=null&&this.attr("stop-opacity",l.opacity),l.color!=null&&this.attr("stop-color",l.color),l.offset!=null&&this.attr("offset",l.offset)}return this}}),r.Box=r.invent({create:function(l,d,E,y){if(typeof l=="object"&&!(l instanceof r.Element))return r.Box.call(this,l.left!=null?l.left:l.x,l.top!=null?l.top:l.y,l.width,l.height);arguments.length==4&&(this.x=l,this.y=d,this.width=E,this.height=y),K(this)},extend:{merge:function(l){var d=new this.constructor;return d.x=Math.min(this.x,l.x),d.y=Math.min(this.y,l.y),d.width=Math.max(this.x+this.width,l.x+l.width)-d.x,d.height=Math.max(this.y+this.height,l.y+l.height)-d.y,K(d)},transform:function(l){var d=1/0,E=-1/0,y=1/0,h=-1/0,x,I=[new r.Point(this.x,this.y),new r.Point(this.x2,this.y),new r.Point(this.x,this.y2),new r.Point(this.x2,this.y2)];return I.forEach(function(F){F=F.transform(l),d=Math.min(d,F.x),E=Math.max(E,F.x),y=Math.min(y,F.y),h=Math.max(h,F.y)}),x=new this.constructor,x.x=d,x.width=E-d,x.y=y,x.height=h-y,K(x),x}}}),r.BBox=r.invent({create:function(l){if(r.Box.apply(this,[].slice.call(arguments)),l instanceof r.Element){var d;try{if(i.documentElement.contains){if(!i.documentElement.contains(l.node))throw new Exception("Element not in the dom")}else{for(var E=l.node;E.parentNode;)E=E.parentNode;if(E!=i)throw new Exception("Element not in the dom")}d=l.node.getBBox()}catch(h){if(l instanceof r.Shape){var y=l.clone(r.parser.draw.instance).show();d=y.node.getBBox(),y.remove()}else d={x:l.node.clientLeft,y:l.node.clientTop,width:l.node.clientWidth,height:l.node.clientHeight}}r.Box.call(this,d)}},inherit:r.Box,parent:r.Element,construct:{bbox:function(){return new r.BBox(this)}}}),r.BBox.prototype.constructor=r.BBox,r.extend(r.Element,{tbox:function(){return console.warn("Use of TBox is deprecated and mapped to RBox. Use .rbox() instead."),this.rbox(this.doc())}}),r.RBox=r.invent({create:function(l){r.Box.apply(this,[].slice.call(arguments)),l instanceof r.Element&&r.Box.call(this,l.node.getBoundingClientRect())},inherit:r.Box,parent:r.Element,extend:{addOffset:function(){return this.x+=n.pageXOffset,this.y+=n.pageYOffset,this}},construct:{rbox:function(l){return l?new r.RBox(this).transform(l.screenCTM().inverse()):new r.RBox(this).addOffset()}}}),r.RBox.prototype.constructor=r.RBox,r.Matrix=r.invent({create:function(l){var d,E=C([1,0,0,1,0,0]);for(l=l instanceof r.Element?l.matrixify():typeof l=="string"?C(l.split(r.regex.delimiter).map(parseFloat)):arguments.length==6?C([].slice.call(arguments)):Array.isArray(l)?C(l):typeof l=="object"?l:E,d=U.length-1;d>=0;--d)this[U[d]]=l[U[d]]!=null?l[U[d]]:E[U[d]]},extend:{extract:function(){var l=S(this,0,1),d=S(this,1,0),E=180/Math.PI*Math.atan2(l.y,l.x)-90;return{x:this.e,y:this.f,transformedX:(this.e*Math.cos(E*Math.PI/180)+this.f*Math.sin(E*Math.PI/180))/Math.sqrt(this.a*this.a+this.b*this.b),transformedY:(this.f*Math.cos(E*Math.PI/180)+this.e*Math.sin(-E*Math.PI/180))/Math.sqrt(this.c*this.c+this.d*this.d),skewX:-E,skewY:180/Math.PI*Math.atan2(d.y,d.x),scaleX:Math.sqrt(this.a*this.a+this.b*this.b),scaleY:Math.sqrt(this.c*this.c+this.d*this.d),rotation:E,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f,matrix:new r.Matrix(this)}},clone:function(){return new r.Matrix(this)},morph:function(l){return this.destination=new r.Matrix(l),this},at:function(l){if(!this.destination)return this;var d=new r.Matrix({a:this.a+(this.destination.a-this.a)*l,b:this.b+(this.destination.b-this.b)*l,c:this.c+(this.destination.c-this.c)*l,d:this.d+(this.destination.d-this.d)*l,e:this.e+(this.destination.e-this.e)*l,f:this.f+(this.destination.f-this.f)*l});return d},multiply:function(l){return new r.Matrix(this.native().multiply(D(l).native()))},inverse:function(){return new r.Matrix(this.native().inverse())},translate:function(l,d){return new r.Matrix(this.native().translate(l||0,d||0))},scale:function(l,d,E,y){return arguments.length==1?d=l:arguments.length==3&&(y=E,E=d,d=l),this.around(E,y,new r.Matrix(l,0,0,d,0,0))},rotate:function(l,d,E){return l=r.utils.radians(l),this.around(d,E,new r.Matrix(Math.cos(l),Math.sin(l),-Math.sin(l),Math.cos(l),0,0))},flip:function(l,d){return l=="x"?this.scale(-1,1,d,0):l=="y"?this.scale(1,-1,0,d):this.scale(-1,-1,l,d!=null?d:l)},skew:function(l,d,E,y){return arguments.length==1?d=l:arguments.length==3&&(y=E,E=d,d=l),l=r.utils.radians(l),d=r.utils.radians(d),this.around(E,y,new r.Matrix(1,Math.tan(d),Math.tan(l),1,0,0))},skewX:function(l,d,E){return this.skew(l,0,d,E)},skewY:function(l,d,E){return this.skew(0,l,d,E)},around:function(l,d,E){return this.multiply(new r.Matrix(1,0,0,1,l||0,d||0)).multiply(E).multiply(new r.Matrix(1,0,0,1,-l||0,-d||0))},native:function(){for(var l=r.parser.native.createSVGMatrix(),d=U.length-1;d>=0;d--)l[U[d]]=this[U[d]];return l},toString:function(){return"matrix("+z(this.a)+","+z(this.b)+","+z(this.c)+","+z(this.d)+","+z(this.e)+","+z(this.f)+")"}},parent:r.Element,construct:{ctm:function(){return new r.Matrix(this.node.getCTM())},screenCTM:function(){if(this instanceof r.Nested){var l=this.rect(1,1),d=l.node.getScreenCTM();return l.remove(),new r.Matrix(d)}return new r.Matrix(this.node.getScreenCTM())}}}),r.Point=r.invent({create:function(l,d){var E,y={x:0,y:0};E=Array.isArray(l)?{x:l[0],y:l[1]}:typeof l=="object"?{x:l.x,y:l.y}:l!=null?{x:l,y:d!=null?d:l}:y,this.x=E.x,this.y=E.y},extend:{clone:function(){return new r.Point(this)},morph:function(l,d){return this.destination=new r.Point(l,d),this},at:function(l){if(!this.destination)return this;var d=new r.Point({x:this.x+(this.destination.x-this.x)*l,y:this.y+(this.destination.y-this.y)*l});return d},native:function(){var l=r.parser.native.createSVGPoint();return l.x=this.x,l.y=this.y,l},transform:function(l){return new r.Point(this.native().matrixTransform(l.native()))}}}),r.extend(r.Element,{point:function(l,d){return new r.Point(l,d).transform(this.screenCTM().inverse())}}),r.extend(r.Element,{attr:function(l,d,E){if(l==null){for(l={},d=this.node.attributes,E=d.length-1;E>=0;E--)l[d[E].nodeName]=r.regex.isNumber.test(d[E].nodeValue)?parseFloat(d[E].nodeValue):d[E].nodeValue;return l}else if(typeof l=="object")for(d in l)this.attr(d,l[d]);else if(d===null)this.node.removeAttribute(l);else{if(d==null)return d=this.node.getAttribute(l),d==null?r.defaults.attrs[l]:r.regex.isNumber.test(d)?parseFloat(d):d;l=="stroke-width"?this.attr("stroke",parseFloat(d)>0?this._stroke:null):l=="stroke"&&(this._stroke=d),(l=="fill"||l=="stroke")&&(r.regex.isImage.test(d)&&(d=this.doc().defs().image(d,0,0)),d instanceof r.Image&&(d=this.doc().defs().pattern(0,0,function(){this.add(d)}))),typeof d=="number"?d=new r.Number(d):r.Color.isColor(d)?d=new r.Color(d):Array.isArray(d)&&(d=new r.Array(d)),l=="leading"?this.leading&&this.leading(d):typeof E=="string"?this.node.setAttributeNS(E,l,d.toString()):this.node.setAttribute(l,d.toString()),this.rebuild&&(l=="font-size"||l=="x")&&this.rebuild(l,d)}return this}}),r.extend(r.Element,{transform:function(l,d){var E=this,y,h;if(typeof l!="object")return y=new r.Matrix(E).extract(),typeof l=="string"?y[l]:y;if(y=new r.Matrix(E),d=!!d||!!l.relative,l.a!=null)y=d?y.multiply(new r.Matrix(l)):new r.Matrix(l);else if(l.rotation!=null)$(l,E),y=d?y.rotate(l.rotation,l.cx,l.cy):y.rotate(l.rotation-y.extract().rotation,l.cx,l.cy);else if(l.scale!=null||l.scaleX!=null||l.scaleY!=null){if($(l,E),l.scaleX=l.scale!=null?l.scale:l.scaleX!=null?l.scaleX:1,l.scaleY=l.scale!=null?l.scale:l.scaleY!=null?l.scaleY:1,!d){var x=y.extract();l.scaleX=l.scaleX*1/x.scaleX,l.scaleY=l.scaleY*1/x.scaleY}y=y.scale(l.scaleX,l.scaleY,l.cx,l.cy)}else if(l.skew!=null||l.skewX!=null||l.skewY!=null){if($(l,E),l.skewX=l.skew!=null?l.skew:l.skewX!=null?l.skewX:0,l.skewY=l.skew!=null?l.skew:l.skewY!=null?l.skewY:0,!d){var x=y.extract();y=y.multiply(new r.Matrix().skew(x.skewX,x.skewY,l.cx,l.cy).inverse())}y=y.skew(l.skewX,l.skewY,l.cx,l.cy)}else l.flip?(l.flip=="x"||l.flip=="y"?l.offset=l.offset==null?E.bbox()["c"+l.flip]:l.offset:l.offset==null?(h=E.bbox(),l.flip=h.cx,l.offset=h.cy):l.flip=l.offset,y=new r.Matrix().flip(l.flip,l.offset)):(l.x!=null||l.y!=null)&&(d?y=y.translate(l.x,l.y):(l.x!=null&&(y.e=l.x),l.y!=null&&(y.f=l.y)));return this.attr("transform",y)}}),r.extend(r.FX,{transform:function(l,d){var E=this.target(),y,h;return typeof l!="object"?(y=new r.Matrix(E).extract(),typeof l=="string"?y[l]:y):(d=!!d||!!l.relative,l.a!=null?y=new r.Matrix(l):l.rotation!=null?($(l,E),y=new r.Rotate(l.rotation,l.cx,l.cy)):l.scale!=null||l.scaleX!=null||l.scaleY!=null?($(l,E),l.scaleX=l.scale!=null?l.scale:l.scaleX!=null?l.scaleX:1,l.scaleY=l.scale!=null?l.scale:l.scaleY!=null?l.scaleY:1,y=new r.Scale(l.scaleX,l.scaleY,l.cx,l.cy)):l.skewX!=null||l.skewY!=null?($(l,E),l.skewX=l.skewX!=null?l.skewX:0,l.skewY=l.skewY!=null?l.skewY:0,y=new r.Skew(l.skewX,l.skewY,l.cx,l.cy)):l.flip?(l.flip=="x"||l.flip=="y"?l.offset=l.offset==null?E.bbox()["c"+l.flip]:l.offset:l.offset==null?(h=E.bbox(),l.flip=h.cx,l.offset=h.cy):l.flip=l.offset,y=new r.Matrix().flip(l.flip,l.offset)):(l.x!=null||l.y!=null)&&(y=new r.Translate(l.x,l.y)),y?(y.relative=d,this.last().transforms.push(y),this._callStart()):this)}}),r.extend(r.Element,{untransform:function(){return this.attr("transform",null)},matrixify:function(){var l=(this.attr("transform")||"").split(r.regex.transforms).slice(0,-1).map(function(d){var E=d.trim().split("(");return[E[0],E[1].split(r.regex.delimiter).map(function(y){return parseFloat(y)})]}).reduce(function(d,E){return E[0]=="matrix"?d.multiply(C(E[1])):d[E[0]].apply(d,E[1])},new r.Matrix);return l},toParent:function(l){if(this==l)return this;var d=this.screenCTM(),E=l.screenCTM().inverse();return this.addTo(l).untransform().transform(E.multiply(d)),this},toDoc:function(){return this.toParent(this.doc())}}),r.Transformation=r.invent({create:function(l,d){if(arguments.length>1&&typeof d!="boolean")return this.constructor.call(this,[].slice.call(arguments));if(Array.isArray(l))for(var E=0,y=this.arguments.length;E<y;++E)this[this.arguments[E]]=l[E];else if(typeof l=="object")for(var E=0,y=this.arguments.length;E<y;++E)this[this.arguments[E]]=l[this.arguments[E]];this.inversed=!1,d===!0&&(this.inversed=!0)},extend:{arguments:[],method:"",at:function(l){for(var d=[],E=0,y=this.arguments.length;E<y;++E)d.push(this[this.arguments[E]]);var h=this._undo||new r.Matrix;return h=new r.Matrix().morph(r.Matrix.prototype[this.method].apply(h,d)).at(l),this.inversed?h.inverse():h},undo:function(l){for(var d=0,E=this.arguments.length;d<E;++d)l[this.arguments[d]]=typeof this[this.arguments[d]]=="undefined"?0:l[this.arguments[d]];return l.cx=this.cx,l.cy=this.cy,this._undo=new r[_(this.method)](l,!0).at(1),this}}}),r.Translate=r.invent({parent:r.Matrix,inherit:r.Transformation,create:function(l,d){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["transformedX","transformedY"],method:"translate"}}),r.Rotate=r.invent({parent:r.Matrix,inherit:r.Transformation,create:function(l,d){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["rotation","cx","cy"],method:"rotate",at:function(l){var d=new r.Matrix().rotate(new r.Number().morph(this.rotation-(this._undo?this._undo.rotation:0)).at(l),this.cx,this.cy);return this.inversed?d.inverse():d},undo:function(l){return this._undo=l,this}}}),r.Scale=r.invent({parent:r.Matrix,inherit:r.Transformation,create:function(l,d){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["scaleX","scaleY","cx","cy"],method:"scale"}}),r.Skew=r.invent({parent:r.Matrix,inherit:r.Transformation,create:function(l,d){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["skewX","skewY","cx","cy"],method:"skew"}}),r.extend(r.Element,{style:function(l,d){if(arguments.length==0)return this.node.style.cssText||"";if(arguments.length<2)if(typeof l=="object")for(d in l)this.style(d,l[d]);else if(r.regex.isCss.test(l))for(l=l.split(/\s*;\s*/).filter(function(E){return!!E}).map(function(E){return E.split(/\s*:\s*/)});d=l.pop();)this.style(d[0],d[1]);else return this.node.style[b(l)];else this.node.style[b(l)]=d===null||r.regex.isBlank.test(d)?"":d;return this}}),r.Parent=r.invent({create:function(l){this.constructor.call(this,l)},inherit:r.Element,extend:{children:function(){return r.utils.map(r.utils.filterSVGElements(this.node.childNodes),function(l){return r.adopt(l)})},add:function(l,d){return d==null?this.node.appendChild(l.node):l.node!=this.node.childNodes[d]&&this.node.insertBefore(l.node,this.node.childNodes[d]),this},put:function(l,d){return this.add(l,d),l},has:function(l){return this.index(l)>=0},index:function(l){return[].slice.call(this.node.childNodes).indexOf(l.node)},get:function(l){return r.adopt(this.node.childNodes[l])},first:function(){return this.get(0)},last:function(){return this.get(this.node.childNodes.length-1)},each:function(l,d){var E,y,h=this.children();for(E=0,y=h.length;E<y;E++)h[E]instanceof r.Element&&l.apply(h[E],[E,h]),d&&h[E]instanceof r.Container&&h[E].each(l,d);return this},removeElement:function(l){return this.node.removeChild(l.node),this},clear:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return delete this._defs,this},defs:function(){return this.doc().defs()}}}),r.extend(r.Parent,{ungroup:function(l,d){return d===0||this instanceof r.Defs||this.node==r.parser.draw?this:(l=l||(this instanceof r.Doc?this:this.parent(r.Parent)),d=d||1/0,this.each(function(){return this instanceof r.Defs?this:this instanceof r.Parent?this.ungroup(l,d-1):this.toParent(l)}),this.node.firstChild||this.remove(),this)},flatten:function(l,d){return this.ungroup(l,d)}}),r.Container=r.invent({create:function(l){this.constructor.call(this,l)},inherit:r.Parent}),r.ViewBox=r.invent({create:function(l){var d=[0,0,0,0],E,y,h,x,I,F,O,H=1,W=1,Y=/[+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?/gi;if(l instanceof r.Element){for(F=l,O=l,I=(l.attr("viewBox")||"").match(Y),l.bbox,h=new r.Number(l.width()),x=new r.Number(l.height());h.unit=="%";)H*=h.value,h=new r.Number(F instanceof r.Doc?F.parent().offsetWidth:F.parent().width()),F=F.parent();for(;x.unit=="%";)W*=x.value,x=new r.Number(O instanceof r.Doc?O.parent().offsetHeight:O.parent().height()),O=O.parent();this.x=0,this.y=0,this.width=h*H,this.height=x*W,this.zoom=1,I&&(E=parseFloat(I[0]),y=parseFloat(I[1]),h=parseFloat(I[2]),x=parseFloat(I[3]),this.zoom=this.width/this.height>h/x?this.height/x:this.width/h,this.x=E,this.y=y,this.width=h,this.height=x)}else l=typeof l=="string"?l.match(Y).map(function(he){return parseFloat(he)}):Array.isArray(l)?l:typeof l=="object"?[l.x,l.y,l.width,l.height]:arguments.length==4?[].slice.call(arguments):d,this.x=l[0],this.y=l[1],this.width=l[2],this.height=l[3]},extend:{toString:function(){return this.x+" "+this.y+" "+this.width+" "+this.height},morph:function(l,d,E,y){return this.destination=new r.ViewBox(l,d,E,y),this},at:function(l){return this.destination?new r.ViewBox([this.x+(this.destination.x-this.x)*l,this.y+(this.destination.y-this.y)*l,this.width+(this.destination.width-this.width)*l,this.height+(this.destination.height-this.height)*l]):this}},parent:r.Container,construct:{viewbox:function(l,d,E,y){return arguments.length==0?new r.ViewBox(this):this.attr("viewBox",new r.ViewBox(l,d,E,y))}}}),["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","touchstart","touchmove","touchleave","touchend","touchcancel"].forEach(function(l){r.Element.prototype[l]=function(d){return d==null?r.off(this,l):r.on(this,l,d),this}}),r.listenerId=0,r.on=function(l,d,E,y,h){var x=E.bind(y||l),I=l instanceof r.Element?l.node:l;I.instance=I.instance||{_events:{}};var F=I.instance._events;E._svgjsListenerId||(E._svgjsListenerId=++r.listenerId),d.split(r.regex.delimiter).forEach(function(O){var H=O.split(".")[0],W=O.split(".")[1]||"*";F[H]=F[H]||{},F[H][W]=F[H][W]||{},F[H][W][E._svgjsListenerId]=x,I.addEventListener(H,x,h||!1)})},r.off=function(l,d,E,y){var h=l instanceof r.Element?l.node:l;if(h.instance&&!(typeof E=="function"&&(E=E._svgjsListenerId,!E))){var x=h.instance._events;(d||"").split(r.regex.delimiter).forEach(function(I){var F=I&&I.split(".")[0],O=I&&I.split(".")[1],H,W;if(E)x[F]&&x[F][O||"*"]&&(h.removeEventListener(F,x[F][O||"*"][E],y||!1),delete x[F][O||"*"][E]);else if(F&&O){if(x[F]&&x[F][O]){for(W in x[F][O])r.off(h,[F,O].join("."),W);delete x[F][O]}}else if(O)for(I in x)for(H in x[I])O===H&&r.off(h,[I,O].join("."));else if(F){if(x[F]){for(H in x[F])r.off(h,[F,H].join("."));delete x[F]}}else{for(I in x)r.off(h,I);h.instance._events={}}})}},r.extend(r.Element,{on:function(l,d,E,y){return r.on(this,l,d,E,y),this},off:function(l,d){return r.off(this.node,l,d),this},fire:function(l,d){return l instanceof n.Event?this.node.dispatchEvent(l):this.node.dispatchEvent(l=new r.CustomEvent(l,{detail:d,cancelable:!0})),this._event=l,this},event:function(){return this._event}}),r.Defs=r.invent({create:"defs",inherit:r.Container}),r.G=r.invent({create:"g",inherit:r.Container,extend:{x:function(l){return l==null?this.transform("x"):this.transform({x:l-this.x()},!0)},y:function(l){return l==null?this.transform("y"):this.transform({y:l-this.y()},!0)},cx:function(l){return l==null?this.gbox().cx:this.x(l-this.gbox().width/2)},cy:function(l){return l==null?this.gbox().cy:this.y(l-this.gbox().height/2)},gbox:function(){var l=this.bbox(),d=this.transform();return l.x+=d.x,l.x2+=d.x,l.cx+=d.x,l.y+=d.y,l.y2+=d.y,l.cy+=d.y,l}},construct:{group:function(){return this.put(new r.G)}}}),r.Doc=r.invent({create:function(l){l&&(l=typeof l=="string"?i.getElementById(l):l,l.nodeName=="svg"?this.constructor.call(this,l):(this.constructor.call(this,r.create("svg")),l.appendChild(this.node),this.size("100%","100%")),this.namespace().defs())},inherit:r.Container,extend:{namespace:function(){return this.attr({xmlns:r.ns,version:"1.1"}).attr("xmlns:xlink",r.xlink,r.xmlns).attr("xmlns:svgjs",r.svgjs,r.xmlns)},defs:function(){if(!this._defs){var l;(l=this.node.getElementsByTagName("defs")[0])?this._defs=r.adopt(l):this._defs=new r.Defs,this.node.appendChild(this._defs.node)}return this._defs},parent:function(){return!this.node.parentNode||this.node.parentNode.nodeName=="#document"||this.node.parentNode.nodeName=="#document-fragment"?null:this.node.parentNode},spof:function(){var l=this.node.getScreenCTM();return l&&this.style("left",-l.e%1+"px").style("top",-l.f%1+"px"),this},remove:function(){return this.parent()&&this.parent().removeChild(this.node),this},clear:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return delete this._defs,r.parser.draw.parentNode||this.node.appendChild(r.parser.draw),this},clone:function(l){this.writeDataToDom();var d=this.node,E=V(d.cloneNode(!0));return l?(l.node||l).appendChild(E.node):d.parentNode.insertBefore(E.node,d.nextSibling),E}}}),r.extend(r.Element,{siblings:function(){return this.parent().children()},position:function(){return this.parent().index(this)},next:function(){return this.siblings()[this.position()+1]},previous:function(){return this.siblings()[this.position()-1]},forward:function(){var l=this.position()+1,d=this.parent();return d.removeElement(this).add(this,l),d instanceof r.Doc&&d.node.appendChild(d.defs().node),this},backward:function(){var l=this.position();return l>0&&this.parent().removeElement(this).add(this,l-1),this},front:function(){var l=this.parent();return l.node.appendChild(this.node),l instanceof r.Doc&&l.node.appendChild(l.defs().node),this},back:function(){return this.position()>0&&this.parent().removeElement(this).add(this,0),this},before:function(l){l.remove();var d=this.position();return this.parent().add(l,d),this},after:function(l){l.remove();var d=this.position();return this.parent().add(l,d+1),this}}),r.Mask=r.invent({create:function(){this.constructor.call(this,r.create("mask")),this.targets=[]},inherit:r.Container,extend:{remove:function(){for(var l=this.targets.length-1;l>=0;l--)this.targets[l]&&this.targets[l].unmask();return this.targets=[],r.Element.prototype.remove.call(this),this}},construct:{mask:function(){return this.defs().put(new r.Mask)}}}),r.extend(r.Element,{maskWith:function(l){return this.masker=l instanceof r.Mask?l:this.parent().mask().add(l),this.masker.targets.push(this),this.attr("mask",'url("#'+this.masker.attr("id")+'")')},unmask:function(){return delete this.masker,this.attr("mask",null)}}),r.ClipPath=r.invent({create:function(){this.constructor.call(this,r.create("clipPath")),this.targets=[]},inherit:r.Container,extend:{remove:function(){for(var l=this.targets.length-1;l>=0;l--)this.targets[l]&&this.targets[l].unclip();return this.targets=[],this.parent().removeElement(this),this}},construct:{clip:function(){return this.defs().put(new r.ClipPath)}}}),r.extend(r.Element,{clipWith:function(l){return this.clipper=l instanceof r.ClipPath?l:this.parent().clip().add(l),this.clipper.targets.push(this),this.attr("clip-path",'url("#'+this.clipper.attr("id")+'")')},unclip:function(){return delete this.clipper,this.attr("clip-path",null)}}),r.Gradient=r.invent({create:function(l){this.constructor.call(this,r.create(l+"Gradient")),this.type=l},inherit:r.Container,extend:{at:function(l,d,E){return this.put(new r.Stop).update(l,d,E)},update:function(l){return this.clear(),typeof l=="function"&&l.call(this,this),this},fill:function(){return"url(#"+this.id()+")"},toString:function(){return this.fill()},attr:function(l,d,E){return l=="transform"&&(l="gradientTransform"),r.Container.prototype.attr.call(this,l,d,E)}},construct:{gradient:function(l,d){return this.defs().gradient(l,d)}}}),r.extend(r.Gradient,r.FX,{from:function(l,d){return(this._target||this).type=="radial"?this.attr({fx:new r.Number(l),fy:new r.Number(d)}):this.attr({x1:new r.Number(l),y1:new r.Number(d)})},to:function(l,d){return(this._target||this).type=="radial"?this.attr({cx:new r.Number(l),cy:new r.Number(d)}):this.attr({x2:new r.Number(l),y2:new r.Number(d)})}}),r.extend(r.Defs,{gradient:function(l,d){return this.put(new r.Gradient(l)).update(d)}}),r.Stop=r.invent({create:"stop",inherit:r.Element,extend:{update:function(l){return(typeof l=="number"||l instanceof r.Number)&&(l={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),l.opacity!=null&&this.attr("stop-opacity",l.opacity),l.color!=null&&this.attr("stop-color",l.color),l.offset!=null&&this.attr("offset",new r.Number(l.offset)),this}}}),r.Pattern=r.invent({create:"pattern",inherit:r.Container,extend:{fill:function(){return"url(#"+this.id()+")"},update:function(l){return this.clear(),typeof l=="function"&&l.call(this,this),this},toString:function(){return this.fill()},attr:function(l,d,E){return l=="transform"&&(l="patternTransform"),r.Container.prototype.attr.call(this,l,d,E)}},construct:{pattern:function(l,d,E){return this.defs().pattern(l,d,E)}}}),r.extend(r.Defs,{pattern:function(l,d,E){return this.put(new r.Pattern).update(E).attr({x:0,y:0,width:l,height:d,patternUnits:"userSpaceOnUse"})}}),r.Shape=r.invent({create:function(l){this.constructor.call(this,l)},inherit:r.Element}),r.Bare=r.invent({create:function(l,d){if(this.constructor.call(this,r.create(l)),d)for(var E in d.prototype)typeof d.prototype[E]=="function"&&(this[E]=d.prototype[E])},inherit:r.Element,extend:{words:function(l){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return this.node.appendChild(i.createTextNode(l)),this}}}),r.extend(r.Parent,{element:function(l,d){return this.put(new r.Bare(l,d))}}),r.Symbol=r.invent({create:"symbol",inherit:r.Container,construct:{symbol:function(){return this.put(new r.Symbol)}}}),r.Use=r.invent({create:"use",inherit:r.Shape,extend:{element:function(l,d){return this.attr("href",(d||"")+"#"+l,r.xlink)}},construct:{use:function(l,d){return this.put(new r.Use).element(l,d)}}}),r.Rect=r.invent({create:"rect",inherit:r.Shape,construct:{rect:function(l,d){return this.put(new r.Rect).size(l,d)}}}),r.Circle=r.invent({create:"circle",inherit:r.Shape,construct:{circle:function(l){return this.put(new r.Circle).rx(new r.Number(l).divide(2)).move(0,0)}}}),r.extend(r.Circle,r.FX,{rx:function(l){return this.attr("r",l)},ry:function(l){return this.rx(l)}}),r.Ellipse=r.invent({create:"ellipse",inherit:r.Shape,construct:{ellipse:function(l,d){return this.put(new r.Ellipse).size(l,d).move(0,0)}}}),r.extend(r.Ellipse,r.Rect,r.FX,{rx:function(l){return this.attr("rx",l)},ry:function(l){return this.attr("ry",l)}}),r.extend(r.Circle,r.Ellipse,{x:function(l){return l==null?this.cx()-this.rx():this.cx(l+this.rx())},y:function(l){return l==null?this.cy()-this.ry():this.cy(l+this.ry())},cx:function(l){return l==null?this.attr("cx"):this.attr("cx",l)},cy:function(l){return l==null?this.attr("cy"):this.attr("cy",l)},width:function(l){return l==null?this.rx()*2:this.rx(new r.Number(l).divide(2))},height:function(l){return l==null?this.ry()*2:this.ry(new r.Number(l).divide(2))},size:function(l,d){var E=A(this,l,d);return this.rx(new r.Number(E.width).divide(2)).ry(new r.Number(E.height).divide(2))}}),r.Line=r.invent({create:"line",inherit:r.Shape,extend:{array:function(){return new r.PointArray([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])},plot:function(l,d,E,y){return l==null?this.array():(typeof d!="undefined"?l={x1:l,y1:d,x2:E,y2:y}:l=new r.PointArray(l).toLine(),this.attr(l))},move:function(l,d){return this.attr(this.array().move(l,d).toLine())},size:function(l,d){var E=A(this,l,d);return this.attr(this.array().size(E.width,E.height).toLine())}},construct:{line:function(l,d,E,y){return r.Line.prototype.plot.apply(this.put(new r.Line),l!=null?[l,d,E,y]:[0,0,0,0])}}}),r.Polyline=r.invent({create:"polyline",inherit:r.Shape,construct:{polyline:function(l){return this.put(new r.Polyline).plot(l||new r.PointArray)}}}),r.Polygon=r.invent({create:"polygon",inherit:r.Shape,construct:{polygon:function(l){return this.put(new r.Polygon).plot(l||new r.PointArray)}}}),r.extend(r.Polyline,r.Polygon,{array:function(){return this._array||(this._array=new r.PointArray(this.attr("points")))},plot:function(l){return l==null?this.array():this.clear().attr("points",typeof l=="string"?l:this._array=new r.PointArray(l))},clear:function(){return delete this._array,this},move:function(l,d){return this.attr("points",this.array().move(l,d))},size:function(l,d){var E=A(this,l,d);return this.attr("points",this.array().size(E.width,E.height))}}),r.extend(r.Line,r.Polyline,r.Polygon,{morphArray:r.PointArray,x:function(l){return l==null?this.bbox().x:this.move(l,this.bbox().y)},y:function(l){return l==null?this.bbox().y:this.move(this.bbox().x,l)},width:function(l){var d=this.bbox();return l==null?d.width:this.size(l,d.height)},height:function(l){var d=this.bbox();return l==null?d.height:this.size(d.width,l)}}),r.Path=r.invent({create:"path",inherit:r.Shape,extend:{morphArray:r.PathArray,array:function(){return this._array||(this._array=new r.PathArray(this.attr("d")))},plot:function(l){return l==null?this.array():this.clear().attr("d",typeof l=="string"?l:this._array=new r.PathArray(l))},clear:function(){return delete this._array,this},move:function(l,d){return this.attr("d",this.array().move(l,d))},x:function(l){return l==null?this.bbox().x:this.move(l,this.bbox().y)},y:function(l){return l==null?this.bbox().y:this.move(this.bbox().x,l)},size:function(l,d){var E=A(this,l,d);return this.attr("d",this.array().size(E.width,E.height))},width:function(l){return l==null?this.bbox().width:this.size(l,this.bbox().height)},height:function(l){return l==null?this.bbox().height:this.size(this.bbox().width,l)}},construct:{path:function(l){return this.put(new r.Path).plot(l||new r.PathArray)}}}),r.Image=r.invent({create:"image",inherit:r.Shape,extend:{load:function(l){if(!l)return this;var d=this,E=new n.Image;return r.on(E,"load",function(){r.off(E);var y=d.parent(r.Pattern);y!==null&&(d.width()==0&&d.height()==0&&d.size(E.width,E.height),y&&y.width()==0&&y.height()==0&&y.size(d.width(),d.height()),typeof d._loaded=="function"&&d._loaded.call(d,{width:E.width,height:E.height,ratio:E.width/E.height,url:l}))}),r.on(E,"error",function(y){r.off(E),typeof d._error=="function"&&d._error.call(d,y)}),this.attr("href",E.src=this.src=l,r.xlink)},loaded:function(l){return this._loaded=l,this},error:function(l){return this._error=l,this}},construct:{image:function(l,d,E){return this.put(new r.Image).load(l).size(d||0,E||d||0)}}}),r.Text=r.invent({create:function(){this.constructor.call(this,r.create("text")),this.dom.leading=new r.Number(1.3),this._rebuild=!0,this._build=!1,this.attr("font-family",r.defaults.attrs["font-family"])},inherit:r.Shape,extend:{x:function(l){return l==null?this.attr("x"):this.attr("x",l)},y:function(l){var d=this.attr("y"),E=typeof d=="number"?d-this.bbox().y:0;return l==null?typeof d=="number"?d-E:d:this.attr("y",typeof l.valueOf()=="number"?l+E:l)},cx:function(l){return l==null?this.bbox().cx:this.x(l-this.bbox().width/2)},cy:function(l){return l==null?this.bbox().cy:this.y(l-this.bbox().height/2)},text:function(l){if(typeof l=="undefined"){for(var l="",d=this.node.childNodes,E=0,y=d.length;E<y;++E)E!=0&&d[E].nodeType!=3&&r.adopt(d[E]).dom.newLined==!0&&(l+=`
`),l+=d[E].textContent;return l}if(this.clear().build(!0),typeof l=="function")l.call(this,this);else{l=l.split(`
`);for(var E=0,h=l.length;E<h;E++)this.tspan(l[E]).newLine()}return this.build(!1).rebuild()},size:function(l){return this.attr("font-size",l).rebuild()},leading:function(l){return l==null?this.dom.leading:(this.dom.leading=new r.Number(l),this.rebuild())},lines:function(){var l=(this.textPath&&this.textPath()||this).node,d=r.utils.map(r.utils.filterSVGElements(l.childNodes),function(E){return r.adopt(E)});return new r.Set(d)},rebuild:function(l){if(typeof l=="boolean"&&(this._rebuild=l),this._rebuild){var d=this,E=0,y=this.dom.leading*new r.Number(this.attr("font-size"));this.lines().each(function(){this.dom.newLined&&(d.textPath()||this.attr("x",d.attr("x")),this.text()==`
`?E+=y:(this.attr("dy",y+E),E=0))}),this.fire("rebuild")}return this},build:function(l){return this._build=!!l,this},setData:function(l){return this.dom=l,this.dom.leading=new r.Number(l.leading||1.3),this}},construct:{text:function(l){return this.put(new r.Text).text(l)},plain:function(l){return this.put(new r.Text).plain(l)}}}),r.Tspan=r.invent({create:"tspan",inherit:r.Shape,extend:{text:function(l){return l==null?this.node.textContent+(this.dom.newLined?`
`:""):(typeof l=="function"?l.call(this,this):this.plain(l),this)},dx:function(l){return this.attr("dx",l)},dy:function(l){return this.attr("dy",l)},newLine:function(){var l=this.parent(r.Text);return this.dom.newLined=!0,this.dy(l.dom.leading*l.attr("font-size")).attr("x",l.x())}}}),r.extend(r.Text,r.Tspan,{plain:function(l){return this._build===!1&&this.clear(),this.node.appendChild(i.createTextNode(l)),this},tspan:function(l){var d=(this.textPath&&this.textPath()||this).node,E=new r.Tspan;return this._build===!1&&this.clear(),d.appendChild(E.node),E.text(l)},clear:function(){for(var l=(this.textPath&&this.textPath()||this).node;l.hasChildNodes();)l.removeChild(l.lastChild);return this},length:function(){return this.node.getComputedTextLength()}}),r.TextPath=r.invent({create:"textPath",inherit:r.Parent,parent:r.Text,construct:{morphArray:r.PathArray,path:function(l){for(var d=new r.TextPath,E=this.doc().defs().path(l);this.node.hasChildNodes();)d.node.appendChild(this.node.firstChild);return this.node.appendChild(d.node),d.attr("href","#"+E,r.xlink),this},array:function(){var l=this.track();return l?l.array():null},plot:function(l){var d=this.track(),E=null;return d&&(E=d.plot(l)),l==null?E:this},track:function(){var l=this.textPath();if(l)return l.reference("href")},textPath:function(){if(this.node.firstChild&&this.node.firstChild.nodeName=="textPath")return r.adopt(this.node.firstChild)}}}),r.Nested=r.invent({create:function(){this.constructor.call(this,r.create("svg")),this.style("overflow","visible")},inherit:r.Container,construct:{nested:function(){return this.put(new r.Nested)}}}),r.A=r.invent({create:"a",inherit:r.Container,extend:{to:function(l){return this.attr("href",l,r.xlink)},show:function(l){return this.attr("show",l,r.xlink)},target:function(l){return this.attr("target",l)}},construct:{link:function(l){return this.put(new r.A).to(l)}}}),r.extend(r.Element,{linkTo:function(l){var d=new r.A;return typeof l=="function"?l.call(d,d):d.to(l),this.parent().put(d).put(this)}}),r.Marker=r.invent({create:"marker",inherit:r.Container,extend:{width:function(l){return this.attr("markerWidth",l)},height:function(l){return this.attr("markerHeight",l)},ref:function(l,d){return this.attr("refX",l).attr("refY",d)},update:function(l){return this.clear(),typeof l=="function"&&l.call(this,this),this},toString:function(){return"url(#"+this.id()+")"}},construct:{marker:function(l,d,E){return this.defs().marker(l,d,E)}}}),r.extend(r.Defs,{marker:function(l,d,E){return this.put(new r.Marker).size(l,d).ref(l/2,d/2).viewbox(0,0,l,d).attr("orient","auto").update(E)}}),r.extend(r.Line,r.Polyline,r.Polygon,r.Path,{marker:function(l,d,E,y){var h=["marker"];return l!="all"&&h.push(l),h=h.join("-"),l=arguments[1]instanceof r.Marker?arguments[1]:this.doc().marker(d,E,y),this.attr(h,l)}});var p={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(l,d){return d=="color"?l:l+"-"+d}};["fill","stroke"].forEach(function(l){var d,E={};E[l]=function(y){if(typeof y=="undefined")return this;if(typeof y=="string"||r.Color.isRgb(y)||y&&typeof y.fill=="function")this.attr(l,y);else for(d=p[l].length-1;d>=0;d--)y[p[l][d]]!=null&&this.attr(p.prefix(l,p[l][d]),y[p[l][d]]);return this},r.extend(r.Element,r.FX,E)}),r.extend(r.Element,r.FX,{rotate:function(l,d,E){return this.transform({rotation:l,cx:d,cy:E})},skew:function(l,d,E,y){return arguments.length==1||arguments.length==3?this.transform({skew:l,cx:d,cy:E}):this.transform({skewX:l,skewY:d,cx:E,cy:y})},scale:function(l,d,E,y){return arguments.length==1||arguments.length==3?this.transform({scale:l,cx:d,cy:E}):this.transform({scaleX:l,scaleY:d,cx:E,cy:y})},translate:function(l,d){return this.transform({x:l,y:d})},flip:function(l,d){return d=typeof l=="number"?l:d,this.transform({flip:l||"both",offset:d})},matrix:function(l){return this.attr("transform",new r.Matrix(arguments.length==6?[].slice.call(arguments):l))},opacity:function(l){return this.attr("opacity",l)},dx:function(l){return this.x(new r.Number(l).plus(this instanceof r.FX?0:this.x()),!0)},dy:function(l){return this.y(new r.Number(l).plus(this instanceof r.FX?0:this.y()),!0)},dmove:function(l,d){return this.dx(l).dy(d)}}),r.extend(r.Rect,r.Ellipse,r.Circle,r.Gradient,r.FX,{radius:function(l,d){var E=(this._target||this).type;return E=="radial"||E=="circle"?this.attr("r",new r.Number(l)):this.rx(l).ry(d==null?l:d)}}),r.extend(r.Path,{length:function(){return this.node.getTotalLength()},pointAt:function(l){return this.node.getPointAtLength(l)}}),r.extend(r.Parent,r.Text,r.Tspan,r.FX,{font:function(l,d){if(typeof l=="object")for(d in l)this.font(d,l[d]);return l=="leading"?this.leading(d):l=="anchor"?this.attr("text-anchor",d):l=="size"||l=="family"||l=="weight"||l=="stretch"||l=="variant"||l=="style"?this.attr("font-"+l,d):this.attr(l,d)}}),r.Set=r.invent({create:function(l){l instanceof r.Set?this.members=l.members.slice():Array.isArray(l)?this.members=l:this.clear()},extend:{add:function(){var l,d,E=[].slice.call(arguments);for(l=0,d=E.length;l<d;l++)this.members.push(E[l]);return this},remove:function(l){var d=this.index(l);return d>-1&&this.members.splice(d,1),this},each:function(l){for(var d=0,E=this.members.length;d<E;d++)l.apply(this.members[d],[d,this.members]);return this},clear:function(){return this.members=[],this},length:function(){return this.members.length},has:function(l){return this.index(l)>=0},index:function(l){return this.members.indexOf(l)},get:function(l){return this.members[l]},first:function(){return this.get(0)},last:function(){return this.get(this.members.length-1)},valueOf:function(){return this.members},bbox:function(){if(this.members.length==0)return new r.RBox;var l=this.members[0].rbox(this.members[0].doc());return this.each(function(){l=l.merge(this.rbox(this.doc()))}),l}},construct:{set:function(l){return new r.Set(l)}}}),r.FX.Set=r.invent({create:function(l){this.set=l}}),r.Set.inherit=function(){var l,d=[];for(var l in r.Shape.prototype)typeof r.Shape.prototype[l]=="function"&&typeof r.Set.prototype[l]!="function"&&d.push(l);d.forEach(function(E){r.Set.prototype[E]=function(){for(var y=0,h=this.members.length;y<h;y++)this.members[y]&&typeof this.members[y][E]=="function"&&this.members[y][E].apply(this.members[y],arguments);return E=="animate"?this.fx||(this.fx=new r.FX.Set(this)):this}}),d=[];for(var l in r.FX.prototype)typeof r.FX.prototype[l]=="function"&&typeof r.FX.Set.prototype[l]!="function"&&d.push(l);d.forEach(function(E){r.FX.Set.prototype[E]=function(){for(var y=0,h=this.set.members.length;y<h;y++)this.set.members[y].fx[E].apply(this.set.members[y].fx,arguments);return this}})},r.extend(r.Element,{data:function(l,d,E){if(typeof l=="object")for(d in l)this.data(d,l[d]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+l))}catch(y){return this.attr("data-"+l)}else this.attr("data-"+l,d===null?null:E===!0||typeof d=="string"||typeof d=="number"?d:JSON.stringify(d));return this}}),r.extend(r.Element,{remember:function(l,d){if(typeof arguments[0]=="object")for(var d in l)this.remember(d,l[d]);else{if(arguments.length==1)return this.memory()[l];this.memory()[l]=d}return this},forget:function(){if(arguments.length==0)this._memory={};else for(var l=arguments.length-1;l>=0;l--)delete this.memory()[arguments[l]];return this},memory:function(){return this._memory||(this._memory={})}}),r.get=function(l){var d=i.getElementById(X(l)||l);return r.adopt(d)},r.select=function(l,d){return new r.Set(r.utils.map((d||i).querySelectorAll(l),function(E){return r.adopt(E)}))},r.extend(r.Parent,{select:function(l){return r.select(l,this.node)}});function f(l,d,E,y){return E+y.replace(r.regex.dots," .")}function m(l){for(var d=l.slice(0),E=d.length;E--;)Array.isArray(d[E])&&(d[E]=m(d[E]));return d}function v(l,d){return l instanceof d}function g(l,d){return(l.matches||l.matchesSelector||l.msMatchesSelector||l.mozMatchesSelector||l.webkitMatchesSelector||l.oMatchesSelector).call(l,d)}function b(l){return l.toLowerCase().replace(/-(.)/g,function(d,E){return E.toUpperCase()})}function _(l){return l.charAt(0).toUpperCase()+l.slice(1)}function k(l){return l.length==4?["#",l.substring(1,2),l.substring(1,2),l.substring(2,3),l.substring(2,3),l.substring(3,4),l.substring(3,4)].join(""):l}function N(l){var d=l.toString(16);return d.length==1?"0"+d:d}function A(l,d,E){if(d==null||E==null){var y=l.bbox();d==null?d=y.width/y.height*E:E==null&&(E=y.height/y.width*d)}return{width:d,height:E}}function S(l,d,E){return{x:d*l.a+E*l.c+0,y:d*l.b+E*l.d+0}}function C(l){return{a:l[0],b:l[1],c:l[2],d:l[3],e:l[4],f:l[5]}}function D(l){return l instanceof r.Matrix||(l=new r.Matrix(l)),l}function $(l,d){l.cx=l.cx==null?d.bbox().cx:l.cx,l.cy=l.cy==null?d.bbox().cy:l.cy}function M(l){for(var d=0,E=l.length,y="";d<E;d++)y+=l[d][0],l[d][1]!=null&&(y+=l[d][1],l[d][2]!=null&&(y+=" ",y+=l[d][2],l[d][3]!=null&&(y+=" ",y+=l[d][3],y+=" ",y+=l[d][4],l[d][5]!=null&&(y+=" ",y+=l[d][5],y+=" ",y+=l[d][6],l[d][7]!=null&&(y+=" ",y+=l[d][7])))));return y+" "}function V(l){for(var d=l.childNodes.length-1;d>=0;d--)l.childNodes[d]instanceof n.SVGElement&&V(l.childNodes[d]);return r.adopt(l).id(r.eid(l.nodeName))}function K(l){return l.x==null&&(l.x=0,l.y=0,l.width=0,l.height=0),l.w=l.width,l.h=l.height,l.x2=l.x+l.width,l.y2=l.y+l.height,l.cx=l.x+l.width/2,l.cy=l.y+l.height/2,l}function X(l){var d=(l||"").toString().match(r.regex.reference);if(d)return d[1]}function z(l){return Math.abs(l)>1e-37?l:0}var U="abcdef".split("");if(typeof n.CustomEvent!="function"){var Q=function(l,d){d=d||{bubbles:!1,cancelable:!1,detail:void 0};var E=i.createEvent("CustomEvent");return E.initCustomEvent(l,d.bubbles,d.cancelable,d.detail),E};Q.prototype=n.Event.prototype,r.CustomEvent=Q}else r.CustomEvent=n.CustomEvent;return function(l){for(var d=0,E=["moz","webkit"],y=0;y<E.length&&!n.requestAnimationFrame;++y)l.requestAnimationFrame=l[E[y]+"RequestAnimationFrame"],l.cancelAnimationFrame=l[E[y]+"CancelAnimationFrame"]||l[E[y]+"CancelRequestAnimationFrame"];l.requestAnimationFrame=l.requestAnimationFrame||function(h){var x=new Date().getTime(),I=Math.max(0,16-(x-d)),F=l.setTimeout(function(){h(x+I)},I);return d=x+I,F},l.cancelAnimationFrame=l.cancelAnimationFrame||l.clearTimeout}(n),r})})(JE);var wN=JE.exports,Yc={exports:{}};(function(e,t){function n(i,a){return a.querySelector(i)}t=e.exports=function(i,a){return a=a||document,n(i,a)},t.all=function(i,a){return a=a||document,a.querySelectorAll(i)},t.engine=function(i){if(!i.one)throw new Error(".one callback required");if(!i.all)throw new Error(".all callback required");return n=i.one,t.all=i.all,t}})(Yc,Yc.exports);var TN=Yc.exports,wo=TN,$t="tokenSimulation",Ne={TOGGLE_MODE_EVENT:$t+".toggleMode",GENERATE_TOKEN_EVENT:$t+".generateToken",CONSUME_TOKEN_EVENT:$t+".consumeToken",PLAY_SIMULATION_EVENT:$t+".playSimulation",PAUSE_SIMULATION_EVENT:$t+".pauseSimulation",RESET_SIMULATION_EVENT:$t+".resetSimulation",TERMINATE_EVENT:$t+".terminateEvent",UPDATE_ELEMENTS_EVENT:$t+".updateElements",UPDATE_ELEMENT_EVENT:$t+".updateElement",PROCESS_INSTANCE_CREATED_EVENT:$t+".processInstanceCreated",PROCESS_INSTANCE_FINISHED_EVENT:$t+".processInstanceFinished",PROCESS_INSTANCE_SHOWN_EVENT:$t+".processInstanceShown",PROCESS_INSTANCE_HIDDEN_EVENT:$t+".processInstanceHidden",ANIMATION_CREATED_EVENT:$t+".animationCreated"},He={};const QE=w_(F_);var CN=QE.every,AN=QE.some;He.is=function(e,t){if(e.type!=="label"){Array.isArray(t)||(t=[t]);var n=!1;return t.forEach(function(i){i===e.type&&(n=!0)}),n}};He.isTypedEvent=function(e,t,n){function i(a,r){return CN(r,function(o,s){return a[s]==o})}return AN(e.eventDefinitions,function(a){return a.$type===t&&i(e,n)})};He.getBusinessObject=function(e){return e&&e.businessObject||e};function eb(e,t){for(var n=t.parent;n;){if(n===e)return!0;n=n.parent}return!1}He.isAncestor=eb;He.getDescendants=function(e,t){return e.filter(function(n){return eb(t,n)})};He.supportedElements=["bpmn:Association","bpmn:BoundaryEvent","bpmn:BusinessRuleTask","bpmn:CallActivity","bpmn:DataInputAssociation","bpmn:DataObjectReference","bpmn:DataOutputAssociation","bpmn:DataStoreReference","bpmn:EndEvent","bpmn:EventBasedGateway","bpmn:ExclusiveGateway","bpmn:IntermediateCatchEvent","bpmn:ManualTask","bpmn:ParallelGateway","bpmn:Process","bpmn:ScriptTask","bpmn:SequenceFlow","bpmn:ServiceTask","bpmn:StartEvent","bpmn:SubProcess","bpmn:Task","bpmn:TextAnnotation","bpmn:UserTask"];var Df={};Df.getMid=function(e){var t=e.bbox();return{x:t.x+t.width/2,y:t.y+t.height/2}};Df.distance=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))};var sv=wN,PN=wo,ra=Ne,RN=ra.RESET_SIMULATION_EVENT,IN=ra.PLAY_SIMULATION_EVENT,NN=ra.PAUSE_SIMULATION_EVENT,MN=ra.TERMINATE_EVENT,kN=ra.PROCESS_INSTANCE_FINISHED_EVENT,DN=ra.ANIMATION_CREATED_EVENT,lv=He.isAncestor,ON=Df,LN=ON.distance,BN=getComputedStyle(document.documentElement).getPropertyValue("--token-simulation-green-base-44");function $N(e){return e===1}function VN(e){return e.length==2}var FN=0,jN="-",HN="<",zN="<>",wr=20;function cr(e,t){var n=window.animation=this;this._eventBus=t,this.animations=[],this.hiddenAnimations=[],this.animationSpeed=1,t.on("import.done",function(){var i=sv(e._svg),a=PN(".viewport",e._svg),r=sv.adopt(a);n.group=i.group().attr("id","token-simulation"),r.put(n.group)}),t.on(MN,function(i){var a=i.element,r=a.parent;n.animations.forEach(function(o){lv(r,o.element)&&(o.animation.stop(),n.animations=n.animations.filter(function(s){return s!==o}))})}),t.on(kN,function(i){var a=i.parent;n.animations.forEach(function(r){(i.processInstanceId===r.processInstanceId||lv(a,r.element))&&(r.animation.stop(),n.animations=n.animations.filter(function(o){return o!==r}))})}),t.on(RN,function(){n.animations.forEach(function(i){i.animation.stop()}),n.animations=[],n.hiddenAnimations=[]}),t.on(NN,function(){n.animations.forEach(function(i){i.animation.pause()})}),t.on(IN,function(){n.animations.forEach(function(i){i.animation.play()})})}cr.prototype.createAnimation=function(e,t,n){var i=this;if(this.group){var a=this._createTokenGfx(t),r;return r=new To(a,e.waypoints,function(){i.animations=i.animations.filter(function(o){return o.animation!==r}),n&&n()}),this.hiddenAnimations.includes(t)&&a.hide(),a.fx._speed=this.animationSpeed,this.animations.push({tokenGfx:a,animation:r,element:e,processInstanceId:t}),this._eventBus.fire(DN,{tokenGfx:a,animation:r,element:e,processInstanceId:t}),r}};cr.prototype.setAnimationSpeed=function(e){this.animations.forEach(function(t){t.tokenGfx.fx._speed=e}),this.animationSpeed=e};cr.prototype._createTokenGfx=function(e){var t=this.group.group().attr("class","token").hide();return t.circle(wr,wr).attr("fill",BN).attr("class","circle"),t.text(e.toString()).attr("transform","translate(10, -7)").attr("text-anchor","middle").attr("class","text"),t};cr.prototype.showProcessInstanceAnimations=function(e){this.animations.forEach(function(t){t.processInstanceId===e&&t.tokenGfx.show()}),this.hiddenAnimations=this.hiddenAnimations.filter(function(t){return t!==e})};cr.prototype.hideProcessInstanceAnimations=function(e){this.animations.forEach(function(t){t.processInstanceId===e&&t.tokenGfx.hide()}),this.hiddenAnimations.push(e)};cr.$inject=["canvas","eventBus"];var GN=cr;function To(e,t,n){this.gfx=this.fx=e,this.waypoints=t,this.done=n,this.create()}To.prototype.create=function(){var e=this.gfx,t=this.waypoints,n=this.done,i=this.fx;e.show().move(t[0].x-wr/2,t[0].y-wr/2),t.forEach(function(a,r){if(r>0){var o=a.x-wr/2,s=a.y-wr/2,u=$N(r)?HN:jN;VN(t)&&(u=zN);var c=LN(t[r-1],a)*20;i=i.animate(c,u,FN).move(o,s)}}),i.after(function(){e.remove(),n()})};To.prototype.play=function(){this.gfx.play()};To.prototype.pause=function(){this.gfx.pause()};To.prototype.stop=function(){this.fx.stop(),this.gfx.remove()};var UN=WN,tb=!1,gs;typeof document!="undefined"&&(gs=document.createElement("div"),gs.innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',tb=!gs.getElementsByTagName("link").length,gs=void 0);var et={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:tb?[1,"X<div>","</div>"]:[0,"",""]};et.td=et.th=[3,"<table><tbody><tr>","</tr></tbody></table>"];et.option=et.optgroup=[1,'<select multiple="multiple">',"</select>"];et.thead=et.tbody=et.colgroup=et.caption=et.tfoot=[1,"<table>","</table>"];et.polyline=et.ellipse=et.polygon=et.circle=et.text=et.line=et.path=et.rect=et.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];function WN(e,t){if(typeof e!="string")throw new TypeError("String expected");t||(t=document);var n=/<([\w:]+)/.exec(e);if(!n)return t.createTextNode(e);e=e.replace(/^\s+|\s+$/g,"");var i=n[1];if(i=="body"){var u=t.createElement("html");return u.innerHTML=e,u.removeChild(u.lastChild)}var a=Object.prototype.hasOwnProperty.call(et,i)?et[i]:et._default,r=a[0],o=a[1],s=a[2],u=t.createElement("div");for(u.innerHTML=o+e+s;r--;)u=u.lastChild;if(u.firstChild==u.lastChild)return u.removeChild(u.firstChild);for(var c=t.createDocumentFragment();u.firstChild;)c.appendChild(u.removeChild(u.firstChild));return c}var Bt=UN,Of={},nb=window.addEventListener?"addEventListener":"attachEvent",qN=window.removeEventListener?"removeEventListener":"detachEvent",ib=nb!=="addEventListener"?"on":"";Of.bind=function(e,t,n,i){return e[nb](ib+t,n,i||!1),n};Of.unbind=function(e,t,n,i){return e[qN](ib+t,n,i||!1),n};var Cn=Of,YN=Bt,KN=Cn,uv=He.is,rb=Ne,XN=rb.GENERATE_TOKEN_EVENT,ZN=rb.UPDATE_ELEMENT_EVENT;function Lf(e,t,n){this._eventBus=e,this._processInstances=t,this._processInstanceSettings=n}Lf.prototype.createContextPads=function(e){if(e.attachers.length&&this._processInstances.getProcessInstances(e).length){var t=e.incoming.filter(function(a){return uv(a,"bpmn:SequenceFlow")}),n=this,i=[];return e.attachers.forEach(function(a){var r=a.outgoing.filter(function(s){return uv(s,"bpmn:SequenceFlow")});if(!(!t.length||!r.length)){var o=YN('<div class="context-pad" title="Trigger Event"><i class="fa fa-play"></i></div>');i.push({element:a,html:o}),KN.bind(o,"click",function(){n._processInstances.getProcessInstances(e).forEach(function(s){var u=s.parentProcessInstanceId;a.businessObject.cancelActivity&&(e.children.forEach(function(c){c.tokenCount&&c.tokenCount[s.processInstanceId]&&c.tokenCount[s.processInstanceId]--}),n._processInstances.finish(s.processInstanceId),n._eventBus.fire(ZN,{element:e})),n._eventBus.fire(XN,{element:a,processInstanceId:u})})})}}),i}};Lf.$inject=["eventBus","processInstances","processInstanceSettings"];var JN=Lf,QN=He.is,eM=Bt,tM=Cn;function Bf(e){this._exclusiveGatewaySettings=e}Bf.prototype.createContextPads=function(e){var t=this,n=e.outgoing.filter(function(a){return QN(a,"bpmn:SequenceFlow")});if(!(n.length<2)){var i=eM('<div class="context-pad" title="Set Sequence Flow"><i class="fa fa-code-fork"></i></div>');return tM.bind(i,"click",function(){t._exclusiveGatewaySettings.setSequenceFlow(e)}),[{element:e,html:i}]}};Bf.$inject=["exclusiveGatewaySettings"];var nM=Bf,cv=Bt,pv=Cn,Xu=He.is,iM=Ne,fv=iM.GENERATE_TOKEN_EVENT;function $f(e){this._eventBus=e}$f.prototype.createContextPads=function(e){var t=e.parent.shownProcessInstance,n=e.incoming.filter(function(s){return Xu(s,"bpmn:SequenceFlow")}),i=[];n.forEach(function(s){var u=s.source;Xu(u,"bpmn:EventBasedGateway")&&u.tokenCount&&u.tokenCount[t]&&i.push(u)});var a=e.outgoing.filter(function(s){return Xu(s,"bpmn:SequenceFlow")});if(!(!n.length||!a.length)){var r=this,o;if(e.tokenCount&&e.tokenCount[t])o=cv('<div class="context-pad" title="Trigger Event"><i class="fa fa-play"></i></div>'),pv.bind(o,"click",function(){e.tokenCount[t]--,r._eventBus.fire(fv,{element:e,processInstanceId:t})});else if(i.length)o=cv('<div class="context-pad" title="Trigger Event"><i class="fa fa-play"></i></div>'),pv.bind(o,"click",function(){i.forEach(function(s){s.tokenCount[t]--}),r._eventBus.fire(fv,{element:e,processInstanceId:t})});else return;return[{element:e,html:o}]}};$f.$inject=["eventBus"];var rM=$f,aM=Bt,oM=Cn;function Vf(e,t){this._processInstances=e,this._processInstanceSettings=t}Vf.prototype.createContextPads=function(e){var t=this,n=this._processInstances.getProcessInstances(e).filter(function(a){return!a.isFinished});if(!(n.length<2)){var i=aM('<div class="context-pad" title="View Process Instances"><i class="fa fa-list-ol"></i></div>');return oM.bind(i,"click",function(){t._processInstanceSettings.showNext(e)}),[{element:e,html:i}]}};Vf.$inject=["processInstances","processInstanceSettings"];var sM=Vf,lM=Bt,uM=Cn,cM=He.is,pM=Ne,fM=pM.GENERATE_TOKEN_EVENT;function Ff(e,t,n){this._eventBus=e,this._elementRegistry=t,this._animation=n}Ff.prototype.createContextPads=function(e){var t=!1;if(this._elementRegistry.forEach(function(a){a.tokenCount&&Object.values(a.tokenCount).forEach(function(r){r&&(t=!0)})}),!(cM(e.parent,"bpmn:SubProcess")||t||this._animation.animations.length)){var n=this,i=lM('<div class="context-pad"><i class="fa fa-play"></i></div>');return uM.bind(i,"click",function(){n._eventBus.fire(fM,{element:e})}),[{element:e,html:i}]}};Ff.$inject=["eventBus","elementRegistry","animation"];var dM=Ff,hM=He,ab=hM.isAncestor,aa=Ne,mM=aa.TOGGLE_MODE_EVENT,vM=aa.RESET_SIMULATION_EVENT,gM=aa.TERMINATE_EVENT,yM=aa.UPDATE_ELEMENTS_EVENT,EM=aa.UPDATE_ELEMENT_EVENT,bM=aa.PROCESS_INSTANCE_SHOWN_EVENT,_M=JN,xM=nM,SM=rM,wM=sM,TM=dM,Ca=500,CM=-15,AM=-15;function pr(e,t,n,i,a,r){var o=this;this._elementRegistry=t,this._overlays=n,this._injector=i,this._canvas=a,this._processInstances=r,this.overlayIds={},this.handlers={},this.registerHandler("bpmn:ExclusiveGateway",xM),this.registerHandler("bpmn:IntermediateCatchEvent",SM),this.registerHandler("bpmn:SubProcess",wM),this.registerHandler("bpmn:SubProcess",_M),this.registerHandler("bpmn:StartEvent",TM),e.on(mM,Ca,function(s){var u=s.simulationModeActive;u?o.openContextPads():o.closeContextPads()}),e.on(vM,Ca,function(){o.closeContextPads(),o.openContextPads()}),e.on(gM,Ca,function(s){var u=s.element,c=u.parent;o.closeContextPads(c)}),e.on(yM,Ca,function(s){var u=s.elements;u.forEach(function(c){o.closeElementContextPads(c),o.openElementContextPads(c)})}),e.on(EM,Ca,function(s){var u=s.element;o.closeElementContextPads(u),o.openElementContextPads(u)}),e.on(bM,function(s){var u=s.processInstanceId,c=r.getProcessInstance(u),p=c.parent;o.closeContextPads(p),o.openContextPads(p)})}pr.prototype.registerHandler=function(e,t){var n=this._injector.instantiate(t);this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(n)};pr.prototype.openContextPads=function(e){var t=this;e||(e=this._canvas.getRootElement()),this._elementRegistry.forEach(function(n){t.handlers[n.type]&&ab(e,n)&&t.openElementContextPads(n)})};pr.prototype.openElementContextPads=function(e){if(this.handlers[e.type]){var t=[];this.handlers[e.type].forEach(function(i){var a=i.createContextPads(e);a&&a.forEach(function(r){r&&t.push(r)})});var n=this;t.forEach(function(i){var a={top:CM,left:AM},r=n._overlays.add(i.element,"context-menu",{position:a,html:i.html,show:{minZoom:.5}});n.overlayIds[i.element.id]=r})}};pr.prototype.closeContextPads=function(e){var t=this;e||(e=this._canvas.getRootElement()),this._elementRegistry.forEach(function(n){ab(e,n)&&t.closeElementContextPads(n)})};pr.prototype.closeElementContextPads=function(e){var t=this;e.attachers&&e.attachers.length>0&&e.attachers.forEach(function(i){t.closeElementContextPads(i)}),e.children&&e.children.length>0&&e.children.forEach(function(i){t.closeElementContextPads(i)});var n=this.overlayIds[e.id];n&&(this._overlays.remove(n),delete this.overlayIds[e.id])};pr.$inject=["eventBus","elementRegistry","overlays","injector","canvas","processInstances"];var PM=pr,RM=PM,IM=Ne,NM=IM.TOGGLE_MODE_EVENT,MM=10001;function ob(e,t,n,i,a,r,o,s){var u=this;this._eventBus=e,this.modelingDisabled=!1,e.on(NM,MM,function(m){var v=m.simulationModeActive;u.modelingDisabled=v,u.modelingDisabled&&(i.cancel(),t.close(),n.cancel()),o._update()});function c(m,v,g){var b=m[v];m[v]=function(){return g.call(this,b,arguments)}}function p(m,v){c(m,v,function(g,b){if(!u.modelingDisabled)return g.apply(this,b)})}function f(m,v){c(m,v,function(g,b){if(u.modelingDisabled)throw new Error("model is read-only");return g.apply(this,b)})}p(t,"open"),p(n,"init"),p(i,"activate"),p(n,"init"),p(i,"activate"),f(r,"moveShape"),f(r,"updateAttachment"),f(r,"moveElements"),f(r,"moveConnection"),f(r,"layoutConnection"),f(r,"createConnection"),f(r,"createShape"),f(r,"createLabel"),f(r,"appendShape"),f(r,"removeElements"),f(r,"distributeElements"),f(r,"removeShape"),f(r,"removeConnection"),f(r,"replaceShape"),f(r,"pasteElements"),f(r,"alignElements"),f(r,"resizeShape"),f(r,"createSpace"),f(r,"updateWaypoints"),f(r,"reconnectStart"),f(r,"reconnectEnd"),c(a,"trigger",function(m,v){var g=v[0];if(!(u.modelingDisabled&&DM(["undo","redo","copy","paste","removeSelection","spaceTool","lassoTool","globalConnectTool","distributeElements","alignElements","directEditing"],g)))return m.apply(this,v)})}ob.$inject=["eventBus","contextPad","dragging","directEditing","editorActions","modeling","palette","paletteProvider"];var kM=ob;function DM(e,t){return e.indexOf(t)>-1}var OM=kM,LM=Bt,jf=Ne,BM=jf.TOGGLE_MODE_EVENT,$M=jf.RESET_SIMULATION_EVENT,VM=jf.GENERATE_TOKEN_EVENT,FM=-15,jM=15;function oa(e,t){var n=this;this._overlays=e,t.on(BM,function(i){var a=i.simulationModeActive;a||n.removeElementNotifications()}),t.on([$M,VM],function(){n.removeElementNotifications()})}oa.prototype.addElementNotifications=function(e,t){var n=this;e.forEach(function(i){n.addElementNotification(i,t)})};oa.prototype.addElementNotification=function(e,t){var n={top:FM,right:jM},i='<div class="element-notification '+(t.type||"")+'">'+(t.icon?'<i class="fa '+t.icon+'"></i>':"")+('<span class="text">'+t.text+"</span>"||"")+"</div>",a=LM(i);this._overlays.add(e,"element-notification",{position:n,html:a,show:{minZoom:.5}})};oa.prototype.removeElementNotifications=function(e){var t=this;e?e.forEach(function(n){t.removeElementNotification(n)}):this._overlays.remove({type:"element-notification"})};oa.prototype.removeElementNotification=function(e){this._overlays.remove({element:e})};oa.$inject=["overlays","eventBus"];var HM=oa,zM=HM,Zu,dv;function hv(){return dv||(dv=1,Zu=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}),Zu}try{var Ql=hv()}catch(e){var Ql=hv()}var GM=/\s+/,UM=Object.prototype.toString,WM=function(e){return new Si(e)};function Si(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}Si.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array(),n=Ql(t,e);return~n||t.push(e),this.el.className=t.join(" "),this};Si.prototype.remove=function(e){if(UM.call(e)=="[object RegExp]")return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=Ql(t,e);return~n&&t.splice(n,1),this.el.className=t.join(" "),this};Si.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this};Si.prototype.toggle=function(e,t){return this.list?(typeof t!="undefined"?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(typeof t!="undefined"?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)};Si.prototype.array=function(){var e=this.el.getAttribute("class")||"",t=e.replace(/^\s+|\s+$/g,""),n=t.split(GM);return n[0]===""&&n.shift(),n};Si.prototype.has=Si.prototype.contains=function(e){return this.list?this.list.contains(e):!!~Ql(this.array(),e)};var Bi=WM,mv=Bi,sb=He,Wa=sb.is,lb=sb.supportedElements,ub=Ne,qM=ub.TOGGLE_MODE_EVENT,YM=ub.GENERATE_TOKEN_EVENT,cb=["bpmn:Process","bpmn:Collaboration","bpmn:Participant","bpmn:Lane","bpmn:TextAnnotation"];function pb(e){return e.labelTarget}function Co(e,t,n,i,a){var r=this;this._eventBus=e,this._elementRegistry=t,this._elementNotifications=a,this._notifications=i,this.canvasParent=n.getContainer().parentNode,e.on(YM,2e4,function(o){var s=o.element;if(Wa(s,"bpmn:StartEvent")&&!r.allElementsSupported())return r.showWarnings(),mv(r.canvasParent).add("warning"),!0}),e.on(qM,function(o){var s=o.simulationModeActive;s||mv(r.canvasParent).remove("warning")})}Co.prototype.allElementsSupported=function(){var e=!0;return this._elementRegistry.forEach(function(t){!Wa(t,cb)&&!Wa(t,lb)&&!pb(t)&&(e=!1)}),e};Co.prototype.showWarnings=function(e){var t=this,n=[];this._elementRegistry.forEach(function(i){!Wa(i,cb)&&!Wa(i,lb)&&!pb(i)&&(t.showWarning(i),n.indexOf(i.type)&&(t._notifications.showNotification(i.type+" not supported","warning"),n.push(i.type)))})};Co.prototype.showWarning=function(e){this._elementNotifications.addElementNotification(e,{type:"warning",icon:"fa-exclamation-triangle",text:"Not supported"})};Co.$inject=["eventBus","elementRegistry","canvas","notifications","elementNotifications"];var KM=Co,XM=KM,Hf=He.is,ZM=Ne,JM=ZM.TOGGLE_MODE_EVENT,QM=getComputedStyle(document.documentElement).getPropertyValue("--token-simulation-grey-lighten-56"),ek=getComputedStyle(document.documentElement).getPropertyValue("--token-simulation-grey-darken-30");function tk(e){var t=e.outgoing.filter(qa),n=t.indexOf(e.sequenceFlow);return t[n+1]?t[n+1]:t[0]}function qa(e){return Hf(e,"bpmn:SequenceFlow")}function fr(e,t,n){var i=this;this._elementRegistry=t,this._graphicsFactory=n,e.on(JM,function(a){var r=a.simulationModeActive;r?i.setSequenceFlowsDefault():i.resetSequenceFlows()})}fr.prototype.setSequenceFlowsDefault=function(){var e=this,t=this._elementRegistry.filter(function(n){return Hf(n,"bpmn:ExclusiveGateway")});t.forEach(function(n){n.outgoing.filter(qa).length&&e.setSequenceFlow(n,n.outgoing.filter(qa)[0])})};fr.prototype.resetSequenceFlows=function(){var e=this,t=this._elementRegistry.filter(function(n){return Hf(n,"bpmn:ExclusiveGateway")});t.forEach(function(n){n.outgoing.filter(qa).length&&e.resetSequenceFlow(n)})};fr.prototype.resetSequenceFlow=function(e){e.sequenceFlow&&delete e.sequenceFlow};fr.prototype.setSequenceFlow=function(e){var t=this,n=e.outgoing.filter(qa);if(n.length){var i=e.sequenceFlow;i?e.sequenceFlow=tk(e):e.sequenceFlow=n[0],e.outgoing.forEach(function(a){a===e.sequenceFlow?t.setColor(a,ek):t.setColor(a,QM)})}};fr.prototype.setColor=function(e,t){var n=e.businessObject;n.di.set("stroke",t);var i=this._elementRegistry.getGraphics(e);this._graphicsFactory.update("connection",e,i)};fr.$inject=["eventBus","elementRegistry","graphicsFactory"];var nk=fr,ik=nk,tl=Bt,Jn=Bi,Aa=Cn,ys=wo,zf=He,rk=zf.getBusinessObject,nn=zf.is,ak=zf.isTypedEvent,Ao=Ne,ok=Ao.GENERATE_TOKEN_EVENT,sk=Ao.CONSUME_TOKEN_EVENT,lk=Ao.TOGGLE_MODE_EVENT,uk=Ao.RESET_SIMULATION_EVENT,ck=Ao.PROCESS_INSTANCE_CREATED_EVENT;function Ju(e){return e&&e.businessObject.name}function sa(e,t,n,i){var a=this;this._notifications=t,this._tokenSimulationPalette=n,this._canvas=i,this._init(),e.on(ok,function(r){var o=r.element,s=Ju(o);if(nn(o,"bpmn:BusinessRuleTask"))a.log(s||"Business Rule Task","info","bpmn-icon-business-rule");else if(nn(o,"bpmn:CallActivity"))a.log(s||"Call Activity","info","bpmn-icon-call-activity");else if(nn(o,["bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent"]))a.log(s||"Intermediate Event","info","bpmn-icon-intermediate-event-none");else if(nn(o,"bpmn:ManualTask"))a.log(s||"Manual Task","info","bpmn-icon-manual");else if(nn(o,"bpmn:ScriptTask"))a.log(s||"Script Task","info","bpmn-icon-script");else if(nn(o,"bpmn:ServiceTask"))a.log(s||"Service Task","info","bpmn-icon-service");else if(nn(o,"bpmn:StartEvent"))a.log(s||"Start Event","info","bpmn-icon-start-event-none");else if(nn(o,"bpmn:Task"))a.log(s||"Task","info","bpmn-icon-task");else if(nn(o,"bpmn:UserTask"))a.log(s||"User Task","info","bpmn-icon-user");else if(nn(o,"bpmn:ExclusiveGateway")){if(o.outgoing.length<2)return;var u=Ju(o.sequenceFlow),c=s||"Gateway";u&&(c=c.concat(' <i class="fa fa-angle-right" aria-hidden="true"></i> '+u)),a.log(c,"info","bpmn-icon-gateway-xor")}}),e.on(sk,function(r){var o=r.element,s=Ju(o);nn(o,"bpmn:EndEvent")&&(ak(rk(o),"bpmn:TerminateEventDefinition")?a.log(s||"Terminate End Event","info","bpmn-icon-end-event-terminate"):a.log(s||"End Event","info","bpmn-icon-end-event-none"))}),e.on(ck,function(r){var o=r.processInstanceId,s=r.parent;nn(s,"bpmn:Process")?a.log("Process "+o+" started","success","fa-check"):a.log("Subprocess "+o+" started","info","fa-check")}),e.on(lk,function(r){var o=r.simulationModeActive;o||(a.emptyLog(),Jn(a.container).add("hidden"))}),e.on(uk,function(r){a.emptyLog(),Jn(a.container).add("hidden")})}sa.prototype._init=function(){var e=this;this.container=tl('<div class="token-simulation-log hidden"><div class="header"><i class="fa fa-align-left"></i><button class="close"><i class="fa fa-times" aria-hidden="true"></i></button></div><div class="content"><p class="entry placeholder">No Entries</p></div></div>'),this.placeholder=ys(".placeholder",this.container),this.content=ys(".content",this.container),Aa.bind(this.content,"wheel",function(t){t.stopPropagation()}),Aa.bind(this.content,"mousedown",function(t){t.stopPropagation()}),this.close=ys(".close",this.container),Aa.bind(this.close,"click",function(){Jn(e.container).add("hidden")}),this.icon=ys(".fa-align-left",this.container),Aa.bind(this.icon,"click",function(){Jn(e.container).add("hidden")}),this._canvas.getContainer().appendChild(this.container),this.paletteEntry=tl('<div class="entry" title="Show Simulation Log"><i class="fa fa-align-left"></i></div>'),Aa.bind(this.paletteEntry,"click",function(){Jn(e.container).remove("hidden")}),this._tokenSimulationPalette.addEntry(this.paletteEntry,3)};sa.prototype.toggle=function(){var e=this.container;Jn(e).has("hidden")?Jn(e).remove("hidden"):Jn(e).add("hidden")};sa.prototype.log=function(e,t,n){Jn(this.placeholder).add("hidden");var i=new Date,a=i.toLocaleTimeString()+":"+i.getUTCMilliseconds();this._notifications.showNotification(e,t,n);var r;n||(n="fa-info"),n.includes("bpmn")?r='<span class="icon '+n+'">':r='<i class="icon fa '+n+'"></i>';var o=tl('<p class="entry '+t+'"><span class="date">'+a+"</span>"+r+"</span>"+e+"</p>");this.content.appendChild(o),this.content.scrollTop=this.content.scrollHeight};sa.prototype.emptyLog=function(){for(;this.content.firstChild;)this.content.removeChild(this.content.firstChild);this.placeholder=tl('<p class="entry placeholder">No Entries</p>'),this.content.appendChild(this.placeholder)};sa.$inject=["eventBus","notifications","tokenSimulationPalette","canvas"];var pk=sa,fk=pk,fb=Bt,dk=Ne,hk=dk.TOGGLE_MODE_EVENT,mk=2e3;function Po(e,t){var n=this;this._eventBus=e,this._canvas=t,this._init(),e.on(hk,function(i){var a=i.simulationModeActive;a||n.removeAll()})}Po.prototype._init=function(){this.container=fb('<div class="notifications"></div>'),this._canvas.getContainer().appendChild(this.container)};Po.prototype.showNotification=function(e,t,n){var i;n||(n="fa-info"),n.includes("bpmn")?i='<i class="'+n+'"></i>':i='<i class="fa '+n+'"></i>';var a=fb('<div class="notification '+t+'"><span class="icon">'+i+"</span>"+e+"</div>");for(this.container.appendChild(a);this.container.children.length>5;)this.container.children[0].remove();setTimeout(function(){a.remove()},mk)};Po.prototype.removeAll=function(){for(;this.container.children.length;)this.container.children[0].remove()};Po.$inject=["eventBus","canvas"];var vk=Po,gk=vk,yk=Bt,Ji=Bi,Ek=Cn,la=Ne,bk=la.TOGGLE_MODE_EVENT,_k=la.PLAY_SIMULATION_EVENT,xk=la.PAUSE_SIMULATION_EVENT,Sk=la.RESET_SIMULATION_EVENT,wk=la.ANIMATION_CREATED_EVENT,Tk=la.PROCESS_INSTANCE_CREATED_EVENT,db='<i class="fa fa-play"></i>',Ck='<i class="fa fa-pause"></i>';function $i(e,t,n,i){var a=this;this._eventBus=e,this._tokenSimulationPalette=t,this._notifications=n,this.canvasParent=i.getContainer().parentNode,this.isActive=!1,this.isPaused=!1,this._init(),e.on(Tk,function(r){var o=r.parent;o.parent||(a.activate(),a.unpause(),n.showNotification("Start Simulation","info"))}),e.on([Sk,bk],function(){a.deactivate(),a.unpause()}),e.on(wk,function(r){var o=r.animation;a.isPaused&&o.pause()})}$i.prototype._init=function(){this.paletteEntry=yk('<div class="entry disabled" title="Play/Pause Simulation">'+db+"</div>"),Ek.bind(this.paletteEntry,"click",this.toggle.bind(this)),this._tokenSimulationPalette.addEntry(this.paletteEntry,1)};$i.prototype.toggle=function(){this.isActive&&(this.isPaused?this.unpause():this.pause())};$i.prototype.pause=function(){this.isActive&&(Ji(this.paletteEntry).remove("active"),Ji(this.canvasParent).add("paused"),this.paletteEntry.innerHTML=db,this._eventBus.fire(xk),this._notifications.showNotification("Pause Simulation","info"),this.isPaused=!0)};$i.prototype.unpause=function(){this.isActive&&(Ji(this.paletteEntry).add("active"),Ji(this.canvasParent).remove("paused"),this.paletteEntry.innerHTML=Ck,this._eventBus.fire(_k),this._notifications.showNotification("Play Simulation","info"),this.isPaused=!1)};$i.prototype.activate=function(){this.isActive=!0,Ji(this.paletteEntry).remove("disabled")};$i.prototype.deactivate=function(){this.isActive=!1,Ji(this.paletteEntry).remove("active"),Ji(this.paletteEntry).add("disabled")};$i.$inject=["eventBus","tokenSimulationPalette","notifications","canvas"];var Ak=$i,Pk=Ak,Rk=Ne,Ik=Rk.TOGGLE_MODE_EVENT,Nk=5e4;function Ro(e,t,n){var i=this;this._elementRegistry=t,this._graphicsFactory=n,this.elementColors={},e.on(Ik,Nk,function(a){var r=a.simulationModeActive;r?i.preserveColors():i.resetColors()})}Ro.prototype.preserveColors=function(){var e=this;this._elementRegistry.forEach(function(t){e.elementColors[t.id]={stroke:t.businessObject.di.get("stroke"),fill:t.businessObject.di.get("fill")},e.setColor(t,"#000","#fff")})};Ro.prototype.resetColors=function(){var e=this;this._elementRegistry.forEach(function(t){e.elementColors[t.id]&&e.setColor(t,e.elementColors[t.id].stroke,e.elementColors[t.id].fill)}),this.elementColors={}};Ro.prototype.setColor=function(e,t,n){var i=e.businessObject;i.di.set("stroke",t),i.di.set("fill",n);var a=this._elementRegistry.getGraphics(e),r=e.waypoints?"connection":"shape";this._graphicsFactory.update(r,e,a)};Ro.$inject=["eventBus","elementRegistry","graphicsFactory"];var Mk=Ro,kk=Mk,hb=Ne,Dk=hb.TOGGLE_MODE_EVENT,Ok=hb.RESET_SIMULATION_EVENT;function eu(e){this.nextProcessInstanceId=1,e.on(Dk,this.reset.bind(this)),e.on(Ok,this.reset.bind(this))}eu.prototype.getNext=function(){var e=this.nextProcessInstanceId;return this.nextProcessInstanceId++,e};eu.prototype.reset=function(){this.nextProcessInstanceId=1};eu.$inject=["eventBus"];var Lk=eu,Bk=Lk,Io=Ne,$k=Io.TOGGLE_MODE_EVENT,Vk=Io.PROCESS_INSTANCE_CREATED_EVENT,Fk=Io.PROCESS_INSTANCE_FINISHED_EVENT,jk=Io.PROCESS_INSTANCE_SHOWN_EVENT,Hk=Io.PROCESS_INSTANCE_HIDDEN_EVENT,vv=500;function No(e,t,n,i){var a=this;this._animation=e,this._eventBus=t,this._processInstances=n,this._elementRegistry=i,this._eventBus.on(Vk,vv,function(r){var o=r.parent,s=r.processInstanceId,u=n.getProcessInstances(o).filter(function(c){return!c.isFinished});u.length===1?a.showProcessInstance(s,o):u.length>1&&a.hideProcessInstance(s)}),this._eventBus.on(Fk,vv,function(r){var o=r.parent,s=r.processInstanceId,u=n.getProcessInstances(o).filter(function(c){return s!==c.processInstanceId&&!c.isFinished});u.length&&s===o.shownProcessInstance?a.showProcessInstance(u[0].processInstanceId,o):delete o.shownProcessInstance,o.parent||i.forEach(function(c){delete c.shownProcessInstance})}),t.on($k,function(){i.forEach(function(r){delete r.shownProcessInstance})})}No.prototype.showProcessInstance=function(e,t){this._animation.showProcessInstanceAnimations(e),t.shownProcessInstance=e,this._eventBus.fire(jk,{processInstanceId:e})};No.prototype.hideProcessInstance=function(e){this._animation.hideProcessInstanceAnimations(e),this._eventBus.fire(Hk,{processInstanceId:e})};No.prototype.showNext=function(e){var t=this,n=this._processInstances.getProcessInstances(e),i=e.shownProcessInstance,a=0;for(let r=0;r<n.length&&n[r].processInstanceId!==i;r++)a++;n.forEach(function(r){t.hideProcessInstance(r.processInstanceId)}),a===n.length-1?this.showProcessInstance(n[0].processInstanceId,e):this.showProcessInstance(n[a+1].processInstanceId,e)};No.$inject=["animation","eventBus","processInstances","elementRegistry"];var zk=No,Gk=zk,tu=Ne,Uk=tu.TOGGLE_MODE_EVENT,Wk=tu.RESET_SIMULATION_EVENT,qk=tu.PROCESS_INSTANCE_CREATED_EVENT,Yk=tu.PROCESS_INSTANCE_FINISHED_EVENT;function dr(e,t){var n=this;this._eventBus=e,this._processInstanceIds=t,this.processInstances=[],e.on([Uk,Wk],function(){n.processInstances=[]})}dr.prototype.create=function(e,t){var n=this._processInstanceIds.getNext(),i={parent:e,processInstanceId:n,parentProcessInstanceId:t};return this.processInstances.push(i),this._eventBus.fire(qk,i),n};dr.prototype.remove=function(e){this.processInstances=this.processInstances.filter(function(t){return t.processInstanceId!==e})};dr.prototype.finish=function(e){var t=this.processInstances.find(function(n){return n.processInstanceId===e});this._eventBus.fire(Yk,t),t.isFinished=!0};dr.prototype.getProcessInstances=function(e,t){if(!e)return this.processInstances;var n=this.processInstances.filter(function(i){return i.parent===e});return t&&t.includeFinished!==!0&&(n=n.filter(function(i){return!i.isFinished})),n};dr.prototype.getProcessInstance=function(e){return this.processInstances.find(function(t){return t.processInstanceId===e})};dr.$inject=["eventBus","processInstanceIds"];var Kk=dr,Xk=Kk,Zk=Bt,mb=Bi,Jk=Cn,Qk=He.is,Gf=Ne,eD=Gf.TOGGLE_MODE_EVENT,tD=Gf.GENERATE_TOKEN_EVENT,nD=Gf.RESET_SIMULATION_EVENT;function nu(e,t,n,i){var a=this;this._eventBus=e,this._tokenSimulationPalette=t,this._notifications=n,this._elementRegistry=i,this._init(),e.on(tD,function(r){Qk(r.element,"bpmn:StartEvent")&&mb(a.paletteEntry).remove("disabled")}),e.on(eD,function(r){var o=r.simulationModeActive;o||a.resetSimulation()})}nu.prototype._init=function(){var e=this;this.paletteEntry=Zk('<div class="entry disabled" title="Reset Simulation"><i class="fa fa-refresh"></i></div>'),Jk.bind(this.paletteEntry,"click",function(){e.resetSimulation(),e._notifications.showNotification("Reset Simulation","info")}),this._tokenSimulationPalette.addEntry(this.paletteEntry,2)};nu.prototype.resetSimulation=function(){mb(this.paletteEntry).add("disabled"),this._elementRegistry.forEach(function(e){e.tokenCount!==void 0&&delete e.tokenCount}),this._eventBus.fire(nD)};nu.$inject=["eventBus","tokenSimulationPalette","notifications","elementRegistry"];var iD=nu,rD=iD,aD=Bt,nl=Bi,Qu=Cn,ks=wo,oD=Ne,sD=oD.TOGGLE_MODE_EVENT;function iu(e,t,n){var i=this;this._canvas=e,this._animation=t,this._eventBus=n,this._init(),n.on(sD,function(a){var r=a.simulationModeActive;r?nl(i.container).remove("hidden"):nl(i.container).add("hidden")})}iu.prototype._init=function(){var e=this;this.container=aD('<div class="set-animation-speed hidden"><i title="Set Animation Speed" class="fa fa-tachometer" aria-hidden="true"></i><div class="animation-speed-buttons"><div title="Slow" id="animation-speed-1" class="animation-speed-button"><i class="fa fa-angle-right" aria-hidden="true"></i></div><div title="Normal" id="animation-speed-2" class="animation-speed-button active"><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-angle-right" aria-hidden="true"></i></div><div title="Fast" id="animation-speed-3" class="animation-speed-button"><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-angle-right" aria-hidden="true"></i></div></div></div>');var t=ks("#animation-speed-1",this.container),n=ks("#animation-speed-2",this.container),i=ks("#animation-speed-3",this.container);Qu.bind(t,"click",function(){e.setActive(t),e._animation.setAnimationSpeed(.5)}),Qu.bind(n,"click",function(){e.setActive(n),e._animation.setAnimationSpeed(1)}),Qu.bind(i,"click",function(){e.setActive(i),e._animation.setAnimationSpeed(1.5)}),this._canvas.getContainer().appendChild(this.container)};iu.prototype.setActive=function(e){ks.all(".animation-speed-button",this.container).forEach(function(t){nl(t).remove("active")}),nl(e).add("active")};iu.$inject=["canvas","animation","eventBus"];var lD=iu,uD=lD,cD=function(e){for(var t;e.childNodes.length;)t=e.childNodes[0],e.removeChild(t);return e},vb=Bt,$r=Bi,ec=Cn,Uf=wo,pD=cD,ua=Ne,fD=ua.TOGGLE_MODE_EVENT,dD=ua.PROCESS_INSTANCE_CREATED_EVENT,hD=ua.PROCESS_INSTANCE_FINISHED_EVENT,mD=ua.PROCESS_INSTANCE_SHOWN_EVENT,vD=ua.PROCESS_INSTANCE_HIDDEN_EVENT,gD=ua.RESET_SIMULATION_EVENT,yD=getComputedStyle(document.documentElement).getPropertyValue("--token-simulation-silver-base-97"),ED=getComputedStyle(document.documentElement).getPropertyValue("--token-simulation-green-base-44");function gb(e){return e===null}function An(e,t,n,i,a,r){var o=this;this._eventBus=e,this._canvas=t,this._processInstanceSettings=n,this._processInstances=i,this._graphicsFactory=a,this._elementRegistry=r,this.highlightedElement=null,this._init(),e.on(fD,function(s){var u=s.simulationModeActive;u?$r(o.container).remove("hidden"):($r(o.container).add("hidden"),pD(o.container),gb(o.highlightedElement)||(o.removeHighlightFromProcess(o.highlightedElement.element),o.highlightedElement=null))}),e.on(dD,function(s){o.addInstance(s)}),e.on(hD,function(s){o.removeInstance(s)}),e.on(mD,function(s){o.setInstanceShown(s.processInstanceId)}),e.on(vD,function(s){o.setInstanceHidden(s.processInstanceId)}),e.on(gD,function(){o.removeAllInstances()})}An.prototype._init=function(){this.container=vb('<div class="process-instances hidden"></div>'),this._canvas.getContainer().appendChild(this.container)};An.prototype.addInstance=function(e){var t=this,n=e.processInstanceId,i=e.parent,a=vb('<div id="instance-'+n+'" class="process-instance" title="View Process Instance '+n+'">'+n+"</div>");ec.bind(a,"click",function(){var r=t._processInstances.getProcessInstances(i);r.forEach(function(o){t._processInstanceSettings.hideProcessInstance(o.processInstanceId)}),t._processInstanceSettings.showProcessInstance(n,i)}),ec.bind(a,"mouseenter",function(){t.highlightedElement={element:i,stroke:i.businessObject.di.get("stroke"),fill:i.businessObject.di.get("fill")},t.addHighlightToProcess(i)}),ec.bind(a,"mouseleave",function(){t.removeHighlightFromProcess(i),t.highlightedElement=null}),this.container.appendChild(a)};An.prototype.removeInstance=function(e){var t=e.processInstanceId,n=Uf("#instance-"+t,this.container);n&&n.remove()};An.prototype.removeAllInstances=function(){this.container.innerHTML=""};An.prototype.setInstanceShown=function(e){var t=Uf("#instance-"+e,this.container);t&&$r(t).add("active")};An.prototype.setInstanceHidden=function(e){var t=Uf("#instance-"+e,this.container);t&&$r(t).remove("active")};An.prototype.addHighlightToProcess=function(e){this.setColor(e,ED,yD),e.parent||$r(this._canvas.getContainer()).add("highlight")};An.prototype.removeHighlightFromProcess=function(e){gb(this.highlightedElement)||(this.setColor(e,this.highlightedElement.stroke,this.highlightedElement.fill),e.parent||$r(this._canvas.getContainer()).remove("highlight"))};An.prototype.setColor=function(e,t,n){var i=e.businessObject;i.di.set("stroke",t),i.di.set("fill",n);var a=this._elementRegistry.getGraphics(e);this._graphicsFactory.update("connection",e,a)};An.$inject=["eventBus","canvas","processInstanceSettings","processInstances","graphicsFactory","elementRegistry"];var bD=An,_D=bD,ru=He,xD=ru.getBusinessObject,Ds=ru.is,SD=ru.isAncestor,wD=ru.isTypedEvent,TD=Ne,CD=TD.CONSUME_TOKEN_EVENT,AD=250;function au(e,t,n,i,a,r,o){this._animation=t,this._elementRegistry=n,this._log=i,this._elementNotifications=a,this._canvas=r,this._processInstances=o,e.on(CD,AD,function(){})}au.prototype.isDeadlock=function(){var e=this,t=[];this._elementRegistry.forEach(function(a){a.tokenCount&&t.push(a)});var n=[],i=[];t.forEach(function(a){var r=a.outgoing.filter(function(c){return Ds(c,"bpmn:SequenceFlow")});if(r.length||n.push(a),Ds(a,"bpmn:ParallelGateway")){var o=a.incoming.filter(function(c){return Ds(c,"bpmn:SequenceFlow")});o.length>a.tokenCount&&n.push(a)}var s=[];function u(c){c.outgoing.forEach(function(p){if(s.indexOf(p.target)===-1){s.push(p.target);var f=wD(xD(p.target),"bpmn:TerminateEventDefinition");f&&i.push(c),u(p.target)}})}u(a)}),t.length&&!i.length&&n.length&&!this._animation.animations.length&&(e._log.log("Deadlock","warning","fa-exclamation-triangle"),n.forEach(function(a){e._elementNotifications.addElementNotification(a,{type:"warning",icon:"fa-exclamation-triangle",text:"Deadlock"})}))};au.prototype.isFinished=function(e,t){var n=this._processInstances.getProcessInstance(t),i=n.parent,a=!1;i||(i=this._canvas.getRootElement()),i.children.forEach(function(o){o.tokenCount&&o.tokenCount[t]&&o.tokenCount[t].length&&(a=!0)});var r=!1;if(this._animation.animations.forEach(function(o){SD(i,o.element)&&o.processInstanceId===t&&(r=!0)}),!a&&!r)return Ds(i,"bpmn:SubProcess")?this._log.log("Subprocess "+t+" finished","info","fa-check-circle"):(this._log.log("Process "+t+" finished","success","fa-check-circle"),this._elementNotifications.addElementNotification(e,{type:"success",icon:"fa-check-circle",text:"Finished"})),!0};au.$inject=["eventBus","animation","elementRegistry","log","elementNotifications","canvas","processInstances"];var PD=au,RD=PD,ID=Bt,Es=Bi,ND=Cn,MD=wo,kD=Ne,gv=kD.TOGGLE_MODE_EVENT;function ou(e,t,n,i){var a=this;this._eventBus=e,this._canvas=t,this._selection=n,this._contextPad=i,this.simulationModeActive=!1,e.on("import.done",function(){a.canvasParent=a._canvas.getContainer().parentNode,a.palette=MD(".djs-palette",a._canvas.getContainer()),a._init()})}ou.prototype._init=function(){this.container=ID(`
    <div class="toggle-mode">
      Token Simulation <span class="toggle"><i class="fa fa-toggle-off"></i></span>
    </div>
  `),ND.bind(this.container,"click",this.toggleMode.bind(this)),this._canvas.getContainer().appendChild(this.container)};ou.prototype.toggleMode=function(){if(this.simulationModeActive){this.container.innerHTML='Token Simulation <span class="toggle"><i class="fa fa-toggle-off"></i></span>',Es(this.canvasParent).remove("simulation"),Es(this.palette).remove("hidden"),this._eventBus.fire(gv,{simulationModeActive:!1});var e=this._selection.get();e.length===1&&this._contextPad.open(e[0])}else this.container.innerHTML='Token Simulation <span class="toggle"><i class="fa fa-toggle-on"></i></span>',Es(this.canvasParent).add("simulation"),Es(this.palette).add("hidden"),this._eventBus.fire(gv,{simulationModeActive:!0});this.simulationModeActive=!this.simulationModeActive};ou.$inject=["eventBus","canvas","selection","contextPad"];var DD=ou,OD=DD,LD=Bt,BD=He,yb=BD.isAncestor,ca=Ne,$D=ca.TOGGLE_MODE_EVENT,VD=ca.GENERATE_TOKEN_EVENT,FD=ca.CONSUME_TOKEN_EVENT,jD=ca.RESET_SIMULATION_EVENT,HD=ca.TERMINATE_EVENT,zD=ca.PROCESS_INSTANCE_SHOWN_EVENT,GD=10,UD=-15,WD=500;function hr(e,t,n,i,a){var r=this;this._overlays=t,this._elementRegistry=n,this._canvas=i,this._processInstances=a,this.overlayIds={},e.on($D,function(o){var s=o.simulationModeActive;s||r.removeTokenCounts()}),e.on(jD,function(){r.removeTokenCounts()}),e.on(HD,function(o){var s=o.element,u=s.parent;r.removeTokenCounts(u)}),e.on([VD,FD],WD,function(o){var s=o.element,u=s.parent;r.removeTokenCounts(u),r.addTokenCounts(u)}),e.on(zD,function(o){var s=o.processInstanceId,u=a.getProcessInstance(s),c=u.parent;r.removeTokenCounts(c),r.addTokenCounts(c)})}hr.prototype.addTokenCounts=function(e){var t=this;e||(e=this._canvas.getRootElement());var n=e.shownProcessInstance;if(!n){var i=this._processInstances.getProcessInstances(e);if(!i.length)return;n=i[0].processInstanceId}this._elementRegistry.forEach(function(a){yb(e,a)&&t.addTokenCount(a,n)})};hr.prototype.addTokenCount=function(e,t){var n=e.tokenCount&&e.tokenCount[t];if(n){var i=this.createTokenCount(n),a={bottom:GD,left:UD},r=this._overlays.add(e,"token-count",{position:a,html:i,show:{minZoom:.5}});this.overlayIds[e.id]=r}};hr.prototype.createTokenCount=function(e){return LD('<div class="token-count waiting">'+e+"</div>")};hr.prototype.removeTokenCounts=function(e){var t=this;e||(e=this._canvas.getRootElement()),this._elementRegistry.forEach(function(n){yb(e,n)&&t.removeTokenCount(n)})};hr.prototype.removeTokenCount=function(e){var t=this.overlayIds[e.id];t&&(this._overlays.remove(t),delete this.overlayIds[e.id])};hr.$inject=["eventBus","overlays","elementRegistry","canvas","processInstances"];var qD=hr,YD=qD,Mo=He,KD=Mo.getBusinessObject,XD=Mo.is,ZD=Mo.isAncestor,JD=Mo.getDescendants,QD=Mo.isTypedEvent,Wf=Ne,eO=Wf.GENERATE_TOKEN_EVENT,tO=Wf.TERMINATE_EVENT,nO=Wf.UPDATE_ELEMENTS_EVENT;function su(e,t,n,i,a,r){this._animation=e,this._eventBus=t,this._log=n,this._simulationState=i,this._elementRegistry=a,this._processInstances=r}su.prototype.consume=function(e){var t=e.element,n=e.processInstanceId,i=QD(KD(t),"bpmn:TerminateEventDefinition"),a=XD(t.parent,"bpmn:SubProcess");i&&(this._eventBus.fire(tO,e),this._elementRegistry.forEach(function(s){ZD(t.parent,s)&&s.tokenCount&&s.tokenCount[n]&&delete s.tokenCount[n]}),this._processInstances.finish(n));var r=this._simulationState.isFinished(t,n);if(r&&this._processInstances.finish(n),(r||i)&&a){var o=this._processInstances.getProcessInstance(n);this._eventBus.fire(eO,{element:t.parent,processInstanceId:o.parentProcessInstanceId})}this._eventBus.fire(nO,{elements:JD(this._elementRegistry.getAll(),t.parent)})};su.prototype.generate=function(e){};su.$inject=["animation","eventBus","log","simulationState","elementRegistry","processInstances"];var iO=su,rO=He.is,aO=Ne,oO=aO.UPDATE_ELEMENTS_EVENT;function lu(e,t){this._eventBus=e,this._animation=t}lu.prototype.consume=function(e){var t=e.element,n=e.processInstanceId;t.tokenCount||(t.tokenCount={}),t.tokenCount[n]||(t.tokenCount[n]=0),t.tokenCount[n]++;var i=t.outgoing,a=[];i.forEach(function(r){var o=r.target;rO(o,"bpmn:IntermediateCatchEvent")&&a.push(o)}),this._eventBus.fire(oO,{elements:a})};lu.prototype.generate=function(){};lu.$inject=["eventBus","animation"];var sO=lu,Eb=Ne,lO=Eb.CONSUME_TOKEN_EVENT,uO=Eb.GENERATE_TOKEN_EVENT;function uu(e,t,n){this._eventBus=e,this._animation=t,this._elementRegistry=n}uu.prototype.consume=function(e){var t=e.element;if(!t.sequenceFlow)throw new Error("no sequence flow configured for element "+t.id);this._eventBus.fire(uO,e)};uu.prototype.generate=function(e){var t=e.element,n=e.processInstanceId;if(!t.sequenceFlow)throw new Error("no sequence flow configured for element "+t.id);var i=this,a=this._elementRegistry.get(t.sequenceFlow.id);this._animation.createAnimation(a,n,function(){i._eventBus.fire(lO,{element:a.target,processInstanceId:n})})};uu.$inject=["eventBus","animation","elementRegistry"];var cO=uu,pO=He,yv=pO.is,qf=Ne,fO=qf.CONSUME_TOKEN_EVENT,dO=qf.UPDATE_ELEMENT_EVENT,hO=qf.UPDATE_ELEMENTS_EVENT;function cu(e,t,n){this._animation=e,this._eventBus=t,this._elementRegistry=n}cu.prototype.consume=function(e){var t=e.element,n=e.processInstanceId;t.tokenCount||(t.tokenCount={}),t.tokenCount[n]||(t.tokenCount[n]=0),t.tokenCount[n]++,this._eventBus.fire(dO,{element:t})};cu.prototype.generate=function(e){var t=this,n=e.element,i=e.processInstanceId,a=n.outgoing.filter(function(s){return yv(s,"bpmn:SequenceFlow")});a.forEach(function(s){t._animation.createAnimation(s,i,function(){t._eventBus.fire(fO,{element:s.target,processInstanceId:i})})});var r=n.parent,o=this._elementRegistry.filter(function(s){return yv(s,"bpmn:IntermediateCatchEvent")&&s.parent===r});this._eventBus.fire(hO,{elements:o})};cu.$inject=["animation","eventBus","elementRegistry"];var mO=cu,vO=He.is,bb=Ne,gO=bb.CONSUME_TOKEN_EVENT,yO=bb.GENERATE_TOKEN_EVENT;function pu(e,t){this._animation=e,this._eventBus=t}pu.prototype.consume=function(e){this._eventBus.fire(yO,{element:e})};pu.prototype.generate=function(e){var t=this,n=e.outgoing.filter(function(i){return vO(i,"bpmn:SequenceFlow")});n.forEach(function(i){t._animation.createAnimation(i,function(){t._eventBus.fire(gO,{element:i.target})})})};pu.$inject=["animation","eventBus"];var EO=pu,bO=He.is,_b=Ne,_O=_b.CONSUME_TOKEN_EVENT,xO=_b.GENERATE_TOKEN_EVENT;function fu(e,t){this._animation=e,this._eventBus=t}fu.prototype.consume=function(e){var t=e.element,n=e.processInstanceId;t.tokenCount||(t.tokenCount={}),t.tokenCount[n]||(t.tokenCount[n]=0),t.tokenCount[n]++;var i=t.incoming;i.length===t.tokenCount[n]&&(this._eventBus.fire(xO,e),t.tokenCount[n]=0)};fu.prototype.generate=function(e){var t=this,n=e.element,i=e.processInstanceId,a=n.outgoing.filter(function(r){return bO(r,"bpmn:SequenceFlow")});a.forEach(function(r){t._animation.createAnimation(r,i,function(){t._eventBus.fire(_O,{element:r.target,processInstanceId:i})})})};fu.$inject=["animation","eventBus"];var SO=fu,tc=He.is,xb=Ne,wO=xb.CONSUME_TOKEN_EVENT,TO=xb.UPDATE_ELEMENTS_EVENT;function du(e,t,n,i){this._animation=e,this._eventBus=t,this._elementRegistry=n,this._processInstances=i}du.prototype.consume=function(){};du.prototype.generate=function(e){var t=this,n=e.element,i=e.parentProcessInstanceId,a=n.outgoing.filter(function(u){return tc(u,"bpmn:SequenceFlow")}),r=n.parent,o=this._processInstances.create(r,i);if(a.forEach(function(u){t._animation.createAnimation(u,o,function(){t._eventBus.fire(wO,{element:u.target,processInstanceId:o})})}),!tc(n.parent,"bpmn:SubProcess")){var s=this._elementRegistry.filter(function(u){return tc(u,"bpmn:StartEvent")});this._eventBus.fire(TO,{elements:s})}};du.$inject=["animation","eventBus","elementRegistry","processInstances"];var CO=du,Sb=He.is,Yf=Ne,AO=Yf.CONSUME_TOKEN_EVENT,Ev=Yf.GENERATE_TOKEN_EVENT,wb=Yf.UPDATE_ELEMENT_EVENT;function hu(e,t,n){this._animation=e,this._eventBus=t,this._log=n}hu.prototype.consume=function(e){var t=e.element,n=e.processInstanceId,i=t.children.filter(function(a){return Sb(a,"bpmn:StartEvent")})[0];i?(this._log.log("Starting Subprocess","info","fa-sign-in"),this._eventBus.fire(Ev,{element:i,parentProcessInstanceId:n})):(this._log.log("Skipping Subprocess","info","fa-angle-double-right"),this._eventBus.fire(Ev,e)),this._eventBus.fire(wb,{element:t})};hu.prototype.generate=function(e){var t=this,n=e.element,i=e.processInstanceId,a=n.outgoing.filter(function(r){return Sb(r,"bpmn:SequenceFlow")});a.forEach(function(r){t._animation.createAnimation(r,i,function(){t._eventBus.fire(AO,{element:r.target,processInstanceId:i})})}),this._eventBus.fire(wb,{element:n})};hu.$inject=["animation","eventBus","log"];var PO=hu,RO=He,IO=RO.is,Tb=Ne,NO=Tb.CONSUME_TOKEN_EVENT,MO=Tb.UPDATE_ELEMENT_EVENT;function mu(e,t,n){this._animation=e,this._eventBus=t,this._elementRegistry=n}mu.prototype.consume=function(e){var t=e.element,n=e.processInstanceId;t.tokenCount||(t.tokenCount={}),t.tokenCount[n]||(t.tokenCount[n]=0),t.tokenCount[n]++,this._eventBus.fire(MO,{element:t})};mu.prototype.generate=function(e){var t=this,n=e.element,i=e.processInstanceId,a=n.outgoing.filter(function(r){return IO(r,"bpmn:SequenceFlow")});a.forEach(function(r){t._animation.createAnimation(r,i,function(){t._eventBus.fire(NO,{element:r.target,processInstanceId:i})})})};mu.$inject=["animation","eventBus","elementRegistry"];var kO=mu,DO=He.is,Cb=Ne,OO=Cb.CONSUME_TOKEN_EVENT,LO=Cb.GENERATE_TOKEN_EVENT;function vu(e,t){this._animation=e,this._eventBus=t}vu.prototype.consume=function(e){this._eventBus.fire(LO,e)};vu.prototype.generate=function(e){var t=this,n=e.element,i=e.processInstanceId,a=n.outgoing.filter(function(r){return DO(r,"bpmn:SequenceFlow")});a.forEach(function(r){t._animation.createAnimation(r,i,function(){t._eventBus.fire(OO,{element:r.target,processInstanceId:i})})})};vu.$inject=["animation","eventBus"];var BO=vu,$O=iO,VO=sO,FO=cO,jO=mO,HO=EO,zO=SO,GO=CO,UO=PO,WO=kO,qO=BO,Ab=Ne,YO=Ab.GENERATE_TOKEN_EVENT,KO=Ab.CONSUME_TOKEN_EVENT;function Kf(e,t,n){var i=this;this._injector=n,this.handlers={},this.registerHandler("bpmn:EndEvent",$O),this.registerHandler("bpmn:EventBasedGateway",VO),this.registerHandler("bpmn:ExclusiveGateway",FO),this.registerHandler("bpmn:IntermediateCatchEvent",jO),this.registerHandler("bpmn:IntermediateThrowEvent",HO),this.registerHandler("bpmn:ParallelGateway",zO),this.registerHandler("bpmn:StartEvent",GO),this.registerHandler("bpmn:SubProcess",UO),this.registerHandler("bpmn:BoundaryEvent",WO),this.registerHandler(["bpmn:BusinessRuleTask","bpmn:CallActivity","bpmn:ManualTask","bpmn:ScriptTask","bpmn:ServiceTask","bpmn:Task","bpmn:UserTask"],qO),e.on(YO,function(a){var r=a.element;if(!i.handlers[r.type])throw new Error("no handler for type "+r.type);i.handlers[r.type].generate(a)}),e.on(KO,function(a){var r=a.element;if(!i.handlers[r.type])throw new Error("no handler for type "+r.type);i.handlers[r.type].consume(a)})}Kf.prototype.registerHandler=function(e,t){var n=this,i=this._injector.instantiate(t);Array.isArray(e)||(e=[e]),e.forEach(function(a){n.handlers[a]=i})};Kf.$inject=["eventBus","animation","injector"];var XO=Kf,ZO=XO;function Pb(e,t,n,i,a,r){r.register({toggleTokenSimulation:function(){t.toggleMode()}}),r.register({togglePauseTokenSimulation:function(){n.toggle()}}),r.register({resetTokenSimulation:function(){a.resetSimulation()}}),r.register({toggleTokenSimulationLog:function(){i.toggle()}})}Pb.$inject=["eventBus","toggleMode","pauseSimulation","log","resetSimulation","editorActions"];var JO=Pb,QO=JO,eL=Ne,tL=eL.TOGGLE_MODE_EVENT,nL=1e4;function Rb(e,t){var n=t.get("editorActions",!1),i=t.get("keyboard",!1);if(!i||!n)return;var a=!1;function r(o){if(bs(["t","T"],o))return n.trigger("toggleTokenSimulation"),!0;if(a){if(bs(["l","L"],o))return n.trigger("toggleTokenSimulationLog"),!0;if(bs([" ","Spacebar"],o))return n.trigger("togglePauseTokenSimulation"),!0;if(bs(["r","R"],o))return n.trigger("resetTokenSimulation"),!0}}e.on("keyboard.init",function(){i.addListener(nL,function(o){var s=o.keyEvent;r(s)})}),e.on(tL,function(o){var s=o.simulationModeActive;s?a=!0:a=!1})}Rb.$inject=["eventBus","injector"];var iL=Rb;function bs(e,t){return e.indexOf(t.key)>-1}var rL=iL,aL=Bt,bv=Bi,oL=Ne,sL=oL.TOGGLE_MODE_EVENT;function gu(e,t){var n=this;this._canvas=t,this.entries=[],this._init(),e.on(sL,function(i){var a=i.simulationModeActive;a?bv(n.container).remove("hidden"):bv(n.container).add("hidden")})}gu.prototype._init=function(){this.container=aL('<div class="token-simulation-palette hidden"></div>'),this._canvas.getContainer().appendChild(this.container)};gu.prototype.addEntry=function(e,t){var n=0;this.entries.forEach(function(i){t>=i.index&&n++}),this.container.insertBefore(e,this.container.childNodes[n]),this.entries.push({entry:e,index:t})};gu.$inject=["eventBus","canvas"];var lL=gu,uL=lL,cL={__init__:["animation","contextPads","disableModeling","elementNotifications","elementSupport","exclusiveGatewaySettings","log","notifications","pauseSimulation","preserveElementColors","processInstanceIds","processInstanceSettings","processInstances","resetSimulation","setAnimationSpeed","showProcessInstance","simulationState","toggleMode","tokenCount","tokenSimulationBehavior","tokenSimulationEditorActions","tokenSimulationKeyboardBindings","tokenSimulationPalette"],animation:["type",GN],contextPads:["type",RM],disableModeling:["type",OM],elementNotifications:["type",zM],elementSupport:["type",XM],exclusiveGatewaySettings:["type",ik],log:["type",fk],notifications:["type",gk],pauseSimulation:["type",Pk],preserveElementColors:["type",kk],processInstanceIds:["type",Bk],processInstanceSettings:["type",Gk],processInstances:["type",Xk],resetSimulation:["type",rD],setAnimationSpeed:["type",uD],showProcessInstance:["type",_D],simulationState:["type",RD],toggleMode:["type",OD],tokenCount:["type",YD],tokenSimulationBehavior:["type",ZO],tokenSimulationEditorActions:["type",QO],tokenSimulationKeyboardBindings:["type",rL],tokenSimulationPalette:["type",uL]},pL=cL;const fL=Fr(pL),dL="Camunda",hL="http://camunda.org/schema/1.0/bpmn",mL="camunda",vL={tagAlias:"lowerCase"},gL=[],yL=[{name:"Definitions",isAbstract:!0,extends:["bpmn:Definitions"],properties:[{name:"diagramRelationId",isAttr:!0,type:"String"}]},{name:"InOutBinding",superClass:["Element"],isAbstract:!0,properties:[{name:"source",isAttr:!0,type:"String"},{name:"sourceExpression",isAttr:!0,type:"String"},{name:"target",isAttr:!0,type:"String"},{name:"businessKey",isAttr:!0,type:"String"},{name:"local",isAttr:!0,type:"Boolean",default:!1},{name:"variables",isAttr:!0,type:"String"}]},{name:"In",superClass:["InOutBinding"],meta:{allowedIn:["bpmn:CallActivity","bpmn:SignalEventDefinition"]}},{name:"Out",superClass:["InOutBinding"],meta:{allowedIn:["bpmn:CallActivity"]}},{name:"AsyncCapable",isAbstract:!0,extends:["bpmn:Activity","bpmn:Gateway","bpmn:Event"],properties:[{name:"async",isAttr:!0,type:"Boolean",default:!1},{name:"asyncBefore",isAttr:!0,type:"Boolean",default:!1},{name:"asyncAfter",isAttr:!0,type:"Boolean",default:!1},{name:"exclusive",isAttr:!0,type:"Boolean",default:!0}]},{name:"JobPriorized",isAbstract:!0,extends:["bpmn:Process","camunda:AsyncCapable"],properties:[{name:"jobPriority",isAttr:!0,type:"String"}]},{name:"SignalEventDefinition",isAbstract:!0,extends:["bpmn:SignalEventDefinition"],properties:[{name:"async",isAttr:!0,type:"Boolean",default:!1}]},{name:"ErrorEventDefinition",isAbstract:!0,extends:["bpmn:ErrorEventDefinition"],properties:[{name:"errorCodeVariable",isAttr:!0,type:"String"},{name:"errorMessageVariable",isAttr:!0,type:"String"}]},{name:"Error",isAbstract:!0,extends:["bpmn:Error"],properties:[{name:"camunda:errorMessage",isAttr:!0,type:"String"}]},{name:"PotentialStarter",superClass:["Element"],properties:[{name:"resourceAssignmentExpression",type:"bpmn:ResourceAssignmentExpression"}]},{name:"FormSupported",isAbstract:!0,extends:["bpmn:StartEvent","bpmn:UserTask"],properties:[{name:"formHandlerClass",isAttr:!0,type:"String"},{name:"formKey",isAttr:!0,type:"String"}]},{name:"TemplateSupported",isAbstract:!0,extends:["bpmn:Process","bpmn:FlowElement"],properties:[{name:"modelerTemplate",isAttr:!0,type:"String"},{name:"modelerTemplateVersion",isAttr:!0,type:"Integer"}]},{name:"Initiator",isAbstract:!0,extends:["bpmn:StartEvent"],properties:[{name:"initiator",isAttr:!0,type:"String"}]},{name:"ScriptTask",isAbstract:!0,extends:["bpmn:ScriptTask"],properties:[{name:"resultVariable",isAttr:!0,type:"String"},{name:"resource",isAttr:!0,type:"String"}]},{name:"Process",isAbstract:!0,extends:["bpmn:Process"],properties:[{name:"candidateStarterGroups",isAttr:!0,type:"String"},{name:"candidateStarterUsers",isAttr:!0,type:"String"},{name:"versionTag",isAttr:!0,type:"String"},{name:"historyTimeToLive",isAttr:!0,type:"String"},{name:"isStartableInTasklist",isAttr:!0,type:"Boolean",default:!0}]},{name:"EscalationEventDefinition",isAbstract:!0,extends:["bpmn:EscalationEventDefinition"],properties:[{name:"escalationCodeVariable",isAttr:!0,type:"String"}]},{name:"FormalExpression",isAbstract:!0,extends:["bpmn:FormalExpression"],properties:[{name:"resource",isAttr:!0,type:"String"}]},{name:"Assignable",extends:["bpmn:UserTask"],properties:[{name:"assignee",isAttr:!0,type:"String"},{name:"candidateUsers",isAttr:!0,type:"String"},{name:"candidateGroups",isAttr:!0,type:"String"},{name:"dueDate",isAttr:!0,type:"String"},{name:"followUpDate",isAttr:!0,type:"String"},{name:"priority",isAttr:!0,type:"String"}]},{name:"CallActivity",extends:["bpmn:CallActivity"],properties:[{name:"calledElementBinding",isAttr:!0,type:"String",default:"latest"},{name:"calledElementVersion",isAttr:!0,type:"String"},{name:"calledElementVersionTag",isAttr:!0,type:"String"},{name:"calledElementTenantId",isAttr:!0,type:"String"},{name:"caseRef",isAttr:!0,type:"String"},{name:"caseBinding",isAttr:!0,type:"String",default:"latest"},{name:"caseVersion",isAttr:!0,type:"String"},{name:"caseTenantId",isAttr:!0,type:"String"},{name:"variableMappingClass",isAttr:!0,type:"String"},{name:"variableMappingDelegateExpression",isAttr:!0,type:"String"}]},{name:"ServiceTaskLike",extends:["bpmn:ServiceTask","bpmn:BusinessRuleTask","bpmn:SendTask","bpmn:MessageEventDefinition"],properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"resultVariable",isAttr:!0,type:"String"}]},{name:"DmnCapable",extends:["bpmn:BusinessRuleTask"],properties:[{name:"decisionRef",isAttr:!0,type:"String"},{name:"decisionRefBinding",isAttr:!0,type:"String",default:"latest"},{name:"decisionRefVersion",isAttr:!0,type:"String"},{name:"mapDecisionResult",isAttr:!0,type:"String",default:"resultList"},{name:"decisionRefTenantId",isAttr:!0,type:"String"}]},{name:"ExternalCapable",extends:["camunda:ServiceTaskLike"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"topic",isAttr:!0,type:"String"}]},{name:"TaskPriorized",extends:["bpmn:Process","camunda:ExternalCapable"],properties:[{name:"taskPriority",isAttr:!0,type:"String"}]},{name:"Properties",superClass:["Element"],meta:{allowedIn:["*"]},properties:[{name:"values",type:"Property",isMany:!0}]},{name:"Property",superClass:["Element"],properties:[{name:"id",type:"String",isAttr:!0},{name:"name",type:"String",isAttr:!0},{name:"value",type:"String",isAttr:!0}]},{name:"Connector",superClass:["Element"],meta:{allowedIn:["camunda:ServiceTaskLike"]},properties:[{name:"inputOutput",type:"InputOutput"},{name:"connectorId",type:"String"}]},{name:"InputOutput",superClass:["Element"],meta:{allowedIn:["bpmn:FlowNode","camunda:Connector"]},properties:[{name:"inputOutput",type:"InputOutput"},{name:"connectorId",type:"String"},{name:"inputParameters",isMany:!0,type:"InputParameter"},{name:"outputParameters",isMany:!0,type:"OutputParameter"}]},{name:"InputOutputParameter",properties:[{name:"name",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"},{name:"definition",type:"InputOutputParameterDefinition"}]},{name:"InputOutputParameterDefinition",isAbstract:!0},{name:"List",superClass:["InputOutputParameterDefinition"],properties:[{name:"items",isMany:!0,type:"InputOutputParameterDefinition"}]},{name:"Map",superClass:["InputOutputParameterDefinition"],properties:[{name:"entries",isMany:!0,type:"Entry"}]},{name:"Entry",properties:[{name:"key",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"},{name:"definition",type:"InputOutputParameterDefinition"}]},{name:"Value",superClass:["InputOutputParameterDefinition"],properties:[{name:"id",isAttr:!0,type:"String"},{name:"name",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"}]},{name:"Script",superClass:["InputOutputParameterDefinition"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"resource",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"}]},{name:"Field",superClass:["Element"],meta:{allowedIn:["camunda:ServiceTaskLike","camunda:ExecutionListener","camunda:TaskListener"]},properties:[{name:"name",isAttr:!0,type:"String"},{name:"expression",type:"String"},{name:"stringValue",isAttr:!0,type:"String"},{name:"string",type:"String"}]},{name:"InputParameter",superClass:["InputOutputParameter"]},{name:"OutputParameter",superClass:["InputOutputParameter"]},{name:"Collectable",isAbstract:!0,extends:["bpmn:MultiInstanceLoopCharacteristics"],superClass:["camunda:AsyncCapable"],properties:[{name:"collection",isAttr:!0,type:"String"},{name:"elementVariable",isAttr:!0,type:"String"}]},{name:"FailedJobRetryTimeCycle",superClass:["Element"],meta:{allowedIn:["camunda:AsyncCapable","bpmn:MultiInstanceLoopCharacteristics"]},properties:[{name:"body",isBody:!0,type:"String"}]},{name:"ExecutionListener",superClass:["Element"],meta:{allowedIn:["bpmn:Task","bpmn:ServiceTask","bpmn:UserTask","bpmn:BusinessRuleTask","bpmn:ScriptTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:ExclusiveGateway","bpmn:SequenceFlow","bpmn:ParallelGateway","bpmn:InclusiveGateway","bpmn:EventBasedGateway","bpmn:StartEvent","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:EndEvent","bpmn:BoundaryEvent","bpmn:CallActivity","bpmn:SubProcess","bpmn:Process"]},properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"event",isAttr:!0,type:"String"},{name:"script",type:"Script"},{name:"fields",type:"Field",isMany:!0}]},{name:"TaskListener",superClass:["Element"],meta:{allowedIn:["bpmn:UserTask"]},properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"event",isAttr:!0,type:"String"},{name:"script",type:"Script"},{name:"fields",type:"Field",isMany:!0},{name:"id",type:"String",isAttr:!0},{name:"eventDefinitions",type:"bpmn:TimerEventDefinition",isMany:!0}]},{name:"FormProperty",superClass:["Element"],meta:{allowedIn:["bpmn:StartEvent","bpmn:UserTask"]},properties:[{name:"id",type:"String",isAttr:!0},{name:"name",type:"String",isAttr:!0},{name:"type",type:"String",isAttr:!0},{name:"required",type:"String",isAttr:!0},{name:"readable",type:"String",isAttr:!0},{name:"writable",type:"String",isAttr:!0},{name:"variable",type:"String",isAttr:!0},{name:"expression",type:"String",isAttr:!0},{name:"datePattern",type:"String",isAttr:!0},{name:"default",type:"String",isAttr:!0},{name:"values",type:"Value",isMany:!0}]},{name:"FormData",superClass:["Element"],meta:{allowedIn:["bpmn:StartEvent","bpmn:UserTask"]},properties:[{name:"fields",type:"FormField",isMany:!0},{name:"businessKey",type:"String",isAttr:!0}]},{name:"FormField",superClass:["Element"],properties:[{name:"id",type:"String",isAttr:!0},{name:"label",type:"String",isAttr:!0},{name:"type",type:"String",isAttr:!0},{name:"datePattern",type:"String",isAttr:!0},{name:"defaultValue",type:"String",isAttr:!0},{name:"properties",type:"Properties"},{name:"validation",type:"Validation"},{name:"values",type:"Value",isMany:!0}]},{name:"Validation",superClass:["Element"],properties:[{name:"constraints",type:"Constraint",isMany:!0}]},{name:"Constraint",superClass:["Element"],properties:[{name:"name",type:"String",isAttr:!0},{name:"config",type:"String",isAttr:!0}]},{name:"ConditionalEventDefinition",isAbstract:!0,extends:["bpmn:ConditionalEventDefinition"],properties:[{name:"variableName",isAttr:!0,type:"String"},{name:"variableEvents",isAttr:!0,type:"String"}]}],EL=[],bL={name:dL,uri:hL,prefix:mL,xml:vL,associations:gL,types:yL,emumerations:EL},_L="Activiti",xL="http://activiti.org/bpmn",SL="activiti",wL={tagAlias:"lowerCase"},TL=[],CL=[{name:"Definitions",isAbstract:!0,extends:["bpmn:Definitions"],properties:[{name:"diagramRelationId",isAttr:!0,type:"String"}]},{name:"InOutBinding",superClass:["Element"],isAbstract:!0,properties:[{name:"source",isAttr:!0,type:"String"},{name:"sourceExpression",isAttr:!0,type:"String"},{name:"target",isAttr:!0,type:"String"},{name:"businessKey",isAttr:!0,type:"String"},{name:"local",isAttr:!0,type:"Boolean",default:!1},{name:"variables",isAttr:!0,type:"String"}]},{name:"In",superClass:["InOutBinding"],meta:{allowedIn:["bpmn:CallActivity"]}},{name:"Out",superClass:["InOutBinding"],meta:{allowedIn:["bpmn:CallActivity"]}},{name:"AsyncCapable",isAbstract:!0,extends:["bpmn:Activity","bpmn:Gateway","bpmn:Event"],properties:[{name:"async",isAttr:!0,type:"Boolean",default:!1},{name:"asyncBefore",isAttr:!0,type:"Boolean",default:!1},{name:"asyncAfter",isAttr:!0,type:"Boolean",default:!1},{name:"exclusive",isAttr:!0,type:"Boolean",default:!0}]},{name:"JobPriorized",isAbstract:!0,extends:["bpmn:Process","activiti:AsyncCapable"],properties:[{name:"jobPriority",isAttr:!0,type:"String"}]},{name:"SignalEventDefinition",isAbstract:!0,extends:["bpmn:SignalEventDefinition"],properties:[{name:"async",isAttr:!0,type:"Boolean",default:!1}]},{name:"ErrorEventDefinition",isAbstract:!0,extends:["bpmn:ErrorEventDefinition"],properties:[{name:"errorCodeVariable",isAttr:!0,type:"String"},{name:"errorMessageVariable",isAttr:!0,type:"String"}]},{name:"Error",isAbstract:!0,extends:["bpmn:Error"],properties:[{name:"activiti:errorMessage",isAttr:!0,type:"String"}]},{name:"PotentialStarter",superClass:["Element"],properties:[{name:"resourceAssignmentExpression",type:"bpmn:ResourceAssignmentExpression"}]},{name:"FormSupported",isAbstract:!0,extends:["bpmn:StartEvent","bpmn:UserTask"],properties:[{name:"formHandlerClass",isAttr:!0,type:"String"},{name:"formKey",isAttr:!0,type:"String"}]},{name:"TemplateSupported",isAbstract:!0,extends:["bpmn:Process","bpmn:FlowElement"],properties:[{name:"modelerTemplate",isAttr:!0,type:"String"}]},{name:"Initiator",isAbstract:!0,extends:["bpmn:StartEvent"],properties:[{name:"initiator",isAttr:!0,type:"String"}]},{name:"ScriptTask",isAbstract:!0,extends:["bpmn:ScriptTask"],properties:[{name:"resultVariable",isAttr:!0,type:"String"},{name:"resource",isAttr:!0,type:"String"}]},{name:"Process",isAbstract:!0,extends:["bpmn:Process"],properties:[{name:"candidateStarterGroups",isAttr:!0,type:"String"},{name:"candidateStarterUsers",isAttr:!0,type:"String"},{name:"versionTag",isAttr:!0,type:"String"},{name:"historyTimeToLive",isAttr:!0,type:"String"},{name:"isStartableInTasklist",isAttr:!0,type:"Boolean",default:!0},{name:"executionListener",isAbstract:!0,type:"Expression"}]},{name:"EscalationEventDefinition",isAbstract:!0,extends:["bpmn:EscalationEventDefinition"],properties:[{name:"escalationCodeVariable",isAttr:!0,type:"String"}]},{name:"FormalExpression",isAbstract:!0,extends:["bpmn:FormalExpression"],properties:[{name:"resource",isAttr:!0,type:"String"}]},{name:"multiinstance_type",superClass:["Element"]},{name:"multiinstance_condition",superClass:["Element"]},{name:"Assignable",extends:["bpmn:UserTask"],properties:[{name:"assignee",isAttr:!0,type:"String"},{name:"candidateUsers",isAttr:!0,type:"String"},{name:"candidateGroups",isAttr:!0,type:"String"},{name:"dueDate",isAttr:!0,type:"String"},{name:"followUpDate",isAttr:!0,type:"String"},{name:"priority",isAttr:!0,type:"String"},{name:"multiinstance_condition",isAttr:!0,type:"String"}]},{name:"CallActivity",extends:["bpmn:CallActivity"],properties:[{name:"calledElementBinding",isAttr:!0,type:"String",default:"latest"},{name:"calledElementVersion",isAttr:!0,type:"String"},{name:"calledElementVersionTag",isAttr:!0,type:"String"},{name:"calledElementTenantId",isAttr:!0,type:"String"},{name:"caseRef",isAttr:!0,type:"String"},{name:"caseBinding",isAttr:!0,type:"String",default:"latest"},{name:"caseVersion",isAttr:!0,type:"String"},{name:"caseTenantId",isAttr:!0,type:"String"},{name:"variableMappingClass",isAttr:!0,type:"String"},{name:"variableMappingDelegateExpression",isAttr:!0,type:"String"}]},{name:"ServiceTaskLike",extends:["bpmn:ServiceTask","bpmn:BusinessRuleTask","bpmn:SendTask","bpmn:MessageEventDefinition"],properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"resultVariable",isAttr:!0,type:"String"}]},{name:"DmnCapable",extends:["bpmn:BusinessRuleTask"],properties:[{name:"decisionRef",isAttr:!0,type:"String"},{name:"decisionRefBinding",isAttr:!0,type:"String",default:"latest"},{name:"decisionRefVersion",isAttr:!0,type:"String"},{name:"mapDecisionResult",isAttr:!0,type:"String",default:"resultList"},{name:"decisionRefTenantId",isAttr:!0,type:"String"}]},{name:"ExternalCapable",extends:["activiti:ServiceTaskLike"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"topic",isAttr:!0,type:"String"}]},{name:"TaskPriorized",extends:["bpmn:Process","activiti:ExternalCapable"],properties:[{name:"taskPriority",isAttr:!0,type:"String"}]},{name:"Properties",superClass:["Element"],meta:{allowedIn:["*"]},properties:[{name:"values",type:"Property",isMany:!0}]},{name:"Property",superClass:["Element"],properties:[{name:"id",type:"String",isAttr:!0},{name:"name",type:"String",isAttr:!0},{name:"value",type:"String",isAttr:!0}]},{name:"Connector",superClass:["Element"],meta:{allowedIn:["activiti:ServiceTaskLike"]},properties:[{name:"inputOutput",type:"InputOutput"},{name:"connectorId",type:"String"}]},{name:"InputOutput",superClass:["Element"],meta:{allowedIn:["bpmn:FlowNode","activiti:Connector"]},properties:[{name:"inputOutput",type:"InputOutput"},{name:"connectorId",type:"String"},{name:"inputParameters",isMany:!0,type:"InputParameter"},{name:"outputParameters",isMany:!0,type:"OutputParameter"}]},{name:"InputOutputParameter",properties:[{name:"name",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"},{name:"definition",type:"InputOutputParameterDefinition"}]},{name:"InputOutputParameterDefinition",isAbstract:!0},{name:"List",superClass:["InputOutputParameterDefinition"],properties:[{name:"items",isMany:!0,type:"InputOutputParameterDefinition"}]},{name:"Map",superClass:["InputOutputParameterDefinition"],properties:[{name:"entries",isMany:!0,type:"Entry"}]},{name:"Entry",properties:[{name:"key",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"},{name:"definition",type:"InputOutputParameterDefinition"}]},{name:"Value",superClass:["InputOutputParameterDefinition"],properties:[{name:"id",isAttr:!0,type:"String"},{name:"name",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"}]},{name:"Script",superClass:["InputOutputParameterDefinition"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"resource",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"}]},{name:"Field",superClass:["Element"],meta:{allowedIn:["activiti:ServiceTaskLike","activiti:ExecutionListener","activiti:TaskListener"]},properties:[{name:"name",isAttr:!0,type:"String"},{name:"expression",type:"String"},{name:"stringValue",isAttr:!0,type:"String"},{name:"string",type:"String"}]},{name:"InputParameter",superClass:["InputOutputParameter"]},{name:"OutputParameter",superClass:["InputOutputParameter"]},{name:"Collectable",isAbstract:!0,extends:["bpmn:MultiInstanceLoopCharacteristics"],superClass:["activiti:AsyncCapable"],properties:[{name:"collection",isAttr:!0,type:"String"},{name:"elementVariable",isAttr:!0,type:"String"}]},{name:"FailedJobRetryTimeCycle",superClass:["Element"],meta:{allowedIn:["activiti:AsyncCapable","bpmn:MultiInstanceLoopCharacteristics"]},properties:[{name:"body",isBody:!0,type:"String"}]},{name:"ExecutionListener",superClass:["Element"],meta:{allowedIn:["bpmn:Task","bpmn:ServiceTask","bpmn:UserTask","bpmn:BusinessRuleTask","bpmn:ScriptTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:ExclusiveGateway","bpmn:SequenceFlow","bpmn:ParallelGateway","bpmn:InclusiveGateway","bpmn:EventBasedGateway","bpmn:StartEvent","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:EndEvent","bpmn:BoundaryEvent","bpmn:CallActivity","bpmn:SubProcess","bpmn:Process"]},properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"event",isAttr:!0,type:"String"},{name:"script",type:"Script"},{name:"fields",type:"Field",isMany:!0}]},{name:"TaskListener",superClass:["Element"],meta:{allowedIn:["bpmn:UserTask"]},properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"event",isAttr:!0,type:"String"},{name:"script",type:"Script"},{name:"fields",type:"Field",isMany:!0}]},{name:"FormProperty",superClass:["Element"],meta:{allowedIn:["bpmn:StartEvent","bpmn:UserTask"]},properties:[{name:"id",type:"String",isAttr:!0},{name:"name",type:"String",isAttr:!0},{name:"type",type:"String",isAttr:!0},{name:"required",type:"String",isAttr:!0},{name:"readable",type:"String",isAttr:!0},{name:"writable",type:"String",isAttr:!0},{name:"variable",type:"String",isAttr:!0},{name:"expression",type:"String",isAttr:!0},{name:"datePattern",type:"String",isAttr:!0},{name:"default",type:"String",isAttr:!0},{name:"values",type:"Value",isMany:!0}]},{name:"FormProperty",superClass:["Element"],properties:[{name:"id",type:"String",isAttr:!0},{name:"label",type:"String",isAttr:!0},{name:"type",type:"String",isAttr:!0},{name:"datePattern",type:"String",isAttr:!0},{name:"defaultValue",type:"String",isAttr:!0},{name:"properties",type:"Properties"},{name:"validation",type:"Validation"},{name:"values",type:"Value",isMany:!0}]},{name:"Validation",superClass:["Element"],properties:[{name:"constraints",type:"Constraint",isMany:!0}]},{name:"Constraint",superClass:["Element"],properties:[{name:"name",type:"String",isAttr:!0},{name:"config",type:"String",isAttr:!0}]},{name:"ConditionalEventDefinition",isAbstract:!0,extends:["bpmn:ConditionalEventDefinition"],properties:[{name:"variableName",isAttr:!0,type:"String"},{name:"variableEvent",isAttr:!0,type:"String"}]}],AL=[],PL={name:_L,uri:xL,prefix:SL,xml:wL,associations:TL,types:CL,emumerations:AL},RL="Flowable",IL="http://flowable.org/bpmn",NL="flowable",ML={tagAlias:"lowerCase"},kL=[],DL=[{name:"InOutBinding",superClass:["Element"],isAbstract:!0,properties:[{name:"source",isAttr:!0,type:"String"},{name:"sourceExpression",isAttr:!0,type:"String"},{name:"target",isAttr:!0,type:"String"},{name:"businessKey",isAttr:!0,type:"String"},{name:"local",isAttr:!0,type:"Boolean",default:!1},{name:"variables",isAttr:!0,type:"String"}]},{name:"In",superClass:["InOutBinding"],meta:{allowedIn:["bpmn:CallActivity"]}},{name:"Out",superClass:["InOutBinding"],meta:{allowedIn:["bpmn:CallActivity"]}},{name:"AsyncCapable",isAbstract:!0,extends:["bpmn:Activity","bpmn:Gateway","bpmn:Event"],properties:[{name:"async",isAttr:!0,type:"Boolean",default:!1},{name:"asyncBefore",isAttr:!0,type:"Boolean",default:!1},{name:"asyncAfter",isAttr:!0,type:"Boolean",default:!1},{name:"exclusive",isAttr:!0,type:"Boolean",default:!0}]},{name:"JobPriorized",isAbstract:!0,extends:["bpmn:Process","flowable:AsyncCapable"],properties:[{name:"jobPriority",isAttr:!0,type:"String"}]},{name:"SignalEventDefinition",isAbstract:!0,extends:["bpmn:SignalEventDefinition"],properties:[{name:"async",isAttr:!0,type:"Boolean",default:!1}]},{name:"ErrorEventDefinition",isAbstract:!0,extends:["bpmn:ErrorEventDefinition"],properties:[{name:"errorCodeVariable",isAttr:!0,type:"String"},{name:"errorMessageVariable",isAttr:!0,type:"String"}]},{name:"Error",isAbstract:!0,extends:["bpmn:Error"],properties:[{name:"flowable:errorMessage",isAttr:!0,type:"String"}]},{name:"PotentialStarter",superClass:["Element"],properties:[{name:"resourceAssignmentExpression",type:"bpmn:ResourceAssignmentExpression"}]},{name:"FormSupported",isAbstract:!0,extends:["bpmn:StartEvent","bpmn:UserTask"],properties:[{name:"formHandlerClass",isAttr:!0,type:"String"},{name:"formKey",isAttr:!0,type:"String"},{name:"formType",isAttr:!0,type:"String"},{name:"formReadOnly",isAttr:!0,type:"Boolean",default:!1},{name:"formInit",isAttr:!0,type:"Boolean",default:!0}]},{name:"TemplateSupported",isAbstract:!0,extends:["bpmn:Process","bpmn:FlowElement"],properties:[{name:"modelerTemplate",isAttr:!0,type:"String"}]},{name:"Initiator",isAbstract:!0,extends:["bpmn:StartEvent"],properties:[{name:"initiator",isAttr:!0,type:"String"}]},{name:"ScriptTask",isAbstract:!0,extends:["bpmn:ScriptTask"],properties:[{name:"resultVariable",isAttr:!0,type:"String"},{name:"resource",isAttr:!0,type:"String"}]},{name:"Process",isAbstract:!0,extends:["bpmn:Process"],properties:[{name:"candidateStarterGroups",isAttr:!0,type:"String"},{name:"candidateStarterUsers",isAttr:!0,type:"String"},{name:"versionTag",isAttr:!0,type:"String"},{name:"historyTimeToLive",isAttr:!0,type:"String"},{name:"isStartableInTasklist",isAttr:!0,type:"Boolean",default:!0}]},{name:"EscalationEventDefinition",isAbstract:!0,extends:["bpmn:EscalationEventDefinition"],properties:[{name:"escalationCodeVariable",isAttr:!0,type:"String"}]},{name:"FormalExpression",isAbstract:!0,extends:["bpmn:FormalExpression"],properties:[{name:"resource",isAttr:!0,type:"String"}]},{name:"Assignable",extends:["bpmn:UserTask"],properties:[{name:"assignee",isAttr:!0,type:"String"},{name:"candidateUsers",isAttr:!0,type:"String"},{name:"candidateGroups",isAttr:!0,type:"String"},{name:"dueDate",isAttr:!0,type:"String"},{name:"followUpDate",isAttr:!0,type:"String"},{name:"priority",isAttr:!0,type:"String"}]},{name:"Assignee",supperClass:"Element",meta:{allowedIn:["*"]},properties:[{name:"label",type:"String",isAttr:!0},{name:"viewId",type:"Number",isAttr:!0}]},{name:"CallActivity",extends:["bpmn:CallActivity"],properties:[{name:"calledElementBinding",isAttr:!0,type:"String",default:"latest"},{name:"calledElementVersion",isAttr:!0,type:"String"},{name:"calledElementVersionTag",isAttr:!0,type:"String"},{name:"calledElementTenantId",isAttr:!0,type:"String"},{name:"caseRef",isAttr:!0,type:"String"},{name:"caseBinding",isAttr:!0,type:"String",default:"latest"},{name:"caseVersion",isAttr:!0,type:"String"},{name:"caseTenantId",isAttr:!0,type:"String"},{name:"variableMappingClass",isAttr:!0,type:"String"},{name:"variableMappingDelegateExpression",isAttr:!0,type:"String"}]},{name:"ServiceTaskLike",extends:["bpmn:ServiceTask","bpmn:BusinessRuleTask","bpmn:SendTask","bpmn:MessageEventDefinition"],properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"resultVariable",isAttr:!0,type:"String"}]},{name:"DmnCapable",extends:["bpmn:BusinessRuleTask"],properties:[{name:"decisionRef",isAttr:!0,type:"String"},{name:"decisionRefBinding",isAttr:!0,type:"String",default:"latest"},{name:"decisionRefVersion",isAttr:!0,type:"String"},{name:"mapDecisionResult",isAttr:!0,type:"String",default:"resultList"},{name:"decisionRefTenantId",isAttr:!0,type:"String"}]},{name:"ExternalCapable",extends:["flowable:ServiceTaskLike"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"topic",isAttr:!0,type:"String"}]},{name:"TaskPriorized",extends:["bpmn:Process","flowable:ExternalCapable"],properties:[{name:"taskPriority",isAttr:!0,type:"String"}]},{name:"Properties",superClass:["Element"],meta:{allowedIn:["*"]},properties:[{name:"values",type:"Property",isMany:!0}]},{name:"Property",superClass:["Element"],properties:[{name:"id",type:"String",isAttr:!0},{name:"name",type:"String",isAttr:!0},{name:"value",type:"String",isAttr:!0}]},{name:"Button",superClass:["Element"],meta:{allowedIn:["bpmn:UserTask"]},properties:[{name:"id",type:"String",isAttr:!0},{name:"name",type:"String",isAttr:!0},{name:"code",type:"String",isAttr:!0},{name:"isHide",type:"String",isAttr:!0},{name:"next",type:"String",isAttr:!0},{name:"sort",type:"Integer",isAttr:!0}]},{name:"Assignee",superClass:["Element"],meta:{allowedIn:["bpmn:UserTask"]},properties:[{name:"id",type:"String",isAttr:!0},{name:"type",type:"String",isAttr:!0},{name:"value",type:"String",isAttr:!0},{name:"condition",type:"String",isAttr:!0},{name:"operationType",type:"String",isAttr:!0},{name:"sort",type:"Integer",isAttr:!0}]},{name:"Connector",superClass:["Element"],meta:{allowedIn:["flowable:ServiceTaskLike"]},properties:[{name:"inputOutput",type:"InputOutput"},{name:"connectorId",type:"String"}]},{name:"InputOutput",superClass:["Element"],meta:{allowedIn:["bpmn:FlowNode","flowable:Connector"]},properties:[{name:"inputOutput",type:"InputOutput"},{name:"connectorId",type:"String"},{name:"inputParameters",isMany:!0,type:"InputParameter"},{name:"outputParameters",isMany:!0,type:"OutputParameter"}]},{name:"InputOutputParameter",properties:[{name:"name",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"},{name:"definition",type:"InputOutputParameterDefinition"}]},{name:"InputOutputParameterDefinition",isAbstract:!0},{name:"List",superClass:["InputOutputParameterDefinition"],properties:[{name:"items",isMany:!0,type:"InputOutputParameterDefinition"}]},{name:"Map",superClass:["InputOutputParameterDefinition"],properties:[{name:"entries",isMany:!0,type:"Entry"}]},{name:"Entry",properties:[{name:"key",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"},{name:"definition",type:"InputOutputParameterDefinition"}]},{name:"Value",superClass:["InputOutputParameterDefinition"],properties:[{name:"id",isAttr:!0,type:"String"},{name:"name",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"}]},{name:"Script",superClass:["InputOutputParameterDefinition"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"resource",isAttr:!0,type:"String"},{name:"value",isBody:!0,type:"String"}]},{name:"Field",superClass:["Element"],meta:{allowedIn:["flowable:ServiceTaskLike","flowable:ExecutionListener","flowable:TaskListener"]},properties:[{name:"name",isAttr:!0,type:"String"},{name:"expression",type:"String"},{name:"stringValue",isAttr:!0,type:"String"},{name:"string",type:"String"}]},{name:"ChildField",superClass:["Element"],properties:[{name:"id",type:"String",isAttr:!0},{name:"name",type:"String",isAttr:!0},{name:"type",type:"String",isAttr:!0},{name:"required",type:"String",isAttr:!0},{name:"readable",type:"String",isAttr:!0},{name:"writable",type:"String",isAttr:!0},{name:"variable",type:"String",isAttr:!0},{name:"expression",type:"String",isAttr:!0},{name:"datePattern",type:"String",isAttr:!0},{name:"default",type:"String",isAttr:!0},{name:"values",type:"Value",isMany:!0}]},{name:"InputParameter",superClass:["InputOutputParameter"]},{name:"OutputParameter",superClass:["InputOutputParameter"]},{name:"Collectable",isAbstract:!0,extends:["bpmn:MultiInstanceLoopCharacteristics"],superClass:["flowable:AsyncCapable"],properties:[{name:"collection",isAttr:!0,type:"String"},{name:"elementVariable",isAttr:!0,type:"String"}]},{name:"FailedJobRetryTimeCycle",superClass:["Element"],meta:{allowedIn:["flowable:AsyncCapable","bpmn:MultiInstanceLoopCharacteristics"]},properties:[{name:"body",isBody:!0,type:"String"}]},{name:"ExecutionListener",superClass:["Element"],meta:{allowedIn:["bpmn:Task","bpmn:ServiceTask","bpmn:UserTask","bpmn:BusinessRuleTask","bpmn:ScriptTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:ExclusiveGateway","bpmn:SequenceFlow","bpmn:ParallelGateway","bpmn:InclusiveGateway","bpmn:EventBasedGateway","bpmn:StartEvent","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:EndEvent","bpmn:BoundaryEvent","bpmn:CallActivity","bpmn:SubProcess","bpmn:Process"]},properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"event",isAttr:!0,type:"String"},{name:"script",type:"Script"},{name:"fields",type:"Field",isMany:!0}]},{name:"TaskListener",superClass:["Element"],meta:{allowedIn:["bpmn:UserTask"]},properties:[{name:"expression",isAttr:!0,type:"String"},{name:"class",isAttr:!0,type:"String"},{name:"delegateExpression",isAttr:!0,type:"String"},{name:"event",isAttr:!0,type:"String"},{name:"script",type:"Script"},{name:"fields",type:"Field",isMany:!0}]},{name:"FormProperty",superClass:["Element"],meta:{allowedIn:["bpmn:StartEvent","bpmn:UserTask"]},properties:[{name:"id",type:"String",isAttr:!0},{name:"name",type:"String",isAttr:!0},{name:"type",type:"String",isAttr:!0},{name:"required",type:"String",isAttr:!0},{name:"readable",type:"String",isAttr:!0},{name:"writable",type:"String",isAttr:!0},{name:"variable",type:"String",isAttr:!0},{name:"expression",type:"String",isAttr:!0},{name:"datePattern",type:"String",isAttr:!0},{name:"default",type:"String",isAttr:!0},{name:"values",type:"Value",isMany:!0},{name:"children",type:"ChildField",isMany:!0},{name:"extensionElements",type:"bpmn:ExtensionElements",isMany:!0}]},{name:"FormData",superClass:["Element"],meta:{allowedIn:["bpmn:StartEvent","bpmn:UserTask"]},properties:[{name:"fields",type:"FormField",isMany:!0},{name:"businessKey",type:"String",isAttr:!0}]},{name:"FormField",superClass:["Element"],properties:[{name:"id",type:"String",isAttr:!0},{name:"label",type:"String",isAttr:!0},{name:"type",type:"String",isAttr:!0},{name:"datePattern",type:"String",isAttr:!0},{name:"defaultValue",type:"String",isAttr:!0},{name:"properties",type:"Properties"},{name:"validation",type:"Validation"},{name:"values",type:"Value",isMany:!0}]},{name:"Validation",superClass:["Element"],properties:[{name:"constraints",type:"Constraint",isMany:!0}]},{name:"Constraint",superClass:["Element"],properties:[{name:"name",type:"String",isAttr:!0},{name:"config",type:"String",isAttr:!0}]},{name:"ConditionalEventDefinition",isAbstract:!0,extends:["bpmn:ConditionalEventDefinition"],properties:[{name:"variableName",isAttr:!0,type:"String"},{name:"variableEvent",isAttr:!0,type:"String"}]},{name:"Condition",superClass:["Element"],meta:{allowedIn:["bpmn:SequenceFlow"]},properties:[{name:"id",type:"String",isAttr:!0},{name:"field",type:"String",isAttr:!0},{name:"compare",type:"String",isAttr:!0},{name:"value",type:"String",isAttr:!0},{name:"logic",type:"String",isAttr:!0},{name:"sort",type:"Integer",isAttr:!0}]}],OL=[],LL={name:RL,uri:IL,prefix:NL,xml:ML,associations:kL,types:DL,emumerations:OL},BL="*";function pa(e){const t=this;e.on("moddleCopy.canCopyProperty",function(n){const i=n.property,a=n.parent;return t.canCopyProperty(i,a)})}pa.$inject=["eventBus"];pa.prototype.canCopyProperty=function(e,t){if(T_(e)&&!$L(e,t)||Vr(e,"camunda:InputOutput")&&!this.canHostInputOutput(t)||Ib(e,["camunda:Connector","camunda:Field"])&&!this.canHostConnector(t)||Vr(e,"camunda:In")&&!this.canHostIn(t))return!1};pa.prototype.canHostInputOutput=function(e){if(xn(e,"camunda:Connector"))return!0;const n=xn(e,"bpmn:FlowNode");return!n||Ib(n,["bpmn:StartEvent","bpmn:Gateway","bpmn:BoundaryEvent"])?!1:!(Vr(n,"bpmn:SubProcess")&&n.get("triggeredByEvent"))};pa.prototype.canHostConnector=function(e){const t=xn(e,"camunda:ServiceTaskLike");return Vr(t,"bpmn:MessageEventDefinition")?xn(e,"bpmn:IntermediateThrowEvent")||xn(e,"bpmn:EndEvent"):!0};pa.prototype.canHostIn=function(e){return xn(e,"bpmn:CallActivity")?!0:xn(e,"bpmn:SignalEventDefinition")?xn(e,"bpmn:IntermediateThrowEvent")||xn(e,"bpmn:EndEvent"):!0};function Vr(e,t){return e&&C_(e.$instanceOf)&&e.$instanceOf(t)}function Ib(e,t){return jr(t,function(n){return Vr(e,n)})}function xn(e,t){if(!t)return e.$parent;if(Vr(e,t))return e;if(e.$parent)return xn(e.$parent,t)}function $L(e,t){const n=e.$type&&e.$model.getTypeDescriptor(e.$type),i=n&&n.meta&&n.meta.allowedIn;return!i||VL(i)?!0:jr(i,function(a){return xn(t,a)})}function VL(e){return e.indexOf(BL)!==-1}const FL={__init__:["camundaModdleExtension"],camundaModdleExtension:["type",pa]},jL={FailedJobRetryTimeCycle:["bpmn:StartEvent","bpmn:BoundaryEvent","bpmn:IntermediateCatchEvent","bpmn:Activity"],Connector:["bpmn:EndEvent","bpmn:IntermediateThrowEvent"],Field:["bpmn:EndEvent","bpmn:IntermediateThrowEvent"]};function Xf(e,t){return e&&typeof e.$instanceOf=="function"&&e.$instanceOf(t)}function HL(e){return e&&e.length}function _s(e,t){return HL(e)&&jr(e,function(n){return Xf(n,t)})}function zL(e,t){return jr(t,function(n){return Xf(e,n)})}function nc(e,t,n){const i=t.name,a=jL[i.replace(/activiti:/,"")];return i===e&&zL(n,a)}function Zf(e){e.on("property.clone",function(t){const n=t.newElement,i=t.propertyDescriptor;this.canCloneProperty(n,i)},this)}Zf.$inject=["eventBus"];Zf.prototype.canCloneProperty=function(e,t){if(nc("activiti:FailedJobRetryTimeCycle",t,e))return _s(e.eventDefinitions,"bpmn:TimerEventDefinition")||_s(e.eventDefinitions,"bpmn:SignalEventDefinition")||Xf(e.loopCharacteristics,"bpmn:MultiInstanceLoopCharacteristics");if(nc("activiti:Connector",t,e)||nc("activiti:Field",t,e))return _s(e.eventDefinitions,"bpmn:MessageEventDefinition")};const GL={__init__:["ActivitiModdleExtension"],ActivitiModdleExtension:["type",Zf]},UL={FailedJobRetryTimeCycle:["bpmn:StartEvent","bpmn:BoundaryEvent","bpmn:IntermediateCatchEvent","bpmn:Activity"],Connector:["bpmn:EndEvent","bpmn:IntermediateThrowEvent"],Field:["bpmn:EndEvent","bpmn:IntermediateThrowEvent"]};function Jf(e,t){return e&&typeof e.$instanceOf=="function"&&e.$instanceOf(t)}function WL(e){return e&&e.length}function xs(e,t){return WL(e)&&jr(e,function(n){return Jf(n,t)})}function qL(e,t){return jr(t,function(n){return Jf(e,n)})}function ic(e,t,n){const i=t.name,a=UL[i.replace(/flowable:/,"")];return i===e&&qL(n,a)}function Qf(e){e.on("property.clone",function(t){const n=t.newElement,i=t.propertyDescriptor;this.canCloneProperty(n,i)},this)}Qf.$inject=["eventBus"];Qf.prototype.canCloneProperty=function(e,t){if(ic("flowable:FailedJobRetryTimeCycle",t,e))return xs(e.eventDefinitions,"bpmn:TimerEventDefinition")||xs(e.eventDefinitions,"bpmn:SignalEventDefinition")||Jf(e.loopCharacteristics,"bpmn:MultiInstanceLoopCharacteristics");if(ic("flowable:Connector",t,e)||ic("flowable:Field",t,e))return xs(e.eventDefinitions,"bpmn:MessageEventDefinition")};const YL={__init__:["FlowableModdleExtension"],FlowableModdleExtension:["type",Qf]};var KL=Object.defineProperty,il=Object.getOwnPropertySymbols,Nb=Object.prototype.hasOwnProperty,Mb=Object.prototype.propertyIsEnumerable,Kc=(e,t,n)=>t in e?KL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,kb=(e,t)=>{for(var n in t||(t={}))Nb.call(t,n)&&Kc(e,n,t[n]);if(il)for(var n of il(t))Mb.call(t,n)&&Kc(e,n,t[n]);return e},XL=(e,t)=>{var n={};for(var i in e)Nb.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&il)for(var i of il(e))t.indexOf(i)<0&&Mb.call(e,i)&&(n[i]=e[i]);return n},mi=(e,t,n)=>(Kc(e,typeof t!="symbol"?t+"":t,n),n);function En(e){return e==null}function ed(e){return typeof e=="string"}function ZL(e){return typeof e=="boolean"}var Ie;(function(e){e.Root="Root",e.Declaration="Declaration",e.Comment="Comment",e.DocumentType="DocumentType",e.Element="Element",e.Text="Text",e.Instruction="Instruction",e.CDATA="CDATA"})(Ie||(Ie={}));var rn=class{constructor(e,t=null,n=null){mi(this,"name"),mi(this,"type"),mi(this,"parent"),mi(this,"children"),mi(this,"attributes"),mi(this,"value"),mi(this,"selfClosing"),mi(this,"prefix"),this.name="",this.type=e,this.parent=t,this.value=n,this.children=null,this.attributes={},this.selfClosing=!1,this.prefix=""}setName(e){return this.name=e,this}setType(e){return this.type=e,this}setParent(e){return this.parent=e,this}setChildren(e){return this.children=e&&Array.from(e),this}setAttributes(e){return this.attributes=kb({},e),this}setValue(e){return this.value=e,this}setSelfClosing(e){return this.selfClosing=e,this}setPrefix(e){return this.prefix=e,this}addAttribute(e,t){return this.attributes[e]=t,this}removeAttribute(e){return delete this.attributes[e],this}addChild(e){return e===this?this:(this.children||(this.children=[]),this.children.push(e),e.parent!==this&&(e.parent=this),this)}removeChild(e){if(this.children&&this.children.length){const t=this.children.findIndex(n=>n===e);~t&&(this.children.splice(t,1),e.parent=null)}return this}toJsObject(){return{name:this.name||void 0,prefix:this.prefix||void 0,type:this.type,attributes:Object.keys(this.attributes).length?this.attributes:void 0,value:En(this.value)?void 0:this.value,selfClosing:this.selfClosing||void 0,children:(this.type===Ie.Element||this.type===Ie.Root)&&this.children&&this.children.length?this.children.map(e=>e.toJSON()):void 0}}toXmlString(e="  ",t=`
`,n=0){const i=e.repeat(n);let a="";switch(this.type){case Ie.Root:{a+=this.children&&this.children.length?this.children.map(r=>r.toXmlString(e,t,n)).join(t):"";break}case Ie.Element:{if(!this.name)return"";const r=this.prefix?`${this.prefix}:${this.name}`:this.name;a+=`${i}<${r}`;const o=_v(this.attributes||{});o&&(a+=` ${o}`),this.children&&this.children.length?a+=`>${t}${this.children.map(s=>s.toXmlString(e,t,n+1)).join(t)}${t}${i}</${r}>`:a+=this.selfClosing?" />":`></${r}>`;break}case Ie.CDATA:{a+=`${i}<![CDATA[${En(this.value)?"":this.value}]]>`;break}case Ie.Text:{a+=En(this.value)?"":`${i}${this.value}`;break}case Ie.DocumentType:{a+=En(this.value)?"":`${i}<!DOCTYPE ${this.value}>`;break}case Ie.Comment:{a+=`${i}<!-- ${En(this.value)?"":this.value+" "}-->`;break}case Ie.Declaration:{if(a+=`${i}<?xml `,!this.attributes||En(this.attributes.version))a+='version="1.0" ';else{const r=parseFloat(this.attributes.version);a+=`version="${Number.isNaN(r)?"1.0":r.toFixed(1)}" `}if(this.attributes){const r=this.attributes,o=XL(r,["version"]);o&&(a+=_v(o))}a+="?>";break}case Ie.Instruction:{a+=En(this.value)?"":`${i}<?${this.value}?>`;break}}return a}toJSON(){return this.toJsObject()}toString(){return this.toXmlString("","")}};function _v(e){return Object.keys(e).map(t=>{const n=e[t];return En(n)?null:ZL(n)?n?t:null:`${t}="${n}"`}).filter(Boolean).join(" ")}var xv=e=>e,Db={ignoreAttributes:!1,parseNodeValue:!0,trimValues:!0,prefixInName:!1,valueProcessor:xv,attributeProcessor:xv},JL=Object.keys(Db);function QL(e={}){const t=kb({},e);return JL.forEach(n=>{En(t[n])&&(t[n]=Db[n])}),t}var Gi="Tag is not closed.";function e2(e,t={}){const n=e.replace(/\r\n?/g,`
`),i=QL(t),a=n.length,r=new rn(Ie.Root);let o=r,s="";for(let u=0;u<a;u++){const c=n[u];if(c!=="<")s+=c;else if(n[u+1]==="/"){const p=xr(n,">",u,`Element End ${Gi}`);let f=n.substring(u+2,p),m="";if(!i.prefixInName){const v=f.indexOf(":");~v&&(m=f.substring(0,v),f=f.substring(v+1))}if(o.prefix!==m||o.name!==f)throw new Error("End Tag is incorrect.");if(s){const v=rc(Ui("",Ie.Text,s,i));v&&o.addChild(new rn(Ie.Text,o,v))}o=o.parent,s="",u=p}else if(n[u+1]==="?"){const p=xr(n,"?>",u,`Processing Instruction ${Gi}`),f=n.substring(u+2,p-1);if(o)if(f.startsWith("xml ")&&f.includes("version=")&&o.type===Ie.Root){const m=new rn(Ie.Declaration,o);m.attributes=ac(f.substr(4),Ie.Declaration,i),o.addChild(m)}else o.addChild(new rn(Ie.Instruction,o,Ui("",Ie.Instruction,f,i)));u=p}else if(n.substr(u+1,3)==="!--"){const p=xr(n,"-->",u,`Comment ${Gi}`),f=n.substring(u+4,p-2);o&&o.addChild(new rn(Ie.Comment,o,Ui("",Ie.Comment,f,i))),u=p}else if(n.substr(u+1,8)==="!DOCTYPE"){let p=xr(n,">",u,`Document Type ${Gi}`),f=n.substring(u+9,p);f.includes("[")&&(p=xr(n,"]>",u,`Document Type ${Gi}`),f=n.substring(u+9,p)),o&&o.addChild(new rn(Ie.DocumentType,o,Ui("",Ie.DocumentType,f,i))),u=p}else if(n.substr(u+1,8)==="![CDATA["){const p=xr(n,"]]>",u,`CDATA Section ${Gi}`),f=n.substring(u+9,p-2);if(o&&s){const m=rc(Ui("",Ie.Text,s,i));m&&o.addChild(new rn(Ie.Text,o,m))}o.addChild(new rn(Ie.CDATA,o,Ui("",Ie.CDATA,f,i))),s="",u=p}else{let p="",f="",m=u+1;for(;m<=a;){let _=n[m];if(p)_===p&&(p="");else if(_==='"'||_==="'")p=_;else if(_==="	")_=" ";else if(_===">")break;f+=_,m++}if(m>a)throw new Error(`Element ${Gi}`);f=f.trim();const v=f.indexOf(" ");let g=f,b="";if(~v?(g=f.substr(0,v),f=f.substr(v+1)):f="",!i.prefixInName){const _=g.indexOf(":");~_&&(b=g.substring(0,_),g=g.substring(_+1))}if(o&&s){const _=rc(Ui("",Ie.Text,s,i));_&&o.addChild(new rn(Ie.Text,o,_))}if(f.length&&f.lastIndexOf("/")===f.length-1){g[g.length-1]==="/"?(g=g.substr(0,g.length-1),f=""):f=f.substr(0,f.length-1);const _=new rn(Ie.Element,o);_.name=g,_.selfClosing=!0,_.prefix=b,f&&!i.ignoreAttributes&&(_.attributes=ac(f,Ie.Element,i)),o.addChild(_)}else{const _=new rn(Ie.Element,o);f&&!i.ignoreAttributes&&(_.attributes=ac(f,Ie.Element,i)),_.name=g,_.prefix=b,o.addChild(_),o=_}s="",u=m}}return r}function xr(e,t,n,i){const a=e.indexOf(t,n);if(!~a)throw new Error(i);return a+t.length-1}function Ui(e,t,n,i){return n?(i.trimValues&&(n=n.trim()),Ob(i.valueProcessor(n,t,e),i.parseNodeValue)):null}function Ob(e,t){return t&&ed(e)?(e=e.trim(),e==="true"?!0:e==="false"?!1:t2(e)):En(e)?null:e}function t2(e){const t=parseFloat(e);return Number.isNaN(t)?e:t}function rc(e){return En(e)?"":ed(e)?e:String(e)}var n2=/[^\s=]+\s*(=\s*['"][\s\S]*?['"])?/g;function ac(e,t,n){e=e.replace(/\r?\n/g," ");const i=e.match(n2)||[],a={};for(let r=0;r<i.length;r++){const o=i[r];let[s,u]=o.split("=");s=s.trim(),ed(u)?(u=u.substring(1,u.length-1),n.trimValues&&(u=u.trim()),a[s]=Ob(n.attributeProcessor(u,s,t),n.parseNodeValue)):a[s]=!0}return a}const i2={class:"my-process-designer"},r2={class:"my-process-designer__header",style:{"z-index":"999",display:"table-row-group"}},a2={style:{color:"#409eff"}},o2=Ve("br",null,null,-1),s2=Ve("br",null,null,-1),l2=Ve("br",null,null,-1),u2={class:"my-process-designer__container"},c2={class:"hljs"},oc=mt({name:"MyProcessDesigner",__name:"ProcessDesigner",props:{value:String,processId:String,processName:String,formId:Number,translations:{type:Object,default:()=>{}},additionalModel:[Object,Array],moddleExtension:{type:Object,default:()=>{}},onlyCustomizeAddi:{type:Boolean,default:!1},onlyCustomizeModdle:{type:Boolean,default:!1},simulation:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},prefix:{type:String,default:"camunda"},events:{type:Array,default:()=>["element.click"]},headerButtonSize:{type:String,default:"small",validator:e=>["default","medium","small","mini"].indexOf(e)!==-1},headerButtonType:{type:String,default:"primary",validator:e=>["default","primary","success","warning","danger","info"].indexOf(e)!==-1}},emits:["destroy","init-finished","save","commandStack-changed","input","change","canvas-viewbox-changed","element-click"],setup(e,{emit:t}){const n=e,i=Z(),a=Z();Ls("configGlobal",n);let r=null;const o=Z(1),s=Z(!1),u=Z(!1),c=Z(""),p=Z("xml"),f=Z(!1),m=Z(!1),v=Yn(()=>{console.log(n.additionalModel,"additionalModel");const h=[];if(n.onlyCustomizeAddi)return Object.prototype.toString.call(n.additionalModel)=="[object Array]"?n.additionalModel||[]:[n.additionalModel];Object.prototype.toString.call(n.additionalModel)=="[object Array]"?h.push(...n.additionalModel):n.additionalModel&&h.push(n.additionalModel);const x={translate:["value",xN(n.translations||SN)]};return h.push(x),n.simulation&&h.push(fL),console.log(n.prefix,"props.prefix "),n.prefix==="camunda"&&h.push(FL),n.prefix==="flowable"&&h.push(YL),n.prefix==="activiti"&&h.push(GL),h}),g=Yn(()=>{console.log(n.onlyCustomizeModdle,"props.onlyCustomizeModdle"),console.log(n.moddleExtension,"props.moddleExtension"),console.log(n.prefix,"props.prefix");const h={};if(n.onlyCustomizeModdle)return n.moddleExtension||null;if(n.moddleExtension)for(let x in n.moddleExtension)h[x]=n.moddleExtension[x];return n.prefix==="activiti"&&(h.activiti=PL),n.prefix==="flowable"&&(h.flowable=LL),n.prefix==="camunda"&&(h.camunda=bL),h});console.log(v,"additionalModules()"),console.log(g,"moddleExtensions()");const b=()=>{if(r)return;let h=document.getElementById("bpmnCanvas");console.log(h,"data"),console.log(n.keyboard,"props.keyboard"),console.log(v,"additionalModules()"),console.log(g,"moddleExtensions()"),r=new Ln({container:h,keyboard:n.keyboard?{bindTo:document}:null,additionalModules:v.value,moddleExtensions:g.value}),console.log(r,"bpmnModeler111111"),t("init-finished",r),_()},_=()=>{const h=r.get("eventBus");console.log(h,"EventBus"),n.events.forEach(x=>{h.on(x,function(I){let F=x.replace(/\./g,"-"),O=I?I.element:null;console.log(F,"eventName"),console.log(O,"element"),t("element-click",O,I)})}),h.on("commandStack.changed",x=>en(this,null,function*(){try{f.value=r.get("commandStack").canRedo(),m.value=r.get("commandStack").canUndo();let{xml:I}=yield r.saveXML({format:!0});t("commandStack-changed",x),t("input",I),t("change",I)}catch(I){console.error(`[Process Designer Warn]: ${I.message||I}`)}})),r.on("canvas.viewbox.changed",({viewbox:x})=>{t("canvas-viewbox-changed",{viewbox:x});const{scale:I}=x;o.value=Math.floor(I*100)/100})},k=h=>en(this,null,function*(){console.log(h,"xml");let x=n.processId||`Process_${new Date().getTime()}`,I=n.processName||`业务流程_${new Date().getTime()}`,F=h||ZE(x,I,n.prefix);try{let{warnings:O}=yield r.importXML(F);console.log(O,"warnings"),O&&O.length&&O.forEach(H=>console.warn(H))}catch(O){console.error(`[Process Designer Warn]: ${O.message||O}`)}}),N=h=>en(this,null,function*(){try{if(h==="xml"||h==="bpmn"){const{err:I,xml:F}=yield r.saveXML();I&&console.error(`[Process Designer Warn ]: ${I.message||I}`);let{href:O,filename:H}=A(h.toUpperCase(),F);x(O,H)}else{const{err:I,svg:F}=yield r.saveSVG();if(I)return console.error(I);let{href:O,filename:H}=A("SVG",F);x(O,H)}}catch(I){console.error(`[Process Designer Warn ]: ${I.message||I}`)}function x(I,F){if(I&&F){let O=document.createElement("a");O.download=F,O.href=I,O.click(),URL.revokeObjectURL(O.href)}}}),A=(h,x)=>{const I="diagram",F=encodeURIComponent(x);return{filename:`${I}.${h}`,href:`data:application/${h==="svg"?"text/xml":"bpmn20-xml"};charset=UTF-8,${F}`,data:x}},S=()=>{const h=a.value.files[0],x=new FileReader;x.readAsText(h),x.onload=function(){let I=this.result;k(I)}},C=()=>{N("xml")},D=()=>{N("bpmn")},$=()=>{N("svg")},M=()=>{u.value=!u.value,console.log(r.get("toggleMode","strict"),"bpmnModeler.get('toggleMode')"),n.simulation&&r.get("toggleMode","strict").toggleMode()},V=()=>{r.get("commandStack").redo()},K=()=>{r.get("commandStack").undo()},X=(h=.1)=>{let x=Math.floor(o.value*100+h*100)/100;if(x>4)throw new Error("[Process Designer Warn ]: The zoom ratio cannot be greater than 4");o.value=x,r.get("canvas").zoom(o.value)},z=(h=.1)=>{let x=Math.floor(o.value*100-h*100)/100;if(x<.2)throw new Error("[Process Designer Warn ]: The zoom ratio cannot be less than 0.2");o.value=x,r.get("canvas").zoom(o.value)},U=()=>{o.value=1,r.get("canvas").zoom("fit-viewport","auto")},Q=()=>{f.value=!1,m.value=!1,k(null)},l=h=>{const x=r.get("alignElements"),F=r.get("selection").get();if(!F||F.length<=1){_d.warning("请按住 Shift 键选择多个元素对齐");return}Pr.confirm("自动对齐可能造成图形变形，是否继续？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{x.trigger(F,h)})},d=()=>{console.log(r.saveXML,"bpmnModeler"),r.saveXML({format:!0}).then(({xml:h})=>{c.value=h,p.value="xml",s.value=!0})},E=()=>{r.saveXML({format:!0}).then(({xml:h})=>{var I;const x=new rn(Ie.Root,e2(h));c.value=(I=x.parent)==null?void 0:I.toJSON(),p.value="json",s.value=!0})},y=()=>en(this,null,function*(){const{err:h,xml:x}=yield r.saveXML();if(h){_d.warning("保存模型失败，请重试！");return}t("save",x)});return m_(()=>{console.log(n,"props")}),Ya(()=>{b(),k(n.value)}),Vn(()=>{r&&r.destroy(),t("destroy",r),r=null}),(h,x)=>{const I=te("el-button"),F=te("Dialog"),O=v_("highlight");return re(),Oe("div",i2,[Ve("div",r2,[g_(h.$slots,"control-header"),(h.$slots["control-header"],re(),Oe(an,{key:0},[R(Ge(zo),{key:"file-control"},{default:j(()=>[R(Ke,{preIcon:"ep:folder-opened",title:"打开文件",onClick:x[0]||(x[0]=H=>a.value.click())}),R(Ge(kt),{effect:"light",placement:"bottom"},{content:j(()=>[Ve("div",a2,[R(ma,{title:"下载为XML文件",onClick:x[1]||(x[1]=H=>C())}),o2,R(ma,{title:"下载为SVG文件",onClick:x[2]||(x[2]=H=>$())}),s2,R(ma,{title:"下载为BPMN文件",onClick:x[3]||(x[3]=H=>D())})])]),default:j(()=>[R(Ke,{title:"下载文件",preIcon:"ep:download"})]),_:1}),R(Ge(kt),{effect:"light"},{content:j(()=>[R(ma,{title:"预览XML",onClick:d}),l2,R(ma,{title:"预览JSON",onClick:E})]),default:j(()=>[R(Ke,{preIcon:"ep:view",title:"浏览"})]),_:1}),n.simulation?(re(),ye(Ge(kt),{key:0,effect:"light",content:u.value?"退出模拟":"开启模拟"},{default:j(()=>[R(Ke,{preIcon:"ep:cpu",title:"模拟",onClick:M})]),_:1},8,["content"])):Ce("",!0)]),_:1}),R(Ge(zo),{key:"align-control"},{default:j(()=>[R(Ge(kt),{effect:"light",content:"向左对齐"},{default:j(()=>[R(Ke,{preIcon:"fa:align-left",class:"align align-bottom",onClick:x[4]||(x[4]=H=>l("left"))})]),_:1}),R(Ge(kt),{effect:"light",content:"向右对齐"},{default:j(()=>[R(Ke,{preIcon:"fa:align-left",class:"align align-top",onClick:x[5]||(x[5]=H=>l("right"))})]),_:1}),R(Ge(kt),{effect:"light",content:"向上对齐"},{default:j(()=>[R(Ke,{preIcon:"fa:align-left",class:"align align-left",onClick:x[6]||(x[6]=H=>l("top"))})]),_:1}),R(Ge(kt),{effect:"light",content:"向下对齐"},{default:j(()=>[R(Ke,{preIcon:"fa:align-left",class:"align align-right",onClick:x[7]||(x[7]=H=>l("bottom"))})]),_:1}),R(Ge(kt),{effect:"light",content:"水平居中"},{default:j(()=>[R(Ke,{preIcon:"fa:align-left",class:"align align-center",onClick:x[8]||(x[8]=H=>l("center"))})]),_:1}),R(Ge(kt),{effect:"light",content:"垂直居中"},{default:j(()=>[R(Ke,{preIcon:"fa:align-left",class:"align align-middle",onClick:x[9]||(x[9]=H=>l("middle"))})]),_:1})]),_:1}),R(Ge(zo),{key:"scale-control"},{default:j(()=>[R(Ge(kt),{effect:"light",content:"缩小视图"},{default:j(()=>[R(Ke,{preIcon:"ep:zoom-out",onClick:x[10]||(x[10]=H=>z()),disabled:o.value<.2},null,8,["disabled"])]),_:1}),R(I,null,{default:j(()=>[me(Os(Math.floor(o.value*10*10)+"%"),1)]),_:1}),R(Ge(kt),{effect:"light",content:"放大视图"},{default:j(()=>[R(Ke,{preIcon:"ep:zoom-in",onClick:x[11]||(x[11]=H=>X()),disabled:o.value>4},null,8,["disabled"])]),_:1}),R(Ge(kt),{effect:"light",content:"重置视图并居中"},{default:j(()=>[R(Ke,{preIcon:"ep:scale-to-original",onClick:x[12]||(x[12]=H=>U())})]),_:1})]),_:1}),R(Ge(zo),{key:"stack-control"},{default:j(()=>[R(Ge(kt),{effect:"light",content:"撤销"},{default:j(()=>[R(Ke,{preIcon:"ep:refresh-left",onClick:x[13]||(x[13]=H=>K()),disabled:!m.value},null,8,["disabled"])]),_:1}),R(Ge(kt),{effect:"light",content:"恢复"},{default:j(()=>[R(Ke,{preIcon:"ep:refresh-right",onClick:x[14]||(x[14]=H=>V()),disabled:!f.value},null,8,["disabled"])]),_:1}),R(Ge(kt),{effect:"light",content:"重新绘制"},{default:j(()=>[R(Ke,{preIcon:"ep:refresh",onClick:x[15]||(x[15]=H=>Q())})]),_:1})]),_:1}),R(Ke,{preIcon:"ep:plus",title:"保存模型",onClick:y,type:n.headerButtonType,disabled:u.value},null,8,["type","disabled"])],64)),Ve("input",{type:"file",id:"files",ref_key:"refFile",ref:a,style:{display:"none"},accept:".xml, .bpmn",onChange:S},null,544)]),Ve("div",u2,[Ve("div",{class:"my-process-designer__canvas",ref_key:"bpmnCanvas",ref:i,id:"bpmnCanvas",style:{width:"1680px",height:"800px"}},null,512)]),R(F,{title:"预览",modelValue:s.value,"onUpdate:modelValue":x[16]||(x[16]=H=>s.value=H),width:"80%",scroll:!0,"max-height":"600px"},{default:j(()=>[uc((re(),Oe("div",null,[Ve("code",c2,Os(c.value),1)])),[[O]])]),_:1},8,["modelValue"])])}}});oc.install=function(e){e.component(oc.name,oc)};const p2={class:"panel-tab__content"},f2={key:0},d2={key:1},h2=mt({name:"ElementBaseInfo",__name:"ElementBaseInfo",props:{businessObject:{type:Object,default:()=>{}},model:{type:Object,default:()=>{}}},setup(e){const t=e,n=Z({}),i=Z(),a=Z({}),r=y_({id:[{required:!0,message:"流程标识不能为空",trigger:"blur"}],name:[{required:!0,message:"流程名称不能为空",trigger:"blur"}]}),o=()=>window==null?void 0:window.bpmnInstances,s=()=>{var f;console.log(window,"window"),console.log(i.value,"bpmnElement"),i.value=(f=o())==null?void 0:f.bpmnElement,console.log(i.value,"resetBaseInfo11111111111"),a.value=i.value.businessObject,n.value.type=i.value.businessObject.$type,console.log(a.value,"elementBaseInfo22222222222")},u=f=>{if(f){if(!f.match(/[a-zA-Z_][\-_.0-9a-zA-Z$]*/)){console.log("key 不满足 XML NCName 规则，所以不进行赋值");return}console.log("key 满足 XML NCName 规则，所以进行赋值"),a.value.id=f,setTimeout(()=>{p("id")},100)}},c=f=>{console.log(a,"elementBaseInfo"),f&&(a.value.name=f,setTimeout(()=>{p("name")},100))},p=f=>{console.log(f,"key");const m=Object.create(null);m[f]=a.value[f],console.log(a,"elementBaseInfo11111111111"),n.value=at(at({},a.value),n.value),f==="id"?(console.log("jinru"),console.log(window,"window"),console.log(i.value,"bpmnElement"),console.log($e(i.value),"bpmnElement"),o().modeling.updateProperties($e(i.value),{id:a.value[f],di:{id:`${a.value[f]}_di`}})):(console.log(m,"attrObj"),o().modeling.updateProperties($e(i.value),m))};return Ya(()=>{setTimeout(()=>{console.log(t.model,"props.model"),u(t.model.key),c(t.model.name),console.log(t,"propsssssssssssssssssssss")},1e3)}),ct(()=>t.businessObject,f=>{console.log(f,"val11111111111111111111"),f&&s()}),Vn(()=>{i.value=null}),(f,m)=>{const v=te("el-link"),g=te("el-input"),b=te("el-form-item"),_=te("el-form");return re(),Oe("div",p2,[R(_,{"label-width":"90px",model:n.value,rules:r},{default:j(()=>[n.value.type=="bpmn:Process"?(re(),Oe("div",f2,[R(v,{href:"https://doc.iocoder.cn/bpm/#_3-%E6%B5%81%E7%A8%8B%E5%9B%BE%E7%A4%BA%E4%BE%8B",type:"danger",target:"_blank"},{default:j(()=>[me(" 如何实现实现会签、或签？ ")]),_:1}),R(b,{label:"流程标识",prop:"id"},{default:j(()=>[R(g,{modelValue:n.value.id,"onUpdate:modelValue":m[0]||(m[0]=k=>n.value.id=k),placeholder:"请输入流标标识",disabled:n.value.id!==void 0&&n.value.id.length>0,onChange:u},null,8,["modelValue","disabled"])]),_:1}),R(b,{label:"流程名称",prop:"name"},{default:j(()=>[R(g,{modelValue:n.value.name,"onUpdate:modelValue":m[1]||(m[1]=k=>n.value.name=k),placeholder:"请输入流程名称",clearable:"",onChange:c},null,8,["modelValue"])]),_:1})])):(re(),Oe("div",d2,[R(b,{label:"ID"},{default:j(()=>[R(g,{modelValue:a.value.id,"onUpdate:modelValue":m[2]||(m[2]=k=>a.value.id=k),clearable:"",onChange:m[3]||(m[3]=k=>p("id"))},null,8,["modelValue"])]),_:1}),R(b,{label:"名称"},{default:j(()=>[R(g,{modelValue:a.value.name,"onUpdate:modelValue":m[4]||(m[4]=k=>a.value.name=k),clearable:"",onChange:m[5]||(m[5]=k=>p("name"))},null,8,["modelValue"])]),_:1})]))]),_:1},8,["model","rules"])])}}}),m2={class:"panel-tab__content"},v2={class:"element-property input-property"},g2=Ve("div",{class:"element-property__label"},"元素文档：",-1),y2={class:"element-property__value"},E2=mt({name:"ElementOtherConfig",__name:"ElementOtherConfig",props:{id:String},setup(e){const t=e,n=Z(""),i=Z(),a=()=>window.bpmnInstances,r=()=>{i.value&&i.value.id===t.id||(i.value=a().elementRegistry.get(t.id));const o=a().bpmnFactory.create("bpmn:Documentation",{text:n.value});a().modeling.updateProperties($e(i.value),{documentation:[o]})};return Vn(()=>{i.value=null}),ct(()=>t.id,o=>{o&&o.length?Dt(()=>{var u;const s=(u=a().bpmnElement.businessObject)==null?void 0:u.documentation;n.value=s&&s.length?s[0].text:""}):n.value=""},{immediate:!0}),(o,s)=>{const u=te("el-input");return re(),Oe("div",m2,[Ve("div",v2,[g2,Ve("div",y2,[R(u,{type:"textarea",modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=c=>n.value=c),resize:"vertical",autosize:{minRows:2,maxRows:4},onInput:r,onBlur:r},null,8,["modelValue"])])])])}}}),b2={style:{"margin-top":"16px"}},_2=mt({name:"UserTask",__name:"UserTask",props:{id:String,type:String},setup(e){const t=e,n=Z({assignee:"",candidateUsers:[],candidateGroups:[],dueDate:"",followUpDate:"",priority:""}),i=Z({}),a=Z(),r=()=>window==null?void 0:window.bpmnInstances,o=()=>{var u,c;for(let p in n.value){let f;p==="candidateUsers"||p==="candidateGroups"?f=(u=a.value)!=null&&u.businessObject[p]?a.value.businessObject[p].split(","):[]:f=((c=a.value)==null?void 0:c.businessObject[p])||n.value[p],i.value[p]=f}},s=u=>{const c=Object.create(null);u==="candidateUsers"||u==="candidateGroups"?c[u]=i.value[u]&&i.value[u].length?i.value[u].join():null:c[u]=i.value[u]||null,r().modeling.updateProperties($e(a.value),c)};return ct(()=>t.id,()=>{a.value=r().bpmnElement,Dt(()=>{o()})},{immediate:!0}),Vn(()=>{a.value=null}),(u,c)=>{const p=te("el-input"),f=te("el-form-item"),m=te("el-link"),v=te("router-link");return re(),Oe("div",b2,[R(f,{label:"到期时间"},{default:j(()=>[R(p,{modelValue:i.value.dueDate,"onUpdate:modelValue":c[0]||(c[0]=g=>i.value.dueDate=g),clearable:"",onChange:c[1]||(c[1]=g=>s("dueDate"))},null,8,["modelValue"])]),_:1}),R(f,{label:"跟踪时间"},{default:j(()=>[R(p,{modelValue:i.value.followUpDate,"onUpdate:modelValue":c[2]||(c[2]=g=>i.value.followUpDate=g),clearable:"",onChange:c[3]||(c[3]=g=>s("followUpDate"))},null,8,["modelValue"])]),_:1}),R(f,{label:"优先级"},{default:j(()=>[R(p,{modelValue:i.value.priority,"onUpdate:modelValue":c[4]||(c[4]=g=>i.value.priority=g),clearable:"",onChange:c[5]||(c[5]=g=>s("priority"))},null,8,["modelValue"])]),_:1}),me(" 友情提示：任务的分配规则，使用 "),R(v,{target:"_blank",to:{path:"/bpm/manager/model"}},{default:j(()=>[R(m,{type:"danger"},{default:j(()=>[me("流程模型")]),_:1})]),_:1}),me(" 下的【分配规则】替代，提供指定角色、部门负责人、部门成员、岗位、工作组、自定义脚本等 7 种维护的任务分配维度，更加灵活！ ")])}}}),x2={style:{"margin-top":"16px"}},S2=mt({name:"ScriptTask",__name:"ScriptTask",props:{id:String,type:String},setup(e){const t=e,n=Z({scriptFormat:"",script:"",resource:"",resultVariable:""}),i=Z({}),a=Z(),r=()=>window==null?void 0:window.bpmnInstances,o=()=>{var u;for(let c in n.value){let p=((u=a.value)==null?void 0:u.businessObject[c])||n.value[c];i.value[c]=p}i.value.scriptType=i.value.script?"inline":"external"},s=()=>{let u=Object.create(null);u.scriptFormat=i.value.scriptFormat||null,u.resultVariable=i.value.resultVariable||null,i.value.scriptType==="inline"?(u.script=i.value.script||null,u.resource=null):(u.resource=i.value.resource||null,u.script=null),r().modeling.updateProperties($e(a.value),u)};return Vn(()=>{a.value=null}),ct(()=>t.id,()=>{a.value=r().bpmnElement,Dt(()=>{o()})},{immediate:!0}),(u,c)=>{const p=te("el-input"),f=te("el-form-item"),m=te("el-option"),v=te("el-select");return re(),Oe("div",x2,[R(f,{label:"脚本格式"},{default:j(()=>[R(p,{modelValue:i.value.scriptFormat,"onUpdate:modelValue":c[0]||(c[0]=g=>i.value.scriptFormat=g),clearable:"",onInput:c[1]||(c[1]=g=>s()),onChange:c[2]||(c[2]=g=>s())},null,8,["modelValue"])]),_:1}),R(f,{label:"脚本类型"},{default:j(()=>[R(v,{modelValue:i.value.scriptType,"onUpdate:modelValue":c[3]||(c[3]=g=>i.value.scriptType=g)},{default:j(()=>[R(m,{label:"内联脚本",value:"inline"}),R(m,{label:"外部资源",value:"external"})]),_:1},8,["modelValue"])]),_:1}),uc(R(f,{label:"脚本"},{default:j(()=>[R(p,{modelValue:i.value.script,"onUpdate:modelValue":c[4]||(c[4]=g=>i.value.script=g),type:"textarea",resize:"vertical",autosize:{minRows:2,maxRows:4},clearable:"",onInput:c[5]||(c[5]=g=>s()),onChange:c[6]||(c[6]=g=>s())},null,8,["modelValue"])]),_:1},512),[[bd,i.value.scriptType==="inline"]]),uc(R(f,{label:"资源地址"},{default:j(()=>[R(p,{modelValue:i.value.resource,"onUpdate:modelValue":c[7]||(c[7]=g=>i.value.resource=g),clearable:"",onInput:c[8]||(c[8]=g=>s()),onChange:c[9]||(c[9]=g=>s())},null,8,["modelValue"])]),_:1},512),[[bd,i.value.scriptType==="external"]]),R(f,{label:"结果变量"},{default:j(()=>[R(p,{modelValue:i.value.resultVariable,"onUpdate:modelValue":c[10]||(c[10]=g=>i.value.resultVariable=g),clearable:"",onInput:c[11]||(c[11]=g=>s()),onChange:c[12]||(c[12]=g=>s())},null,8,["modelValue"])]),_:1})])}}}),w2={style:{"margin-top":"16px"}},T2={style:{display:"flex","align-items":"center","justify-content":"space-between","flex-wrap":"nowrap"}},C2=mt({name:"ReceiveTask",__name:"ReceiveTask",props:{id:String,type:String},setup(e){const t=e,n=Av(),i=Z(""),a=Z({}),r=Z({}),o=Z(!1),s=Z(),u=Z(),c=Z(),p=()=>window.bpmnInstances,f=()=>{var b,_;s.value=p().bpmnElement,i.value=((_=(b=s.value.businessObject)==null?void 0:b.messageRef)==null?void 0:_.id)||"-1"},m=()=>{o.value=!0,a.value={}},v=()=>{if(r.value[a.value.id]){n.error("该消息已存在，请修改id后重新保存");return}const b=p().moddle.create("bpmn:Message",a.value);c.value.push(b),r.value[a.value.id]=a.value.name,u.value[a.value.id]=b,o.value=!1},g=b=>{b==="-1"?p().modeling.updateProperties($e(s.value),{messageRef:null}):p().modeling.updateProperties($e(s.value),{messageRef:u.value[b]})};return Ya(()=>{u.value=Object.create(null),c.value=p().modeler.getDefinitions().rootElements,c.value.filter(b=>b.$type==="bpmn:Message").forEach(b=>{u.value[b.id]=b,r.value[b.id]=b.name}),r.value[-1]="无"}),Vn(()=>{s.value=null}),ct(()=>t.id,()=>{Dt(()=>{f()})},{immediate:!0}),(b,_)=>{const k=te("el-option"),N=te("el-select"),A=te("el-form-item"),S=te("el-input"),C=te("el-form"),D=te("el-button"),$=te("el-dialog");return re(),Oe("div",w2,[R(A,{label:"消息实例"},{default:j(()=>[Ve("div",T2,[R(N,{modelValue:i.value,"onUpdate:modelValue":_[0]||(_[0]=M=>i.value=M),onChange:g},{default:j(()=>[(re(!0),Oe(an,null,Tr(Object.keys(r.value),M=>(re(),ye(k,{value:M,label:r.value[M],key:M},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),R(Ke,{type:"primary",preIcon:"ep:plus",style:{"margin-left":"8px"},onClick:m})])]),_:1}),R($,{modelValue:o.value,"onUpdate:modelValue":_[3]||(_[3]=M=>o.value=M),"close-on-click-modal":!1,title:"创建新消息",width:"400px","append-to-body":"","destroy-on-close":""},{footer:j(()=>[R(D,{size:"small",type:"primary",onClick:v},{default:j(()=>[me("确 认")]),_:1})]),default:j(()=>[R(C,{model:a.value,size:"small","label-width":"90px"},{default:j(()=>[R(A,{label:"消息ID"},{default:j(()=>[R(S,{modelValue:a.value.id,"onUpdate:modelValue":_[1]||(_[1]=M=>a.value.id=M),clearable:""},null,8,["modelValue"])]),_:1}),R(A,{label:"消息名称"},{default:j(()=>[R(S,{modelValue:a.value.name,"onUpdate:modelValue":_[2]||(_[2]=M=>a.value.name=M),clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),A2={class:"panel-tab__content"},P2=mt({name:"ElementTaskConfig",__name:"ElementTask",props:{id:String,type:String},setup(e){const t=e,n=Z({asyncAfter:!1,asyncBefore:!1,exclusive:!1}),i=Z(),a=Z({UserTask:"UserTask",ScriptTask:"ScriptTask",ReceiveTask:"ReceiveTask"}),r=Z(),o=()=>window.bpmnInstances,s=()=>{!n.value.asyncBefore&&!n.value.asyncAfter&&(n.value.exclusive=!1),o().modeling.updateProperties(o().bpmnElement,at({},n.value))};return ct(()=>t.id,()=>{var u,c,p,f,m,v;r.value=o().bpmnElement,n.value.asyncBefore=(c=(u=r.value)==null?void 0:u.businessObject)==null?void 0:c.asyncBefore,n.value.asyncAfter=(f=(p=r.value)==null?void 0:p.businessObject)==null?void 0:f.asyncAfter,n.value.exclusive=(v=(m=r.value)==null?void 0:m.businessObject)==null?void 0:v.exclusive},{immediate:!0}),ct(()=>t.type,()=>{t.type==a.value.UserTask&&(i.value=_2),t.type==a.value.ScriptTask&&(i.value=S2),t.type==a.value.ReceiveTask&&(i.value=C2)},{immediate:!0}),(u,c)=>{const p=te("el-checkbox"),f=te("el-form-item"),m=te("el-form");return re(),Oe("div",A2,[R(m,{size:"small","label-width":"90px"},{default:j(()=>[R(f,{label:"异步延续"},{default:j(()=>[R(p,{modelValue:n.value.asyncBefore,"onUpdate:modelValue":c[0]||(c[0]=v=>n.value.asyncBefore=v),label:"异步前",onChange:s},null,8,["modelValue"]),R(p,{modelValue:n.value.asyncAfter,"onUpdate:modelValue":c[1]||(c[1]=v=>n.value.asyncAfter=v),label:"异步后",onChange:s},null,8,["modelValue"]),n.value.asyncAfter||n.value.asyncBefore?(re(),ye(p,{key:0,modelValue:n.value.exclusive,"onUpdate:modelValue":c[2]||(c[2]=v=>n.value.exclusive=v),label:"排除",onChange:s},null,8,["modelValue"])):Ce("",!0)]),_:1}),(re(),ye(E_(i.value),b_(__(u.$props)),null,16))]),_:1})])}}}),R2={class:"panel-tab__content"},I2=mt({name:"ElementMultiInstance",__name:"ElementMultiInstance",props:{businessObject:Object,type:String},setup(e){const t=e,n=Ar("prefix"),i=Z(""),a=Z({completionCondition:"",loopCardinality:"",extensionElements:[],asyncAfter:!1,asyncBefore:!1,exclusive:!1}),r=Z({}),o=Z(null),s=Z(null),u=()=>window==null?void 0:window.bpmnInstances,c=_=>{var k,N,A,S,C,D;if(!_.loopCharacteristics){i.value="Null",r.value={};return}if(_.loopCharacteristics.$type==="bpmn:StandardLoopCharacteristics"){i.value="StandardLoop",r.value={};return}_.loopCharacteristics.isSequential?i.value="SequentialMultiInstance":i.value="ParallelMultiInstance",r.value=Fi(at(at({},a.value),_.loopCharacteristics),{completionCondition:(A=(N=(k=_.loopCharacteristics)==null?void 0:k.completionCondition)==null?void 0:N.body)!=null?A:"",loopCardinality:(D=(C=(S=_.loopCharacteristics)==null?void 0:S.loopCardinality)==null?void 0:C.body)!=null?D:""}),s.value=u().bpmnElement.businessObject.loopCharacteristics,_.loopCharacteristics.extensionElements&&_.loopCharacteristics.extensionElements.values&&_.loopCharacteristics.extensionElements.values.length&&(r.value.timeCycle=_.loopCharacteristics.extensionElements.values[0].body)},p=_=>{if(_==="Null"){u().modeling.updateProperties($e(o.value),{loopCharacteristics:null});return}if(_==="StandardLoop"){const k=u().moddle.create("bpmn:StandardLoopCharacteristics");u().modeling.updateProperties($e(o.value),{loopCharacteristics:k}),s.value=null;return}_==="SequentialMultiInstance"?s.value=u().moddle.create("bpmn:MultiInstanceLoopCharacteristics",{isSequential:!0}):s.value=u().moddle.create("bpmn:MultiInstanceLoopCharacteristics",{collection:"${coll_userList}"}),u().modeling.updateProperties($e(o.value),{loopCharacteristics:$e(s.value)})},f=_=>{let k=null;_&&_.length&&(k=u().moddle.create("bpmn:FormalExpression",{body:_})),u().modeling.updateModdleProperties($e(o.value),s.value,{loopCardinality:k})},m=_=>{let k=null;_&&_.length&&(k=u().moddle.create("bpmn:FormalExpression",{body:_})),u().modeling.updateModdleProperties($e(o.value),s.value,{completionCondition:k})},v=_=>{const k=u().moddle.create("bpmn:ExtensionElements",{values:[u().moddle.create(`${n}:FailedJobRetryTimeCycle`,{body:_})]});u().modeling.updateModdleProperties($e(o.value),s.value,{extensionElements:k})},g=()=>{u().modeling.updateModdleProperties($e(o.value),s.value,{collection:r.value.collection||null,elementVariable:r.value.elementVariable||null})},b=_=>{const{asyncBefore:k,asyncAfter:N}=r.value;let A=Object.create(null);!k&&!N?(r.value.exclusive=!1,A={asyncBefore:!1,asyncAfter:!1,exclusive:!1,extensionElements:null}):A[_]=r.value[_],u().modeling.updateModdleProperties($e(o.value),s.value,A)};return Vn(()=>{s.value=null,o.value=null}),ct(()=>t.businessObject,_=>{o.value=u().bpmnElement,c(_)},{immediate:!0}),(_,k)=>{const N=te("el-option"),A=te("el-select"),S=te("el-form-item"),C=te("el-input"),D=te("el-checkbox"),$=te("el-form");return re(),Oe("div",R2,[R($,{"label-width":"90px"},{default:j(()=>[R(S,{label:"回路特性"},{default:j(()=>[R(A,{modelValue:i.value,"onUpdate:modelValue":k[0]||(k[0]=M=>i.value=M),onChange:p},{default:j(()=>[R(N,{label:"并行多重事件",value:"ParallelMultiInstance"}),R(N,{label:"时序多重事件",value:"SequentialMultiInstance"}),R(N,{label:"循环事件",value:"StandardLoop"}),R(N,{label:"无",value:"Null"})]),_:1},8,["modelValue"])]),_:1}),i.value==="ParallelMultiInstance"||i.value==="SequentialMultiInstance"?(re(),Oe(an,{key:0},[R(S,{label:"循环基数",key:"loopCardinality"},{default:j(()=>[R(C,{modelValue:r.value.loopCardinality,"onUpdate:modelValue":k[1]||(k[1]=M=>r.value.loopCardinality=M),clearable:"",onChange:f},null,8,["modelValue"])]),_:1}),R(S,{label:"集合",key:"collection"},{default:j(()=>[R(C,{modelValue:r.value.collection,"onUpdate:modelValue":k[2]||(k[2]=M=>r.value.collection=M),clearable:"",onChange:g},null,8,["modelValue"])]),_:1}),R(S,{label:"元素变量",key:"elementVariable"},{default:j(()=>[R(C,{modelValue:r.value.elementVariable,"onUpdate:modelValue":k[3]||(k[3]=M=>r.value.elementVariable=M),clearable:"",onChange:g},null,8,["modelValue"])]),_:1}),R(S,{label:"完成条件",key:"completionCondition"},{default:j(()=>[R(C,{modelValue:r.value.completionCondition,"onUpdate:modelValue":k[4]||(k[4]=M=>r.value.completionCondition=M),clearable:"",onChange:m},null,8,["modelValue"])]),_:1}),R(S,{label:"异步状态",key:"async"},{default:j(()=>[R(D,{modelValue:r.value.asyncBefore,"onUpdate:modelValue":k[5]||(k[5]=M=>r.value.asyncBefore=M),label:"异步前",onChange:k[6]||(k[6]=M=>b("asyncBefore"))},null,8,["modelValue"]),R(D,{modelValue:r.value.asyncAfter,"onUpdate:modelValue":k[7]||(k[7]=M=>r.value.asyncAfter=M),label:"异步后",onChange:k[8]||(k[8]=M=>b("asyncAfter"))},null,8,["modelValue"]),r.value.asyncAfter||r.value.asyncBefore?(re(),ye(D,{key:0,modelValue:r.value.exclusive,"onUpdate:modelValue":k[9]||(k[9]=M=>r.value.exclusive=M),label:"排除",onChange:k[10]||(k[10]=M=>b("exclusive"))},null,8,["modelValue"])):Ce("",!0)]),_:1}),r.value.asyncAfter||r.value.asyncBefore?(re(),ye(S,{label:"重试周期",prop:"timeCycle",key:"timeCycle"},{default:j(()=>[R(C,{modelValue:r.value.timeCycle,"onUpdate:modelValue":k[11]||(k[11]=M=>r.value.timeCycle=M),clearable:"",onChange:v},null,8,["modelValue"])]),_:1})):Ce("",!0)],64)):Ce("",!0)]),_:1})])}}}),N2={class:"panel-tab__content"},M2=mt({name:"FlowCondition",__name:"FlowCondition",props:{businessObject:Object,type:String},setup(e){const t=e,n=Z({}),i=Z(),a=Z(),r=Z(),o=Z(),s=()=>window==null?void 0:window.bpmnInstances,u=()=>{if(i.value=s().bpmnElement,a.value=i.value.source,r.value=i.value.businessObject.sourceRef,r.value&&r.value.default&&r.value.default.id===i.value.id&&n.value.type=="default")n.value={type:"default"};else if(!i.value.businessObject.conditionExpression)n.value={type:"normal"};else{const f=i.value.businessObject.conditionExpression;if(n.value=Fi(at({},f),{type:"condition"}),n.value.resource){n.value.conditionType="script",n.value.scriptType="externalScript";return}if(f.language){n.value.conditionType="script",n.value.scriptType="inlineScript";return}n.value.conditionType="expression"}},c=f=>{if(f==="condition"){o.value=s().moddle.create("bpmn:FormalExpression"),s().modeling.updateProperties($e(i.value),{conditionExpression:o.value});return}if(f==="default"){s().modeling.updateProperties($e(i.value),{conditionExpression:null}),s().modeling.updateProperties($e(a.value),{default:i.value});return}r.value.default&&r.value.default.id===i.value.id&&s().modeling.updateProperties($e(a.value),{default:null}),s().modeling.updateProperties($e(i.value),{conditionExpression:null})},p=()=>{let{conditionType:f,scriptType:m,body:v,resource:g,language:b}=n.value,_;f==="expression"?_=s().moddle.create("bpmn:FormalExpression",{body:v}):m==="inlineScript"?(_=s().moddle.create("bpmn:FormalExpression",{body:v,language:b}),n.value.resource=""):(n.value.body="",_=s().moddle.create("bpmn:FormalExpression",{resource:g,language:b})),s().modeling.updateProperties($e(i.value),{conditionExpression:_})};return Vn(()=>{i.value=null,a.value=null,r.value=null}),ct(()=>t.businessObject,f=>{console.log(f,"val"),Dt(()=>{u()})},{immediate:!0}),(f,m)=>{const v=te("el-option"),g=te("el-select"),b=te("el-form-item"),_=te("el-input"),k=te("el-form");return re(),Oe("div",N2,[R(k,{model:n.value,"label-width":"90px",size:"small"},{default:j(()=>[R(b,{label:"流转类型"},{default:j(()=>[R(g,{modelValue:n.value.type,"onUpdate:modelValue":m[0]||(m[0]=N=>n.value.type=N),onChange:c},{default:j(()=>[R(v,{label:"普通流转路径",value:"normal"}),R(v,{label:"默认流转路径",value:"default"}),R(v,{label:"条件流转路径",value:"condition"})]),_:1},8,["modelValue"])]),_:1}),n.value.type==="condition"?(re(),ye(b,{label:"条件格式",key:"condition"},{default:j(()=>[R(g,{modelValue:n.value.conditionType,"onUpdate:modelValue":m[1]||(m[1]=N=>n.value.conditionType=N)},{default:j(()=>[R(v,{label:"表达式",value:"expression"}),R(v,{label:"脚本",value:"script"})]),_:1},8,["modelValue"])]),_:1})):Ce("",!0),n.value.conditionType&&n.value.conditionType==="expression"?(re(),ye(b,{label:"表达式",key:"express"},{default:j(()=>[R(_,{modelValue:n.value.body,"onUpdate:modelValue":m[2]||(m[2]=N=>n.value.body=N),style:{width:"192px"},clearable:"",onChange:p},null,8,["modelValue"])]),_:1})):Ce("",!0),n.value.conditionType&&n.value.conditionType==="script"?(re(),Oe(an,{key:2},[R(b,{label:"脚本语言",key:"language"},{default:j(()=>[R(_,{modelValue:n.value.language,"onUpdate:modelValue":m[3]||(m[3]=N=>n.value.language=N),clearable:"",onChange:p},null,8,["modelValue"])]),_:1}),R(b,{label:"脚本类型",key:"scriptType"},{default:j(()=>[R(g,{modelValue:n.value.scriptType,"onUpdate:modelValue":m[4]||(m[4]=N=>n.value.scriptType=N)},{default:j(()=>[R(v,{label:"内联脚本",value:"inlineScript"}),R(v,{label:"外部脚本",value:"externalScript"})]),_:1},8,["modelValue"])]),_:1}),n.value.scriptType==="inlineScript"?(re(),ye(b,{label:"脚本",key:"body"},{default:j(()=>[R(_,{modelValue:n.value.body,"onUpdate:modelValue":m[5]||(m[5]=N=>n.value.body=N),type:"textarea",clearable:"",onChange:p},null,8,["modelValue"])]),_:1})):Ce("",!0),n.value.scriptType==="externalScript"?(re(),ye(b,{label:"资源地址",key:"resource"},{default:j(()=>[R(_,{modelValue:n.value.resource,"onUpdate:modelValue":m[6]||(m[6]=N=>n.value.resource=N),clearable:"",onChange:p},null,8,["modelValue"])]),_:1})):Ce("",!0)],64)):Ce("",!0)]),_:1},8,["model"])])}}}),k2={class:"panel-tab__content"},D2={class:"panel-tab__content--title"},O2={class:"panel-tab__content--title",style:{"padding-top":"8px","margin-top":"8px","border-top":"1px solid #eee"}},L2=mt({name:"SignalAndMassage",__name:"SignalAndMessage",setup(e){const t=Av(),n=Z([]),i=Z([]),a=Z(!1),r=Z(""),o=Z({}),s=Z(),u=Z(),c=Z(),p=Yn(()=>r.value==="message"?{title:"创建消息",idLabel:"消息ID",nameLabel:"消息名称"}:{title:"创建信号",idLabel:"信号ID",nameLabel:"信号名称"}),f=()=>window==null?void 0:window.bpmnInstances,m=()=>{console.log(window,"window"),s.value=f().modeler.getDefinitions().rootElements,u.value={},c.value={},i.value=[],n.value=[],s.value.forEach(b=>{b.$type==="bpmn:Message"&&(u.value[b.id]=!0,i.value.push(at({},b))),b.$type==="bpmn:Signal"&&(c.value[b.id]=!0,n.value.push(at({},b)))})},v=b=>{r.value=b,o.value={},a.value=!0},g=()=>{if(r.value==="message"){u.value[o.value.id]&&t.error("该消息已存在，请修改id后重新保存");const b=f().moddle.create("bpmn:Message",o.value);s.value.push(b)}else{c.value[o.value.id]&&t.error("该信号已存在，请修改id后重新保存");const b=f().moddle.create("bpmn:Signal",o.value);s.value.push(b)}a.value=!1,m()};return Ya(()=>{m()}),(b,_)=>{const k=te("Icon"),N=te("el-table-column"),A=te("el-table"),S=te("el-input"),C=te("el-form-item"),D=te("el-form"),$=te("el-button"),M=te("el-dialog");return re(),Oe("div",k2,[Ve("div",D2,[Ve("span",null,[R(k,{icon:"ep:menu",style:{"margin-right":"8px",color:"#555"}}),me("消息列表")]),R(Ke,{type:"primary",title:"创建新消息",preIcon:"ep:plus",onClick:_[0]||(_[0]=V=>v("message"))})]),R(A,{data:i.value,border:""},{default:j(()=>[R(N,{type:"index",label:"序号",width:"60px"}),R(N,{label:"消息ID",prop:"id","max-width":"300px","show-overflow-tooltip":""}),R(N,{label:"消息名称",prop:"name","max-width":"300px","show-overflow-tooltip":""})]),_:1},8,["data"]),Ve("div",O2,[Ve("span",null,[R(k,{icon:"ep:menu",style:{"margin-right":"8px",color:"#555"}}),me("信号列表")]),R(Ke,{type:"primary",title:"创建新信号",preIcon:"ep:plus",onClick:_[1]||(_[1]=V=>v("signal"))})]),R(A,{data:n.value,border:""},{default:j(()=>[R(N,{type:"index",label:"序号",width:"60px"}),R(N,{label:"信号ID",prop:"id","max-width":"300px","show-overflow-tooltip":""}),R(N,{label:"信号名称",prop:"name","max-width":"300px","show-overflow-tooltip":""})]),_:1},8,["data"]),R(M,{modelValue:a.value,"onUpdate:modelValue":_[5]||(_[5]=V=>a.value=V),title:p.value.title,"close-on-click-modal":!1,width:"400px","append-to-body":"","destroy-on-close":""},{footer:j(()=>[R($,{onClick:_[4]||(_[4]=V=>a.value=!1)},{default:j(()=>[me("取 消")]),_:1}),R($,{type:"primary",onClick:g},{default:j(()=>[me("保 存")]),_:1})]),default:j(()=>[R(D,{model:o.value,"label-width":"90px"},{default:j(()=>[R(C,{label:p.value.idLabel},{default:j(()=>[R(S,{modelValue:o.value.id,"onUpdate:modelValue":_[2]||(_[2]=V=>o.value.id=V),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),R(C,{label:p.value.nameLabel},{default:j(()=>[R(S,{modelValue:o.value.name,"onUpdate:modelValue":_[3]||(_[3]=V=>o.value.name=V),clearable:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Xi=()=>window==null?void 0:window.bpmnInstances;function Lb(e,t,n){const i=Object.create(null);switch(i.event=e.event,t&&(i.id=e.id),e.listenerType){case"scriptListener":i.script=$2(e,n);break;case"expressionListener":i.expression=e.expression;break;case"delegateExpressionListener":i.delegateExpression=e.delegateExpression;break;default:i.class=e.class}if(e.fields&&(i.fields=e.fields.map(a=>B2(a,n))),t&&e.event==="timeout"&&e.eventDefinitionType){const a=Xi().moddle.create("bpmn:FormalExpression",{body:e.eventTimeDefinitions}),r=Xi().moddle.create("bpmn:TimerEventDefinition",{id:`TimerEventDefinition_${V2(8)}`,[`time${e.eventDefinitionType.replace(/^\S/,o=>o.toUpperCase())}`]:a});i.eventDefinitions=[r]}return Xi().moddle.create(`${n}:${t?"TaskListener":"ExecutionListener"}`,i)}function B2(e,t){const{name:n,fieldType:i,string:a,expression:r}=e,o=i==="string"?{name:n,string:a}:{name:n,expression:r};return Xi().moddle.create(`${t}:Field`,o)}function $2(e,t){const{scriptType:n,scriptFormat:i,value:a,resource:r}=e,o=n==="inlineScript"?{scriptFormat:i,value:a}:{scriptFormat:i,resource:r};return Xi().moddle.create(`${t}:Script`,o)}function rl(e,t){const n=Xi().moddle.create("bpmn:ExtensionElements",{values:t});Xi().modeling.updateProperties($e(e),{extensionElements:n})}function V2(e=8,t){let n="";const i=t||"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let a=e;a>0;--a)n+=i[Math.floor(Math.random()*i.length)];return n}function Bb(e){let t=at({},e);if(e.script&&(t=Fi(at(at({},e),e.script),{scriptType:e.script.resource?"externalScript":"inlineScript"})),e.event==="timeout"&&e.eventDefinitions&&e.eventDefinitions.length){let n="";for(const i in e.eventDefinitions[0])console.log(e.eventDefinitions,i),i.indexOf("time")!==-1&&(n=i,t.eventDefinitionType=i.replace("time","").toLowerCase());console.log(n),t.eventTimeDefinitions=e.eventDefinitions[0][n].body}return t}function $b(e){var n;let t;return e.class&&(t="classListener"),e.expression&&(t="expressionListener"),e.delegateExpression&&(t="delegateExpressionListener"),e.script&&(t="scriptListener"),Fi(at(at({},JSON.parse(JSON.stringify(e))),(n=e.script)!=null?n:{}),{listenerType:t})}const Vb={classListener:"Java 类",expressionListener:"表达式",delegateExpressionListener:"代理表达式",scriptListener:"脚本"},F2={create:"创建",assignment:"指派",complete:"完成",delete:"删除",update:"更新",timeout:"超时"},Fb={string:"字符串",expression:"表达式"},j2={class:"panel-tab__content"},H2={class:"element-drawer__button"},z2={class:"listener-filed__title"},G2={class:"element-drawer__button"},U2=mt({name:"ElementListeners",__name:"ElementListeners",props:{id:String,type:String},setup(e){const t=e,n=Ar("prefix"),i=Ar("width"),a=Z([]),r=Z({}),o=Z(!1),s=Z([]),u=Z({}),c=Z(!1),p=Z(-1),f=Z(-1),m=Z(Vb),v=Z(Fb),g=Z(),b=Z(),_=Z(),k=Z(),N=Z(),A=()=>window==null?void 0:window.bpmnInstances,S=()=>{var X,z,U,Q;g.value=A().bpmnElement,b.value=[],_.value=(Q=(U=(z=(X=g.value.businessObject)==null?void 0:X.extensionElements)==null?void 0:z.values)==null?void 0:U.filter(l=>l.$type===`${n}:ExecutionListener`))!=null?Q:[],a.value=_.value.map(l=>$b(l))},C=(X,z)=>{X?(r.value=Bb(X),p.value=z):(r.value={},p.value=-1),X&&X.fields?s.value=X.fields.map(U=>Fi(at({},U),{fieldType:U.string?"string":"expression"})):(s.value=[],r.value.fields=[]),o.value=!0,Dt(()=>{k.value&&k.value.clearValidate()})},D=(X,z)=>{u.value=X?JSON.parse(JSON.stringify(X)):{},f.value=X?z:-1,c.value=!0,Dt(()=>{N.value&&N.value.clearValidate()})},$=()=>en(this,null,function*(){(yield N.value.validate())&&(f.value===-1?(s.value.push(u.value),r.value.fields.push(u.value)):(s.value.splice(f.value,1,u.value),r.value.fields.splice(f.value,1,u.value)),c.value=!1,Dt(()=>{u.value={}}))}),M=X=>{Pr.confirm("确认移除该字段吗？","提示",{confirmButtonText:"确 认",cancelButtonText:"取 消"}).then(()=>{s.value.splice(X,1),r.value.fields.splice(X,1)}).catch(()=>console.info("操作取消"))},V=X=>{Pr.confirm("确认移除该监听器吗？","提示",{confirmButtonText:"确 认",cancelButtonText:"取 消"}).then(()=>{_.value.splice(X,1),a.value.splice(X,1),rl(g.value,b.value.concat(_.value))}).catch(()=>console.info("操作取消"))},K=()=>en(this,null,function*(){var U,Q,l,d;if(!(yield k.value.validate()))return;const z=Lb(r.value,!1,n);p.value===-1?(_.value.push(z),a.value.push(r.value)):(_.value.splice(p.value,1,z),a.value.splice(p.value,1,r.value)),b.value=(d=(l=(Q=(U=g.value.businessObject)==null?void 0:U.extensionElements)==null?void 0:Q.values)==null?void 0:l.filter(E=>E.$type!==`${n}:ExecutionListener`))!=null?d:[],rl(g.value,b.value.concat(_.value)),o.value=!1,r.value={}});return ct(()=>t.id,X=>{X&&X.length&&Dt(()=>{S()})},{immediate:!0}),(X,z)=>{const U=te("el-table-column"),Q=te("el-button"),l=te("el-divider"),d=te("el-table"),E=te("el-option"),y=te("el-select"),h=te("el-form-item"),x=te("el-input"),I=te("el-form"),F=te("Icon"),O=te("el-drawer"),H=te("el-dialog");return re(),Oe("div",j2,[R(d,{data:a.value,size:"small",border:""},{default:j(()=>[R(U,{label:"序号",width:"50px",type:"index"}),R(U,{label:"事件类型","min-width":"100px",prop:"event"}),R(U,{label:"监听器类型","min-width":"100px","show-overflow-tooltip":"",formatter:W=>m.value[W.listenerType]},null,8,["formatter"]),R(U,{label:"操作",width:"100px"},{default:j(W=>[R(Q,{size:"small",link:"",onClick:Y=>C(W.row,W.$index)},{default:j(()=>[me("编辑")]),_:2},1032,["onClick"]),R(l,{direction:"vertical"}),R(Q,{size:"small",link:"",style:{color:"#ff4d4f"},onClick:Y=>V(W.$index)},{default:j(()=>[me("移除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),Ve("div",H2,[R(Ke,{type:"primary",preIcon:"ep:plus",title:"添加监听器",onClick:z[0]||(z[0]=W=>C(null))})]),R(O,{modelValue:o.value,"onUpdate:modelValue":z[12]||(z[12]=W=>o.value=W),title:"执行监听器",size:`${Ge(i)}px`,"append-to-body":"","destroy-on-close":""},{default:j(()=>[R(I,{model:r.value,"label-width":"96px",ref_key:"listenerFormRef",ref:k},{default:j(()=>[R(h,{label:"事件类型",prop:"event",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(y,{modelValue:r.value.event,"onUpdate:modelValue":z[1]||(z[1]=W=>r.value.event=W)},{default:j(()=>[R(E,{label:"start",value:"start"}),R(E,{label:"end",value:"end"})]),_:1},8,["modelValue"])]),_:1}),R(h,{label:"监听器类型",prop:"listenerType",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(y,{modelValue:r.value.listenerType,"onUpdate:modelValue":z[2]||(z[2]=W=>r.value.listenerType=W)},{default:j(()=>[(re(!0),Oe(an,null,Tr(Object.keys(m.value),W=>(re(),ye(E,{key:W,label:m.value[W],value:W},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r.value.listenerType==="classListener"?(re(),ye(h,{label:"Java类",prop:"class",key:"listener-class",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(x,{modelValue:r.value.class,"onUpdate:modelValue":z[3]||(z[3]=W=>r.value.class=W),clearable:""},null,8,["modelValue"])]),_:1})):Ce("",!0),r.value.listenerType==="expressionListener"?(re(),ye(h,{label:"表达式",prop:"expression",key:"listener-expression",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(x,{modelValue:r.value.expression,"onUpdate:modelValue":z[4]||(z[4]=W=>r.value.expression=W),clearable:""},null,8,["modelValue"])]),_:1})):Ce("",!0),r.value.listenerType==="delegateExpressionListener"?(re(),ye(h,{label:"代理表达式",prop:"delegateExpression",key:"listener-delegate",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(x,{modelValue:r.value.delegateExpression,"onUpdate:modelValue":z[5]||(z[5]=W=>r.value.delegateExpression=W),clearable:""},null,8,["modelValue"])]),_:1})):Ce("",!0),r.value.listenerType==="scriptListener"?(re(),Oe(an,{key:3},[R(h,{label:"脚本格式",prop:"scriptFormat",key:"listener-script-format",rules:{required:!0,trigger:["blur","change"],message:"请填写脚本格式"}},{default:j(()=>[R(x,{modelValue:r.value.scriptFormat,"onUpdate:modelValue":z[6]||(z[6]=W=>r.value.scriptFormat=W),clearable:""},null,8,["modelValue"])]),_:1}),R(h,{label:"脚本类型",prop:"scriptType",key:"listener-script-type",rules:{required:!0,trigger:["blur","change"],message:"请选择脚本类型"}},{default:j(()=>[R(y,{modelValue:r.value.scriptType,"onUpdate:modelValue":z[7]||(z[7]=W=>r.value.scriptType=W)},{default:j(()=>[R(E,{label:"内联脚本",value:"inlineScript"}),R(E,{label:"外部脚本",value:"externalScript"})]),_:1},8,["modelValue"])]),_:1}),r.value.scriptType==="inlineScript"?(re(),ye(h,{label:"脚本内容",prop:"value",key:"listener-script",rules:{required:!0,trigger:["blur","change"],message:"请填写脚本内容"}},{default:j(()=>[R(x,{modelValue:r.value.value,"onUpdate:modelValue":z[8]||(z[8]=W=>r.value.value=W),clearable:""},null,8,["modelValue"])]),_:1})):Ce("",!0),r.value.scriptType==="externalScript"?(re(),ye(h,{label:"资源地址",prop:"resource",key:"listener-resource",rules:{required:!0,trigger:["blur","change"],message:"请填写资源地址"}},{default:j(()=>[R(x,{modelValue:r.value.resource,"onUpdate:modelValue":z[9]||(z[9]=W=>r.value.resource=W),clearable:""},null,8,["modelValue"])]),_:1})):Ce("",!0)],64)):Ce("",!0)]),_:1},8,["model"]),R(l),Ve("p",z2,[Ve("span",null,[R(F,{icon:"ep:menu"}),me("注入字段：")]),R(Ke,{type:"primary",onClick:z[10]||(z[10]=W=>D(null)),title:"添加字段"})]),R(d,{data:s.value,size:"small","max-height":"240",border:"",fit:"",style:{flex:"none"}},{default:j(()=>[R(U,{label:"序号",width:"50px",type:"index"}),R(U,{label:"字段名称","min-width":"100px",prop:"name"}),R(U,{label:"字段类型","min-width":"80px","show-overflow-tooltip":"",formatter:W=>v.value[W.fieldType]},null,8,["formatter"]),R(U,{label:"字段值/表达式","min-width":"100px","show-overflow-tooltip":"",formatter:W=>W.string||W.expression},null,8,["formatter"]),R(U,{label:"操作",width:"130px"},{default:j(W=>[R(Q,{size:"small",link:"",onClick:Y=>D(W.row,W.$index)},{default:j(()=>[me("编辑")]),_:2},1032,["onClick"]),R(l,{direction:"vertical"}),R(Q,{size:"small",link:"",style:{color:"#ff4d4f"},onClick:Y=>M(W.$index)},{default:j(()=>[me("移除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),Ve("div",G2,[R(Q,{onClick:z[11]||(z[11]=W=>o.value=!1)},{default:j(()=>[me("取 消")]),_:1}),R(Q,{type:"primary",onClick:K},{default:j(()=>[me("保 存")]),_:1})])]),_:1},8,["modelValue","size"]),R(H,{title:"字段配置",modelValue:c.value,"onUpdate:modelValue":z[18]||(z[18]=W=>c.value=W),width:"600px","append-to-body":"","destroy-on-close":""},{footer:j(()=>[R(Q,{size:"small",onClick:z[17]||(z[17]=W=>c.value=!1)},{default:j(()=>[me("取 消")]),_:1}),R(Q,{size:"small",type:"primary",onClick:$},{default:j(()=>[me("确 定")]),_:1})]),default:j(()=>[R(I,{model:u.value,"label-width":"96spx",ref_key:"listenerFieldFormRef",ref:N,style:{height:"136px"}},{default:j(()=>[R(h,{label:"字段名称：",prop:"name",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(x,{modelValue:u.value.name,"onUpdate:modelValue":z[13]||(z[13]=W=>u.value.name=W),clearable:""},null,8,["modelValue"])]),_:1}),R(h,{label:"字段类型：",prop:"fieldType",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(y,{modelValue:u.value.fieldType,"onUpdate:modelValue":z[14]||(z[14]=W=>u.value.fieldType=W)},{default:j(()=>[(re(!0),Oe(an,null,Tr(Object.keys(v.value),W=>(re(),ye(E,{key:W,label:v.value[W],value:W},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u.value.fieldType==="string"?(re(),ye(h,{label:"字段值：",prop:"string",key:"field-string",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(x,{modelValue:u.value.string,"onUpdate:modelValue":z[15]||(z[15]=W=>u.value.string=W),clearable:""},null,8,["modelValue"])]),_:1})):Ce("",!0),u.value.fieldType==="expression"?(re(),ye(h,{label:"表达式：",prop:"expression",key:"field-expression",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(x,{modelValue:u.value.expression,"onUpdate:modelValue":z[16]||(z[16]=W=>u.value.expression=W),clearable:""},null,8,["modelValue"])]),_:1})):Ce("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),W2={class:"panel-tab__content"},q2={class:"element-drawer__button"},Y2=mt({name:"ElementProperties",__name:"ElementProperties",props:{id:String,type:String},setup(e){const t=e,n=Ar("prefix"),i=Z([]),a=Z({}),r=Z(-1),o=Z(!1),s=Z(),u=Z(),c=Z(),p=Z(),f=Z(),m=()=>window==null?void 0:window.bpmnInstances,v=()=>{var N,A,S,C;console.log(window,"windowwindowwindowwindowwindowwindowwindow"),s.value=m().bpmnElement,u.value=[],c.value=(S=(A=(N=s.value.businessObject)==null?void 0:N.extensionElements)==null?void 0:A.values.filter(D=>(D.$type!==`${n}:Properties`&&u.value.push(D),D.$type===`${n}:Properties`)))!=null?S:[],p.value=c.value.reduce((D,$)=>D.concat($.values),[]),i.value=JSON.parse(JSON.stringify((C=p.value)!=null?C:[]))},g=(N,A)=>{r.value=A,a.value=A===-1?{}:JSON.parse(JSON.stringify(N)),o.value=!0,Dt(()=>{f.value&&f.value.clearValidate()})},b=(N,A)=>{console.log(N,"attr"),Pr.confirm("确认移除该属性吗？","提示",{confirmButtonText:"确 认",cancelButtonText:"取 消"}).then(()=>{i.value.splice(A,1),p.value.splice(A,1);const S=m().moddle.create(`${n}:Properties`,{values:p.value});k(S),v()}).catch(()=>console.info("操作取消"))},_=()=>{console.log(a.value,"propertyForm.value");const{name:N,value:A}=a.value;if(r.value!==-1)m().modeling.updateModdleProperties($e(s.value),$e(p.value)[$e(r.value)],{name:N,value:A});else{const S=m().moddle.create(`${n}:Property`,{name:N,value:A}),C=m().moddle.create(`${n}:Properties`,{values:p.value.concat([S])});k(C)}o.value=!1,v()},k=N=>{const A=m().moddle.create("bpmn:ExtensionElements",{values:u.value.concat([N])});m().modeling.updateProperties($e(s.value),{extensionElements:A})};return ct(()=>t.id,N=>{N&&N&&N.length&&v()},{immediate:!0}),(N,A)=>{const S=te("el-table-column"),C=te("el-button"),D=te("el-divider"),$=te("el-table"),M=te("el-input"),V=te("el-form-item"),K=te("el-form"),X=te("el-dialog");return re(),Oe("div",W2,[R($,{data:i.value,"max-height":"240",border:"",fit:""},{default:j(()=>[R(S,{label:"序号",width:"50px",type:"index"}),R(S,{label:"属性名",prop:"name","min-width":"100px","show-overflow-tooltip":""}),R(S,{label:"属性值",prop:"value","min-width":"100px","show-overflow-tooltip":""}),R(S,{label:"操作",width:"110px"},{default:j(z=>[R(C,{link:"",onClick:U=>g(z.row,z.$index),size:"small"},{default:j(()=>[me(" 编辑 ")]),_:2},1032,["onClick"]),R(D,{direction:"vertical"}),R(C,{link:"",size:"small",style:{color:"#ff4d4f"},onClick:U=>b(z.row,z.$index)},{default:j(()=>[me(" 移除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),Ve("div",q2,[R(Ke,{type:"primary",preIcon:"ep:plus",title:"添加属性",onClick:A[0]||(A[0]=z=>g(null,-1))})]),R(X,{modelValue:o.value,"onUpdate:modelValue":A[4]||(A[4]=z=>o.value=z),title:"属性配置",width:"600px","append-to-body":"","destroy-on-close":""},{footer:j(()=>[R(C,{onClick:A[3]||(A[3]=z=>o.value=!1)},{default:j(()=>[me("取 消")]),_:1}),R(C,{type:"primary",onClick:_},{default:j(()=>[me("确 定")]),_:1})]),default:j(()=>[R(K,{model:a.value,"label-width":"80px",ref_key:"attributeFormRef",ref:f},{default:j(()=>[R(V,{label:"属性名：",prop:"name"},{default:j(()=>[R(M,{modelValue:a.value.name,"onUpdate:modelValue":A[1]||(A[1]=z=>a.value.name=z),clearable:""},null,8,["modelValue"])]),_:1}),R(V,{label:"属性值：",prop:"value"},{default:j(()=>[R(M,{modelValue:a.value.value,"onUpdate:modelValue":A[2]||(A[2]=z=>a.value.value=z),clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),K2={class:"panel-tab__content"},X2={class:"element-drawer__button"},Z2={class:"listener-filed__title"},J2={class:"element-drawer__button"},Q2=mt({name:"UserTaskListeners",__name:"UserTaskListeners",props:{id:String,type:String},setup(e){const t=e,n=Ar("prefix"),i=Ar("width"),a=Z([]),r=Z(F2),o=Z(Vb),s=Z(!1),u=Z({}),c=Z(Fb),p=Z([]),f=Z(!1),m=Z(-1),v=Z(-1),g=Z({}),b=Z(),_=Z(),k=Z(),N=Z(),A=Z(),S=()=>window==null?void 0:window.bpmnInstances,C=()=>{var z,U,Q;console.log(S().bpmnElement,"window.bpmnInstances.bpmnElementwindow.bpmnInstances.bpmnElementwindow.bpmnInstances.bpmnElementwindow.bpmnInstances.bpmnElementwindow.bpmnInstances.bpmnElementwindow.bpmnInstances.bpmnElement"),b.value=S().bpmnElement,k.value=[],_.value=(Q=(U=(z=b.value.businessObject)==null?void 0:z.extensionElements)==null?void 0:U.values.filter(l=>l.$type===`${n}:TaskListener`))!=null?Q:[],a.value=_.value.map(l=>$b(l))},D=(z,U)=>{z?(u.value=Bb(z),m.value=U):(u.value={},m.value=-1),z&&z.fields?p.value=z.fields.map(Q=>Fi(at({},Q),{fieldType:Q.string?"string":"expression"})):(p.value=[],u.value.fields=[]),s.value=!0,Dt(()=>{N.value&&N.value.clearValidate()})},$=(z,U)=>{console.log(z,"listener"),Pr.confirm("确认移除该监听器吗？","提示",{confirmButtonText:"确 认",cancelButtonText:"取 消"}).then(()=>{_.value.splice(U,1),a.value.splice(U,1),rl(b.value,k.value.concat(_.value))}).catch(()=>console.info("操作取消"))},M=()=>en(this,null,function*(){var Q,l,d,E;if(!(yield N.value.validate()))return;const U=Lb(u.value,!0,n);m.value===-1?(_.value.push(U),a.value.push(u.value)):(_.value.splice(m.value,1,U),a.value.splice(m.value,1,u.value)),k.value=(E=(d=(l=(Q=b.value.businessObject)==null?void 0:Q.extensionElements)==null?void 0:l.values)==null?void 0:d.filter(y=>y.$type!==`${n}:TaskListener`))!=null?E:[],rl(b.value,k.value.concat(_.value)),s.value=!1,u.value={}}),V=(z,U)=>{g.value=z?JSON.parse(JSON.stringify(z)):{},v.value=z?U:-1,f.value=!0,Dt(()=>{A.value&&A.value.clearValidate()})},K=()=>en(this,null,function*(){(yield A.value.validate())&&(v.value===-1?(p.value.push(g.value),u.value.fields.push(g.value)):(p.value.splice(v.value,1,g.value),u.value.fields.splice(v.value,1,g.value)),f.value=!1,Dt(()=>{g.value={}}))}),X=(z,U)=>{console.log(z,"field"),Pr.confirm("确认移除该字段吗？","提示",{confirmButtonText:"确 认",cancelButtonText:"取 消"}).then(()=>{p.value.splice(U,1),u.value.fields.splice(U,1)}).catch(()=>console.info("操作取消"))};return ct(()=>t.id,z=>{z&&z.length&&Dt(()=>{C()})},{immediate:!0}),(z,U)=>{const Q=te("el-table-column"),l=te("el-button"),d=te("el-divider"),E=te("el-table"),y=te("el-option"),h=te("el-select"),x=te("el-form-item"),I=te("el-input"),F=te("el-form"),O=te("Icon"),H=te("el-drawer"),W=te("el-dialog");return re(),Oe("div",K2,[R(E,{data:a.value,size:"small",border:""},{default:j(()=>[R(Q,{label:"序号",width:"50px",type:"index"}),R(Q,{label:"事件类型","min-width":"80px","show-overflow-tooltip":"",formatter:Y=>r.value[Y.event]},null,8,["formatter"]),R(Q,{label:"事件id","min-width":"80px",prop:"id","show-overflow-tooltip":""}),R(Q,{label:"监听器类型","min-width":"80px","show-overflow-tooltip":"",formatter:Y=>o.value[Y.listenerType]},null,8,["formatter"]),R(Q,{label:"操作",width:"90px"},{default:j(Y=>[R(l,{size:"small",link:"",onClick:he=>D(Y.row,Y.$index)},{default:j(()=>[me("编辑")]),_:2},1032,["onClick"]),R(d,{direction:"vertical"}),R(l,{size:"small",link:"",style:{color:"#ff4d4f"},onClick:he=>$(Y.row,Y.$index)},{default:j(()=>[me("移除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),Ve("div",X2,[R(Ke,{size:"small",type:"primary",preIcon:"ep:plus",title:"添加监听器",onClick:U[0]||(U[0]=Y=>D(null))})]),R(H,{modelValue:s.value,"onUpdate:modelValue":U[15]||(U[15]=Y=>s.value=Y),title:"任务监听器",size:`${Ge(i)}px`,"append-to-body":"","destroy-on-close":""},{default:j(()=>[R(F,{size:"small",model:u.value,"label-width":"96px",ref_key:"listenerFormRef",ref:N},{default:j(()=>[R(x,{label:"事件类型",prop:"event",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(h,{modelValue:u.value.event,"onUpdate:modelValue":U[1]||(U[1]=Y=>u.value.event=Y)},{default:j(()=>[(re(!0),Oe(an,null,Tr(Object.keys(r.value),Y=>(re(),ye(y,{key:Y,label:r.value[Y],value:Y},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),R(x,{label:"监听器ID",prop:"id",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(I,{modelValue:u.value.id,"onUpdate:modelValue":U[2]||(U[2]=Y=>u.value.id=Y),clearable:""},null,8,["modelValue"])]),_:1}),R(x,{label:"监听器类型",prop:"listenerType",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(h,{modelValue:u.value.listenerType,"onUpdate:modelValue":U[3]||(U[3]=Y=>u.value.listenerType=Y)},{default:j(()=>[(re(!0),Oe(an,null,Tr(Object.keys(o.value),Y=>(re(),ye(y,{key:Y,label:o.value[Y],value:Y},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u.value.listenerType==="classListener"?(re(),ye(x,{label:"Java类",prop:"class",key:"listener-class",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(I,{modelValue:u.value.class,"onUpdate:modelValue":U[4]||(U[4]=Y=>u.value.class=Y),clearable:""},null,8,["modelValue"])]),_:1})):Ce("",!0),u.value.listenerType==="expressionListener"?(re(),ye(x,{label:"表达式",prop:"expression",key:"listener-expression",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(I,{modelValue:u.value.expression,"onUpdate:modelValue":U[5]||(U[5]=Y=>u.value.expression=Y),clearable:""},null,8,["modelValue"])]),_:1})):Ce("",!0),u.value.listenerType==="delegateExpressionListener"?(re(),ye(x,{label:"代理表达式",prop:"delegateExpression",key:"listener-delegate",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(I,{modelValue:u.value.delegateExpression,"onUpdate:modelValue":U[6]||(U[6]=Y=>u.value.delegateExpression=Y),clearable:""},null,8,["modelValue"])]),_:1})):Ce("",!0),u.value.listenerType==="scriptListener"?(re(),Oe(an,{key:3},[R(x,{label:"脚本格式",prop:"scriptFormat",key:"listener-script-format",rules:{required:!0,trigger:["blur","change"],message:"请填写脚本格式"}},{default:j(()=>[R(I,{modelValue:u.value.scriptFormat,"onUpdate:modelValue":U[7]||(U[7]=Y=>u.value.scriptFormat=Y),clearable:""},null,8,["modelValue"])]),_:1}),R(x,{label:"脚本类型",prop:"scriptType",key:"listener-script-type",rules:{required:!0,trigger:["blur","change"],message:"请选择脚本类型"}},{default:j(()=>[R(h,{modelValue:u.value.scriptType,"onUpdate:modelValue":U[8]||(U[8]=Y=>u.value.scriptType=Y)},{default:j(()=>[R(y,{label:"内联脚本",value:"inlineScript"}),R(y,{label:"外部脚本",value:"externalScript"})]),_:1},8,["modelValue"])]),_:1}),u.value.scriptType==="inlineScript"?(re(),ye(x,{label:"脚本内容",prop:"value",key:"listener-script",rules:{required:!0,trigger:["blur","change"],message:"请填写脚本内容"}},{default:j(()=>[R(I,{modelValue:u.value.value,"onUpdate:modelValue":U[9]||(U[9]=Y=>u.value.value=Y),clearable:""},null,8,["modelValue"])]),_:1})):Ce("",!0),u.value.scriptType==="externalScript"?(re(),ye(x,{label:"资源地址",prop:"resource",key:"listener-resource",rules:{required:!0,trigger:["blur","change"],message:"请填写资源地址"}},{default:j(()=>[R(I,{modelValue:u.value.resource,"onUpdate:modelValue":U[10]||(U[10]=Y=>u.value.resource=Y),clearable:""},null,8,["modelValue"])]),_:1})):Ce("",!0)],64)):Ce("",!0),u.value.event==="timeout"?(re(),Oe(an,{key:4},[R(x,{label:"定时器类型",prop:"eventDefinitionType",key:"eventDefinitionType"},{default:j(()=>[R(h,{modelValue:u.value.eventDefinitionType,"onUpdate:modelValue":U[11]||(U[11]=Y=>u.value.eventDefinitionType=Y)},{default:j(()=>[R(y,{label:"日期",value:"date"}),R(y,{label:"持续时长",value:"duration"}),R(y,{label:"循环",value:"cycle"}),R(y,{label:"无",value:"null"})]),_:1},8,["modelValue"])]),_:1}),u.value.eventDefinitionType&&u.value.eventDefinitionType!=="null"?(re(),ye(x,{label:"定时器",prop:"eventTimeDefinitions",key:"eventTimeDefinitions",rules:{required:!0,trigger:["blur","change"],message:"请填写定时器配置"}},{default:j(()=>[R(I,{modelValue:u.value.eventTimeDefinitions,"onUpdate:modelValue":U[12]||(U[12]=Y=>u.value.eventTimeDefinitions=Y),clearable:""},null,8,["modelValue"])]),_:1})):Ce("",!0)],64)):Ce("",!0)]),_:1},8,["model"]),R(d),Ve("p",Z2,[Ve("span",null,[R(O,{icon:"ep:menu"}),me("注入字段：")]),R(l,{size:"small",type:"primary",onClick:U[13]||(U[13]=Y=>V(null))},{default:j(()=>[me("添加字段")]),_:1})]),R(E,{data:p.value,size:"small","max-height":"240",border:"",fit:"",style:{flex:"none"}},{default:j(()=>[R(Q,{label:"序号",width:"50px",type:"index"}),R(Q,{label:"字段名称","min-width":"100px",prop:"name"}),R(Q,{label:"字段类型","min-width":"80px","show-overflow-tooltip":"",formatter:Y=>c.value[Y.fieldType]},null,8,["formatter"]),R(Q,{label:"字段值/表达式","min-width":"100px","show-overflow-tooltip":"",formatter:Y=>Y.string||Y.expression},null,8,["formatter"]),R(Q,{label:"操作",width:"100px"},{default:j(Y=>[R(l,{size:"small",link:"",onClick:he=>V(Y.row,Y.$index)},{default:j(()=>[me("编辑")]),_:2},1032,["onClick"]),R(d,{direction:"vertical"}),R(l,{size:"small",link:"",style:{color:"#ff4d4f"},onClick:he=>X(Y.row,Y.$index)},{default:j(()=>[me("移除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),Ve("div",J2,[R(l,{size:"small",onClick:U[14]||(U[14]=Y=>s.value=!1)},{default:j(()=>[me("取 消")]),_:1}),R(l,{size:"small",type:"primary",onClick:M},{default:j(()=>[me("保 存")]),_:1})])]),_:1},8,["modelValue","size"]),R(W,{title:"字段配置",modelValue:f.value,"onUpdate:modelValue":U[21]||(U[21]=Y=>f.value=Y),width:"600px","append-to-body":"","destroy-on-close":""},{footer:j(()=>[R(l,{size:"small",onClick:U[20]||(U[20]=Y=>f.value=!1)},{default:j(()=>[me("取 消")]),_:1}),R(l,{size:"small",type:"primary",onClick:K},{default:j(()=>[me("确 定")]),_:1})]),default:j(()=>[R(F,{model:g.value,size:"small","label-width":"96px",ref_key:"listenerFieldFormRef",ref:A,style:{height:"136px"}},{default:j(()=>[R(x,{label:"字段名称：",prop:"name",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(I,{modelValue:g.value.name,"onUpdate:modelValue":U[16]||(U[16]=Y=>g.value.name=Y),clearable:""},null,8,["modelValue"])]),_:1}),R(x,{label:"字段类型：",prop:"fieldType",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(h,{modelValue:g.value.fieldType,"onUpdate:modelValue":U[17]||(U[17]=Y=>g.value.fieldType=Y)},{default:j(()=>[(re(!0),Oe(an,null,Tr(Object.keys(c.value),Y=>(re(),ye(y,{key:Y,label:c.value[Y],value:Y},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),g.value.fieldType==="string"?(re(),ye(x,{label:"字段值：",prop:"string",key:"field-string",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(I,{modelValue:g.value.string,"onUpdate:modelValue":U[18]||(U[18]=Y=>g.value.string=Y),clearable:""},null,8,["modelValue"])]),_:1})):Ce("",!0),g.value.fieldType==="expression"?(re(),ye(x,{label:"表达式：",prop:"expression",key:"field-expression",rules:{required:!0,trigger:["blur","change"]}},{default:j(()=>[R(I,{modelValue:g.value.expression,"onUpdate:modelValue":U[19]||(U[19]=Y=>g.value.expression=Y),clearable:""},null,8,["modelValue"])]),_:1})):Ce("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),sc=mt({name:"MyPropertiesPanel",__name:"PropertiesPanel",props:{bpmnModeler:{type:Object,default:()=>{}},prefix:{type:String,default:"camunda"},width:{type:Number,default:480},idEditDisabled:{type:Boolean,default:!1},model:Object},setup(e){const t=e,n=Z("base"),i=Z(""),a=Z(""),r=Z({}),o=Z(!1),s=Z(!1),u=Z();Ls("prefix",t.prefix),Ls("width",t.width);const c=()=>window==null?void 0:window.bpmnInstances,p=ct(()=>t.bpmnModeler,()=>{if(!t.bpmnModeler){console.log("缺少props.bpmnModeler");return}console.log("props.bpmnModeler 有值了！！！");const v=window;v.bpmnInstances={modeler:t.bpmnModeler,modeling:t.bpmnModeler.get("modeling"),moddle:t.bpmnModeler.get("moddle"),eventBus:t.bpmnModeler.get("eventBus"),bpmnFactory:t.bpmnModeler.get("bpmnFactory"),elementFactory:t.bpmnModeler.get("elementFactory"),elementRegistry:t.bpmnModeler.get("elementRegistry"),replace:t.bpmnModeler.get("replace"),selection:t.bpmnModeler.get("selection")},console.log(c(),"window.bpmnInstances"),f(),p()},{immediate:!0}),f=()=>{m(null),t.bpmnModeler.on("import.done",v=>{console.log(v,"eeeee"),m(null)}),t.bpmnModeler.on("selection.changed",({newSelection:v})=>{m(v[0]||null)}),t.bpmnModeler.on("element.changed",({element:v})=>{v&&v.id===i.value&&m(v)})},m=v=>{var b;let g=v;g||(g=(b=c().elementRegistry.find(_=>_.type==="bpmn:Process"))!=null?b:c().elementRegistry.find(_=>_.type==="bpmn:Collaboration")),g&&(console.log(`
              ----------
      select element changed:
                id:  ${g.id}
              type:  ${g.businessObject.$type}
              ----------
              `),console.log("businessObject: ",g.businessObject),c().bpmnElement=g,u.value=g,i.value=g.id,a.value=g.type.split(":")[1]||"",r.value=JSON.parse(JSON.stringify(g.businessObject)),o.value=!!(a.value==="SequenceFlow"&&g.source&&g.source.type.indexOf("StartEvent")===-1),s.value=a.value==="UserTask"||a.value==="StartEvent")};return Vn(()=>{const v=window;v.bpmnInstances=null,console.log(t,"props1"),console.log(t.bpmnModeler,"props.bpmnModeler1")}),ct(()=>i.value,()=>{n.value="base"}),(v,g)=>{const b=te("Icon"),_=te("el-collapse-item"),k=te("el-link"),N=te("router-link"),A=te("el-collapse");return re(),Oe("div",{class:"process-panel__container",style:Sv({width:`${e.width}px`})},[R(A,{modelValue:n.value,"onUpdate:modelValue":g[0]||(g[0]=S=>n.value=S)},{default:j(()=>[R(_,{name:"base"},{title:j(()=>[R(b,{icon:"ep:info-filled"}),me(" 常规")]),default:j(()=>[R(h2,{"id-edit-disabled":e.idEditDisabled,"business-object":r.value,type:a.value,model:e.model},null,8,["id-edit-disabled","business-object","type","model"])]),_:1}),a.value==="Process"?(re(),ye(_,{name:"condition",key:"message"},{title:j(()=>[R(b,{icon:"ep:comment"}),me("消息与信号")]),default:j(()=>[R(L2)]),_:1})):Ce("",!0),o.value?(re(),ye(_,{name:"condition",key:"condition"},{title:j(()=>[R(b,{icon:"ep:promotion"}),me("流转条件")]),default:j(()=>[R(M2,{"business-object":r.value,type:a.value},null,8,["business-object","type"])]),_:1})):Ce("",!0),s.value?(re(),ye(_,{name:"condition",key:"form"},{title:j(()=>[R(b,{icon:"ep:list"}),me("表单")]),default:j(()=>[me(" 友情提示：使用 "),R(N,{to:{path:"/bpm/manager/form"}},{default:j(()=>[R(k,{type:"danger"},{default:j(()=>[me("流程表单")]),_:1})]),_:1}),me(" 替代，提供更好的表单设计功能 ")]),_:1})):Ce("",!0),a.value.indexOf("Task")!==-1?(re(),ye(_,{name:"task",key:"task"},{title:j(()=>[R(b,{icon:"ep:checked"}),me("任务")]),default:j(()=>[R(P2,{id:i.value,type:a.value},null,8,["id","type"])]),_:1})):Ce("",!0),a.value.indexOf("Task")!==-1?(re(),ye(_,{name:"multiInstance",key:"multiInstance"},{title:j(()=>[R(b,{icon:"ep:help-filled"}),me("多实例")]),default:j(()=>[R(I2,{"business-object":r.value,type:a.value},null,8,["business-object","type"])]),_:1})):Ce("",!0),R(_,{name:"listeners",key:"listeners"},{title:j(()=>[R(b,{icon:"ep:bell-filled"}),me("执行监听器")]),default:j(()=>[R(U2,{id:i.value,type:a.value},null,8,["id","type"])]),_:1}),a.value==="UserTask"?(re(),ye(_,{name:"taskListeners",key:"taskListeners"},{title:j(()=>[R(b,{icon:"ep:bell-filled"}),me("任务监听器")]),default:j(()=>[R(Q2,{id:i.value,type:a.value},null,8,["id","type"])]),_:1})):Ce("",!0),R(_,{name:"extensions",key:"extensions"},{title:j(()=>[R(b,{icon:"ep:circle-plus-filled"}),me("扩展属性")]),default:j(()=>[R(Y2,{id:i.value,type:a.value},null,8,["id","type"])]),_:1}),R(_,{name:"other",key:"other"},{title:j(()=>[R(b,{icon:"ep:promotion"}),me("其他")]),default:j(()=>[R(E2,{id:i.value},null,8,["id"])]),_:1})]),_:1},8,["modelValue"])],4)}}});sc.install=function(e){e.component(sc.name,sc)};const eB={class:"my-process-designer"},tB={class:"my-process-designer__container"},lc=mt({name:"MyProcessViewer",__name:"ProcessViewer",props:{value:{type:String,default:""},prefix:{type:String,default:"camunda"},activityData:{type:Array,default:()=>[]},processInstanceData:{type:Object,default:()=>{}},taskData:{type:Array,default:()=>[]}},emits:["destroy"],setup(e,{emit:t}){const n=e;Ls("configGlobal",n);let i;const a=Z(""),r=Z([]),o=Z(void 0),s=Z([]),u=Z(),c=Z(null),p=Z(null),f=()=>{i||(i=new ri({container:u.value,bpmnRenderer:{}}))},m=S=>en(this,null,function*(){let C=`Process_${new Date().getTime()}`,D=`业务流程_${new Date().getTime()}`,$=S||ZE(C,D,n.prefix);try{let{warnings:M}=yield i.importXML($);M&&M.length&&M.forEach(K=>console.warn(K)),yield v(),i.get("canvas").zoom("fit-viewport","auto")}catch(M){console.error(M)}}),v=()=>en(this,null,function*(){var M;const S=r.value;if(S.length===0)return;let C=i.get("canvas"),D=S.find(V=>!V.endTime),$=S[S.length-1];(M=i.getDefinitions().rootElements[0].flowElements)==null||M.forEach(V=>{var X,z,U;let K=S.find(Q=>Q.key===V.id);if(K){if(V.$type==="bpmn:UserTask"){const Q=s.value.find(d=>d.id===K.taskId);if(!Q||(C.addMarker(V.id,b(Q.result)),Q.result!==2))return;const l=_(K);l==null||l.forEach(d=>{let E=S.find(y=>y.key===d.targetRef.id);E?C.addMarker(d.id,E.endTime?"highlight":"highlight-todo"):d.targetRef.$type==="bpmn:ExclusiveGateway"?(C.addMarker(d.id,K.endTime?"highlight":"highlight-todo"),C.addMarker(d.targetRef.id,K.endTime?"highlight":"highlight-todo")):d.targetRef.$type==="bpmn:EndEvent"&&(!D&&$.key===V.id&&(C.addMarker(d.id,"highlight"),C.addMarker(d.targetRef.id,"highlight")),K.endTime||(C.addMarker(d.id,"highlight-todo"),C.addMarker(d.targetRef.id,"highlight-todo")))})}else if(V.$type==="bpmn:ExclusiveGateway"){C.addMarker(V.id,g(K));let Q,l;(X=V.outgoing)==null||X.forEach(d=>{let E=S.find(y=>y.key===d.targetRef.id);E&&(!l||l.type==="endEvent")&&(Q=d,l=E)}),Q&&l&&C.addMarker(Q.id,g(l))}else if(V.$type==="bpmn:ParallelGateway")C.addMarker(V.id,g(K)),(z=V.outgoing)==null||z.forEach(Q=>{const l=S.find(d=>d.key===Q.targetRef.id);l&&(C.addMarker(Q.id,g(l)),C.addMarker(Q.targetRef.id,g(l)))});else if(V.$type==="bpmn:StartEvent")(U=V.outgoing)==null||U.forEach(Q=>{S.find(d=>d.key===Q.targetRef.id)&&(C.addMarker(Q.id,"highlight"),C.addMarker(V.id,"highlight"))});else if(V.$type==="bpmn:EndEvent"){if(!o.value||o.value.result===1)return;C.addMarker(V.id,b(o.value.result))}else if(V.$type==="bpmn:ServiceTask"&&(K.startTime>0&&K.endTime===0&&C.addMarker(V.id,b(1)),K.endTime>0)){C.addMarker(V.id,b(2));const Q=_(K);Q==null||Q.forEach(l=>{C.addMarker(l.id,b(2))})}}})}),g=S=>S.endTime?"highlight":"highlight-todo",b=S=>S===1?"highlight-todo":S===2?"highlight":S===3?"highlight-reject":S===4?"highlight-cancel":"",_=S=>{if(S.outgoing&&S.outgoing.length>0)return S.outgoing;const C=i.getDefinitions().rootElements[0].flowElements,D=[];return C.forEach($=>{$.$type==="bpmn:SequenceFlow"&&$.sourceRef.id===S.key&&D.push($)}),D},k=()=>{const S=i.get("eventBus");S.on("element.hover",function(C){let D=C?C.element:null;N(D)}),S.on("element.out",function(C){let D=C?C.element:null;A(D)})},N=S=>{var D,$;S.value=S,!c.value&&(c.value={}),!p.value&&(p.value=i.get("overlays"));const C=r.value.find(M=>M.key===S.value.id);if(!c.value[S.value.id]&&S.value.type!=="bpmn:Process"){let M=`<div class="element-overlays">
            <p>Elemet id: ${S.value.id}</p>
            <p>Elemet type: ${S.value.type}</p>
          </div>`;if(S.value.type==="bpmn:StartEvent"&&o.value)M=`<p>发起人：${o.value.startUser.nickname}</p>
                  <p>部门：${o.value.startUser.deptName}</p>
                  <p>创建时间：${vr(o.value.createTime)}`;else if(S.value.type==="bpmn:UserTask"){let V=s.value.find(z=>z.id===C.taskId);if(!V)return;let K=xd(Sd.BPM_PROCESS_INSTANCE_RESULT),X="";K.forEach(z=>{z.value==V.result&&(X=z.label)}),M=`<p>审批人：${(D=V==null?void 0:V.assigneeUser)==null?void 0:D.nickname}</p>
                  <p>部门：${($=V==null?void 0:V.assigneeUser)==null?void 0:$.deptName}</p>
                  <p>结果：${X}</p>
                  <p>创建时间：${vr(V.createTime)}</p>`,V.endTime&&(M+=`<p>结束时间：${vr(V.endTime)}</p>`),V.reason&&(M+=`<p>审批建议：${V.reason}</p>`)}else if(S.value.type==="bpmn:ServiceTask"&&o.value)C.startTime>0&&(M=`<p>创建时间：${vr(C.startTime)}</p>`),C.endTime>0&&(M+=`<p>结束时间：${vr(C.endTime)}</p>`),console.log(M);else if(S.value.type==="bpmn:EndEvent"&&o.value){let V=xd(Sd.BPM_PROCESS_INSTANCE_RESULT),K="";V.forEach(X=>{X.value==o.value.result&&(K=X.label)}),M=`<p>结果：${K}</p>`,o.value.endTime&&(M+=`<p>结束时间：${vr(o.value.endTime)}</p>`)}console.log(M,"html111111111111111"),c.value[S.value.id]=$e(p.value).add(S.value,{position:{left:0,bottom:0},html:`<div class="element-overlays">${M}</div>`})}},A=S=>{$e(p.value).remove({element:S}),c.value[S.id]=null};return Ya(()=>{a.value=n.value,r.value=n.activityData,f(),m(a.value),k()}),Vn(()=>{i&&i.destroy(),t("destroy",i),i=null}),ct(()=>n.value,S=>{a.value=S,m(a.value)}),ct(()=>n.activityData,S=>{r.value=S,m(a.value)}),ct(()=>n.processInstanceData,S=>{o.value=S,m(a.value)}),ct(()=>n.taskData,S=>{s.value=S,m(a.value)}),(S,C)=>(re(),Oe("div",eB,[Ve("div",tB,[Ve("div",{class:"my-process-designer__canvas",style:{height:"760px"},ref_key:"bpmnCanvas",ref:u},null,512)])]))}});lc.install=function(e){e.component(lc.name,lc)};export{Nf as P,lc as _,Le as a,w as b,Yt as c,oc as d,sc as e,ar as g,Pe as i};
//# sourceMappingURL=bpmn-embedded-90db6ebb.js.map
