{"version":3,"file":"Operation-8f6d29d1.js","sources":["../../src/views/da/cockpit/operation/Operation.vue"],"sourcesContent":["<template>\n  <div v-if=\"refreshFlag\" class=\"layout rem-layout\">\n    <div class=\"dashboard\">\n      <CockpitHeader\n        v-if=\"tabStatus === 'on'\"\n        class=\"header-layout\"\n        :title=\"title\"\n        @date-change=\"handleDateChange\"\n      />\n      <CockpitSetting v-if=\"tabStatus === 'off'\" @date-change=\"handleDateChange\" />\n      <div class=\"content\">\n        <TopContent ref=\"topContentRef\" :data=\"formState\" />\n        <MiddleContent ref=\"middleContentRef\" :searchInfoByTime=\"searchInfoByTime\" :tabStatus=\"tabStatus\" />\n        <BottomContent ref=\"bottomContentRef\" :searchInfoByTime=\"searchInfoByTime\" :tabStatus=\"tabStatus\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import '../../rem.ts';\n  import { ref, reactive, onMounted, nextTick, getCurrentInstance } from 'vue';\n  import { assign } from 'min-dash';\n  import CockpitHeader from '/@/components/Framework/Chart/CockpitHeader.vue';\n  import TopContent from '/@/views/da/cockpit/operation/TopContent.vue';\n  import MiddleContent from '/@/views/da/cockpit/operation/MiddleContent.vue';\n  import BottomContent from '/@/views/da/cockpit/operation/BottomContent.vue';\n  import * as OperationApi from '@/api/da/cockpit/operation';\n  import CockpitSetting from '/@/components/Framework/Chart/CockpitSetting.vue';\n  import { handleInstanceUpdated } from '/@/utils/route';\n  import { useRouter } from 'vue-router';\n  // import { MsgManager } from '/@/message/MsgManager';\n\n  const title = ref('运维驾驶舱');\n  const formState = reactive({});\n  const refreshFlag = ref(true);\n  const tabStatus = ref('');\n  const searchInfoByTime = ref({}); // 时间参数\n  const instance = getCurrentInstance();\n  const topContentRef = ref();\n  const middleContentRef = ref();\n  const bottomContentRef = ref();\n  const router = useRouter();\n\n  const handleDateChange = ([startDate, endDate]) => {\n    searchInfoByTime.value = { startMonth: startDate, endMonth: endDate };\n    doTopInfo();\n  };\n\n  const doTopInfo = async () => {\n    const topInfo = await OperationApi.topInfo(searchInfoByTime.value);\n    if (topInfo) {\n      assign(formState, topInfo);\n    }\n  };\n\n  // 判断当前页面是否在 iframe 中显示\n  const checkInIframe = () => {\n    try {\n      return window.self !== window.top;\n    } catch (e) {\n      return true;\n    }\n  };\n\n  // 更新页面\n  const handlePageUpdate = () => {\n    try {\n      const path = router.currentRoute.value?.path;\n      if (path === '/frame/cockpit/operation') {\n        handleInstanceUpdated(instance);\n      } else if (path === '/cockpitoperation') {\n        bottomContentRef.value?.handleUpdate();\n        middleContentRef.value?.handleUpdate();\n        topContentRef.value?.handleUpdate();\n      }\n    } catch (error) {\n      console.error('update operation page error:', error);\n    }\n  };\n\n  onMounted(async () => {\n    tabStatus.value = checkInIframe() ? 'off' : 'on';\n    window.addEventListener('resize', handlePageUpdate);\n  });\n</script>\n\n<style lang=\"less\" scoped>\n  .layout {\n    position: relative;\n    width: 100%;\n    height: 100%;\n\n    .dashboard {\n      display: flex;\n      position: relative;\n      flex-direction: column;\n      width: 100%;\n      height: 100%;\n      background: url('../../../../assets/images/da/sky_bg.jpg') no-repeat center/100% 100%;\n\n      .content {\n        display: flex;\n        flex: 1;\n        flex-direction: column;\n        flex-shrink: 0;\n        height: 100%;\n        padding: 2.78vh 0.78vw 1.48vh;\n\n        :deep(.ant-select-selection-search-input) {\n          color: rgb(255 255 255 / 85%);\n        }\n\n        :deep(.ant-select-selection-item) {\n          color: rgb(255 255 255 / 85%);\n        }\n\n        :deep(\n            .ant-select-single .ant-select-selector .ant-select-selection-item,\n            .ant-select-single .ant-select-selector .ant-select-selection-placeholder\n          ) {\n          line-height: 0.24rem;\n        }\n\n        :deep(.ant-select) {\n          font-size: 0.14rem;\n        }\n      }\n    }\n  }\n</style>\n"],"names":["title","ref","formState","reactive","refreshFlag","tabStatus","searchInfoByTime","instance","getCurrentInstance","topContentRef","middleContentRef","bottomContentRef","router","useRouter","handleDateChange","startDate","endDate","doTopInfo","__async","topInfo","OperationApi.topInfo","assign","checkInIframe","handlePageUpdate","path","_a","handleInstanceUpdated","_b","_c","_d","error","onMounted"],"mappings":"gvCAiCQ,MAAAA,EAAQC,EAAI,OAAO,EACnBC,EAAYC,EAAS,CAAA,CAAE,EACvBC,EAAcH,EAAI,EAAI,EACtBI,EAAYJ,EAAI,EAAE,EAClBK,EAAmBL,EAAI,CAAA,CAAE,EACzBM,EAAWC,IACXC,EAAgBR,IAChBS,EAAmBT,IACnBU,EAAmBV,IACnBW,EAASC,IAETC,EAAmB,CAAC,CAACC,EAAWC,CAAO,IAAM,CACjDV,EAAiB,MAAQ,CAAE,WAAYS,EAAW,SAAUC,GAClDC,GAAA,EAGNA,EAAY,IAAYC,EAAA,sBAC5B,MAAMC,EAAU,MAAMC,EAAqBd,EAAiB,KAAK,EAC7Da,GACFE,EAAOnB,EAAWiB,CAAO,CAC3B,GAIIG,EAAgB,IAAM,CACtB,GAAA,CACK,OAAA,OAAO,OAAS,OAAO,UACvB,EAAG,CACH,MAAA,EACT,CAAA,EAIIC,EAAmB,IAAM,aACzB,GAAA,CACI,MAAAC,GAAOC,EAAAb,EAAO,aAAa,QAApB,YAAAa,EAA2B,KACpCD,IAAS,2BACXE,EAAsBnB,CAAQ,EACrBiB,IAAS,uBAClBG,EAAAhB,EAAiB,QAAjB,MAAAgB,EAAwB,gBACxBC,EAAAlB,EAAiB,QAAjB,MAAAkB,EAAwB,gBACxBC,EAAApB,EAAc,QAAd,MAAAoB,EAAqB,sBAEhBC,EAAO,CACN,QAAA,MAAM,+BAAgCA,CAAK,CACrD,CAAA,EAGF,OAAAC,EAAU,IAAYb,EAAA,sBACVb,EAAA,MAAQiB,IAAkB,MAAQ,KACrC,OAAA,iBAAiB,SAAUC,CAAgB,CAAA,EACnD"}