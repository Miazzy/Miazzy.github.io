{"version":3,"file":"boxTransformerSubstationList-719d0cf7.js","sources":["../../src/views/monitor/PVArea/subareaOverview/boxTransformerSubstationList.vue"],"sourcesContent":["<!--\n * @Description: 分区总览-箱变\n * @Date: 2023-10-10 09:40:47\n * @LastEditTime: 2023-11-01 16:12:40\n * @FilePath: \\ygwl-framework\\src\\views\\monitor\\PVArea\\subareaOverview\\boxTransformerSubstationList.vue\n-->\n<template>\n  <div class=\"combiner-box-list\">\n    <div class=\"combiner-box-header\">\n      <div class=\"header-left\">\n        <div>箱变：{{abnormalInfo.deviceNum}}台</div>\n        <div class=\"status-checkbox-group-box\">\n          <CheckboxGroup v-model:value=\"checkedStatus\" @change=\"handleStatusChange\">\n            <Checkbox v-for=\"(item, index) in statusOptions\" :key=\"index\" :value=\"item.value\">\n            <span class=\"status-label-text\">{{item.label}}</span>\n            <span :class=\"{'red-text': item.value!=='normal'&&item.number>0}\">{{item.number}}</span>\n            </Checkbox>\n          </CheckboxGroup>      \n        </div>\n      </div>\n    </div>\n    <div class=\"combiner-box-content\">\n      <div class=\"combiner-box-list-box\">\n        <DeviceItem class=\"device-item-layout\" v-for=\"(item, index) in transformerData\" :key=\"index\" :options=\"deviceItemOptions\" :data=\"item\" /> \n      </div>\n    </div>\n\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import { reactive, ref, watch, onMounted } from 'vue';\n  import { Checkbox, CheckboxGroup } from 'ant-design-vue';\n  import DeviceItem from '../../component/deviceItem.vue';\n  import { getTransformers } from '../../monitorApi.ts';\n\n  const props = defineProps({\n    stationId: String,\n    areaId: String\n  });\n\n  // 设备状态选项\n  const statusOptions = ref([\n    { label: '正常', value: 'normal', number: 0 },\n    { label: '告警', value: 'alarm', number: 0 },\n    { label: '通讯中断', value: 'interrupt', number: 0 },\n  ]);\n  const checkedStatus = ref(['normal', 'alarm', 'interrupt']);\n  const handleStatusChange = (checkedValue)=>{\n    console.log('checkedValue',checkedValue);\n    getTransformerData();\n  };\n\n  const abnormalInfo = reactive({}); // 箱变异常数据\n  const transformerData = ref([]); // 箱变数据\n  // 获取箱变数据\n  const getTransformerData = async () =>{\n    let res = await getTransformers({stationId: props.stationId, areaId: props.areaId, abnormalType: checkedStatus.value });\n    console.log('getTransformers', res);\n    Object.assign(abnormalInfo, res.abnormalInfo);\n    statusOptions.value[0].number = abnormalInfo.normalNum;\n    statusOptions.value[1].number = abnormalInfo.alarmNum;\n    statusOptions.value[2].number = abnormalInfo.interruptNum;\n    transformerData.value = res.dataList; \n  };\n\n  // 设备item显示内容配置\n  const deviceItemOptions = reactive({\n    deviceLabelKey: 'esn',\n    // right: [\n    //   {\n    //     label: '有功功率',\n    //     unit: 'kW',\n    //     dataKey: 'pvTotal',\n    //   },\n    //   {\n    //     label: '油温',\n    //     unit: '°C',\n    //     dataKey: 'oilTemperature',\n    //   },\n    //   {\n    //     label: '环境温度',\n    //     unit: '°C',\n    //     dataKey: 'ambientTemp',\n    //   }\n    // ],\n    // hasStatus: false,\n    left: 'pvTotal'\n  });\n\n  watch(()=>props.areaId, (newValue)=>{\n    if(newValue) {\n      getTransformerData();\n    }\n  });\n\n  onMounted(()=>{\n    // getTransformerData();\n  });\n\n  defineExpose({statusOptions});\n</script>\n\n<style lang=\"less\" scoped>\n  .combiner-box-list {\n    .combiner-box-header {\n      display: flex;\n      justify-content: space-between;\n      padding: 0 15px;\n\n      .header-left {\n        display: flex;\n        align-items: center;\n\n        & > div {\n          margin-right: 20px;\n        }\n      }\n\n      .status-checkbox-group-box {\n        .status-label-text {\n          margin-right: 6px;\n        }\n      }\n\n      .red-text {\n        color: #ff4d4f;\n      }\n    }\n\n    .combiner-box-content {\n      .combiner-box-list-box {\n        display: flex;\n        flex-wrap: wrap;\n        margin-right: -20px;\n        padding: 20px 15px 0;\n        overflow: hidden;\n\n        .device-item-layout {\n          margin: 0 20px 16px 0;\n          // float: left;\n          cursor: pointer;\n        }\n      }\n    }\n  }\n</style>"],"names":["statusOptions","ref","checkedStatus","handleStatusChange","checkedValue","getTransformerData","abnormalInfo","reactive","transformerData","__async","res","getTransformers","props","deviceItemOptions","watch","newValue","onMounted","__expose"],"mappings":"w1BA0CQA,EAAgBC,EAAI,CACxB,CAAE,MAAO,KAAM,MAAO,SAAU,OAAQ,CAAE,EAC1C,CAAE,MAAO,KAAM,MAAO,QAAS,OAAQ,CAAE,EACzC,CAAE,MAAO,OAAQ,MAAO,YAAa,OAAQ,CAAE,CAAA,CAChD,EACKC,EAAgBD,EAAI,CAAC,SAAU,QAAS,WAAW,CAAC,EACpDE,EAAsBC,GAAe,CACjC,QAAA,IAAI,eAAeA,CAAY,EACpBC,GAAA,EAGfC,EAAeC,EAAS,CAAA,CAAE,EAC1BC,EAAkBP,EAAI,CAAA,CAAE,EAExBI,EAAqB,IAAWI,EAAA,sBACpC,IAAIC,EAAM,MAAMC,EAAgB,CAAC,UAAWC,EAAM,UAAW,OAAQA,EAAM,OAAQ,aAAcV,EAAc,KAAO,CAAA,EAC9G,QAAA,IAAI,kBAAmBQ,CAAG,EAC3B,OAAA,OAAOJ,EAAcI,EAAI,YAAY,EAC5CV,EAAc,MAAM,CAAC,EAAE,OAASM,EAAa,UAC7CN,EAAc,MAAM,CAAC,EAAE,OAASM,EAAa,SAC7CN,EAAc,MAAM,CAAC,EAAE,OAASM,EAAa,aAC7CE,EAAgB,MAAQE,EAAI,QAAA,GAIxBG,EAAoBN,EAAS,CACjC,eAAgB,MAmBhB,KAAM,SAAA,CACP,EAED,OAAAO,EAAM,IAAIF,EAAM,OAASG,GAAW,CAC/BA,GACkBV,GACrB,CACD,EAEDW,EAAU,IAAI,CAAA,CAEb,EAEYC,EAAA,CAAC,cAAAjB,EAAc"}