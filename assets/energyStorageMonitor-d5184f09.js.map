{"version":3,"file":"energyStorageMonitor-d5184f09.js","sources":["../../src/views/monitor/energyStorage/energyStorageMonitor.vue"],"sourcesContent":["<!--\n * @Description: 储能监视\n * @Date: 2023-10-21 09:14:05\n * @LastEditTime: 2023-11-09 15:29:59\n * @FilePath: \\ygwl-framework\\src\\views\\monitor\\energyStorage\\energyStorageMonitor.vue\n-->\n<template>\n  <div class=\"energy-storage-monitor\">\n    <a-row class=\"energy-storage-monitor-row\" type=\"flex\" :wrap=\"false\">\n      <a-col flex=\"298px\" style=\"overflow: hidden\">\n        <div class=\"station-selector-box\">\n          <Select\n            style=\"width: 200px\"\n            v-model:value=\"curStationId\"\n            show-search\n            :options=\"stationList\"\n            :fieldNames=\"{ value: 'id', label: 'name' }\"\n            @change=\"handleChange\"\n          />\n        </div>\n\n        <CommonTree\n          class=\"fit-common-tree\"\n          title=\"储能设备树\"\n          :value=\"deviceTreeData\"\n          :toolbar=\"false\"\n          :fieldNames=\"{ key: 'id', title: 'name' }\"\n          :treeStyle=\"'margin: 10px 0 10px 0; height: calc(100vh - 97.5px);'\"\n          @select=\"handleSelect\"\n        />\n      </a-col>\n      <a-col flex=\"auto\" style=\"overflow: hidden\">\n        <EnergyStorageOverview v-if=\"rightType === 'overview'\" />\n        <EnergyStorageDevice\n          ref=\"detailInfo\"\n          v-else\n          :esn=\"selectedEsn\"\n          :curStationId=\"curStationId\"\n        />\n      </a-col>\n    </a-row>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import { ref, onMounted } from 'vue';\n  import { Checkbox, Tabs, Select, TabPane } from 'ant-design-vue';\n  import CommonTree from '@/components/Framework/Tree/CommonTree.vue';\n  import { TreeItem } from '/@/components/Tree';\n  import Icon from '@/components/Icon/Icon.vue';\n  import CategoryDialog from '/@/components/Framework/Modal/CategoryDialog.vue';\n  import EnergyStorageOverview from './energyStorageOverview.vue';\n  import EnergyStorageDevice from './energyStorageDevice.vue';\n  import { getStations, getDeviceTree } from '../monitorApi.ts';\n\n  // 选择的电站\n  const curStationId = ref();\n  const stationList = ref([]);\n  const selectedEsn = ref('');\n  const detailInfo = ref(null);\n  // 选电站\n  // const curStation = '湖北天门通力电站';\n\n  // const filterOption = (input: string, option: any) => {\n  //   return option.name.indexOf(input) >= 0;\n  // };\n  const searchBoxColumns = ref([\n    { title: '类型', dataIndex: 'typeName', key: 'typeName', fixed: 'left', minWidth: 100 },\n    { title: '年份', dataIndex: 'year', key: 'year', fixed: 'left', minWidth: 100 },\n    { title: '月份', dataIndex: 'month', key: 'month', fixed: 'left', minWidth: 100 },\n    { title: '期间', dataIndex: 'date', key: 'date', minWidth: 150 },\n  ]);\n\n  const searchBoxData = ref([\n    { typeName: '财务部类型-吉林通榆', year: '2020', month: '06', date: '2020-06' },\n    { typeName: '市场部类型-吉林通榆', year: '2020', month: '07', date: '2020-07' },\n    { typeName: '华南分部类型-江苏如东', year: '2020', month: '08', date: '2020-08' },\n    { typeName: '西北分部类型-吉林通榆', year: '2020', month: '09', date: '2020-09' },\n    { typeName: '华东分部类型-吉林通榆', year: '2020', month: '10', date: '2020-10' },\n    { typeName: '商务部类型-江苏如东', year: '2020', month: '11', date: '2020-11' },\n    { typeName: '研发部类型', year: '2020', month: '12', date: '2020-12' },\n    { typeName: '财务部类型', year: '2021', month: '01', date: '2021-01' },\n    { typeName: '研发部类型', year: '2021', month: '02', date: '2021-02' },\n    { typeName: '财务部类型', year: '2021', month: '03', date: '2021-03' },\n    { typeName: '市场部类型', year: '2021', month: '04', date: '2021-04' },\n  ]);\n  const stationTreeData = ref<TreeItem[]>([]);\n  // 获取电站列表数据\n  const getPowerStationList = async () => {\n    let res = await getStations();\n    if (res?.length) {\n      stationList.value = res;\n      if (!curStationId.value) {\n        curStationId.value = stationList.value[0].id;\n        loadDeviceTree();\n      }\n    }\n  };\n  // 选择电站\n  const handleChange = async (value: string, option) => {\n    curStationId.value = value;\n    loadDeviceTree();\n  };\n\n  // 设备树\n  const deviceTreeData = ref<TreeItem[]>([]);\n  const loadDeviceTree = async () => {\n    let param = { stationId: curStationId.value, deviceCategory: 'EnergyStorage' };\n    let deviceList = await getDeviceTree(param);\n    if (deviceList) {\n      deviceTreeData.value = deviceList;\n    }\n  };\n\n  // 左侧树状菜单选中事件\n  const handleSelect = (node) => {\n    if (node.nodeKindId === 'device') {\n      rightType.value = 'monitor';\n      selectedEsn.value = node.esn;\n      if (detailInfo.value) {\n        detailInfo.value.loadDetailInfo();\n      }\n    } else if (node.nodeKindId === 'category') {\n      rightType.value = 'overview';\n    }\n  };\n\n  // 右侧显示类型\n  const rightType = ref('overview');\n\n  // 启动\n  onMounted(async () => {\n    getPowerStationList();\n  });\n</script>\n\n<style lang=\"less\">\n  @import '../style/themes.less';\n</style>\n\n<style lang=\"less\" scoped>\n  .energy-storage-monitor {\n    height: 100%;\n    padding: 10px;\n\n    .energy-storage-monitor-row {\n      height: 100%;\n    }\n\n    .fit-common-tree {\n      height: 100% !important;\n      margin: 0 !important;\n      border: none !important;\n\n      :deep(.fit-tree-header) {\n        > div:first-child {\n          display: none;\n        }\n      }\n    }\n\n    .station-selector-box {\n      display: flex;\n      align-items: center;\n      padding: 7px 15px;\n      cursor: pointer;\n\n      .station-text {\n        margin-right: 7px;\n        font-size: 14px;\n      }\n    }\n  }\n</style>\n"],"names":["curStationId","ref","stationList","selectedEsn","detailInfo","getPowerStationList","__async","res","getStations","loadDeviceTree","handleChange","value","option","deviceTreeData","param","deviceList","getDeviceTree","handleSelect","node","rightType","onMounted"],"mappings":"otDAwDE,MAAMA,EAAeC,IACfC,EAAcD,EAAI,CAAA,CAAE,EACpBE,EAAcF,EAAI,EAAE,EACpBG,EAAaH,EAAI,IAAI,EAOFA,EAAI,CAC3B,CAAE,MAAO,KAAM,UAAW,WAAY,IAAK,WAAY,MAAO,OAAQ,SAAU,GAAI,EACpF,CAAE,MAAO,KAAM,UAAW,OAAQ,IAAK,OAAQ,MAAO,OAAQ,SAAU,GAAI,EAC5E,CAAE,MAAO,KAAM,UAAW,QAAS,IAAK,QAAS,MAAO,OAAQ,SAAU,GAAI,EAC9E,CAAE,MAAO,KAAM,UAAW,OAAQ,IAAK,OAAQ,SAAU,GAAI,CAAA,CAC9D,EAEqBA,EAAI,CACxB,CAAE,SAAU,aAAc,KAAM,OAAQ,MAAO,KAAM,KAAM,SAAU,EACrE,CAAE,SAAU,aAAc,KAAM,OAAQ,MAAO,KAAM,KAAM,SAAU,EACrE,CAAE,SAAU,cAAe,KAAM,OAAQ,MAAO,KAAM,KAAM,SAAU,EACtE,CAAE,SAAU,cAAe,KAAM,OAAQ,MAAO,KAAM,KAAM,SAAU,EACtE,CAAE,SAAU,cAAe,KAAM,OAAQ,MAAO,KAAM,KAAM,SAAU,EACtE,CAAE,SAAU,aAAc,KAAM,OAAQ,MAAO,KAAM,KAAM,SAAU,EACrE,CAAE,SAAU,QAAS,KAAM,OAAQ,MAAO,KAAM,KAAM,SAAU,EAChE,CAAE,SAAU,QAAS,KAAM,OAAQ,MAAO,KAAM,KAAM,SAAU,EAChE,CAAE,SAAU,QAAS,KAAM,OAAQ,MAAO,KAAM,KAAM,SAAU,EAChE,CAAE,SAAU,QAAS,KAAM,OAAQ,MAAO,KAAM,KAAM,SAAU,EAChE,CAAE,SAAU,QAAS,KAAM,OAAQ,MAAO,KAAM,KAAM,SAAU,CAAA,CACjE,EACuBA,EAAgB,CAAA,CAAE,EAE1C,MAAMI,EAAsB,IAAYC,EAAA,sBAClC,IAAAC,EAAM,MAAMC,IACZD,GAAA,MAAAA,EAAK,SACPL,EAAY,MAAQK,EACfP,EAAa,QAChBA,EAAa,MAAQE,EAAY,MAAM,CAAC,EAAE,GAC3BO,KAEnB,GAGIC,EAAe,CAAOC,EAAeC,IAAWN,EAAA,sBACpDN,EAAa,MAAQW,EACNF,GAAA,GAIXI,EAAiBZ,EAAgB,CAAA,CAAE,EACnCQ,EAAiB,IAAYH,EAAA,sBACjC,IAAIQ,EAAQ,CAAE,UAAWd,EAAa,MAAO,eAAgB,iBACzDe,EAAa,MAAMC,EAAcF,CAAK,EACtCC,IACFF,EAAe,MAAQE,EACzB,GAIIE,EAAgBC,GAAS,CACzBA,EAAK,aAAe,UACtBC,EAAU,MAAQ,UAClBhB,EAAY,MAAQe,EAAK,IACrBd,EAAW,OACbA,EAAW,MAAM,kBAEVc,EAAK,aAAe,aAC7BC,EAAU,MAAQ,WACpB,EAIIA,EAAYlB,EAAI,UAAU,EAGhC,OAAAmB,EAAU,IAAYd,EAAA,sBACAD,GAAA,EACrB"}