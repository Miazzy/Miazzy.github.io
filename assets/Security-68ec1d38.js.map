{"version":3,"file":"Security-68ec1d38.js","sources":["../../src/views/da/cockpit/security/Security.vue"],"sourcesContent":["<template>\n  <div v-if=\"refreshFlag\" class=\"layout rem-layout\">\n    <div class=\"dashboard\">\n      <CockpitHeader\n        v-if=\"tabStatus === 'on'\"\n        class=\"header-layout\"\n        :title=\"title\"\n        @date-change=\"handleDateChange\"\n      />\n      <CockpitSetting v-if=\"tabStatus === 'off'\" @date-change=\"handleDateChange\" />\n      <div class=\"content\">\n        <TopContent ref=\"topContentRef\" :data=\"formState\" />\n        <MiddleContent ref=\"middleContentRef\" :searchInfoByTime=\"searchInfoByTime\" :tabStatus=\"tabStatus\" />\n        <BottomContent ref=\"bottomContentRef\" :searchInfoByTime=\"searchInfoByTime\" :tabStatus=\"tabStatus\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\n  import '../../rem.ts';\n  import { ref, reactive, onMounted, nextTick, getCurrentInstance } from 'vue';\n  import { assign } from 'min-dash';\n  import CockpitHeader from '/@/components/Framework/Chart/CockpitHeader.vue';\n  import TopContent from '/@/views/da/cockpit/security/TopContent.vue';\n  import MiddleContent from '/@/views/da/cockpit/security/MiddleContent.vue';\n  import BottomContent from '/@/views/da/cockpit/security/BottomContent.vue';\n  import * as SecurityApi from '@/api/da/cockpit/security';\n  import CockpitSetting from '/@/components/Framework/Chart/CockpitSetting.vue';\n  import { handleInstanceUpdated } from '/@/utils/route';\n  import { useRouter } from 'vue-router';\n  // import { MsgManager } from '/@/message/MsgManager';\n\n  //时间参数\n  const searchInfoByTime = ref({});\n  const title = ref('安全驾驶舱');\n  const refreshFlag = ref(true);\n  const tabStatus = ref('');\n  const instance = getCurrentInstance();\n  const topContentRef = ref();\n  const middleContentRef = ref();\n  const bottomContentRef = ref();\n  const router = useRouter();\n  const formState = reactive({\n    runningDays: '',\n\n    safeCheckCount: '',\n    safeCheckQoq: '',\n    safeCheckYoy: '',\n\n    trainingCount: '',\n    trainingQoq: '',\n    trainingYoy: '',\n\n    hiddenCount: '',\n    hiddenQoq: '',\n    hiddenYoy: '',\n\n    toolsCount: '',\n    signRage: '',\n  });\n\n  const handleDateChange = ([startDate, endDate]) => {\n    searchInfoByTime.value = { startMonth: startDate, endMonth: endDate };\n    doTopInfo();\n  };\n\n  const doTopInfo = async () => {\n    const topInfo = await SecurityApi.topInfo(searchInfoByTime.value);\n    if (topInfo) {\n      assign(formState, topInfo);\n    }\n  };\n\n  // 判断当前页面是否在 iframe 中显示\n  const checkInIframe = () => {\n    try {\n      return window.self !== window.top;\n    } catch (e) {\n      return true;\n    }\n  };\n\n  // 更新页面\n  const handlePageUpdate = () => {\n    try {\n      const path = router.currentRoute.value?.path;\n      if (path === '/frame/cockpit/security') {\n        handleInstanceUpdated(instance);\n      } else if (path === '/cockpitsecurity') {\n        bottomContentRef.value?.handleUpdate();\n        middleContentRef.value?.handleUpdate();\n        topContentRef.value?.handleUpdate();\n      }\n    } catch (error) {\n      console.error('update power page error:', error);\n    }\n  };\n\n  onMounted(async () => {\n    tabStatus.value = checkInIframe() ? 'off' : 'on';\n    window.addEventListener('resize', handlePageUpdate);\n  });\n</script>\n\n<style lang=\"less\" scoped>\n  .layout {\n    position: relative;\n    width: 100%;\n    height: 100%;\n\n    .dashboard {\n      display: flex;\n      position: relative;\n      flex-direction: column;\n      width: 100%;\n      height: 100%;\n      background: url('../../../../assets/images/da/sky_bg.jpg') no-repeat center/100% 100%;\n\n      .content {\n        display: flex;\n        flex: 1;\n        flex-direction: column;\n        flex-shrink: 0;\n        height: 100%;\n        padding: 2.78vh 0.78vw 1.48vh;\n\n        :deep(.ant-select-selection-search-input) {\n          color: rgb(255 255 255 / 85%);\n        }\n\n        :deep(.ant-select-selection-item) {\n          color: rgb(255 255 255 / 85%);\n        }\n\n        :deep(\n            .ant-select-single .ant-select-selector .ant-select-selection-item,\n            .ant-select-single .ant-select-selector .ant-select-selection-placeholder\n          ) {\n          line-height: 0.24rem;\n        }\n\n        :deep(.ant-select) {\n          font-size: 0.14rem;\n        }\n      }\n    }\n  }\n</style>\n"],"names":["searchInfoByTime","ref","title","refreshFlag","tabStatus","instance","getCurrentInstance","topContentRef","middleContentRef","bottomContentRef","router","useRouter","formState","reactive","handleDateChange","startDate","endDate","doTopInfo","__async","topInfo","SecurityApi.topInfo","assign","checkInIframe","handlePageUpdate","path","_a","handleInstanceUpdated","_b","_c","_d","error","onMounted"],"mappings":"+uCAkCQ,MAAAA,EAAmBC,EAAI,CAAA,CAAE,EACzBC,EAAQD,EAAI,OAAO,EACnBE,EAAcF,EAAI,EAAI,EACtBG,EAAYH,EAAI,EAAE,EAClBI,EAAWC,IACXC,EAAgBN,IAChBO,EAAmBP,IACnBQ,EAAmBR,IACnBS,EAASC,IACTC,EAAYC,EAAS,CACzB,YAAa,GAEb,eAAgB,GAChB,aAAc,GACd,aAAc,GAEd,cAAe,GACf,YAAa,GACb,YAAa,GAEb,YAAa,GACb,UAAW,GACX,UAAW,GAEX,WAAY,GACZ,SAAU,EAAA,CACX,EAEKC,EAAmB,CAAC,CAACC,EAAWC,CAAO,IAAM,CACjDhB,EAAiB,MAAQ,CAAE,WAAYe,EAAW,SAAUC,GAClDC,GAAA,EAGNA,EAAY,IAAYC,EAAA,sBAC5B,MAAMC,EAAU,MAAMC,EAAoBpB,EAAiB,KAAK,EAC5DmB,GACFE,EAAOT,EAAWO,CAAO,CAC3B,GAIIG,EAAgB,IAAM,CACtB,GAAA,CACK,OAAA,OAAO,OAAS,OAAO,UACvB,EAAG,CACH,MAAA,EACT,CAAA,EAIIC,EAAmB,IAAM,aACzB,GAAA,CACI,MAAAC,GAAOC,EAAAf,EAAO,aAAa,QAApB,YAAAe,EAA2B,KACpCD,IAAS,0BACXE,EAAsBrB,CAAQ,EACrBmB,IAAS,sBAClBG,EAAAlB,EAAiB,QAAjB,MAAAkB,EAAwB,gBACxBC,EAAApB,EAAiB,QAAjB,MAAAoB,EAAwB,gBACxBC,EAAAtB,EAAc,QAAd,MAAAsB,EAAqB,sBAEhBC,EAAO,CACN,QAAA,MAAM,2BAA4BA,CAAK,CACjD,CAAA,EAGF,OAAAC,EAAU,IAAYb,EAAA,sBACVd,EAAA,MAAQkB,IAAkB,MAAQ,KACrC,OAAA,iBAAiB,SAAUC,CAAgB,CAAA,EACnD"}