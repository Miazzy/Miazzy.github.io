{"version":3,"file":"Breadcrumb-7fe96961.js","sources":["../../src/layouts/default/header/components/Breadcrumb.vue"],"sourcesContent":["<template>\n  <div :class=\"[prefixCls, `${prefixCls}--${theme}`]\">\n    <a-breadcrumb :routes=\"routes\">\n      <template #itemRender=\"{ route, routes: routesMatched, paths }\">\n        <Icon :icon=\"getIcon(route)\" v-if=\"getShowBreadCrumbIcon && getIcon(route)\" />\n        <span v-if=\"!hasRedirect(routesMatched, route)\">\n          {{ t(route.name || route.meta.title) }}\n        </span>\n        <router-link v-else to=\"\" @click=\"handleClick(route, paths, $event)\">\n          {{ t(route.name || route.meta.title) }}\n        </router-link>\n      </template>\n    </a-breadcrumb>\n  </div>\n</template>\n<script lang=\"ts\">\n  import type { RouteLocationMatched } from 'vue-router';\n  import { useRouter } from 'vue-router';\n  import type { Menu } from '/@/router/types';\n\n  import { defineComponent, ref, watchEffect } from 'vue';\n\n  import { Breadcrumb } from 'ant-design-vue';\n  import Icon from '@/components/Icon/Icon.vue';\n\n  import { useDesign } from '/@/hooks/web/useDesign';\n  import { useRootSetting } from '/@/hooks/setting/useRootSetting';\n  import { useGo } from '/@/hooks/web/usePage';\n  import { useI18n } from '/@/hooks/web/useI18n';\n\n  import { propTypes } from '/@/utils/propTypes';\n  import { isString } from '/@/utils/is';\n  import { filter } from '/@/utils/helper/treeHelper';\n  import { getMenus } from '/@/router/menus';\n\n  import { REDIRECT_NAME } from '/@/router/constant';\n  import { getAllParentPath } from '/@/router/helper/menuHelper';\n\n  export default defineComponent({\n    name: 'LayoutBreadcrumb',\n    components: { Icon, [Breadcrumb.name]: Breadcrumb },\n    props: {\n      theme: propTypes.oneOf(['dark', 'light']),\n    },\n    setup() {\n      const routes = ref<RouteLocationMatched[]>([]);\n      const { currentRoute } = useRouter();\n      const { prefixCls } = useDesign('layout-breadcrumb');\n      const { getShowBreadCrumbIcon } = useRootSetting();\n      const go = useGo();\n\n      const { t } = useI18n();\n      watchEffect(async () => {\n        if (currentRoute.value.name === REDIRECT_NAME) return;\n        const menus = await getMenus();\n\n        const routeMatched = currentRoute.value.matched;\n        const cur = routeMatched?.[routeMatched.length - 1];\n        let path = currentRoute.value.path;\n\n        if (cur && cur?.meta?.currentActiveMenu) {\n          path = cur.meta.currentActiveMenu as string;\n        }\n\n        const parent = getAllParentPath(menus, path);\n        const filterMenus = menus.filter((item) => item.path === parent[0]);\n        const matched = getMatched(filterMenus, parent) as any;\n\n        if (!matched || matched.length === 0) return;\n\n        const breadcrumbList = filterItem(matched);\n\n        if (currentRoute.value.meta?.currentActiveMenu) {\n          breadcrumbList.push({\n            ...currentRoute.value,\n            name: currentRoute.value.meta?.title || currentRoute.value.name,\n          } as unknown as RouteLocationMatched);\n        }\n        routes.value = breadcrumbList;\n      });\n\n      function getMatched(menus: Menu[], parent: string[]) {\n        const metched: Menu[] = [];\n        menus.forEach((item) => {\n          if (parent.includes(item.path)) {\n            metched.push({\n              ...item,\n              name: item.meta?.title || item.name,\n            });\n          }\n          if (item.children?.length) {\n            metched.push(...getMatched(item.children, parent));\n          }\n        });\n        return metched;\n      }\n\n      function filterItem(list: RouteLocationMatched[]) {\n        return filter(list, (item) => {\n          const { meta, name } = item;\n          if (!meta) {\n            return !!name;\n          }\n          const { title, hideBreadcrumb, hideMenu } = meta;\n          if (!title || hideBreadcrumb || hideMenu) {\n            return false;\n          }\n          return true;\n        }).filter((item) => !item.meta?.hideBreadcrumb);\n      }\n\n      function handleClick(route: RouteLocationMatched, paths: string[], e: Event) {\n        e?.preventDefault();\n        const { children, redirect, meta } = route;\n\n        if (children?.length && !redirect) {\n          e?.stopPropagation();\n          return;\n        }\n        if (meta?.carryParam) {\n          return;\n        }\n\n        if (redirect && isString(redirect)) {\n          go(redirect);\n        } else {\n          let goPath = '';\n          if (paths.length === 1) {\n            goPath = paths[0];\n          } else {\n            const ps = paths.slice(1);\n            const lastPath = ps.pop() || '';\n            goPath = `${lastPath}`;\n          }\n          goPath = /^\\//.test(goPath) ? goPath : `/${goPath}`;\n          go(goPath);\n        }\n      }\n\n      function hasRedirect(routes: RouteLocationMatched[], route: RouteLocationMatched) {\n        return routes.indexOf(route) !== routes.length - 1;\n      }\n\n      function getIcon(route) {\n        return route.icon || route.meta?.icon;\n      }\n\n      return { routes, t, prefixCls, getIcon, getShowBreadCrumbIcon, handleClick, hasRedirect };\n    },\n  });\n</script>\n<style lang=\"less\">\n  @prefix-cls: ~'@{namespace}-layout-breadcrumb';\n\n  .@{prefix-cls} {\n    display: flex;\n    align-items: center;\n    padding: 0 8px;\n\n    .ant-breadcrumb-link {\n      .anticon {\n        margin-right: 4px;\n        margin-bottom: 2px;\n      }\n    }\n\n    &--light {\n      .ant-breadcrumb-link {\n        color: @breadcrumb-item-normal-color;\n\n        a {\n          color: rgb(0 0 0 / 65%);\n\n          &:hover {\n            color: @primary-color;\n          }\n        }\n      }\n\n      .ant-breadcrumb-separator {\n        color: @breadcrumb-item-normal-color;\n      }\n    }\n\n    &--dark {\n      .ant-breadcrumb-link {\n        color: rgb(255 255 255 / 60%);\n\n        a {\n          color: rgb(255 255 255 / 80%);\n\n          &:hover {\n            color: @white;\n          }\n        }\n      }\n\n      .ant-breadcrumb-separator,\n      .anticon {\n        color: rgb(255 255 255 / 80%);\n      }\n    }\n  }\n</style>\n"],"names":["_sfc_main","defineComponent","Icon","Breadcrumb","propTypes","routes","ref","currentRoute","useRouter","prefixCls","useDesign","getShowBreadCrumbIcon","useRootSetting","go","useGo","t","useI18n","watchEffect","__async","REDIRECT_NAME","menus","getMenus","routeMatched","cur","path","_a","parent","getAllParentPath","filterMenus","item","matched","getMatched","breadcrumbList","filterItem","_b","__spreadProps","__spreadValues","_c","metched","list","filter","meta","name","title","hideBreadcrumb","hideMenu","handleClick","route","paths","e","children","redirect","isString","goPath","hasRedirect","getIcon","_resolveComponent","_normalizeClass","_ctx","_createVNode","_component_a_breadcrumb","_withCtx","routesMatched","_openBlock","_createBlock","_component_Icon","_createCommentVNode","_component_router_link","$event","_createElementBlock","_hoisted_1","_toDisplayString"],"mappings":"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"}