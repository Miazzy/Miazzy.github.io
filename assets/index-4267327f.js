var i=(w,h,a)=>new Promise((m,s)=>{var n=o=>{try{l(a.next(o))}catch(c){s(c)}},g=o=>{try{l(a.throw(o))}catch(c){s(c)}},l=o=>o.done?m(o.value):Promise.resolve(o.value).then(n,g);l((a=a.apply(w,h)).next())});import{au as L,b as M,a7 as H,av as k,ax as W,az as q,aA as K,_ as Z}from"./index.js";import{B as $}from"./BasicTable-0434a334.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1ba7be9e.js";import"./index-085d06c7.js";import{u as j}from"./useTable-109483b3.js";import{a2 as y}from"./antd-15ac76ed.js";import{d as G,ax as J,k as S,r as x,o as Q,al as U,Z as _,a9 as X,aa as u,f as v,$ as Y,u as r,E as F,ad as D,_ as I,F as ee,ac as C}from"./vue-71d1abb3.js";import{P as te}from"./index-20519caf.js";import{g as ae,c as oe,s as se,a as ne}from"./daily-77449ffc.js";import{C as re}from"./CommonTree-c4ed7838.js";import{a as ie}from"./assign-37f1c13d.js";import"./useForm-dea3ed18.js";import"./uniqBy-92d3bc7f.js";import"./index-316f6ffb.js";import"./useWindowSizeFn-13b1b8a2.js";import"./index-f4fc48e6.js";import"./useTabs-2b062e85.js";import"./download-03e71dd5.js";import"./index-5d49b7a7.js";import"./SearchBox-22bb02d6.js";import"./UploadBox-636ecf02.js";import"./Dialog-0a006d82.js";import"./DictSelectBox.vue_vue_type_script_setup_true_lang-e03e9fe8.js";import"./OrganDialog-dd1023ce.js";import"./sortable.esm-4ae27e0b.js";import"./dict-c04c0dd8.js";import"./useContentViewHeight-7f845167.js";import"./useRender-21ce56fb.js";import"./index-3801a970.js";const le={class:"right-table-layout"},ce={key:0,style:{color:"red"}},de={key:1,style:{color:"#30ca5a"}},pe=G({__name:"index",setup(w){const{createConfirm:h}=L();J();const a=S({stationId:"",stationOrganId:"",pageNo:1,pageSize:10}),{t:m}=M();let s=S("");x({});const n=x({}),g=S([]),l=()=>i(this,null,function*(){let t=yield ae({});g.value=t.result}),o=()=>i(this,null,function*(){const e=T(),t=O().getFieldsValue();return ie(t,a.value),t.pageNo=e.current,t.pageSize=e.pageSize,t.sortField=n.sortField,t.sortOrder=n.sortOrder,yield ne(t)}),[c,{reload:b,getPaginationRef:T,getForm:O,getSelectRows:P}]=j({title:"日常评价",api:o,rowKey:"id",columns:oe,useSearchForm:!0,showTableSetting:!0,bordered:!0,pagination:{pageSize:20,pageSizeOptions:["20","50","100","200"]},handleSearchInfoFn(e){return e},formConfig:{labelWidth:120,actionColOptions:{span:24},autoAdvancedLine:1,baseColProps:{span:7},schemas:se,noHideBtnFlag:!0,autoSubmitOnEnter:!0},rowSelection:{type:"radio",fixed:!0,onSelect:R},sortFn:e=>{e.order?(n.sortField=e.field,n.sortOrder=e.order.replace("end","")):(n.sortField="",n.sortOrder="")}});function N({keys:e,rows:t}){if(t&&t.length>0){const d=t[0];s.value=d.id}else s.value=""}function R(e,t){t?s.value=e.id:s.value=""}function B(e){e!=null&&(a.value.stationId=e.powerStationId,a.value.stationName=e.powerStationName,a.value.stationOrganId=e.organId),b()}const E=()=>i(this,null,function*(){if(a.value.stationId==""){y.error("请选择电站。");return}W("/po/integrated/assessmentevaluation/daily/create?stationId="+a.value.stationId+"&stationName="+a.value.stationName,"添加日常评价")});function z(e){q(e.id)}function A(){const e=P();return e.length==0?(y.error("请选择一行数据"),!1):e[0]}function V(){return i(this,null,function*(){h({title:"提示",iconType:"warning",content:"确定要删除选中记录？",onOk(){return i(this,null,function*(){const t=A();if(t.id){if(t.status!=0){y.error("非草稿状态不能删除。");return}yield K(t.processInstanceId),y.success("已删除。"),b()}})}})})}return Q(()=>i(this,null,function*(){l(),H.getInstance().listen("daily-evaluation",b)})),(e,t)=>{const d=U("a-button");return _(),X(r(te),{dense:"",contentFullHeight:"",fixedHeight:"",contentClass:"flex",style:{position:"relative"}},{default:u(()=>[v(re,{title:"电站组织",onSelect:B,value:g.value,canEdit:!1,canAdd:!1,canDelete:!1,class:"left-tree-layout",isShowOperationBtns:!1,fieldNames:{key:"id",title:"name"}},null,8,["value"]),Y("div",le,[v(r($),{class:"fix-basic-table",onRegister:r(c),onResizeColumn:t[0]||(t[0]=(p,f)=>f.width=p),onRowDbClick:t[1]||(t[1]=p=>z(p)),onSelectionChange:N},{toolbar:u(()=>[v(d,{type:"primary",preIcon:r(k).ADD,onClick:E},{default:u(()=>[F(D(r(m)("common.action.create")),1)]),_:1},8,["preIcon"]),v(d,{class:"red-btn",disabled:r(s)=="",preIcon:r(k).DELETE,onClick:V},{default:u(()=>[F(D(r(m)("common.delText")),1)]),_:1},8,["disabled","preIcon"])]),bodyCell:u(({column:p,text:f,record:ue})=>[p.key==="businessStatus"?(_(),I(ee,{key:0},[f==0?(_(),I("span",ce,"禁用")):C("",!0),f==1?(_(),I("span",de,"启用")):C("",!0)],64)):C("",!0)]),_:1},8,["onRegister"])])]),_:1})}}});const qe=Z(pe,[["__scopeId","data-v-06218d3d"]]);export{qe as default};
//# sourceMappingURL=index-4267327f.js.map
