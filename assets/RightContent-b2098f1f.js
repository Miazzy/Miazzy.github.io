var F=(e,n,t)=>new Promise((a,r)=>{var o=i=>{try{l(t.next(i))}catch(u){r(u)}},s=i=>{try{l(t.throw(i))}catch(u){r(u)}},l=i=>i.done?a(i.value):Promise.resolve(i.value).then(o,s);l((t=t.apply(e,n)).next())});import{a as de}from"./index.esm-c216ed00.js";import{S as V}from"./SubtitleBar-001f5f49.js";import{_ as fe}from"./EchartLineBarChart.vue_vue_type_style_index_0_lang-90edad95.js";import{d as G,k as m,o as Y,b as se,Z as R,_ as N,$ as y,F as pe,ae as ve,a6 as M,ad as Z,H as ye,w as ie,f as S,u as ge,r as H,al as me,aa as K,a9 as xe,ac as _e}from"./vue-71d1abb3.js";import{_ as ce,am as J,ax as Q}from"./index.js";import{S as X,r as we,c as be}from"./transform-d70cf238.js";import{d as Se,e as De,f as Ce}from"./index-116b659b.js";import{_ as ke}from"./EchartPieChart.vue_vue_type_script_setup_true_lang-58fa16af.js";import"./index-d8a2358f.js";import"./install-58e0bd81.js";import"./NoData-1ab5cc7b.js";import"./antd-15ac76ed.js";function Ae(e){return typeof e=="string"?new X([[document.querySelector(e)]],[document.documentElement]):new X([[e]],we)}function Te(e){var n=0,t=e.children,a=t&&t.length;if(!a)n=1;else for(;--a>=0;)n+=t[a].value;e.value=n}function Me(){return this.eachAfter(Te)}function Re(e,n){let t=-1;for(const a of this)e.call(n,a,++t,this);return this}function Fe(e,n){for(var t=this,a=[t],r,o,s=-1;t=a.pop();)if(e.call(n,t,++s,this),r=t.children)for(o=r.length-1;o>=0;--o)a.push(r[o]);return this}function Ie(e,n){for(var t=this,a=[t],r=[],o,s,l,i=-1;t=a.pop();)if(r.push(t),o=t.children)for(s=0,l=o.length;s<l;++s)a.push(o[s]);for(;t=r.pop();)e.call(n,t,++i,this);return this}function Ne(e,n){let t=-1;for(const a of this)if(e.call(n,a,++t,this))return a}function $e(e){return this.eachAfter(function(n){for(var t=+e(n.data)||0,a=n.children,r=a&&a.length;--r>=0;)t+=a[r].value;n.value=t})}function Be(e){return this.eachBefore(function(n){n.children&&n.children.sort(e)})}function Ee(e){for(var n=this,t=ze(n,e),a=[n];n!==t;)n=n.parent,a.push(n);for(var r=a.length;e!==t;)a.splice(r,0,e),e=e.parent;return a}function ze(e,n){if(e===n)return e;var t=e.ancestors(),a=n.ancestors(),r=null;for(e=t.pop(),n=a.pop();e===n;)r=e,e=t.pop(),n=a.pop();return r}function Pe(){for(var e=this,n=[e];e=e.parent;)n.push(e);return n}function qe(){return Array.from(this)}function Ve(){var e=[];return this.eachBefore(function(n){n.children||e.push(n)}),e}function Ze(){var e=this,n=[];return e.each(function(t){t!==e&&n.push({source:t.parent,target:t})}),n}function*He(){var e=this,n,t=[e],a,r,o;do for(n=t.reverse(),t=[];e=n.pop();)if(yield e,a=e.children)for(r=0,o=a.length;r<o;++r)t.push(a[r]);while(t.length)}function O(e,n){e instanceof Map?(e=[void 0,e],n===void 0&&(n=Le)):n===void 0&&(n=je);for(var t=new z(e),a,r=[t],o,s,l,i;a=r.pop();)if((s=n(a.data))&&(i=(s=Array.from(s)).length))for(a.children=s,l=i-1;l>=0;--l)r.push(o=s[l]=new z(s[l])),o.parent=a,o.depth=a.depth+1;return t.eachBefore(Ye)}function Ue(){return O(this).eachBefore(Ge)}function je(e){return e.children}function Le(e){return Array.isArray(e)?e[1]:null}function Ge(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Ye(e){var n=0;do e.height=n;while((e=e.parent)&&e.height<++n)}function z(e){this.data=e,this.depth=this.height=0,this.parent=null}z.prototype=O.prototype={constructor:z,count:Me,each:Re,eachAfter:Ie,eachBefore:Fe,find:Ne,sum:$e,sort:Be,path:Ee,ancestors:Pe,descendants:qe,leaves:Ve,links:Ze,copy:Ue,[Symbol.iterator]:He};function Oe(e){return e==null?null:We(e)}function We(e){if(typeof e!="function")throw new Error;return e}function ee(){return 0}function Ke(e){return function(){return e}}const Je=1664525,Qe=1013904223,te=4294967296;function Xe(){let e=1;return()=>(e=(Je*e+Qe)%te)/te}function et(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function tt(e,n){let t=e.length,a,r;for(;t;)r=n()*t--|0,a=e[t],e[t]=e[r],e[r]=a;return e}function nt(e,n){for(var t=0,a=(e=tt(Array.from(e),n)).length,r=[],o,s;t<a;)o=e[t],s&&ue(s,o)?++t:(s=rt(r=at(r,o)),t=0);return s}function at(e,n){var t,a;if(U(n,e))return[n];for(t=0;t<e.length;++t)if(B(n,e[t])&&U(I(e[t],n),e))return[e[t],n];for(t=0;t<e.length-1;++t)for(a=t+1;a<e.length;++a)if(B(I(e[t],e[a]),n)&&B(I(e[t],n),e[a])&&B(I(e[a],n),e[t])&&U(he(e[t],e[a],n),e))return[e[t],e[a],n];throw new Error}function B(e,n){var t=e.r-n.r,a=n.x-e.x,r=n.y-e.y;return t<0||t*t<a*a+r*r}function ue(e,n){var t=e.r-n.r+Math.max(e.r,n.r,1)*1e-9,a=n.x-e.x,r=n.y-e.y;return t>0&&t*t>a*a+r*r}function U(e,n){for(var t=0;t<n.length;++t)if(!ue(e,n[t]))return!1;return!0}function rt(e){switch(e.length){case 1:return ot(e[0]);case 2:return I(e[0],e[1]);case 3:return he(e[0],e[1],e[2])}}function ot(e){return{x:e.x,y:e.y,r:e.r}}function I(e,n){var t=e.x,a=e.y,r=e.r,o=n.x,s=n.y,l=n.r,i=o-t,u=s-a,d=l-r,f=Math.sqrt(i*i+u*u);return{x:(t+o+i/f*d)/2,y:(a+s+u/f*d)/2,r:(f+r+l)/2}}function he(e,n,t){var a=e.x,r=e.y,o=e.r,s=n.x,l=n.y,i=n.r,u=t.x,d=t.y,f=t.r,v=a-s,w=a-u,b=r-l,x=r-d,D=i-o,C=f-o,k=a*a+r*r-o*o,A=k-s*s-l*l+i*i,T=k-u*u-d*d+f*f,c=w*b-v*x,h=(b*T-x*A)/(c*2)-a,g=(x*D-b*C)/c,p=(w*A-v*T)/(c*2)-r,_=(v*C-w*D)/c,P=g*g+_*_-1,$=2*(o+h*g+p*_),W=h*h+p*p-o*o,q=-(Math.abs(P)>1e-6?($+Math.sqrt($*$-4*P*W))/(2*P):W/$);return{x:a+h+g*q,y:r+p+_*q,r:q}}function ne(e,n,t){var a=e.x-n.x,r,o,s=e.y-n.y,l,i,u=a*a+s*s;u?(o=n.r+t.r,o*=o,i=e.r+t.r,i*=i,o>i?(r=(u+i-o)/(2*u),l=Math.sqrt(Math.max(0,i/u-r*r)),t.x=e.x-r*a-l*s,t.y=e.y-r*s+l*a):(r=(u+o-i)/(2*u),l=Math.sqrt(Math.max(0,o/u-r*r)),t.x=n.x+r*a-l*s,t.y=n.y+r*s+l*a)):(t.x=n.x+t.r,t.y=n.y)}function ae(e,n){var t=e.r+n.r-1e-6,a=n.x-e.x,r=n.y-e.y;return t>0&&t*t>a*a+r*r}function re(e){var n=e._,t=e.next._,a=n.r+t.r,r=(n.x*t.r+t.x*n.r)/a,o=(n.y*t.r+t.y*n.r)/a;return r*r+o*o}function E(e){this._=e,this.next=null,this.previous=null}function lt(e,n){if(!(o=(e=et(e)).length))return 0;var t,a,r,o,s,l,i,u,d,f,v;if(t=e[0],t.x=0,t.y=0,!(o>1))return t.r;if(a=e[1],t.x=-a.r,a.x=t.r,a.y=0,!(o>2))return t.r+a.r;ne(a,t,r=e[2]),t=new E(t),a=new E(a),r=new E(r),t.next=r.previous=a,a.next=t.previous=r,r.next=a.previous=t;e:for(i=3;i<o;++i){ne(t._,a._,r=e[i]),r=new E(r),u=a.next,d=t.previous,f=a._.r,v=t._.r;do if(f<=v){if(ae(u._,r._)){a=u,t.next=a,a.previous=t,--i;continue e}f+=u._.r,u=u.next}else{if(ae(d._,r._)){t=d,t.next=a,a.previous=t,--i;continue e}v+=d._.r,d=d.previous}while(u!==d.next);for(r.previous=t,r.next=a,t.next=a.previous=a=r,s=re(t);(r=r.next)!==a;)(l=re(r))<s&&(t=r,s=l);a=t.next}for(t=[a._],r=a;(r=r.next)!==a;)t.push(r._);for(r=nt(t,n),i=0;i<o;++i)t=e[i],t.x-=r.x,t.y-=r.y;return r.r}function st(e){return Math.sqrt(e.value)}function it(){var e=null,n=1,t=1,a=ee;function r(o){const s=Xe();return o.x=n/2,o.y=t/2,e?o.eachBefore(oe(e)).eachAfter(j(a,.5,s)).eachBefore(le(1)):o.eachBefore(oe(st)).eachAfter(j(ee,1,s)).eachAfter(j(a,o.r/Math.min(n,t),s)).eachBefore(le(Math.min(n,t)/(2*o.r))),o}return r.radius=function(o){return arguments.length?(e=Oe(o),r):e},r.size=function(o){return arguments.length?(n=+o[0],t=+o[1],r):[n,t]},r.padding=function(o){return arguments.length?(a=typeof o=="function"?o:Ke(+o),r):a},r}function oe(e){return function(n){n.children||(n.r=Math.max(0,+e(n)||0))}}function j(e,n,t){return function(a){if(r=a.children){var r,o,s=r.length,l=e(a)*n||0,i;if(l)for(o=0;o<s;++o)r[o].r+=l;if(i=lt(r,t),l)for(o=0;o<s;++o)r[o].r-=l;a.r=i+l}}}function le(e){return function(n){var t=n.parent;n.r*=e,t&&(n.x=t.x+e*n.x,n.y=t.y+e*n.y)}}const ct={class:"scroll-container"},ut={style:{color:"white"}},ht=.5,L=150,dt=G({__name:"BubbleDataGrid",props:{data:Array,width:{type:Number,default:200},height:{type:Number,default:228},rowHeight:{type:Number,default:"28"},evenRowColor:{type:String,default:"#DAF1FE05"},oddRowColor:{type:String,default:"#DAF1FE10"}},setup(e){const n=e,t=m({width:n.width+"px",height:n.height+"px"}),a=m({width:"35%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}),r=m({width:"65%","text-align":"right","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}),o=m(null),s=m(0),l=m(0);return Y(()=>{const i=o.value,u=i.querySelector(".scroll-container"),d=i.querySelectorAll(".row");function f(){s.value+=ht,u.style.transform=`translateY(-${s.value}px)`;const v=(d.length-3)*n.rowHeight;s.value>=v&&(s.value=0,u.style.transform=`translateY(-${s.value}px)`,clearInterval(l.value),setTimeout(()=>{l.value=setInterval(f,L)},L))}l.value=setInterval(f,L)}),se(()=>{clearInterval(l.value)}),(i,u)=>(R(),N("div",{class:"row-data-display",style:M(t.value),ref_key:"container",ref:o},[y("div",ct,[(R(!0),N(pe,null,ve(e.data,(d,f)=>(R(),N("div",{key:f,class:"row",style:M({"background-color":f%2===0?e.evenRowColor:e.oddRowColor,"line-height":e.rowHeight+"px"})},[y("div",{class:"title",style:M(a.value)},Z(d.title||d.label),5),y("div",{class:"content",style:M(r.value)},[y("span",{style:M(`color: ${d.color}; margin: 0 5px 0 0;`)},Z(d.value),5),y("span",ut,Z(d.unit),1)],4)],4))),128))])],4))}});const ft=ce(dt,[["__scopeId","data-v-2bfb8b33"]]),pt={class:"bubble-chart",style:{position:"relative"}},vt=G({__name:"BubbleChart",props:{data:Array,width:Number,height:Number,fontSize:{type:String,default:"12px"},fontColor:{type:String,default:"black"}},emits:["clickItem"],setup(e,{emit:n}){const t=e,{data:a,width:r,height:o,fontSize:s,fontColor:l}=ye(t),i=m(null);se(()=>{});const u=f=>(Math.sqrt(f)/8).toFixed(2)+"rem";function d(f,v,w,b,x,D){const C=Ae(f).append("svg").attr("width",w).attr("height",b),k=it().size([w,b]).padding(1.5),A=O({children:v}).sum(c=>c.value),T=k(A).leaves();C.selectAll("circle").data(T).enter().append("circle").attr("r",c=>c.r*.9).attr("cx",c=>c.x*1).attr("cy",c=>c.y*1).attr("fill",c=>{const h=c.data.color;return be(h).copy({opacity:.075})}).style("stroke",c=>c.data.color).style("stroke-width","2px").style("cursor","pointer").on("click",(c,h)=>{n("clickItem",h)}),C.selectAll("text").data(T).enter().append("text").attr("x",c=>c.x).attr("y",c=>c.y).attr("text-anchor","middle").attr("dy",".3em").style("font-size",c=>u(c.data.size||x)).style("fill",c=>c.data.color||D).style("cursor","pointer").text(c=>c.data.name).on("click",(c,h)=>{n("clickItem",h)})}return ie(()=>t.data,()=>{d(i.value,a.value,r.value,o.value,s.value,l.value)},{deep:!0}),Y(()=>{d(i.value,a.value,r.value,o.value,s.value,l.value)}),(f,v)=>(R(),N("div",pt,[y("div",{ref_key:"chart",ref:i},null,512),S(ft,{data:t.data,style:M(`position:absolute; top: 0px; left: ${ge(r)+5}px;`)},null,8,["data","style"])]))}}),yt={class:"top-section section-box"},gt={class:"section-bg"},mt={style:{width:"100%",height:"1.85rem"}},xt={style:{"margin-left":"0.16rem",transform:"scale(0.85)","transform-origin":"0 0"}},_t={class:"middel-section section-box"},wt={class:"section-bg"},bt={style:{width:"100%",height:"1.85rem"}},St={class:"bottom-section section-box"},Dt={class:"section-bg"},Ct={style:{width:"100%"}},kt="white",At="#1890FF",Tt=G({__name:"RightContent",props:{searchInfoByTime:{type:Object,default:{}},tabStatus:{type:String,default:""}},setup(e,{expose:n}){const t=e,a=H({}),r=m(J());ie(()=>t.searchInfoByTime,c=>{de(a,c),D(o.selectType)});const o=H({planSelectType:"all",selectType:"ageRange"});Y(()=>F(this,null,function*(){i(),w()}));const s=m([{label:"历年",value:"all"},{label:"当年",value:"inThoseYear"},{label:"近12个月",value:"december"}]),l=m({barData:[[],[]],categories:[],lineData:[[]],colors:[["#488FF6","#60D1F3"],["#078C5D","#68E4B8"],["#078C5D","#68E4B8"],["#e59837","#fae895"],["#078C5D","#68E4B8"]],seriesName:[["减线损上网电量","计划电量"],["完成率"]],dataZoomDefaultValueRange:[0,4]}),i=()=>F(this,null,function*(){var g,p;const c={dateType:o.planSelectType};l.value.barData.splice(0,l.value.barData.length),l.value.categories.splice(0,l.value.categories.length),l.value.lineData.splice(0,l.value.lineData.length);const h=yield Se(c);h&&((g=h.barData)!=null&&g.length?l.value.barData=h.barData:l.value.barData=[],(p=h.lineData)!=null&&p.length?l.value.lineData[0]=h.lineData:l.value.lineData=[],l.value.categories=h.categories)}),u=()=>{i()},d=m("0.18rem"),f=["#1890FF","green","yellow","blue","skyblue","purple","#9023a0"],v=m([]),w=()=>F(this,null,function*(){v.value.splice(0,v.value.length);const c=yield De({});c&&c.forEach((h,g)=>{let p=f[g];if(!p){var _=Math.floor(Math.random()*f.length);p=f[_]}v.value.push({name:h.provinceShortName,label:h.provinceShortName,value:h.stationCount,size:h.stationCount,color:p,unit:"座"})})});m("总人数");const b=m([{label:"年龄结构",value:"ageRange"},{label:"学历结构",value:"degree"}]),x=H({pieData:null}),D=c=>F(this,null,function*(){x.pieData=null;const h=_=>({name:_.label,value:_.value}),g=["#03AAFF90","#62E99F90","#99DD0090","#00BBFF90"],p=yield Ce({startMonth:a.startMonth,endMonth:a.endMonth});p&&(c=="ageRange"?(x.pieData=p.ageRange.map(h),x.colors=g):(x.pieData=p.degree.map(h),x.value.colors=g))}),C=c=>{D(c)};function k(c){Q("/bi/elec/planned","计划电量统计",{startDate:o.planSelectType==="all"?c.name+"-01":c.name,endDate:o.planSelectType==="all"?c.name+"-12":c.name})}const A=()=>{o.selectType==="ageRange"&&Q("/bi/integrated/personnelStructure")};return n({handleUpdate:()=>{r.value=J()}}),(c,h)=>{const g=me("a-select");return R(),N("div",{class:"right-content",key:r.value},[y("div",yt,[y("div",gt,[S(V,{subtitle:"计划完成"},{default:K(()=>[S(g,{value:o.planSelectType,"onUpdate:value":h[0]||(h[0]=p=>o.planSelectType=p),options:s.value,onChange:u,style:{width:"1.2rem"}},null,8,["value","options"])]),_:1}),y("div",mt,[y("div",xt,[S(fe,{data:l.value,colors:l.value.colors,width:"26.06vw",height:e.tabStatus==="on"?"28.07vh":"31.38vh",category:l.value.categories,ybgcolor:"#01B7D730",name:l.value.seriesName,rotate:0,onClickItem:k,xAxisLabelInterval:"auto",dataZoomDefaultValueRange:l.value.dataZoomDefaultValueRange,dataZoomDisabled:!1,dataZoomMaxValueSpan:l.value.categories.length},null,8,["data","colors","height","category","name","dataZoomDefaultValueRange","dataZoomMaxValueSpan"])])])])]),y("div",_t,[y("div",wt,[S(V,{subtitle:"电站分布"}),y("div",bt,[v.value.length?(R(),xe(vt,{key:0,data:v.value,width:200,height:180,"font-size":d.value,"font-color":kt,"bubble-color":At,style:{"margin-top":"2.4vh"}},null,8,["data","font-size"])):_e("",!0)])])]),y("div",St,[y("div",Dt,[S(V,{subtitle:"运维人员"},{default:K(()=>[S(g,{value:o.selectType,"onUpdate:value":h[1]||(h[1]=p=>o.selectType=p),options:b.value,onChange:C,style:{width:"1.2rem"}},null,8,["value","options"])]),_:1}),y("div",Ct,[S(ke,{id:"person-stat-pie",width:"24.4vw",height:e.tabStatus==="on"?"33.08vh":"26.53vh",data:x.pieData,roseType:!1,radius:e.tabStatus==="on"?["35%","50%"]:["40%","60%"],showLabel:"",pieCenter:e.tabStatus==="on"?["50%","40%"]:["50%","55%"],onClickItem:A},null,8,["height","data","radius","pieCenter"])])])])])}}});const Ht=ce(Tt,[["__scopeId","data-v-ea084a55"]]);export{Ht as default};
//# sourceMappingURL=RightContent-b2098f1f.js.map
